(function(e){var f=window.AmazonUIPageJS||window.P,l=f._namespace||f.attributeErrors,d=l?l("PrimeAcquisitionMetricsJS",""):f;d.guardFatal?d.guardFatal(e)(d,window):d.execute(function(){e(d,window)})})(function(e,f,l){e.when("A","prime-page-state-helper").register("prime-forester-loggers",function(d,e,g){var c=function(a){a=a||{};var b=a.createEventData,d=a.channel,c=a.apiVersion||"1",m=a.version||"1",e=a.action||"OP";a=a.debug||!1;var h;if(b===g)throw Error("No createEventData function specified.");
if(d===g)throw Error("No channel specified.");ue!==g&&(h=ue_furl||ue.furl||g);a&&(e="TOP");this.createEventData=b;this.endpoint={protocol:"https",host:h||"fls-na.amazon.com",apiVersion:c,channel:d,version:m,action:e};this.runtime={sendMetricCount:0,logCount:0,logData:[],lastLoggedData:null,mostRecentLoggingIncomplete:!0};b=function(a,b,d){return function(c){a.resendLastData(d);try{b&&"function"===typeof b&&b(c)}catch(n){}}};f.onbeforeunload=b(this,f.onbeforeunload,"bu");f.onunload=b(this,f.onunload,
"u")},h=function(a){a=a||{};a.channel="prime-csm-metrics";a.version="1";a.pageState=a.pageState||"ms3-client-metadata";a.createEventData=function(b,c){b={id:b,ac:c,et:d.now()};this.addCSMMetadata(b);this.addMS3Metadata(b,a.pageState);return b};c.call(this,a)},k=function(a){a=a||{};a.channel="prime-presentation-metrics";a.version="1";a.pageState=a.pageState||"ms3-client-metadata";a.createEventData=function(b,c){b={id:b,pt:c,et:d.now()};this.addCSMMetadata(b);this.addMS3Metadata(b,a.pageState);return b};
c.call(this,a)};c.prototype.getEndpoint=function(){return this.endpoint.protocol+"://"+[this.endpoint.host,this.endpoint.apiVersion,this.endpoint.channel,this.endpoint.version,this.endpoint.action].join("/")};c.prototype.toJsonString=function(a){var b=f.JSON;return b&&b.stringify?b.stringify(a):"{"+d.reduce(a,function(a,b,c){b!==g&&(c='"'+c+'":',c=null===b||"[object Number]"==Object.prototype.toString.call(b)?c+b:c+('"'+b+'"'),a.push(c));return a},[]).join(",")+"}"};c.prototype.addMetric=function(a){this.runtime.logCount+=
1;a=this.createEventData(this.runtime.logCount,a);this.runtime.logData.push(a);this.runtime.lastLoggedData=a;d.delay(function(a){return function(){a.sendMetric()}}(this))};c.prototype.sendMetric=function(){for(var a=function(a,b){return function(){a.runtime.logData.push(b);a.runtime.mostRecentLoggingIncomplete=!0}};0<this.runtime.logData.length;){this.runtime.sendMetricCount+=1;var b=new Image,c=this.runtime.logData.shift();b.src=this.getEndpoint()+"/"+this.toJsonString(c)+this.runtime.sendMetricCount;
b.onabort=a(this,c)}};c.prototype.resendLastData=function(a){if(null!==this.runtime.lastLoggedData&&this.runtime.mostRecentLoggingIncomplete){var b=d.copy(this.runtime.lastLoggedData);b.le=a;this.runtime.logData.push(b);this.runtime.mostRecentLoggingIncomplete=!1;this.sendMetric()}};c.prototype.addCSMMetadata=function(a){if(ue!==g){if(ue_sid||ue.sid)a.s=ue_sid||ue.sid;ue.rid&&(a.r=ue.rid)}};c.prototype.addMS3Metadata=function(a,b){b=e.get(b);b!==g&&(b.containerRequestID&&(a.mgid=b.containerRequestID),
b.customerID&&(a.cid=b.customerID),b.marketplaceID&&(a.mkt=b.marketplaceID))};Object&&Object.create?(h.prototype=Object.create(c.prototype),k.prototype=Object.create(c.prototype)):(h.prototype=d.copy(c.prototype),h.prototype.constructor=h,k.prototype=d.copy(c.prototype),k.prototype.constructor=k);return{BaseLogger:c,EventLogger:h,PresentationLogger:k}});e.when("A").register("prime-page-state-helper",function(d){return{get:function(e){var g={};d.each(d.$('script[type\x3d"a-state"]'),function(c,f){d.$(c).data("a-state").key===
e&&(g=d.parseJSON(d.$(c).html()))});return g}}})});
/* ******** */
(function(d){var e=window.AmazonUIPageJS||window.P,h=e._namespace||e.attributeErrors,a=h?h("PrimeCheckoutAssets",""):e;a.guardFatal?a.guardFatal(d)(a,window):a.execute(function(){d(a,window)})})(function(d,e,h){d.when("A","a-modal","page-conductor","page-transition-controller","ready").register("offers-panel-controller",function(a,d,k,l){function g(){if(f=a.state("offersPanelDeclineParams")){var c=d.get(b("#offers-panel-modal"));c&&c.show();c=b(".prime-no-button .a-button-inner");0===c.find("a").length&&
c.append('\x3ca href\x3d"'+f.declineRedirectUrl+'"/\x3e');b.ajax({type:"GET",url:"/hp/wlp/pipeline/signups?actionFlowId\x3dWLPAction_CheckoutInterstitialDecline\x26sessionId\x3d"+f.sessionId+"\x26purchaseId\x3d"+f.purchaseId+"\x26subscriptionPlanID\x3dNone\x26locationId\x3dPrimeInterstitialOffers"});0<b(".a-popover-inner").has(".prime-no-button").length&&(c=b(".a-popover-inner #action-buttons").find('span[data-action\x3d"page-transit-no-update-action"]'))&&0<c.length&&c.attr("data-action","a-popover-close");
a.trigger("checkout:continueButton:disable")}}var b=a.$,f;a.on("a:popover:beforeHide:offers-panel-prime-modal",function(a){l.show();k.loadPage("offers","spc",(e.history.state||{}).additionalURLArgs,{pushNewFrame:"true"},f.declineRedirectUrl)});a.on("checkout:reload:offers",g);g()});d.when("A","ready").register(function(a){a.$("#checkoutDisplayPage").bind("DOMSubtreeModified",function(){a.$("#foldableMembershipLegalStatementSeeMoreButton").click(function(){a.$("#foldableMembershipLegalStatementPartial").addClass("aok-hidden");
a.$("#foldableMembershipLegalStatementFull").removeClass("aok-hidden");a.$("#foldableMembershipLegalStatementSeeMoreButton").addClass("aok-hidden")})})});d.when("A","prime-forester-loggers","prime-page-state-helper","page-detector").register("prime-events",function(a,d,k,l){function g(){if(!f){var a=k.get("ms3-client-metadata");a&&(b=new d.EventLogger({marketplace:a.marketplaceID}),f=!0)}}var b,f=!1;l.isSpc()&&g();a.on("checkout:reload:spc",function(a){g()});a.declarative("prime-event","click",function(a){b&&
b.addMetric(a.data.metric)});a.$(document).delegate("[data-prime-metric]","click touchend",function(c){(c=a.$(this).data("prime-metric"))&&b.addMetric(c)});a.on("a:popover:dismiss:prime-acquisition-spc-popover",function(a){b&&b.addMetric("ac1")});a.on("a:popover:show:prime-acquisition-spc-popover",function(a){0===a.popover.$popover.find("form").length&&e.ue&&e.ue.tag&&e.uex&&(e.ue.tag("prime-spc-popover-fallback-hit"),e.uex("ld","primePopoverFallback"))});return{getLogger:function(){return b}}});
d.when("A","prime-forester-loggers","prime-page-state-helper","page-detector").register("prime-presentations",function(a,d,e,l){function g(a){var b=f[a];if(b)return b;b=new d.PresentationLogger({pageState:a});return f[a]=b}function b(a){return function(){var b;(b=e.get(a))&&g(a).addMetric(b.pageType)}}var f={},c={SPC:"ms3-client-metadata",PCI:"ms3-client-metadata-pci"},h=b(c.SPC),k=b(c.PCI);l.isSpc()&&h();0<a.$("div#prime.spp-panel.expanded").length&&k();a.on("checkout:reload:spc",h);a.on("checkout:reload:spp-prime",
k);return{metadataKeys:c,getLogger:function(){return g(c.SPC)},getLoggerForPage:g,clearCache:function(){f={}}}})});
/* ******** */
