(function(k){var m=window.AmazonUIPageJS||window.P,l=m._namespace||m.attributeErrors,d=l?l("CalendarWidgetCommonAssets",""):m;d.guardFatal?d.guardFatal(k)(d,window):d.execute(function(){k(d,window)})})(function(k,m,l){k.when("A").register("buttonUtil",function(d){return{setStatus:function(h,e,g){var n=h.find(e);h=[null,"normal","selected","disabled","error","inactive"];e=0>d.indexOfArray(h,g);var l="radio"===n.attr("role");if(e)return k.error(g+" is not a valid status"),!1;d.each(h,function(d){n.removeClass("a-button-"+
d)});n.children(".a-button-inner").children("button,input").prop("disabled","disabled"===g);n.attr("aria-checked",function(d,e){return l?"selected"===g:e});null!==g&&n.addClass("a-button-"+g);return this}}});"use strict";k.when("A","buttonUtil","ready").register("CalendarWidgetActions",function(d,h){var e=d.$,g=function(b,f,d,a){b.find(".dynamic-toggle").each(function(){var b=e(this),f=b.data("property"),c=b.data("value");a.currentSelection[f]&&(f=d.currentSelection[f],f!==l&&f===c?b.removeClass("aok-hidden"):
b.addClass("aok-hidden"))})},n=function(b,f,d){b.find(".dynamic-class").each(function(){var b=e(this),a=b.data("property"),c=b.data("value");if(d.currentSelection[a]){a=f.currentSelection[a];var q=b.data("selected"),g=b.data("unselected");a!==l&&a===c?(b.removeClass(g),b.addClass(q)):(b.removeClass(q),b.addClass(g))}})},k=function(b,f){f.hasOwnProperty("dateId")&&b.find(".a-declarative").each(function(){var b=e(this).find(".a-button-toggle");b&&!b.hasClass("a-button-disabled")&&(b=e(this).data("date-selected"),
b!==l&&b.dateId===f.dateId?h.setStatus(e(this),".calendar-widget-date","selected"):h.setStatus(e(this),".calendar-widget-date","normal"))})},r=function(b,f){f.hasOwnProperty("slotId")&&b.find(".a-declarative").each(function(){var b=e(this).find(".a-button-toggle");b&&!b.hasClass("a-button-disabled")&&(b=e(this).data("slot-selected"),b!==l&&b.slotId===f.slotId?h.setStatus(e(this),".calendar-slot","selected"):h.setStatus(e(this),".calendar-slot","normal"))})},p=function(b,f,a){for(var d=0;d<b.length;d++)if(b[d][f]===
a)return b[d];return l},m=function(b,f){var d=b.dateId;if(!d)return null;f=p(f,"id",d).slots;return(b=b.slotId)?p(f,"id",b):null},c=function(b,f,a){(a=m(f,a))&&null!==a&&d.trigger("calendar_widget_slot_selected",{widgetId:b,slotId:a.id,dateId:f.dateId,timeRange:a.timeRange,metadata:a.metadata})},a=function(b){var f={};d.each(e('script[type\x3d"a-state"]'),function(a,c){e(a).data("a-state").key===b&&(f=d.parseJSON(e(a).html()))});d.state(b,f);return f},t=function(b,a){return(b=(b=a||d.state(b))&&b.currentSelection?
b.currentSelection.slotId:null)&&null!==b?!0:!1},v=function(){var b=e(this),f=b.attr("id"),q=a(f);t(f,q)&&c(f,q.currentSelection,q.dates);d.state.bind(f,function(a,e){e.currentSelection&&(e.currentSelection.dateId&&(g(b,f,a,e),n(b,a,e),h.setStatus(b,".calendar-slot","normal"),k(b,a.currentSelection),d.trigger("calendar_widget_date_selected",{widgetId:f,dateId:a.currentSelection.dateId})),e.currentSelection.slotId&&a.currentSelection.slotId&&(c(a.id,a.currentSelection,a.dates),r(b,a.currentSelection)),
e.currentSelection.currentDatePage&&g(b,f,a,e))})};d.declarative("date-selected","click",function(b){var a=b.data;b=a.dateId;a=a.widgetId;var c=d.state(a);c.currentSelection.dateId=b;c.currentSelection.slotId=null;d.state(a,c)});d.declarative("slot-selected","click",function(b){var a=b.data;b=a.slotId;var c=a.dateId;a=a.widgetId;var e=d.state(a);e.currentSelection.widgetId=a;e.currentSelection.dateId=c;e.currentSelection.slotId=b;d.state(a,e)});d.declarative("previous-page","click",function(b){b=
b.data.widgetId;var a=d.state(b),c=a.currentSelection.currentDatePage;0!==c&&(a.currentSelection.currentDatePage=c-1,d.state(b,a))});d.declarative("next-page","click",function(a){a=a.data.widgetId;var b=d.state(a),c=b.currentSelection.currentDatePage;c!==b.config.lastPage&&(b.currentSelection.currentDatePage=c+1,d.state(a,b))});return{enableWidgetActions:function(a){e("#"+a).each(v)},isSlotSelected:t,getSelectedSlot:function(a){a=d.state(a);if(!a||null===a)return null;var b=a.currentSelection;return b&&
null!==b?m(b,a.dates):null},getFirstSlotForDate:function(a,c){c=d.state(c);if(!c||null===c)return null;a=p(c.dates,"id",a);if(!a||null===a)return null;a=a.slots;var b;a!==l&&0<a.length&&(b=a[0]);return b},getSlotById:function(a,c){c=d.state(c);if(!c||null===c)return null;c=c.dates.reduce(function(a,b){return a.concat(b.slots?b.slots:[])},[]);return 0===c.length?null:(a=p(c,"id",a))?a:null}}});"use strict";k.when("A","CalendarWidgetActions").register("CalendarWidget",function(d,h){return{createWidget:function(e,
g,h,l){d.$.ajax({url:e,type:"POST",dataType:"html",contentType:"application/json",data:JSON.stringify(g),success:function(d){h({payload:d})},error:function(d){l(d)}})},enableWidgetActions:h.enableWidgetActions,isSlotSelected:h.isSlotSelected,getSelectedSlot:h.getSelectedSlot,getFirstSlotForDate:h.getFirstSlotForDate,getSlotById:h.getSlotById}});"use strict";k.when("A","buttonUtil","SlotContainerWidgetConstants","ready").register("SlotContainerWidgetActions",function(d,h,e){var g=d.$,k=function(c,
a){if(c=c.id)a:{for(var d=0;d<a.length;d++)if(a[d].id===c){a=a[d];break a}a=l}else a=null;return a},m=function(c,a,e){e=k(a,e);a&&null!==a&&d.trigger("slot-container-slot-selected",{widgetId:c,slotId:e.id,pageType:a.pageType,callCaseForSDOverride:a.callCaseForSDOverride,metadata:e.metadata})},r=function(c){var a={};d.each(g('script[type\x3d"a-state"]'),function(e,b){g(e).data("a-state").key===c&&(a=d.parseJSON(g(e).html()))});if(a.selectedSlot&&a.selectedSlot.id){var e=g("#"+a.selectedSlot.id).find("[data-action]").data("slotContainerSlotSelected");
a.selectedSlot.pageType=e.pageType;a.selectedSlot.callCaseForSDOverride=e.callCaseForSDOverride;a.selectedSlot.widgetId=l}d.state(c)&&"replace"in d.state&&d.$.isFunction(d.state.replace)?d.state.replace(c,a):d.state(c,a);return a},p=function(c,a){return(c=(c=a||d.state(c))&&c.selectedSlot?c.selectedSlot.id:null)&&null!==c?!0:!1},u=function(){var c=g(this).attr("id"),a=r(c);a&&a.selectedSlot&&a.selectedSlot.pageType===e.SHIP_OPTION_SELECT_PAGE&&p(c,a)&&m(c,a.selectedSlot,a.slots);a=d.state(c+e.STATE_BIND_STATUS);
a&&a.isStateBinded||(d.state(c+e.STATE_BIND_STATUS,{isStateBinded:!0}),d.state.bind(c,function(a,c){a.slots&&a.selectedSlot&&m(a.selectedSlot.widgetId,a.selectedSlot,a.slots)}))};d.declarative("slot-container-slot-selected","click",function(c){var a=c.data;c=a.widgetId;var e=a.slotId,g=a.pageType;a=a.callCaseForSDOverride;var b=d.state(c);b.selectedSlot.widgetId=c;b.selectedSlot.id=e;b.selectedSlot.pageType=g;b.selectedSlot.callCaseForSDOverride=a;d.state(c,b)});d.declarative("open-expander","click",
function(c){var a=g("#"+c.data.widgetId);c=a.find("."+e.EXPANDER_HEADER_CLASS);a=a.find("."+e.HIDDEN_CLASS+"."+e.DYNAMIC_CLASS);c.addClass(e.HIDDEN_CLASS);a.each(function(){g(this).removeClass(e.HIDDEN_CLASS)})});d.declarative("open-expander-chewbacca-mdw","click",function(c){var a=g("#"+c.data.widgetId),d=a.find("."+e.EXPANDER_HEADER_CLASS);a=a.find("."+e.HIDDEN_CLASS+"."+e.DYNAMIC_CLASS);d.addClass(e.HIDDEN_CLASS);a.each(function(){g(this).removeClass(e.HIDDEN_CLASS)});c.$event.preventDefault();
c.$event.stopPropagation()});d.on("scheduled-delivery-mdw:select-slot",function(c){c=g("#"+c);h.setStatus(c,"."+e.SLOT_CLASS,"selected")});d.on("scheduled-delivery-mdw:deselect-slot",function(c){c=g("#"+c);h.setStatus(c,"."+e.SLOT_CLASS,"normal")});return{enableWidgetActions:function(c){g("#"+c).each(u)},isSlotSelected:p,getSelectedSlot:function(c){c=d.state(c);if(!c||null===c)return null;var a=c.selectedSlot;return a&&null!==a?k(a,c.slots):null}}});"use strict";k.when("A","SlotContainerWidgetActions").register("SlotContainerWidget",
function(d,h){return{createWidget:function(e,g,h,k){d.$.ajax({url:e,type:"POST",dataType:"html",contentType:"application/json",data:JSON.stringify(g),success:function(d){h({payload:d})},error:function(d){k(d)},timeout:11E3})},enableWidgetActions:h.enableWidgetActions,isSlotSelected:h.isSlotSelected,getSelectedSlot:h.getSelectedSlot}});"use strict";k.when("A").register("SlotContainerWidgetConstants",function(){return{HIDDEN_CLASS:"aok-hidden",DYNAMIC_CLASS:"dynamic-class",EXPANDER_HEADER_CLASS:"slot-container-expander-heading",
SLOT_CLASS:"slot-container-slot",STATE_BIND_STATUS:"-bind-status",SHIP_OPTION_SELECT_PAGE:"SOSP"}})});
/* ******** */
(function(a){var g=window.AmazonUIPageJS||window.P,h=g._namespace||g.attributeErrors,b=h?h("ServicesWidgetCommonAssets",""):g;b.guardFatal?b.guardFatal(a)(b,window):b.execute(function(){a(b,window)})})(function(a,g,h){a.when("A").register("ServicesWidgetConstants",function(){return{AJAX_CALL_URL:"/scheduleddelivery/widgets/services"}});"use strict";a.when("A","ready").register("ServicesWidgetActions",function(b){b.declarative("service-selected","change",function(e){var d="undefined"!==typeof e.$target.attr("checked"),
f=e.data;e=JSON.parse(f.metadata);f=f.id;var c=b.state(f);c||(c=[]);var k=e.service;if(d)a:{for(d=0;d<c.length;d++)if(c[d].serviceSymbol===k.serviceSymbol)break a;c.push(k)}else{d=c;c=[];for(var a=0;a<d.length;a++)d[a].serviceSymbol!==k.serviceSymbol&&c.push(d[a])}b.state(f,c);b.trigger("services_widget_service_selected",{calendarWidgetId:e.calendarWidgetId,selectedServices:c,widgetIndex:e.widgetIndex,trimmedOrderId:e.trimmedOrderId,isAfn:e.isAfn})})});"use strict";a.when("A","ServicesWidgetConstants").register("ServicesWidget",
function(b,a){return{createWidget:function(d,e,c){b.$.ajax({url:a.AJAX_CALL_URL,type:"POST",dataType:"html",contentType:"application/json",data:JSON.stringify(d),success:function(a){e({payload:a})},error:function(a){c(a)}})}}})});
/* ******** */
(function(h){var y=window.AmazonUIPageJS||window.P,p=y._namespace||y.attributeErrors,f=p?p("ScheduledDeliveryDataTransformerJs",""):y;f.guardFatal?f.guardFatal(h)(f,window):f.execute(function(){h(f,window)})})(function(h,y,p){h.when("A","ready").register("SDTransformerConstants",function(){return{TRANSFORMER_OUTPUT_CACHE_KEY:"goldenTransformerOutputKey",SLOT_LIST_CACHE_KEY:"goldenCacheKey",RAP_SERVICE_URL:"/gp/product/features/scheduled-delivery/sd-get-slots-coral.html",NO_SERVICES_KEY:"",SD_RESERVATION_ID_FIELD_TYPE_DELIMITER:";",
SD_RESERVATION_ID_LIST_ITEM_DELIMITER:",",SD_RESERVATION_ID_CURRENCY_DELIMITER:"^",SD_RESERVATION_ID_COMPLEX_SERVICE_DELIMITER:"^",SD_RESERVATION_ID_BASIC_SERVICE_DELIMITER:"",SERVICE_IDS_TO_FILTER_FROM_DISPLAY:["AgeVerification:True","Saturday:true","TestService:Basic","Evening:true"],AJAX_FAILURE:"ajaxCallFailure",VALIDATION_FAILURE:"validationException",DATA_TRANSFORMATION_FAILURE:"dataTransformationException"}});"use strict";h.when("A","SDTransformerConstants","ready").register("GoldenCxDataTransformerUtil",
function(f,d){function c(b){return b===this.element}return{validateMandatoryFields:function(b,a){return b.map(function(b){return[b,a[b]!==p]}).reduce(function(a,b){var e=b[0];b[1]||a.push(Error(e+" is invalid"));return a},[])},arrayContainsAll:function(b,a){return a&&0!==a.length?a.every(function(a){return b.includes(a)}):!0},addElementToArray:function(b,a){a&&-1===b.findIndex(c,{element:a})&&b.push(a)},generateFailurePayload:function(b,a){return{type:b,data:a}}}});"use strict";h.when("A","RapServiceCall",
"GoldenCxDataTransformerUtil","SDTransformerConstants","GoldenCxDataTransformer","ready").register("GoldenCxRapServiceIntegration",function(f,d,c,b,a){var g="marketplace shipoption address lineItems widgetIndex client calendarWidgetId servicesWidgetId trimmedOrderId isAfn".split(" "),k="itemID merchantID merchantSKU inventoryAuthorityID offerListingID fulfillmentManagerID totalQuantity".split(" ");return{getWidgetInputParameters:function(a,z,x){a:{var e=c.validateMandatoryFields(g,a);if(0<e.length)var l=
e;else{for(l in a.lineItems)if(e=c.validateMandatoryFields(k,a.lineItems[l]),0<e.length){l=e;break a}l=[]}}if(0<l.length)return a=c.generateFailurePayload(b.VALIDATION_FAILURE,l),x(a);d.getSlots(a,z,x)},getCachedCalendarWidgetInputParameters:function(e,d,k){(e=a.getCalendarWidgetInputParametersFromCache(e))?d(e):(d=c.generateFailurePayload(b.DATA_TRANSFORMATION_FAILURE,"Unable to retrieve widget input parameters"),k(d))}}});"use strict";h.when("A","SDTransformerConstants","SDTransformerSlotQualityUtil",
"SDTransformerDefaultSlotUtil","SDTransformerRapSlotsMergeUtil","ready").register("GoldenCxDataTransformer",function(f,d,c,b,a){function g(d,e,g,x){d=a.getFilteredSlotsGroupedByTime(d,e,x.udsServiceCodes);var w=c.getSlotQuality(d.hasMultipleSlotsForADay),l=d.slots,k=[],z;for(z in l){var f=a.getMergedSlotsInformation(l[z],e,g);var v=f;var h=x,A=w,q=v.timeRange,r=v.legacyTimeWindows,m=v.priceInformation,n={srsIds:v.srsSlotIdentifiers,reservationId:v.reservationId,reservationType:"RAP",carriers:v.carriers,
shortTimezone:v.shortTimezone,longTimezone:v.longTimezone,startTimeLocalTimezone:q.startTime,startTimeUTC:r.s,endTimeLocalTimezone:q.endTime,endTimeUTC:r.e,fss:v.fss},C=g?g.shipmentDates:p;C&&(n.minShipDate=C.startTime,n.maxShipDate=C.endTime);h.isAfn||(n.cutoffTimeUTC=r.c,n.cutOffTimeLocalTimezone=v.minCutoffTime);v={startTime:q.startTime,endTime:q.endTime,price:m.price,priceCurrency:m.priceCurrency,metadata:JSON.stringify({version:"1.0",widgetIndex:h.widgetIndex,trimmedOrderId:h.trimmedOrderId,
slotQuality:A,slotQualityDetail:"CUSTOMER_NOMINATED",slot:n})};var t=b.getDefaultSlotInformationWithSelectedSlot(t,v,f.longTimezone,x.selectedSlot);k.push(v)}if(t&&t.slot){t.slot.isDefault=!0;var y=t.timezone}return{services:d.services,goldenCxSlots:k,timezone:y}}return{transform:function(b,e){var c={},k=b.rapSlotIntersections;if(!k||null===k||0===k.length)return c;var w=g(k,e.selectedServiceList,b.shippingProperties,e);k={widgetId:e.calendarWidgetId,client:e.client,timezone:w.timezone,marketplaceId:e.marketplace,
customerId:e.customerId,isPrimeCustomer:e.isPrimeCustomer,isAfn:e.isAfn,addressId:e.addressId,sessionId:e.sessionId,slots:w.goldenCxSlots,isSlotPreviouslySelected:e.isSlotPreviouslySelected,shipOption:e.shipOption};c.calendarInput=k;c.widgetIndex=e.widgetIndex;w=a.getServicesToDisplay(w.services,e.marketplace,e.udsServiceCodes);if(0<w.length){for(var l=[],B=0;B<w.length;B++){var u=w[B],h=u.charge.perUnitCharge;u={serviceSymbol:u.serviceSymbol,price:h.Value,priceCurrency:h.Unit,metadata:JSON.stringify({version:"1.0",
widgetIndex:e.widgetIndex,trimmedOrderId:e.trimmedOrderId,isAfn:e.isAfn,calendarWidgetId:e.calendarWidgetId,servicesWidgetId:e.servicesWidgetId,service:u})};l.push(u)}c.servicesInput={widgetId:e.servicesWidgetId,client:e.client,isSelectable:!0,marketplaceId:e.marketplace,customerId:e.customerId,sessionId:e.sessionId,services:l}}e=d.TRANSFORMER_OUTPUT_CACHE_KEY.concat(e.calendarWidgetId);f.state(e,{rapResponse:b,calendarWidgetInputParameters:k});return c},transformRaplessSlots:function(a,b){if(a&&
a.availableSlots&&0<a.availableSlots.length){for(var d=[],e=0;e<a.availableSlots.length;e++){var c=a.availableSlots[e],l=c.totalItemCharge+"^"+c.totalShipmentCharge+"^"+c.currencyCode;l=c.reservationIds.join()+";"+c.carrierNames.join()+";"+l+";";l={srsIds:c.reservationIds,reservationId:l,reservationType:"RAP",carriers:c.carrierNames,shortTimezone:a.deliveryTimeZoneShort,longTimezone:a.deliveryTimeZone,startTimeLocalTimezone:c.slotStartTime,startTimeUTC:c.slotStartTimeUTC,endTimeLocalTimezone:c.slotEndTime,
endTimeUTC:c.slotEndTimeUTC,fss:c.fulfillmentServiceSubclass};b.isAfn?(l.minShipDate=c.promiseMinShipmentDate,l.maxShipDate=c.promiseMaxShipmentDate):(l.cutOffTimeLocalTimezone=c.cutoffTime,l.cutoffTimeUTC=c.cutoffTimeUTC);c={startTime:Number(c.slotStartTime),endTime:Number(c.slotEndTime),price:Number(c.deliveryPrice),priceCurrency:c.currencyCode,metadata:JSON.stringify({version:"1.0",widgetIndex:b.widgetIndex,trimmedOrderId:b.trimmedOrderId,slotQuality:c.slotQuality,slotQualityDetail:c.slotQualityDetail,
slot:l}),id:c.slotId};d.push(c)}if(0<d.length)a:{if((c=b.selectedSlot)&&c.start&&c.end)for(e=parseInt(c.start),l=parseInt(c.end),c=0;c<d.length;c++){var g=d[c];if(g.startTime===e&&g.endTime===l){d[c].isDefault=!0;break a}}for(c=e=0;c<d.length;c++)d[c].startTime<d[e].startTime?e=c:d[c].startTime===d[e].startTime&&d[c].endTime<d[e].endTime&&(e=c);d[e].isDefault=!0}return{calendarInput:{widgetId:b.calendarWidgetId,client:b.client,timezone:a.deliveryTimeZone,marketplaceId:b.marketplace,customerId:b.customerId,
isPrimeCustomer:b.isPrimeCustomer,isAfn:b.isAfn,sessionId:b.sessionId,addressId:b.addressId,slots:d,isSlotPreviouslySelected:b.isSlotPreviouslySelected,shipOption:b.shipOption,defaultSlotId:a.defaultSlotId},widgetIndex:b.widgetIndex}}},getCalendarWidgetInputParametersFromCache:function(b){var a=d.TRANSFORMER_OUTPUT_CACHE_KEY.concat(b.calendarWidgetId);if(a=f.state(a)){var c=a.rapResponse;b=g(c.rapSlotIntersections,b.selectedServices,c.shippingProperties,b);a=a.calendarWidgetInputParameters;a.slots=
b.goldenCxSlots;return{calendarInput:a}}}}});"use strict";h.when("A","SDTransformerConstants","GoldenCxDataTransformerUtil","GoldenCxDataTransformer","ready").register("RapServiceCall",function(f,d,c,b){return{getSlots:function(a,g,k){var e={marketplace:a.marketplace,shipoption:a.shipoption,address:a.address,lineItems:a.lineItems};a.path&&"Rapless"===a.path&&(e.path="Rapless");var h={widgetIndex:a.widgetIndex,calendarWidgetId:a.calendarWidgetId,servicesWidgetId:a.servicesWidgetId,trimmedOrderId:a.trimmedOrderId,
client:a.client,marketplace:a.marketplace,selectedServiceList:a.selectedServiceList,sessionId:a.sessionId!==p?a.sessionId:null,customerId:a.customerId!==p?a.customerId:null,isPrimeCustomer:!!a.isPrimeCustomer,addressId:a.address!==p?a.address:null,isAfn:1===a.isAfn?!0:!1,udsServiceCodes:a.udsServiceCodes,selectedSlot:a.selectedSlot!==p?a.selectedSlot:null,isSlotPreviouslySelected:a.isSlotPreviouslySelected,shipOption:a.shipoption!==p?a.shipoption:null};f.ajax(d.RAP_SERVICE_URL,{method:"post",dataType:"json",
contentType:"application/x-www-form-urlencoded;charset\x3dUTF-8",params:{ajaxCallParams:JSON.stringify(e)},success:function(a){a=a.path&&"Rapless"===a.path?b.transformRaplessSlots(a,h):b.transform(a,h);g(a)},error:function(){var a=c.generateFailurePayload(d.AJAX_FAILURE,e);k(a)},timeout:5E3,traditional:!0})}}});"use strict";h.when("A","SDTransformerConstants","SDTransformerServiceSymbolUtil","ready").register("SDReservationIdUtil",function(f,d,c){return{calculateReservationId:function(b,a,g,k,e,f){Array.isArray(b)&&
(b=b.join(d.SD_RESERVATION_ID_LIST_ITEM_DELIMITER));Array.isArray(a)&&(a=a.join(d.SD_RESERVATION_ID_LIST_ITEM_DELIMITER));b=b+d.SD_RESERVATION_ID_FIELD_TYPE_DELIMITER+a+d.SD_RESERVATION_ID_FIELD_TYPE_DELIMITER+g+d.SD_RESERVATION_ID_CURRENCY_DELIMITER+k+d.SD_RESERVATION_ID_CURRENCY_DELIMITER+e+d.SD_RESERVATION_ID_FIELD_TYPE_DELIMITER;if(f){if(Array.isArray(f)){a=[];g=[];k="";for(var h in f)e=f[h],c.isBasicService(e)?a.push(e):g.push(e);0<a.length&&(k=a.join(d.SD_RESERVATION_ID_BASIC_SERVICE_DELIMITER));
0<a.length&&0<g.length&&(k+=d.SD_RESERVATION_ID_COMPLEX_SERVICE_DELIMITER);0<g.length&&(k+=g.join(d.SD_RESERVATION_ID_COMPLEX_SERVICE_DELIMITER));f=k}b+=f}return b}}});"use strict";h.when("A","ready").register("SDTransformerDefaultSlotUtil",function(f){var d=function(c,b,a){return{slot:c,timezone:b,isSelectedSlot:a}};return{getDefaultSlotInformation:function(c,b,a){var g=c&&null!==c?c.slot:null;return!g||null===g||b.price<g.price||c.slot.price===b.price&&(b.startTime<g.startTime||b.startTime===g.startTime&&
b.endTime<g.endTime)?d(b,a):c},getDefaultSlotInformationWithSelectedSlot:function(c,b,a,g){var f=c&&null!==c?c.slot:null;return c&&null!==c&&c.isSelectedSlot?c:g&&null!==g&&b.startTime.toString()===g.start&&b.endTime.toString()===g.end&&a===g.tz?d(b,a,!0):!f||null===f||b.price<f.price||c.slot.price===b.price&&(b.startTime<f.startTime||b.startTime===f.startTime&&b.endTime<f.endTime)?d(b,a,!1):c}}});"use strict";h.when("A","ready").register("SDTransformerSlotQualityUtil",function(f){return{getSlotQuality:function(d){return d?
"TIME":"DAY"}}});"use strict";h.when("A","ready").register("SDTransformerServiceSymbolUtil",function(f){var d={"Assembly:Basic":"A:B","Assembly:Complex":"A:C","Assembly:Moderate":"A:M","Assembly:Specialized":"A:S","Installation:BuiltInBasic":"I:B","Installation:BuiltInComplex":"I:C","Installation:BuiltInElectronics":"I:I","Installation:BuiltInModerate":"I:M","Installation:StandAloneBasic":"I:A","Installation:StandAloneElectronics":"I:E","Evening:true":"E","Haulaway:true":"H","Installation:true":"I",
"Recycling:true":"R","Unpack:true":"U","Saturday:true":"S","Delivery:RoomOfChoice":"D:R","Delivery:InsideEntryway":"D:E"},c=["E","H","I","R","S"];return{getServiceSymbol:function(b){return d[b]},isBasicService:function(b){return 0<=c.indexOf(b)}}});"use strict";h.when("A","ready").register("SDTransformerFssUtil",function(f){var d=["FAST_TRACK_SAME_DAY","FAST_TRACK_FUTURE_DAY","NOT_FAST_TRACK"];return{calculateFss:function(c,b){if(c&&b){b=b.map(function(a){a=d.indexOf(c[a]);return-1===a?Infinity:a});
b=Math.min.apply(Math,b);var a=Infinity===b?p:d[b]}return a}}});"use strict";h.when("A","SDTransformerServiceSymbolUtil","SDTransformerConstants","SDTransformerFssUtil","SDReservationIdUtil","GoldenCxDataTransformerUtil","SDTransformerPolyfill","ready").register("SDTransformerRapSlotsMergeUtil",function(f,d,c,b,a,g){function k(a){return a.serviceId===this.serviceId}var e=function(a){var b=d.getServiceSymbol(a.serviceId);return a.serviceSymbol=b},h=function(a){a=new Date(1E3*a);return a.getMonth()+
"-"+a.getDate()},x=function(a,b){-1===a.findIndex(k,{serviceId:b.serviceId})&&a.push(b)},w=function(a){return a.map(function(a){return a.slotID})};return{getFilteredSlotsGroupedByTime:function(a,b,d){var f={},l=!1,k=[],A=[],q=[];b?q=b.map(function(a){return a.serviceSymbol}):d&&(q=d);for(b=0;b<a.length;b++){d=a[b];for(var r=[],m=d.services,n=[],p=0;p<m.length;p++){var t=m[p],u=e(t);c.SERVICE_IDS_TO_FILTER_FROM_DISPLAY.includes(t.serviceId)?g.addElementToArray(r,u):(x(A,m[p]),g.addElementToArray(n,
u))}d.invisibleServices=r;g.arrayContainsAll(n,q)&&(r=d.timeRange,m=r.startTime+"-"+r.endTime,(n=f[m])?n.push(d):(f[m]=[d],l||(d=h(r.startTime),l=k[d]&&!0===k[d]?!0:!1,k[d]=!0)))}return{slots:f,hasMultipleSlotsForADay:l,services:A}},getMergedSlotsInformation:function(c,d,e){for(var f=c[0],k=f.carriers,l=f.srsSlotIdentifiers,h=f,q=f,r=1;r<c.length;r++){var m=c[r];k=k.concat(m.carriers);l=l.concat(m.srsSlotIdentifiers);h.minCutoffTime>=m.minCutoffTime||(h=m);q.charge.perShipmentCharge.Value>=m.charge.perShipmentCharge.Value||
(q=m)}c=h.minCutoffTime;r=h.legacyTimeWindows;e=b.calculateFss(e?e.carrierFastTrackMap:p,k);l=w(l);var n=q.charge;q={};q.price=n.perUnitCharge.Value+n.perShipmentCharge.Value;q.priceCurrency=n.perUnitCharge.Unit;m=n.perUnitCharge.Value;n=n.perShipmentCharge.Value;var u=[];u=u.concat(h.invisibleServices);if(d)for(h=0;h<d.length;h++){var t=d[h];g.addElementToArray(u,t.serviceSymbol);t=t.charge;m+=t.perUnitCharge.Value;n+=t.perShipmentCharge.Value}m=+m.toFixed(2);n=+n.toFixed(2);d=a.calculateReservationId(l,
k,m,n,q.priceCurrency,u);return{srsSlotIdentifiers:l,minCutoffTime:c,legacyTimeWindows:r,reservationId:d,timeRange:f.timeRange,shortTimezone:f.shortFormTz,longTimezone:f.timeZone,carriers:k,priceInformation:q,fss:e}},getServicesToDisplay:function(a,b,c){return c===p?a:[]}}});"use strict";h.when("A","ready").register("SDTransformerPolyfill",function(){Array.prototype.map||(Array.prototype.map=function(f){var d,c;if(null==this)throw new TypeError("this is null or not defined");var b=Object(this),a=
b.length>>>0;if("function"!==typeof f)throw new TypeError(f+" is not a function");1<arguments.length&&(d=arguments[1]);var g=Array(a);for(c=0;c<a;){if(c in b){var h=b[c];h=f.call(d,h,c,b);g[c]=h}c++}return g});Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(f,d){if(null==this)throw new TypeError('"this" is null or not defined');var c=Object(this),b=c.length>>>0;if("function"!==typeof f)throw new TypeError("predicate must be a function");for(var a=0;a<b;){if(f.call(d,
c[a],a,c))return a;a++}return-1},configurable:!0,writable:!0});Array.prototype.reduce||Object.defineProperty(Array.prototype,"reduce",{value:function(f){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!==typeof f)throw new TypeError(f+" is not a function");var d=Object(this),c=d.length>>>0,b=0;if(2<=arguments.length)var a=arguments[1];else{for(;b<c&&!(b in d);)b++;if(b>=c)throw new TypeError("Reduce of empty array with no initial value");a=d[b++]}for(;b<
c;)b in d&&(a=f(a,d[b],b,d)),b++;return a}});Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(f,d){if(null==this)throw new TypeError('"this" is null or not defined');var c=Object(this),b=c.length>>>0;if(0===b)return!1;d|=0;for(d=Math.max(0<=d?d:b-Math.abs(d),0);d<b;){var a=c[d],g=f;if(a===g||"number"===typeof a&&"number"===typeof g&&isNaN(a)&&isNaN(g))return!0;d++}return!1}})})});
/* ******** */
(function(p){var u=window.AmazonUIPageJS||window.P,y=u._namespace||u.attributeErrors,c=y?y("ScheduledDeliveryCheckoutAssets",""):u;c.guardFatal?c.guardFatal(p)(c,window):c.execute(function(){p(c,window)})})(function(p,u,y){p.when("A").register("SDWidgetsConstants",function(){return{CALENDAR_AJAX_CALL_URL:"/scheduleddelivery/widgets/calendar",SD_NOT_AVAILABLE_ID_PREFIX:"#sd-not-available-",SD_NOTE_ID_PREFIX:"#sd-widget-note-",SD_CHANGE_LINK_ID_PREFIX:"#sd-widget-change-link-",SD_CALENDAR_WIDGET_PREFIX:"sd-calendar-widget-",
SD_WIDGETS_PREFIX:"sd-widgets-",SD_WIDGETS_SPINNER_PREFIX:"#sd-widget-spinner-",SD_WIDGETS_POPOVER_NAME_PREFIX:"scheduled-delivery-popover-name-",UPSELL_MESSAGE_PREFIX_COLON:": ",UPSELL_MESSAGE_PREFIX_HYPHEN:"- ",UPSELL_MESSAGE_PREFIX_DASH:"— ",SD_UPSELL_MESSAGE_PREFIX:"sd-upsell-messaging-",UPSELL_MESSAGE_CLASS:".upsell-messaging",SD_UDS_ERROR_MESSAGE:"UDS service code missing from hard coded map",SD_MDW_WIDGET_ROOT_CLASS:".sd-mdw-widget-root",SD_MDW_SLOT_CONTAINER_WIDGET_PREFIX:"sd-slot-container-widget-",
SD_CALENDAR_WIDGET_RENDER_ERROR_METRIC:"GoldenCXCalendarRenderErrorCount",SD_CALENDAR_WIDGET_RENDER_SUCCESS_METRIC:"GoldenCXCalendarRenderSuccessCount",SD_CALENDAR_WIDGET_SLOT_REFRESH:"GoldenCXCalendarSlotRefreshed",SD_SERVICE_WIDGET_DISABLED:"GoldenCXServiceWidgetDisabled",SD_SERVICE_WIDGET_LOADED:"GoldenCXServiceWidgetLoaded",SD_SERVICE_WIDGET_RENDER_ERROR_METRIC:"GoldenCXServicesRenderErrorCount",SD_WIDGET_HAS_GVDGO_SLOTS_METRIC:"GoldenCXWidgetHasGvdgoSlots",SD_WIDGET_LOAD_ERROR_METRIC:"GoldenCXWidgetLoadErrorCount",
SD_WIDGET_LOAD_INFORMATION_METRIC:"GoldenCXWidgetLoadInformation",SD_WIDGET_NO_GVDGO_SLOTS_METRIC:"GoldenCXWidgetNoGvdgoSlots",SD_WIDGET_NO_SLOTS_METRIC:"GoldenCXWidgetNoSlots",SD_WIDGET_NO_SHIPOPTION_LEVEL_PRICE_METRIC:"GoldenCXWidgetNoShipoptionLevelPrice",SD_WIDGET_NO_SLOT_LEVEL_PRICE_METRIC:"GoldenCXWidgetNoSlotLevelPrice",SD_WIDGET_RAPLESS_ASYNC_METRIC:"GoldenCXWidgetRaplessAsync",SD_WIDGET_SHADOW_BOTH_SLOTS_EXIST_METRIC:"GoldenCXWidgetShadowBothSlotsExist",SD_WIDGET_SHADOW_BOTH_SLOTS_NOT_EXIST_METRIC:"GoldenCXWidgetShadowBothSlotsNotExist",
SD_WIDGET_SHADOW_COMPARISON_METRIC:"GoldenCXWidgetShadowComparison",SD_WIDGET_SHADOW_ONLY_HAS_GVDGO_SLOTS_METRIC:"GoldenCXWidgetShadowOnlyHasGvdgoSlots",SD_WIDGET_SHADOW_ONLY_HAS_RAP_SLOTS_METRIC:"GoldenCXWidgetShadowOnlyHasRapSlots",SD_WIDGET_SHADOW_RAP_TEN_PLUS_SLOTS_MORE_METRIC:"GoldenCXWidgetShadowRapTenPlusSlotsMore",SD_WIDGET_SHADOW_RAP_FIVE_PLUS_SLOTS_MORE_METRIC:"GoldenCXWidgetShadowRapFivePlusSlotsMore",SD_WIDGET_SHADOW_RAP_ONE_PLUS_SLOTS_MORE_METRIC:"GoldenCXWidgetShadowRapOnePlusSlotsMore",
SD_WIDGET_SHADOW_RAP_ONE_SLOT_MORE_METRIC:"GoldenCXWidgetShadowRapOneSlotMore",SD_WIDGET_SHADOW_GVDGO_TEN_PLUS_SLOTS_MORE_METRIC:"GoldenCXWidgetShadowGvdgoTenPlusSlotsMore",SD_WIDGET_SHADOW_GVDGO_FIVE_PLUS_SLOTS_MORE_METRIC:"GoldenCXWidgetShadowGvdgoFivePlusSlotsMore",SD_WIDGET_SHADOW_GVDGO_ONE_PLUS_SLOTS_MORE_METRIC:"GoldenCXWidgetShadowGvdgoOnePlusSlotsMore",SD_WIDGET_SHADOW_GVDGO_ONE_SLOT_MORE_METRIC:"GoldenCXWidgetShadowGvdgoOneSlotMore",SD_WIDGET_SHADOW_SLOTS_FADD_PRICE_MISMATCH_METRIC:"GoldenCXWidgetShadowSlotsFaddPriceMismatch",
SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_METRIC:"GoldenCXWidgetShadowSlotsFaddTimeMismatch",SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_START_LATE_METRIC:"GoldenCXWidgetShadowSlotsFaddTimeMismatchGvdgoStartLate",SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_START_EARLY_METRIC:"GoldenCXWidgetShadowSlotsFaddTimeMismatchGvdgoStartEarly",SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_END_LATE_METRIC:"GoldenCXWidgetShadowSlotsFaddTimeMismatchGvdgoEndLate",SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_END_EARLY_METRIC:"GoldenCXWidgetShadowSlotsFaddTimeMismatchGvdgoEndEarly",
SD_WIDGET_SHADOW_SLOTS_LENGTH_MISMATCH_METRIC:"GoldenCXWidgetShadowSlotsLengthMismatch",SD_WIDGET_SHADOW_SLOTS_PRICE_MISMATCH_METRIC:"GoldenCXWidgetShadowSlotsPriceMismatch",SD_WIDGET_SHADOW_SLOTS_TIME_MISMATCH_METRIC:"GoldenCXWidgetShadowSlotsTimeMismatch",SD_CALENDAR_WIDGET_SLOT_CHANGE_TRIGGER_ERROR_METRIC:"GoldenCXSlotChangeNotificationErrorCount",SD_CALENDAR_WIDGET_NO_VAS_SHIP_GROUP_ID:"GoldenCXCalendarNoVASGroupIdErrorCount",SD_MDW_UPDATE_SDI_COUNT_METRIC:"MDWUpdateSDICallCount",SD_SHADOW_DUP_ERROR_METRIC:"GoldenCXDupShadowErrorCount",
SD_SHADOW_REGISTER_METRIC:"GoldenCXShadowWidgetRegCount",SD_SHADOW_LOAD_METRIC:"GoldenCXShadowLoadCount",CONTINUE_BUTTON_OWNER:"SD",SD_SLOT_CONTAINER_WIDGET_RENDER_SUCCESS_METRIC:"MdwSlotWidgetRenderSuccessCount",SD_SLOT_CONTAINER_WIDGET_RENDER_ERROR_METRIC:"MdwSlotWidgetRenderErrorCount",SD_MDW_DISABLE_SHIP_OPTION_METRIC:"MdwShipOptionDisableCount",SD_SLOT_CONTAINER_WIDGET_NO_SLOTS_METRIC:"MdwSlotWidgetNoSlotsCount",MDW_WIDGET_INTERACTION_DELIVERY_INFORMATION_EMIT_SUCCESS_METRIC:"MdwWidgetInteractionDeliveryInformationEmitSuccessful",
MDW_WIDGET_INTERACTION_DELIVERY_INFORMATION_EMIT_FAIL_METRIC:"MdwWidgetInteractionDeliveryInformationEmitFailed",MDW_GET_ORDER_ID_FROM_WIDGET_ID_FAILURE_METRIC:"MdwGetOrderIdFromWidgetIdFailed",MDW_GET_SHIP_SPEED_NAME_FROM_WIDGET_ELEMENT_FAILURE_METRIC:"MdwGetShipSpeedNameFromWidgetElementFailed",MDW_GET_SELECTED_SHIP_SPEED_NAME_FROM_WIDGET_ELEMENT_FAILURE_METRIC:"MdwGetSelectedShipSpeedNameFromWidgetElementFailed",MDW_GET_TIMEZONE_FROM_WIDGET_ID_FAILED_METRIC:"MdwGetTimezoneFromWidgetIdFailed",SLOT_CONTAINER_AJAX_CALL_URL:"/scheduleddelivery/widgets/slotcontainer",
AOK_HIDDEN:"aok-hidden",SHIP_OPTION_SELECT_PAGE:"SOSP",SINGLE_PAGE_CHECKOUT:"SPC",SLOT_CONTAINER_WIDGET_ROOT_PREFIX:"sd_widgets_"}});"use strict";p.when("A").register("SDDisableServiceWidget",function(c){return{enabled:!1}});"use strict";p.when("A").register("SDGoldenCXTransformer",function(c){return{transform:function(c){return{calendar:{widgetId:c.widgetIndex,timezone:"America/Los_Angeles",marketplaceId:"A1VC38T7YXB528",sessionId:"123",customerId:"Agatha",client:"SOSP",slots:[{startTime:1551362400,
endTime:1551373200,isFree:!0,isDefault:!0},{startTime:1551373200,endTime:1551384E3,isFree:!1,price:12.99,priceCurrency:"GBP"},{startTime:1551373200,endTime:1551384E3,isFree:!1,price:12.99,priceCurrency:"GBP"},{startTime:1551448800,endTime:1551459600,isFree:!1,price:10.99,priceCurrency:"GBP"},{startTime:1551621600,endTime:1551632400,isFree:!1,price:10.99,priceCurrency:"GBP"}]},services:{widgetId:c.widgetIndex,marketplaceId:"ATVPDKIKX0DER",sessionId:"session",customerId:"customer",client:"SOSP",isSelectable:!0,
services:[{serviceSymbol:"R",price:12.99,priceCurrency:"USD",isDefault:!1,isFree:!1},{serviceSymbol:"D:E",price:10.99,priceCurrency:"USD",isDefault:!0,isFree:!1},{serviceSymbol:"D:R",isDefault:!0,isFree:!0,metadata:"abc to send bla"}]}}}}});"use strict";p.register("sdLogger",function(){return{logMetric:function(c,k){if("undefined"!==typeof u.ue&&"undefined"!==typeof c&&"undefined"!==typeof u.ue.count){var f=u.ue.count(c)||0;u.ue.count(c,f+(k||1))}},logException:function(c,k){var f={logLevel:"ERROR",
attribution:2<arguments.length&&arguments[2]!==y?arguments[2]:"scheduled_delivery_golden_cx_widget",message:k};"undefined"!==typeof u.ueLogError&&u.ueLogError(c,f)}}});"use strict";p.when("A","page-detector","SDWidgetsConstants","ready").register("SDShipOptionHandler",function(c,k,f){function n(a){var r=d(a.currentTarget);a=r.find("input[type\x3d'radio']");r=m(r);a=a.attr("name");c.trigger("scheduled-delivery-mdw:ship-option-changed",{current:r,previous:b[a]});b[a]=r}function m(a){a=a.find(f.SD_MDW_WIDGET_ROOT_CLASS);
return 0<a.length?a.attr("id"):null}function a(a){a=d("#"+a).find("[id^\x3d"+f.SD_MDW_SLOT_CONTAINER_WIDGET_PREFIX+"]");if(!a&&!a.attr("id"))return null;a=a.attr("id");return(a=c.state(a))&&a.selectedSlot&&a.selectedSlot.id?a.selectedSlot.id:null}var d=c.$,b={},h=function(){b={};k.isMobile()?d("div.selectable-box input[type\x3d'radio']:checked").each(function(){var a=d(this),c=a.closest("div.selectable-box");(c=m(c))&&(b[a.attr("name")]=c)}):d("div.fake-label input[type\x3d'radio']:checked").each(function(){var a=
d(this),c=a.closest("div.fake-label");(c=m(c))&&(b[a.attr("name")]=c)})};c.on("checkout:reload:shipoptionselect",h);c.on("checkout:reload:spp-revieworder",h);k.isSosp()&&h();var t=!1;d(document).delegate(".ship-option.is-scheduled-delivery","mousedown",function(a){t=d(a.currentTarget).find("input[type\x3d'radio']").is(":checked")});d(document).delegate(".ship-option.is-scheduled-delivery","click",function(a){if(k.isSpc()){var b=d(a.target);if(!b.closest("a").hasClass("slot-container-expander-heading")){a=
d(a.currentTarget);var r=a.find("input[type\x3d'radio']");if(!b.closest("a").hasClass("sd-ship-option-selection-change")&&!r.attr("disabled")&&(r.is(":checked")||r.attr("checked",!0),!t)){r.closest(".shipping-speed").addClass("selected");var h;a:{if((h=a.find(".a-declarative"))&&(h=h.data("a-modal"))&&h.data&&(h=h.data,h.hasOwnProperty("widgetIndex"))){h=h.widgetIndex;break a}h=null}h?c.trigger("scheduled-delivery-ship-option-selected",r,h):b.closest("li").hasClass("slot-container-slot-item")||(b=
m(a))&&c.trigger("slot-selected-update-sdi",b)}}}});d(document).delegate("div.fake-label","click",function(a){k.isSosp()&&!k.isMobile()&&n(a)});d(document).delegate("div.selectable-box","click",function(a){k.isSosp()&&k.isMobile()&&n(a)});c.on("scheduled-delivery-mdw:ship-option-changed",function(a){var b=a.current;a=a.previous;b&&b!==a&&c.trigger("scheduled-delivery-mdw:ship-option-selected",b);a&&b!==a&&c.trigger("scheduled-delivery-mdw:ship-option-deselected",a)});c.on("scheduled-delivery-mdw:ship-option-selected",
function(b){(b=a(b))&&c.trigger("scheduled-delivery-mdw:select-slot",b)});c.on("scheduled-delivery-mdw:ship-option-deselected",function(b){(b=a(b))&&c.trigger("scheduled-delivery-mdw:deselect-slot",b)});return{disableShipOption:function(a,b){a=d("#"+a);if(0!==a.length){if(k.isSpc())a=a.closest(".shipping-speed");else if(k.isSosp())a=k.isMobile()?a.closest("div.selectable-box.scheduled-delivery.a-box"):a.closest("div.fake-label.a-box");else return;var c=a.find("input[type\x3d'radio']");c.attr("disabled",
!0);c.is(":checked")&&b&&(b=d("input[name\x3d"+c.attr("name")+"]:radio:not(:disabled):first"),b.prop("checked",!0),b.trigger("change"));a.addClass("sd-ship-option-disabled");b=a.find(".sd-ship-option-selection-change");0!==b.length&&b.hide()}},disableMdwShipOption:function(a){a=d("#"+a);if(0!==a.length){if(k.isSpc())a=a.closest(".shipping-speed");else if(k.isSosp())a=k.isMobile()?a.closest("div.selectable-box.a-box"):a.closest("div.fake-label.a-box");else return;var b=a.find("input[type\x3d'radio']");
b.attr("disabled",!0);b.is(":checked")&&(b=d("input[name\x3d"+b.attr("name")+"]:radio:not(:disabled):first"),b.prop("checked",!0),b.trigger("change"));a.addClass("sd-ship-option-disabled")}}}});"use strict";p.when("A","page-detector","button-blocker","client-side-metrics").register("SDButtonBlockerController",function(c,k,f,n){function m(b,c){h[b]!==y&&h[b].state!==c&&(h[b].state=c,a())}function a(){var a;b.each(h,function(c,d){a=d.owner;if(d.state===p.DISABLE_CONTINUE)return f.show(a,r),t||(n.increaseCount("removeauijs12"),
b(".continue-button-blocker").css("display","inline-block")),!1;f.hide(a)})}function d(a){h[a]!==y&&m(a,p.ENABLE_CONTINUE)}var b=c.$,h={},t=u.P&&u.P.AUI_BUILD_DATE,r="Please choose a time for your order",p={ENABLE_CONTINUE:"enableContinue",DISABLE_CONTINUE:"disableContinue"};c.on("checkout:beforeReload",function(){h instanceof Object&&Object.keys(h).forEach(d);h={}});return{disableContinue:function(b,c){h[c]===y&&(h[c]!==y||(h[c]={state:p.ENABLE_CONTINUE,owner:b,toolTipMessage:r}),a());m(c,p.DISABLE_CONTINUE)},
enableContinue:d,setTooltipMessage:function(a){a&&(r=a)}}});"use strict";p.when("A").register("SDUpsellMessagePrefixConfig",function(c){return{prefixType:"COLON"}});"use strict";p.when("A","CalendarWidget","SDWidgetsConstants","SDButtonBlockerController","sdLogger","SDShadowWidgetsHub","SDUpsellMessagePrefixConfig","page-detector","a-popover-base","ready").register("SDCalendarWidget",function(c,k,f,n,m,a,d,b,h){function t(a){c.on("active-shipment-changed",function(){z(a)});u.history&&l(u).bind("popstate",
function(){z(a)});c.on("Shipping::ShipSpeed::Change",function(b){b.shipSpeedType&&"scheduledDelivery"===b.shipSpeedType?z(a):n.enableContinue(a)})}function r(a,b,c){var e=b.slot;b&&(l("[name\x3dSD-OrderID-"+a+"]").val(b.trimmedOrderId),l("[name\x3dSD-SlotQuality-"+a+"]").val(b.slotQuality),l("[name\x3dSD-SlotQualityDetail-"+a+"]").val(b.slotQualityDetail));e&&(l("[name\x3dSD-SlotID-"+a+"]").val(e.srsIds),l("[name\x3dSD-ResID-"+a+"]").val(e.reservationId),l("[name\x3dSD-ResType-"+a+"]").val(e.reservationType),
l("[name\x3dSD-Carriers-"+a+"]").val(e.carriers),l("[name\x3dSD-StartTime-"+a+"]").val(e.startTimeUTC),l("[name\x3dSD-EndTime-"+a+"]").val(e.endTimeUTC),l("[name\x3dSD-CutoffTime-"+a+"]").val(e.cutOffTimeLocalTimezone),l("[name\x3dSD-Cutoff-"+a+"]").val(e.cutOffTimeUTC),l("[name\x3dSD-WindowTZ-"+a+"]").val(e.shortTimezone),l("[name\x3dSD-CutoffTZ-"+a+"]").val(e.shortTimezone),l("[name\x3dSD-SlotLongTZ-"+a+"]").val(e.longTimezone),l("[name\x3dD_MinShipDtUTC-"+a+"]").val(e.minShipDate),l("[name\x3dD_MaxShipDtUTC-"+
a+"]").val(e.maxShipDate),l("[name\x3dSD-SlotStartLTZ-"+a+"]").val(e.startTimeLocalTimezone),l("[name\x3dSD-SlotEndLTZ-"+a+"]").val(e.endTimeLocalTimezone),l("[name\x3dSD-Date-"+a+"]").val(e.startTimeLocalTimezone),l("[name\x3dSD-PromiseLFSS-"+a+"]").val(e.fss));c&&l("[name\x3dSD-ResID-"+a+"]").val(c.reservationId)}function p(a){if(a&&a.hasOwnProperty("popover")&&(g=a.popover,g.data&&g.data.widgetIndex)){a=f.SD_CALENDAR_WIDGET_PREFIX+g.data.widgetIndex;n.disableContinue(f.CONTINUE_BUTTON_OWNER,a);
var b=D[a];if(b&&null!==b){var e={};e.widgetId=a;e.dateId=null;e.slotId=null;e.currentDatePage=0;var d=c.state(a);d.currentSelection=e;c.state(a,d);d.currentSelection=b;c.state(a,d)}}}function C(a){a&&a.hasOwnProperty("popover")&&g&&(g.data||g.data.widgetIndex)&&n.enableContinue(f.SD_CALENDAR_WIDGET_PREFIX+g.data.widgetIndex)}function q(a){a=c.state(a);return a&&null!==a?(a=a.currentSelection)&&null!==a?a:null:null}function y(a){var b=l("#"+a).find('script[type\x3d"a-state"]');a=c.state(a);b.html(JSON.stringify(a))}
var l=c.$,D={},e,g,z=function(a){l("#"+a).is(":visible")?k.isSlotSelected(a)?n.enableContinue(a):n.disableContinue(f.CONTINUE_BUTTON_OWNER,a):n.enableContinue(a)},F=function(a,e){(a=k.getSelectedSlot(a))&&null!==a&&(a=a.fullDateLabel)&&null!==a&&""!==a&&(b.isSpc()?l("."+f.SD_UPSELL_MESSAGE_PREFIX+e).html(a):(e=l("#"+f.SD_WIDGETS_PREFIX+e).parent())&&null!==e&&(e=e.find(".upsell-messaging"))&&null!==e&&("HYPHEN"===d.prefixType?e.html(f.UPSELL_MESSAGE_PREFIX_HYPHEN+a):"DASH"===d.prefixType?e.html(f.UPSELL_MESSAGE_PREFIX_DASH+
a):e.html(f.UPSELL_MESSAGE_PREFIX_COLON+a)))};c.on("calendar_widget_date_selected",function(a){z(a.widgetId);b.isSpc()&&l(".sd-calendar-save-and-continue").addClass("a-button-disabled")});c.on("calendar_widget_slot_selected",function(c){if(b.isSpc()&&0>u.location.href.indexOf("shipoptionselect"))e=c,l(".sd-calendar-save-and-continue").removeClass("a-button-disabled");else{var g=c.metadata;if(g){g=JSON.parse(g);var d=g.widgetIndex;if(a.enabled()&&a.isShadowWidget(d)){var h=a.getMainWidgetInfo(d);h&&
h.widgetIndex&&r(h.widgetIndex,g)}else r(d,g)}F(c.widgetId,d);z(c.widgetId)}});c.declarative("scheduled-delivery-modal-calendar-save","click",function(b){if(!b.$currentTarget.find(".sd-calendar-save-and-continue").hasClass("a-button-disabled")){var d=e.metadata;b=e.widgetId;if(d){d=JSON.parse(d);var f=d.widgetIndex;var t=l("#sd-option-td-"+f).closest(".shipping-speed").find("input[type\x3d'radio']");if(a.enabled()&&a.isShadowWidget(f)){var k=a.getMainWidgetInfo(f);k&&k.widgetIndex&&r(k.widgetIndex,
d)}else r(f,d)}y(b);D[b]=q(b);g&&h.hide(g.id);c.trigger("scheduled-delivery-ship-option-selected",t,f)}});c.on("scheduled-delivery-ship-option-selected",function(a,b){b=f.SD_WIDGETS_PREFIX+b;var e={};l("#"+b+" input[type\x3dhidden]").each(function(){var a=l(this),b=a.attr("key");a=a.attr("value");b&&(e[b]=a)});u.spcpage.scheduledDeliverySetSOCallbackWithTarget(a,e,b)});return{createWidget:function(a,e,d,g){k.createWidget(f.CALENDAR_AJAX_CALL_URL,e,function(d){var h=e.widgetId;l(f.SD_WIDGETS_SPINNER_PREFIX+
a).addClass("aok-hidden");l("#"+h).replaceWith(d.payload);l("#"+h).addClass("hide-if-not-selected");k.enableWidgetActions(h);if(b.isSpc()){n.disableContinue(f.CONTINUE_BUTTON_OWNER,h);D[h]=q(h);d=k.getSelectedSlot(h);r(a,JSON.parse(d.metadata),g);y(h);d="a:popover:show:"+f.SD_WIDGETS_POPOVER_NAME_PREFIX+a;var x="a:popover:hide:"+f.SD_WIDGETS_POPOVER_NAME_PREFIX+a;c.off(d,p);c.off(x,C);c.on(d,p);c.on(x,C)}z(h);t(h);F(h,a);m.logMetric(f.SD_CALENDAR_WIDGET_RENDER_SUCCESS_METRIC,1)},function(a){m.logException(a,
"Got an error while trying to create Calendar Widget");m.logMetric(f.SD_CALENDAR_WIDGET_RENDER_ERROR_METRIC,1);d(a)})},hide:function(a){l("#"+a).hide()}}});"use strict";p.when("A","CalendarWidget","shipspeed-helper","SDWidgetsConstants","sdLogger","ready").register("SDSlotChangeVASNotifier",function(c,k,f,n,m){function a(a){try{var b=d("#"+n.SD_WIDGETS_PREFIX+a.widgetIndex).parent();if(b&&null!==b){var k=b.find('[data-speed-type\x3d"scheduled-delivery"]');var r=k&&0<k.length?k[0]:void 0}else r=void 0;
if(r){var p;var C=(r.getAttribute("name")||"").match(/\d+/gi);null!==C&&0<C.length&&(p=C[0]);var q=p;if(!q)m.logMetric(n.SD_CALENDAR_WIDGET_NO_VAS_SHIP_GROUP_ID,1);else if(!d.isEmptyObject(a)){var u=f.getShipSpeedDataByGroupId(q),l={slotQuality:a.slotQuality},D=a.slot;if(null!==D){l.slotStartTimeEpoch=D.startTimeLocalTimezone;l.slotEndTimeEpoch=D.endTimeLocalTimezone;l.timeZone=D.longTimezone;var e=D.srsIds;var g=e&&0<e.length?e[0]+"_SELECT":void 0}var z=d.extend({},{eventId:g,selectedSlotDetails:l},
u);c.trigger("Shipping::ScheduledDelivery::Change",z)}}}catch(F){m.logException(F,"Got an error when trying to trigger an sd slot change notification event"),m.logMetric(n.SD_CALENDAR_WIDGET_SLOT_CHANGE_TRIGGER_ERROR_METRIC,1)}}var d=c.$;c.on("calendar_widget_date_selected",function(b){if(b=k.getFirstSlotForDate(b.dateId,b.widgetId))b=JSON.parse(b.metadata),a(b)});c.on("calendar_widget_slot_selected",function(b){if(b=b.metadata)b=JSON.parse(b),a(b)})});"use strict";p.when("A","SlotContainerWidget",
"SDWidgetsConstants","SDButtonBlockerController","SDShipOptionHandler","sdLogger","ServicesCustomerIntentWeblab","ready").register("SDSlotContainerWidget",function(c,k,f,n,m,a,d){function b(a){c.on("active-shipment-changed",function(){K(a)});u.history&&q(u).bind("popstate",function(){K(a)});c.on("Shipping::ShipSpeed::Change",function(b){b.shipSpeedType&&"scheduledDelivery"===b.shipSpeedType?K(a):n.enableContinue(a)})}function h(b){if(b.pageType&&b.pageType===f.SHIP_OPTION_SELECT_PAGE&&b.metadata.slot&&
b.widgetId){var e=b.widgetId,d=b.metadata.slot;if(d)try{var h=q("#"+e),D=t(b.metadata.widgetId),k=r(h),l=C(b.metadata.widgetId),n=y(h),m={apptPrefs:[{startTimeInEpoch:d.startTimeUTC,endTimeInEpoch:d.endTimeUTC,timezone:l}],orderId:D,shipSpeedName:k,serviceId:d.serviceId,selectedShipSpeedName:n};p.when("unifiedDeliveryData-dom-updation").execute(function(b){b&&!q.isEmptyObject(b)&&(c.trigger("slot::selected::change::common::event",m),a.logMetric(f.MDW_WIDGET_INTERACTION_DELIVERY_INFORMATION_EMIT_SUCCESS_METRIC,
1))})}catch(R){a.logMetric(f.MDW_WIDGET_INTERACTION_DELIVERY_INFORMATION_EMIT_FAIL_METRIC,1),a.logException(R,"Exception occurred while trying to save customer intent for service line item creation in ssd mdw")}}}function t(b){if(!b)return"";(b=q("[name\x3dSDV1-orderId-"+b+"]").attr("value")||"")||a.logMetric(f.MDW_GET_ORDER_ID_FROM_WIDGET_ID_FAILURE_METRIC,1);return b}function r(b){if(!b||!b.length)return"";var e=b.closest("div.selectable-box");e&&e.length||(e=b.closest("div.fake-label"));(b=e.find("input[type\x3d'radio']").attr("value")||
"")||a.logMetric(f.MDW_GET_SHIP_SPEED_NAME_FROM_WIDGET_ELEMENT_FAILURE_METRIC,1);return b}function y(b){if(!b||!b.length)return"";var e=b.closest("div.one-shipment");e&&e.length||(e=b.closest("div.one-shipment-options"));b=e.find("div.selectable-box.selected");e&&e.length||(b=e.find("div.fake-label.selected"));e=b.find("input[type\x3d'radio']").attr("value")||"";a.logMetric(f.MDW_GET_SELECTED_SHIP_SPEED_NAME_FROM_WIDGET_ELEMENT_FAILURE_METRIC,e&&0<e.length?0:1);return e}function C(b){if(!b)return"";
(b=q("[name\x3dSDV1-timezone-"+b+"]").attr("value")||"")||a.logMetric(f.MDW_GET_TIMEZONE_FROM_WIDGET_ID_FAILED_METRIC,1);return b}var q=c.$,K=function(a){k.isSlotSelected(a)?n.enableContinue(a):n.disableContinue(f.CONTINUE_BUTTON_OWNER,a)},l=function(a,b){q(f.SD_NOT_AVAILABLE_ID_PREFIX+a).removeClass(f.AOK_HIDDEN);q(f.SD_WIDGETS_SPINNER_PREFIX+a).addClass(f.AOK_HIDDEN);q("#"+b).hide();n.enableContinue(b);m.disableMdwShipOption(f.SLOT_CONTAINER_WIDGET_ROOT_PREFIX+a)};c.on("slot-container-slot-selected",
function(a){var b=a.metadata;if(b){var g=a.pageType,k=b.widgetId;if(b=b.slot){q("[name\x3dSDV1-ResID-"+k+"]").val(b.reservationId);q("[name\x3dSDV1-startDeliveryTime-"+k+"]").val(b.startTimeUTC);q("[name\x3dSDV1-endDeliveryTime-"+k+"]").val(b.endTimeUTC);var l=q("[name\x3dSDV1-isUnoGatingEnabled-"+k+"]");l.length&&"1"===l.val()&&q("[name\x3dSDV1-ServiceSecaId-"+k+"]").val(b.serviceSECAId);(l=q("[name\x3dSDV1-isMdwLatencyClawbackEnabled-"+k+"]"))&&"1"===l.val()&&(q("[name\x3dSDV1-carrierSet-"+k+"]").val(b.carrierSet),
q("[name\x3dSDV1-promiseFulfillmentServiceSubclass-"+k+"]").val(b.promiseFulfillmentServiceSubclass),q("[name\x3dSDV1-promiseMaxShipmentDate-"+k+"]").val(b.promiseMaxShipmentDate),q("[name\x3dSDV1-promiseMinShipmentDate-"+k+"]").val(b.promiseMinShipmentDate))}g===f.SINGLE_PAGE_CHECKOUT&&c.trigger("slot-container-slot-selected-on-spc",a);d.isCustomerIntentSaveEnabled()&&g===f.SHIP_OPTION_SELECT_PAGE&&h(a)}});return{createWidget:function(c,e,d){var h=function(e){q(f.SD_WIDGETS_SPINNER_PREFIX+c).addClass(f.AOK_HIDDEN);
q("#"+d).replaceWith(e.payload);k.enableWidgetActions(d);K(d);b(d);a.logMetric(f.SD_SLOT_CONTAINER_WIDGET_RENDER_SUCCESS_METRIC,1)},g=function(b){if(e&&e.selectedSlotUpsellMessage){var h=e.selectedSlotUpsellMessage;q(f.SD_WIDGETS_SPINNER_PREFIX+c).addClass(f.AOK_HIDDEN);var g=q("#"+d);g.addClass(f.AOK_HIDDEN);g.closest(f.SD_MDW_WIDGET_ROOT_CLASS).parent().find(f.UPSELL_MESSAGE_CLASS).html(h);n.enableContinue(d)}else l(c,d),a.logMetric(f.SD_MDW_DISABLE_SHIP_OPTION_METRIC,1);a.logException(b,"Got an error while trying to create slot container widget");
a.logMetric(f.SD_SLOT_CONTAINER_WIDGET_RENDER_ERROR_METRIC,1)},t=e&&e.scheduleSlots&&e.scheduleSlots.availableSlots;t&&0<t.length?k.createWidget(f.SLOT_CONTAINER_AJAX_CALL_URL,e,h,g):(l(c,d),a.logMetric(f.SD_SLOT_CONTAINER_WIDGET_NO_SLOTS_METRIC,1))}}});"use strict";p.when("A","CalendarWidget","SDWidgetsConstants","SDUpsellMessagePrefixConfig","page-detector").register("SDCalendarUtils",function(c,k,f,n,m){function a(a,d){if(m.isSpc())return b("."+f.SD_UPSELL_MESSAGE_PREFIX+d);if(a=b("#"+f.SD_WIDGETS_PREFIX+
d).parent())return a.find(".upsell-messaging")}function d(b,d,c){var h=3<arguments.length&&arguments[3]!==y?arguments[3]:!1,k=a(b,d);if(k&&k.length)if(m.isSpc())k.html(c);else{var t="";h||(t="HYPHEN"===n.prefixType?f.UPSELL_MESSAGE_PREFIX_HYPHEN:"DASH"===n.prefixType?f.UPSELL_MESSAGE_PREFIX_DASH:f.UPSELL_MESSAGE_PREFIX_COLON);k.html(t+c)}}var b=c.$;return{updateUpsellMessage:d,appendUpsellMessage:function(b,c,f){var h=a(b,c);h&&h.length&&d(b,c,h.html()+"\x3cbr /\x3e"+f,!0)}}});"use strict";p.when("A",
"ServicesWidget","SDWidgetsConstants","sdLogger","ready").register("SDServicesWidget",function(c,k,f,n){var m=c.$;return{createWidget:function(a){k.createWidget(a,function(d){var b=a.widgetId;m("#"+b).replaceWith(d.payload);m("#"+b).addClass("hide-if-not-selected")},function(a){n.logException(a,"Got an error while trying to create Service Widget");n.logMetric(f.SD_SERVICE_WIDGET_RENDER_ERROR_METRIC,1)})},hide:function(a){m("#"+a).hide()}}});"use strict";p.when("A").register("SDShadowConfig",function(c){return{enabled:!1}});
"use strict";p.when("A","SDWidgetsConstants","sdLogger").register("SDShadowInputTransformer",function(c,k,f){var n=[function(a,d,b){b.widgetIndex=a;b.calendarInput&&(b.calendarInput.widgetId=d.calendarWidgetId);b.servicesInput&&(b.servicesInput.widgetId=d.servicesWidgetId);return b},function(a,d,b){b.calendarInput&&b.calendarInput.slots&&0<b.calendarInput.slots.length&&c.each(b.calendarInput.slots,function(b){if(b.metadata){var d=JSON.parse(b.metadata);d.widgetIndex=a;b.metadata=JSON.stringify(d)}});
return b},function(a,d,b){b.servicesInput&&b.servicesInput.services&&0<b.servicesInput.services.length&&c.each(b.servicesInput.services,function(b){if(b.metadata){var c=JSON.parse(b.metadata);c.widgetIndex=a;c.calendarWidgetId=d.calendarWidgetId;c.servicesWidgetId=d.servicesWidgetId;b.metadata=JSON.stringify(c)}});return b}],m={A1VC38T7YXB528:[function(a,d,b){b.calendarInput&&b.calendarInput.slots&&0<b.calendarInput.slots.length&&c.each(b.calendarInput.slots,function(a){a.price=0});return b}]};return{transform:function(a,
d,b){var h=c.$.extend(!0,{},b);c.each(n,function(b){h=b(a,d,h)});b=d.marketplace;b in m&&c.each(m[b],function(b){h=b(a,d,h)});return h}}});"use strict";p.when("A","SDWidgetsConstants","sdLogger","SDShadowInputTransformer","SDShadowConfig").register("SDShadowWidgetsHub",function(c,k,f,n,m){var a={},d={};c.on("sd_widget_input_loaded",function(b,d){c.each(a,function(a,h){a.mainWidgetIndex===b&&c.trigger("sd_shadow_widget_input_loaded",h,d)})});c.on("sd_shadow_widget_input_loaded",function(b,c){var h=
a[b];if(h&&b in d){var m=d[b];m&&(b=n.transform(b,h,c),m(b),f.logMetric(k.SD_SHADOW_LOAD_METRIC,1))}});return{enabled:function(){return m.enabled},registerShadowWidget:function(b,c,n){b in a||(a[b]=c,d[b]=n,f.logMetric(k.SD_SHADOW_REGISTER_METRIC,1))},isShadowWidget:function(b){return b in a},getShadowWidgetInfo:function(b){var d=null;c.each(a,function(a,c){d||a.mainWidgetIndex===b&&(d={widgetIndex:c,calendarWidgetId:a.calendarWidgetId,servicesWidgetId:a.servicesWidgetId})});return d},getMainWidgetInfo:function(b){if(!(b in
a))return null;b=a[b];return{widgetIndex:b.mainWidgetIndex,calendarWidgetId:b.mainCalendarWidgetId,servicesWidgetId:b.mainServicesWidgetId}},processShadowCalendarInput:function(b,c){return b in a?n.transform(b,a[b],c):c}}});"use strict";p.when("A","GoldenCxRapServiceIntegration","SDCalendarWidget","SDServicesWidget","SDShipOptionHandler","SDWidgetsConstants","sdLogger","SDButtonBlockerController","SDShadowWidgetsHub","page-detector","SDDisableServiceWidget","ready").register("ScheduledDeliveryWidgets",
function(c,k,f,n,m,a,d,b,h,p,r){function u(a,b){if(b&&b.start&&b.end){var c=parseInt(b.start),d=parseInt(b.end);for(b=0;b<a.length;b++){var e=a[b];if(e.startTime===c&&e.endTime===d)return a[b].isDefault=!0,a}}for(b=c=0;b<a.length;b++)a[b].startTime<a[c].startTime?c=b:a[b].startTime===a[c].startTime&&a[b].endTime<a[c].endTime&&(c=b);a[c].isDefault=!0;return a}var t=c.$,q=function F(c,d,k){t(a.SD_NOT_AVAILABLE_ID_PREFIX+c).removeClass("aok-hidden");t(a.SD_NOTE_ID_PREFIX+c).addClass("aok-hidden");t(a.SD_CHANGE_LINK_ID_PREFIX+
c).addClass("aok-hidden");t(a.SD_WIDGETS_SPINNER_PREFIX+c).addClass("aok-hidden");n.hide(k);f.hide(d);b.enableContinue(d);m.disableShipOption(a.SD_WIDGETS_PREFIX+c,!0);h.enabled()&&!h.isShadowWidget(c)&&(c=h.getShadowWidgetInfo(c))&&F(c.widgetIndex,c.calendarWidgetId,c.servicesWidgetId)},K=function(a){c.each(t('script[type\x3d"a-state"]'),function(b,c){t(b).data("a-state").key===a&&b.remove()})},l=function(a){f.createWidget(a.widgetIndex,a.calendarInput,function(b){q(a.widgetIndex,a.calendarWidgetId,
a.servicesWidgetId)},a.selectedSlot)};c.on("sd_load_information",function(e,g,f,m){K(a.SD_CALENDAR_WIDGET_PREFIX+e);d.logMetric(a.SD_WIDGET_LOAD_INFORMATION_METRIC,1);var x,v;b.setTooltipMessage(g.tooltipMessage);g.isSelected&&1===g.isSelected&&b.disableContinue(a.CONTINUE_BUTTON_OWNER,f);var z=function(b){d.logException(JSON.stringify(b),"Got an error while trying to load SD widgets");d.logMetric(a.SD_WIDGET_LOAD_ERROR_METRIC,1);b.type&&d.logMetric(b.type,1);q(e,f,m)},F=function(){function b(a,b){var c=
JSON.parse(b.metadata).slot.reservationId.split(";"),d;3<=c.length&&(d=c[2]);a[""+b.startTime+b.endTime]=d}function c(a,b){a=a.split("^");b=b.split("^");return 3===a.length&&3===b.length&&parseFloat(a[0])===parseFloat(b[0])&&parseFloat(a[1])===parseFloat(b[1])&&a[2]===b[2]?1:0}d.logMetric(a.SD_WIDGET_SHADOW_COMPARISON_METRIC,1);var e=0;v&&v.calendarInput&&v.calendarInput.slots&&0!==v.calendarInput.slots.length&&(e=1);var f=0;x&&x.calendarInput&&x.calendarInput.slots&&0!==x.calendarInput.slots.length&&
(f=1);if(f||e)if(f&&!e)d.logMetric(a.SD_WIDGET_SHADOW_ONLY_HAS_GVDGO_SLOTS_METRIC,1);else if(!f&&e)d.logMetric(a.SD_WIDGET_SHADOW_ONLY_HAS_RAP_SLOTS_METRIC,1);else{d.logMetric(a.SD_WIDGET_SHADOW_BOTH_SLOTS_EXIST_METRIC,1);e={};f={};var h=""+v.calendarInput.slots[0].startTime+v.calendarInput.slots[0].endTime,g=""+x.calendarInput.slots[0].startTime+x.calendarInput.slots[0].endTime;if("HB"===P)for(var k=0;k<v.calendarInput.slots.length;k++)b(e,v.calendarInput.slots[k]);else if("SP"===P){var l=v.calendarInput.slots[0].startTime+
691200;for(k=0;k<v.calendarInput.slots.length;k++)v.calendarInput.slots[k].startTime<l&&b(e,v.calendarInput.slots[k])}for(k=0;k<x.calendarInput.slots.length;k++)b(f,x.calendarInput.slots[k]);h!==g&&d.logMetric(a.SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_METRIC,1);c(e[h],f[g])||d.logMetric(a.SD_WIDGET_SHADOW_SLOTS_FADD_PRICE_MISMATCH_METRIC,1);v.calendarInput.slots[0].startTime<x.calendarInput.slots[0].startTime?d.logMetric(a.SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_START_LATE_METRIC,x.calendarInput.slots[0].startTime-
v.calendarInput.slots[0].startTime):v.calendarInput.slots[0].startTime>x.calendarInput.slots[0].startTime&&d.logMetric(a.SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_START_EARLY_METRIC,v.calendarInput.slots[0].startTime-x.calendarInput.slots[0].startTime);v.calendarInput.slots[0].endTime<x.calendarInput.slots[0].endTime?d.logMetric(a.SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_END_LATE_METRIC,x.calendarInput.slots[0].endTime-v.calendarInput.slots[0].endTime):v.calendarInput.slots[0].endTime>
x.calendarInput.slots[0].endTime&&d.logMetric(a.SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_END_EARLY_METRIC,v.calendarInput.slots[0].endTime-x.calendarInput.slots[0].endTime);h=Object.keys(e).length;g=Object.keys(f).length;h!==g&&(d.logMetric(a.SD_WIDGET_SHADOW_SLOTS_LENGTH_MISMATCH_METRIC,1),10<h-g?d.logMetric(a.SD_WIDGET_SHADOW_RAP_TEN_PLUS_SLOTS_MORE_METRIC,1):5<h-g?d.logMetric(a.SD_WIDGET_SHADOW_RAP_FIVE_PLUS_SLOTS_MORE_METRIC,1):1<h-g?d.logMetric(a.SD_WIDGET_SHADOW_RAP_ONE_PLUS_SLOTS_MORE_METRIC,
1):1===h-g?d.logMetric(a.SD_WIDGET_SHADOW_RAP_ONE_SLOT_MORE_METRIC,1):10<g-h?d.logMetric(a.SD_WIDGET_SHADOW_GVDGO_TEN_PLUS_SLOTS_MORE_METRIC,1):5<g-h?d.logMetric(a.SD_WIDGET_SHADOW_GVDGO_FIVE_PLUS_SLOTS_MORE_METRIC,1):1<g-h?d.logMetric(a.SD_WIDGET_SHADOW_GVDGO_ONE_PLUS_SLOTS_MORE_METRIC,1):1===g-h&&d.logMetric(a.SD_WIDGET_SHADOW_GVDGO_ONE_SLOT_MORE_METRIC,1));for(var m in e)f.hasOwnProperty(m)?c(e[m],f[m])||d.logMetric(a.SD_WIDGET_SHADOW_SLOTS_PRICE_MISMATCH_METRIC,1):d.logMetric(a.SD_WIDGET_SHADOW_SLOTS_TIME_MISMATCH_METRIC,
1)}else d.logMetric(a.SD_WIDGET_SHADOW_BOTH_SLOTS_NOT_EXIST_METRIC,1)},C=function(a){x=a;F()},G=function(a){v=a;M.path="Rapless";k.getWidgetInputParameters(M,C,z)},Q=g.shadowMode,N=function(b){if(b&&b.calendarInput&&b.calendarInput.slots&&0!==b.calendarInput.slots.length){if(b.selectedSlot=g.selectedSlot,l(b),r.enabled?(n.hide(m),d.logMetric(a.SD_SERVICE_WIDGET_DISABLED,1)):b.servicesInput?(n.createWidget(b.servicesInput),d.logMetric(a.SD_SERVICE_WIDGET_LOADED,1)):n.hide(m),h.enabled()&&!Q){var p=
t.extend(!0,{},b);c.trigger("sd_widget_input_loaded",e,p)}}else d.logMetric(a.SD_WIDGET_NO_SLOTS_METRIC,1),q(e,f,m);S&&(v=b,M.path="Rapless",k.getWidgetInputParameters(M,C,z))};t(a.SD_CHANGE_LINK_ID_PREFIX+e).click(function(a){a.preventDefault()});if(h.enabled()&&Q)g.calendarWidgetId=f,g.servicesWidgetId=m,h.registerShadowWidget(e,g,N);else{if(g.udsServiceCodes){if(-1===g.udsServiceCodes){z({type:a.SD_UDS_ERROR_MESSAGE,data:g.marketplace});b.disableContinue(a.CONTINUE_BUTTON_OWNER,f);return}for(var A=
document.getElementsByName("order_"+g.trimmedOrderId+"_ShippingSpeed"),E=0;E<A.length;E++){var B=A[E];"hidden"===B.type&&B.remove()}}A=[];for(E=0;E<g.items.length;E++){B=g.items[E];var L={itemID:E,merchantID:B.merchantid,merchantSKU:B.merchantsku,inventoryAuthorityID:B.asin,offerListingID:B.offerlistingid,fulfillmentManagerID:B.fulfillmentnetworkid,totalQuantity:B.quantity};g.isSdRaplessAsyncEnabled&&(L.lineItemId=B.lineItemId);A.push(L)}A={marketplace:g.marketplace,shipoption:g.shipoption,address:g.address,
widgetIndex:e,client:"SOSP",trimmedOrderId:g.trimmedOrderId,servicesWidgetId:m,calendarWidgetId:f,sessionId:g.sessionId,customerId:g.customerId,isPrimeCustomer:!!g.isPrimeCustomer,isSlotPreviouslySelected:!!g.selectedSlot,isAfn:g.isAfn,udsServiceCodes:g.udsServiceCodes,lineItems:A};A.client=p.isSosp()?"SOSP":"SPC";A.selectedSlot=g.selectedSlot;if(g.isSdRaplessAsyncEnabled&&"LAUNCH"===g.isSdRaplessAsyncEnabled)d.logMetric(a.SD_WIDGET_RAPLESS_ASYNC_METRIC,1),A.path="Rapless",k.getWidgetInputParameters(A,
N,z);else if(g.isSdRaplessAsyncEnabled&&"SHADOW"===g.isSdRaplessAsyncEnabled&&!g.isSdWithoutRAPFeatureEnabled){if(g.sdRaplessAsyncUseCase)var P=g.sdRaplessAsyncUseCase;var M=JSON.parse(JSON.stringify(A));var S=1;k.getWidgetInputParameters(A,N,z)}else if(g.isSdWithoutRAPFeatureEnabled)if(g.isSdRaplessAsyncEnabled&&"SHADOW"===g.isSdRaplessAsyncEnabled&&(g.sdRaplessAsyncUseCase&&(P=g.sdRaplessAsyncUseCase),M=JSON.parse(JSON.stringify(A)),k.getWidgetInputParameters(A,G,z)),"undefined"===typeof g.sdGoldenCXWidgetsParametersWithoutRAP.deliveryTimeZone||
null===g.sdGoldenCXWidgetsParametersWithoutRAP.deliveryTimeZone||"undefined"===typeof g.sdGoldenCXWidgetsParametersWithoutRAP.availableSlots||0===g.sdGoldenCXWidgetsParametersWithoutRAP.availableSlots.length)d.logMetric(a.SD_WIDGET_NO_GVDGO_SLOTS_METRIC,1),q(e,f,m);else{d.logMetric(a.SD_WIDGET_HAS_GVDGO_SLOTS_METRIC,1);var H;g.sdGoldenCXWidgetsParametersWithoutRAP.shipOptionLevelPrice&&g.sdGoldenCXWidgetsParametersWithoutRAP.shipOptionLevelPrice.CurrencyCode?H=g.sdGoldenCXWidgetsParametersWithoutRAP.shipOptionLevelPrice:
d.logMetric(a.SD_WIDGET_NO_SHIPOPTION_LEVEL_PRICE_METRIC,1);E=0;G=[];B=g.sdGoldenCXWidgetsParametersWithoutRAP.deliveryTimeZone;for(L=0;L<g.sdGoldenCXWidgetsParametersWithoutRAP.availableSlots.length;L++){var w=g.sdGoldenCXWidgetsParametersWithoutRAP.availableSlots[L],J={reservationId:w.reservationIds.join().concat(";;"),reservationType:"CASE",longTimezone:B,startTimeLocalTimezone:Number(w.slotStartTime),endTimeLocalTimezone:Number(w.slotEndTime)},I=y,O=y;w.totalItemCharge&&w.totalShipmentCharge&&
w.deliveryPrice&&w.totalItemCharge.CurrencyAmount&&w.totalShipmentCharge.CurrencyAmount&&w.deliveryPrice.CurrencyAmount&&w.deliveryPrice.CurrencyCode?(I=w.totalItemCharge.CurrencyAmount.concat("^").concat(w.totalShipmentCharge.CurrencyAmount).concat("^").concat(w.deliveryPrice.CurrencyCode),J.reservationId=J.reservationId.concat(I).concat(";"),I=Number(w.deliveryPrice.CurrencyAmount),O=w.deliveryPrice.CurrencyCode):(H?(I="0".concat("^").concat("0").concat("^").concat(H.CurrencyCode),J.reservationId=
J.reservationId.concat(I).concat(";"),I=0,O=H.CurrencyCode):J.reservationId=J.reservationId.concat(";"),E=1);w={startTime:Number(w.slotStartTime),endTime:Number(w.slotEndTime),metadata:JSON.stringify({version:"1.0",widgetIndex:e,trimmedOrderId:g.trimmedOrderId,slot:J})};"undefined"!==typeof I&&O&&(w.price=I,w.priceCurrency=O);G.push(w)}E&&d.logMetric(a.SD_WIDGET_NO_SLOT_LEVEL_PRICE_METRIC,1);0<G.length&&(G[0].isDefault=!0);H={widgetId:f,client:"SOSP",timezone:B,marketplaceId:g.marketplace,customerId:g.customerId,
isPrimeCustomer:!!g.isPrimeCustomer,sessionId:g.sessionId,addressId:g.address,isSlotPreviouslySelected:!!g.selectedSlot,isAfn:g.isAfn,slots:G};G[0].isDefault=!1;H.slots=u(G,A.selectedSlot);H.client=p.isSosp()?"SOSP":"SPC";N({calendarInput:H,widgetIndex:e})}else k.getWidgetInputParameters(A,N,z)}});c.on("services_widget_service_selected",function(a){var b=h.isShadowWidget(a.widgetIndex),c={calendarWidgetId:a.calendarWidgetId,selectedServices:a.selectedServices,widgetIndex:a.widgetIndex,trimmedOrderId:a.trimmedOrderId,
isAfn:a.isAfn};if(h.enabled()&&b){var d=h.getMainWidgetInfo(c.widgetIndex);d&&(c.widgetIndex=d.widgetIndex,c.calendarWidgetId=d.calendarWidgetId)}k.getCachedCalendarWidgetInputParameters(c,function(c){h.enabled()&&b?l(h.processShadowCalendarInput(a.widgetIndex,c)):l(c)},function(b){q(a.widgetIndex,a.calendarWidgetId,a.servicesWidgetId)})});c.on("checkout:reload:shipoptionselect",function(){})});"use strict";p.when("A","SDSlotContainerWidget","SDWidgetsConstants","sdLogger","ready").register("ScheduledDeliveryMdwWidgets",
function(c,k,f,n){var m=c.$;c.on("sd-load-mdw-widget",function(a,c,b){k.createWidget(a,c,b)});c.on("slot-container-slot-selected-on-spc",function(a){a=m("#"+a.widgetId).closest(f.SD_MDW_WIDGET_ROOT_CLASS);0<a.length&&(a=a.attr("id"),c.trigger("slot-selected-update-sdi",a));return null});c.on("slot-selected-update-sdi",function(a){var c={};m("#"+a+" input[type\x3dhidden]").each(function(){var a=m(this),b=a.attr("key");a=a.attr("value");b&&(c[b]=a)});var b=m("#"+a).closest(".shipping-speed").find("input[type\x3d'radio']");
u.spcpage.scheduledDeliveryMdwSetSOCallback(b,c,a);n.logMetric(f.SD_MDW_UPDATE_SDI_COUNT_METRIC,1)})});"use strict";p.when("A","ready").register("ServicesCustomerIntentWeblab",function(c){return{isCustomerIntentSaveEnabled:function(){return!1}}})});
/* ******** */
