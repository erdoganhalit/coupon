(function(h){var v=window.AmazonUIPageJS||window.P,q=v._namespace||v.attributeErrors,a=q?q("CheckoutWebappAssets",""):v;a.guardFatal?a.guardFatal(h)(a,window):a.execute(function(){h(a,window)})})(function(h,v,q){"use strict";h.when("A","jQuery","utils/createClass").register("components/Component",function(a,b,d){var e=d({$el:null,props:{},defaultProps:{},init:function(a){this.$el=b(a.$el);if(1<this.$el.length)throw Error("Component must be attached with only one DOM element");if(!this.$el.length)return this;
this.bindAll();this.props=b.extend({},this.defaultProps,a);this.onInit(this.props)},onInit:b.noop,find:function(b){return this.$el.find(b)},bindAll:function(){for(var a in this)"function"===typeof this[a]&&(this[a]=b.proxy(this[a],this))},data:function(){return this.$el.data.apply(this.$el,arguments)}});e.create=function(e){var f=this;return e.$el.length?a.map(e.$el,function(c){return new f(a.extend({},e,{$el:b(c)}))}):[]};e.extend=function(){function b(c){c=a.call(this,c);c.extend=b;c.create=e.create;
return c}var a=e.extend;return b}();return e});"use strict";h.when("A","a-button","client-side-metrics","a-alert","page-detector","a-modal").register("checkout-continue-button",function(a,b,d,e,g,f){function c(a){a.$event.preventDefault();if((a=f.get("checkout-view-modal"))&&a.isActive())if((a=a.getContent().find("#main-continue-form"))&&0<a.length)d.increaseCount("checkout:continueForm:formSubmittedInActiveModal",1),a.submit();else throw d.increaseCount("checkout:continueForm:formNotFoundInActiveModal",
1),Error("[Checkout Modal] Modal is rendered without any main-continue-form.");else b(".continue-button").isEnabled()&&(g.isMobile()&&l(".continue-button").prop("disabled")?e(".checkout-continue-alert-message").show():0<l("#main-continue-form").length?l("#main-continue-form").submit():d.increaseCount("checkout:continueForm:formNotFound",1))}function p(){g.isMobile()&&e(".checkout-continue-alert-message").hide();b(".continue-button").disable()}var l=a.$;a.declarative("checkout-continue-button-action",
["click","touchend"],c);a.declarative("checkout-continue-button-click-action",["click"],c);a.on("checkout:continueButton:enable",function(){g.isMobile()&&(e(".checkout-continue-alert-message").hide(),l(".continue-button").prop("disabled",!1));b(".continue-button").enable()});a.on("checkout:continueButton:disable",p);a.on("checkout:continueButton:disableWithMessage",function(b){g.isMobile()?(e(".checkout-continue-alert-message").text(b),e(".checkout-continue-alert-message").hide(),l(".continue-button").prop("disabled",
!0)):p()})});"use strict";h.when("jQuery","components/Component","weblab-helper").register("components/Checkbox",function(a,b,d){return b.extend({checkbox:null,$el:null,defaultProps:{onChange:a.noop},onInit:function(){if(d.isPyoClientSideInitiationEnabled()){if(!this.$el.length||!this.$el.is(":checkbox"))throw Error("[Checkbox] No checkbox input is found");this.$el.bind("change",this.handleChange)}else{if(!this.$el.hasClass("a-checkbox"))throw Error("[Checkbox] Checkbox component must instantiate with an `a-checkbox` element");
this.$input=this.find(":checkbox");if(!this.$input.length)throw Error("[Checkbox] No checkbox input is found");this.$input.bind("change",this.handleChange)}},handleChange:function(b){this.props.onChange(this.isChecked(),this,b)},isChecked:function(){return d.isPyoClientSideInitiationEnabled()?this.$el.is(":checked"):this.$input.is(":checked")},data:function(b,a){return this.$el.data(b,a)}})});"use strict";h.when("A","jQuery","components/Component","components/Checkbox","weblab-helper").register("components/PrimaryActionBlockerCheckbox",
function(a,b,d,e,g){function f(){var b=a.reduce(c,function(b,a){var c="";if(b.blocking)return b;g.isPyoClientSideInitiationEnabled()?(b=a.shouldBlock())&&(c=a.getBlockerMessage()):(b=!a.isChecked())&&(c=a.data("blocker-message"));return{blocking:b,message:c}},{blocking:null,message:""});a.equals(b,p)||(p=b,a.trigger(l.blockingStateChanged,b))}var c=[],p={blocking:null,message:""},l={blockingStateChanged:"checkbox:primaryActionBlocker:blockingStateChanged"};d=d.extend({onInit:function(b){g.isPyoClientSideInitiationEnabled()?
(this.checkbox=new e({$el:this.$el,onChange:f}),this.blockerMessage=b.blockerMessage,c.push(this)):(this.checkbox=new e({$el:this.$el,onChange:f}),c.push(this.checkbox));f()},shouldBlock:function(){return!this.$el.is(":checked")},getBlockerMessage:function(){return this.blockerMessage}});d.events=l;d.tryChangingBlockingState=f;d.getState=function(){return c.length?b.extend({},p):null};var k=g.isPyoClientSideInitiationEnabled()?"checkout:unload":"checkout:beforeReload";a.on(k,function(){c=[];p={blocking:null,
message:""}});return d});"use strict";h.register("configurations/keys",function(){var a={VIEW_TYPE:"VIEW_TYPE",CONTAINER_SELECTOR:"CONTAINER_SELECTOR",PURCHASE_ID_SELECTOR:"PURCHASE_ID_SELECTOR",validate:function(b){if("string"!==typeof b||!a[b])throw Error('The key "'+b+'" is not defined within "configurations/keys".');}};return a});"use strict";h.when("configurations/keys").register("configurations/newCheckoutExperienceConfig",function(a){var b={};b[a.VIEW_TYPE]="newCheckoutExperience";b[a.CONTAINER_SELECTOR]=
"#checkout-experience-container";b[a.PURCHASE_ID_SELECTOR]='input[name\x3d"purchaseId"]';return{getConfiguration:function(a){return a in b?b[a]:null}}});h.when("A").register("utils/createClass",function(a){function b(){}if(a.createClass)return a.createClass;var d=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;b.extend=function(a){var e=this.prototype,f=Object.create?Object.create(e):function(b){function a(){}a.prototype=b;return new a}(e),c;for(c in a)f[c]="function"===typeof a[c]&&"function"===typeof e[c]&&
d.test(a[c])?function(b,a){return function(){var c=this._super;this._super=e[b];var f=a.apply(this,arguments);this._super=c;return f}}(c,a[c]):a[c];a="function"===typeof f.init?f.hasOwnProperty("init")?f.init:function(){e.init.apply(this,arguments)}:function(){};a.prototype=f;f.constructor=a;a.extend=b.extend;return a};return function(a){return b.extend(a)}});"use strict";h.when("A","jQuery","client-side-metrics","ready").register("widgets/legalDisclaimers/legalDisclaimers",function(a,b,d){var e=
[];b=b(".legal-disclaimers-container");0<b.length&&(d.setCountValue("checkout:legalDisclaimers:widgetCount",b.length),a.on("a:popover:show",function(b){if(b.popover&&b.popover.name&&0===b.popover.name.indexOf("legalDisclaimersWidgetModal-")){var a=b.popover.name;-1===e.indexOf(a)&&(d.setCountValue("checkout:legalDisclaimers:popoverSuccess",1),b=b.popover.$popover.find("#"+a+"-content"),0<b.length&&d.setCountValue("checkout:legalDisclaimers:popoverContentHeight",b[0].clientHeight),e.push(a))}}))});
"use strict";h.when("A","client-side-metrics").register("utils/redirectionUtils",function(a,b){function d(b,a,d){e(b,a,d||{},!1)}function e(a,c,d,e){a&&0<a.length?(b.setCountValue("checkout:"+c+":startRedirection",1),v.open(g(a,d),e?"_blank":"_self")):b.setCountValue("checkout:"+c+":emptyUrl",1)}function g(b,a){var c=Object.keys(a).map(function(b){return b+"\x3d"+a[b]});return 0<c.length?b+(-1<b.indexOf("?")?"\x26":"?")+c:b}return{redirectInCurrentTab:d,redirectWithReason:function(b,a,e){var c={};
c.redirectReason=e;d(b,a,c)},openInNewTab:function(b,a,d){e(b,a,d||{},!0)}}});"use strict";h.register("utils/smsMessageValidator",function(){var a=/^[\n\r !-Z[\]\\^_a-~¡£¤¥§¿ÄÅÆÇÉÑÓÖØÜßàäåæçèéìñòóöøùüĄąĆćĘęĞğİıŁłŃńŚśŞşŹ-żΓΔΘΛΞΠΣΦΨΩ€]*$/;return{isValid:function(b){return a.test(b)}}});"use strict";h.register("utils/urlConstants",function(){return{GURUPA_URL:"/gp/buy/shared/handlers/dispatch.html",SHOPPING_PORTAL_ROUTED_WEBAPP_LOCATION_PURCHASES:"/checkout/p/"}});"use strict";h.when("utils/urlConstants").register("utils/urlUtils",
function(a){function b(b,e){return a.SHOPPING_PORTAL_ROUTED_WEBAPP_LOCATION_PURCHASES+b+e}return{buildShoppingPortalRoutedWebappUrl:b,buildShoppingPortalRoutedWebappUrlWithParams:function(a,e,g){a=b(a,e);if(!g)return a;e=Object.keys(g).map(function(b){return b+"\x3d"+g[b]});for(var d=0;d<e.length;d++)a=a+(-1<a.indexOf("?")?"\x26":"?")+e[d];return a},isChewbaccaRequest:function(b){return/^\/checkout\//.test(b||v.window.location.pathname)}}});h.when("A","client-side-metrics").register("utils/auiComponentHelper",
function(a,b){return{getRadioButtonData:function(a){var e=a.closest(".a-radio");a=a.attr("name");if(e.length)return e.data();b.logError("AUI_ELEMENT_NOT_FOUND","[a-radio is not found for the radio input"+(a?" with name "+a:"")+"]","[utils/auiComponentHelper] getRadioWrapper","FATAL")},showDropDownList:function(d){var e=a.$("#"+d+" [data-action\x3da-dropdown-button]");if(e.length)return e.click();b.logError("AUI_ELEMENT_NOT_FOUND","[a-dropdown-button is not found in AUI dropdown component with id "+
d+"]","[utils/auiComponentHelper] showDropDownList","FATAL")}}});h.when("A","jQuery","page-detector-current-page","client-side-metrics").execute(function(a,b,d,e){function g(){var a=b("meta[name\x3d'anti-csrftoken-a2z']");return a?a.attr("content"):""}function f(a){b.ajax({type:"POST",url:"/ab/ab-checkout-integrations/update-customer-checkout-step",contentType:"application/json",headers:{"anti-csrftoken-a2z":g()},data:JSON.stringify({checkoutStep:a,timestamp:Date.now().toString(),purchaseId:""}),
async:!0,cache:!1,error:function(b,a,c){e.increaseCount("checkout:savespot:failedToUpdated",1);e.logError(a,b.status+": Failed to notify customer step.","AB-Checkout","WARN")},success:function(b,a,c){e.increaseCount("checkout:savespot:successfullyToUpdated",1)}})}if("1"===b("meta[name\x3dENABLE_AB_UPDATE_CUSTOMER_STEP]").attr("content"))a.on("checkout:reload",function(){var b=d.getCurrentPage();f(b)})});"use strict";h.when("A","jQuery","page-transition-controller","page-conductor","widgets/ageVerification/ageVerificationCommon",
"client-side-metrics").register("widgets/ageVerification/removeLineItems",function(a,b,d,e,g,f){a.declarative("age-restriction-remove-restricted-items","click",function(a){f.increaseCount("checkout:ageverification:removeRestrictedItemsClick",1);a=a.data;var c=(new Date).getTime(),d=e.setAjaxTransitionHeader({"x-amz-checkout-page":"agelimitation"});g.startPageTransition(a.loadingText);b.ajax({type:"POST",url:a.url+"\x26cachebuster\x3d"+c,data:b.param(a.param,!0),dataType:"text",headers:d,error:e.ajaxRedirect,
success:e.ajaxUpdatePage})})});"use strict";h.when("A","jQuery").register("widgets/ageVerification/switchIdForm",function(a,b){a.declarative("age-verification-change-id-dropdown","change",function(a){a=".age-verification-id-"+a.$target.find(":selected").val().toLowerCase().replace(/_/g,"-");var e=b("[name\x3d'age_verification_form']");e.find(".age-verification-id").addClass("aok-hidden");e.find(a).removeClass("aok-hidden")})});"use strict";h.when("A","jQuery","page-transition-controller","page-conductor",
"widgets/ageVerification/ageVerificationCommon","widgets/ageVerification/ageVerificationEndpoint").register("widgets/ageVerification/ageVerification",function(a,b,d,e,g,f){function c(a){var c=!0;a.find(".a-button-error, .a-form-error").removeClass("a-button-error").removeClass("a-form-error").end().find(".calendar-dropdown select, .age-verification-id:visible select, :text:visible, [type\x3ddate]:visible, [type\x3dnumber]:visible").each(function(a,e){a=b(e);a.val()||(c=!1,"INPUT"===a.prop("tagName")?
a.addClass("a-form-error"):a.siblings(".a-button-dropdown").addClass("a-button-error"))});return c?!0:(a.find("#missing-fields-error-message").removeClass("aok-hidden"),!1)}function p(){var a=b('[name\x3d"age_verification_form"]');if(!a.find('[name\x3d"expiry"]').length&&!a.find('[name\x3d"expiry-year"]').length)return!0;var c=g.validateAndParseDate(a,"expiry","expiry-"),e=new Date;return c===q||null===c||c<e?(g.addSelectError(a.find('[name\x3d"expiry-month"]'),"expiration-error-message"),g.addSelectError(a.find('[name\x3d"expiry-day"]'),
"expiration-error-message"),g.addSelectError(a.find('[name\x3d"expiry-year"]'),"expiration-error-message"),!1):!0}function l(a){var c=g.buildFormData(a);if(f.shouldCopyDOB()){var d=c.match(/dob_input=([^&]*)/);c=c.concat("\x26dob_input_copy\x3d").concat(d[1])}d=e.setAjaxTransitionHeader({"x-amz-checkout-page":"agelimitation"});return b.ajax({type:"POST",url:f.getSubmissionEndpoint(a),data:c,dataType:"text",headers:d,success:t,error:e.ajaxRedirect})}function k(a){var c=a.data("profile");a=g.buildFormData(a);
return b.ajax({type:"POST",url:"/ap/cvf/request/identity?sif_profile\x3d"+c,data:a,dataType:"json",success:n,error:e.ajaxRedirect})}function n(a,c){c=b('[name\x3d"age_verification_form"]');var d=c.find('input[name\x3d"ageLimitation"]').val(),g=c.find('input[name\x3d"ivvDomain"]').val();a={claimToken:a.token,ageLimit:d,ivvDomain:g};d=e.setAjaxTransitionHeader({"x-amz-checkout-page":"agelimitation"});return b.ajax({type:"POST",url:f.getSubmissionEndpoint(c),data:a,dataType:"text",headers:d,success:r,
error:e.ajaxRedirect})}function r(a,c,d){var k=a.trim();(k=f.extractNewRequestTokenFromCVFResponse(k))?(g.stopPageTransition(),a=b('[name\x3d"age_verification_form"]'),a.find("#id-error-message").removeClass("aok-hidden"),a.find('input[name\x3d"requestToken"]').val(k)):e.ajaxUpdatePage(a,c,d)}function t(a,c,d){var k=a.trim();null!==d&&f.isSuccessResponse(d,k)?e.ajaxUpdatePage(a,c,d):(g.stopPageTransition(),b('[name\x3d"age_verification_form"]').find("#upload-error-message").removeClass("aok-hidden"))}
b(document.documentElement).delegate('[name\x3d"age_verification_form"]',"submit",function(a){a.preventDefault();a=b(a.target);a.find("#dob-error-message").addClass("aok-hidden");a.find("#expiration-error-message").addClass("aok-hidden");a.find("#id-error-message").addClass("aok-hidden");a.find("#missing-fields-error-message").addClass("aok-hidden");c(a)&&g.validateDateOfBirth()&&p()&&(g.startPageTransition(a.data("loadingtext")),f.shouldCallCVF(a)?k(a):l(a))});return{validateDateOfBirth:g.validateDateOfBirth,
validateExpiryDate:p,validateForm:c,callCVF:k,submitDateOfBirthForm:l,decodeClaimToken:n,verifyServiceResult:r,verifyDateOfBirthUploadResult:t}});"use strict";h.when("A","jQuery","page-transition-controller","page-conductor","utils/urlUtils").register("widgets/ageVerification/ageVerificationCommon",function(a,b,d,e,g){function f(a,b,e){b=a.find('input[name\x3d"'+b+'"]');if(b.length)a=c(b.val());else{b=a.find('[name\x3d"'+e+'year"]').val();var d=a.find('[name\x3d"'+e+'month"]').val();e=a.find('[name\x3d"'+
e+'day"]').val();a=c(b+"-"+d+"-"+e);if(a.getFullYear()!==Number(b)||a.getMonth()!==Number(d)-1||a.getDate()!==Number(e))return null}return a}function c(a){a=a.split(/\D/);return new Date(a[0],a[1]-1,a[2])}function p(a,b){var c=a.find('[name\x3d"'+b+'year"]').val(),e=a.find('[name\x3d"'+b+'month"]').val();a=a.find('[name\x3d"'+b+'day"]').val();return c+"-"+("0"+e).slice(-2)+"-"+("0"+a).slice(-2)}function l(){return g.isChewbaccaRequest()?b("#checkout-age-verification-panel"):b("#agelimitation")}function k(a){var b=
a.find('input[name\x3d"dob_input"]');b.length?n(b,"dob-error-message"):(r(a.find('[name\x3d"month"]'),"dob-error-message"),r(a.find('[name\x3d"day"]'),"dob-error-message"),r(a.find('[name\x3d"year"]'),"dob-error-message"))}function n(a,b){var c=a.parent(".a-input-text-wrapper");(c.length?c:a).addClass("a-form-error");t(a,b)}function r(a,b){a=a.siblings("span.a-button-dropdown");a.addClass("a-button-error");t(a,b)}function t(a,c){a.attr("aria-invalid",!0);a.attr("aria-errormessage",c);b("#"+c).removeClass("aok-hidden")}
return{validateDateOfBirth:function(){var a=b('[name\x3d"age_verification_form"]'),c=f(a,"dob_input","");if(null===c)return k(a),!1;var e=a.find('input[name\x3d"ageLimitation"]').val(),d=new Date;if(d.getFullYear()-c.getFullYear()>Number(e)||d.getFullYear()-c.getFullYear()===Number(e)&&0<=d.getMonth()-c.getMonth()&&0<=d.getDate()-c.getDate())return!0;k(a);return!1},validateAndParseDate:f,buildFormData:function(a){var b=a.serialize();a.find('input[name\x3d"dob_input"]').length||(b+="\x26dob_input\x3d"+
p(a,""));var c=0<a.find('[name\x3d"expiry"]').length,e=0<a.find('[name\x3d"expiry-year"]').length;!c&&e&&(b+="\x26expiry\x3d"+p(a,"expiry-"));return b},stopPageTransition:function(){if(e.isSPP()){var a=l();a.removeClass("spp-panel.collapsed");a.addClass("spp-panel.expanded");var b=a.find(".panel-content");a.find(".shrink-placeholder").hide();b.show();d.unblockAllActions()}else d.hide()},startPageTransition:function(a){e.isSPP()?(d.blockAllActions(),d.shrinkPanel(l(),!0,a)):d.show()},addSelectError:r,
addInputError:n}});"use strict";h.register("widgets/ageVerification/ageVerificationEndpoint",function(){return{getSubmissionEndpoint:function(a){return"/gp/buy/agelimitation/handlers/decode.html"},shouldCallCVF:function(a){return"true"!==a.find('input[name\x3d"isDateOfBirthOnlyEnabled"]').val()},shouldCopyDOB:function(){return!1},extractNewRequestTokenFromCVFResponse:function(a){return-1!==a.indexOf("newRequestToken\x3d")?a.split("\x3d")[1]:q},isSuccessResponse:function(a,b){return null===a.getResponseHeader("x-amz-checkout-agelimitation-embu-write-failed")&&
-1===b.indexOf("embuWriteFailed")&&-1===b.indexOf("ageVerificationErrorReasonCode")}}});"use strict";h.when("A").register("widgets/ageVerification/formPreprocessor/formPreprocessor",function(){function a(a){return/\d/.test(a)}return{preprocessForm:function(b){var d=b.clone();0===b.find('[name\x3d"dob_input"]').length&&(d.find('[name\x3d"day"]').val(b.find('[name\x3d"day"]').val()),d.find('[name\x3d"month"]').val(b.find('[name\x3d"month"]').val()),d.find('[name\x3d"year"]').val(b.find('[name\x3d"year"]').val()));
b=d.find('[name\x3d"door-number"]');var e=b.val();e=e.replace(/(?![A-Za-z0-9])[-¿]/g," ");e=a(e)?e.split(" ").filter(a).join(" "):e;e=e.replace(/\s\s+/g," ").trim();b.val(e);return d}}});"use strict";h.when("A","jQuery","client-side-metrics","widgets/availableExternalPoints/availableExternalPointsCommon","load").register("widgets/availableExternalPoints/availableExternalPoints",function(a,b,d,e){function g(){e.updatePrefilledAmount();e.updatePointsDisplay();b("#external-points-redemption-input").bind({keydown:c,
input:p})}function f(){var a=e.parseExternalPointsRedemptionInputAmount("desktop");isNaN(a)||e.performAjaxPostRequest(Number(a),"desktop")}function c(a){if("Enter"===a.key||13===a.keyCode)a.preventDefault(),f()}function p(){e.updatePointsDisplay();e.showApplyButtonAndHideAppliedMessage()}a.declarative("submit-external-points-for-redemption-action","click",f);a.on("checkout:reload:spc",g);g()});"use strict";h.when("A","jQuery","ajax-utility","client-side-metrics","page-conductor","page-transition-controller",
"widgets/availableExternalPoints/inputUtils","load").register("widgets/availableExternalPoints/availableExternalPointsCommon",function(a,b,d,e,g,f,c){function p(a){try{var c=Number(a).toLocaleString(b("#external-points-display-locale-tag").val())}catch(L){c=Number(a).toLocaleString()}return c}function l(a){a.addClass("aok-hidden")}function k(a){a.removeClass("aok-hidden")}function n(a){l(b("#external-points-redemption-error-bad-value"));l(b("#external-points-redemption-error-bad-max"));l(b("#external-points-redemption-error-bad-min"));
k(b("#external-points-redemption-error-block"));k(a);b("input[name\x3dexternalPointsRedemptionInputValue]").addClass("a-form-error")}function r(a,b){a=Math.round(a+"e"+b);return Number(a+"e"+-b)}return{parseExternalPointsRedemptionInputAmount:function(a){l(b("#external-points-redemption-error-block"));l(b("#external-points-redemption-error-bad-value"));l(b("#external-points-redemption-error-bad-max"));l(b("#external-points-redemption-error-bad-min"));b("input[name\x3dexternalPointsRedemptionInputValue]").removeClass("a-form-error");
var d=c.getUnifiedExternalPointsRedemptionInputLiteral();if(isNaN(d))return n(b("#external-points-redemption-error-bad-value")),e.increaseCount("checkout:externalPointsRedemption:"+a+":badValue",1),NaN;d=parseFloat(d);d=r(d,2);return d>b("#external-points-max-amount").val()?(n(b("#external-points-redemption-error-bad-max")),e.increaseCount("checkout:externalPointsRedemption:"+a+":badMax",1),NaN):d<b("#external-points-min-amount").val()?(n(b("#external-points-redemption-error-bad-min")),e.increaseCount("checkout:externalPointsRedemption:"+
a+":badMin",1),NaN):d},updatePointsDisplay:function(){var a=c.getUnifiedExternalPointsRedemptionInputLiteral();isNaN(a)||(a=parseFloat(a),0<a?(a/=b("#external-points-conversion-rate").val(),a=r(a,b("#external-points-decimal-places").val()),b("#external-points-dynamic-display").html(p(a))):b("#external-points-dynamic-display").html("0"))},updatePrefilledAmount:function(){c.updatePrefilledAmount()},performAjaxPostRequest:function(a,c){e.increaseCount("checkout:externalPointsRedemption:"+c+":redemptionButtonClick:"+
b("#external-points-applied-or-available").val(),1);a>Number(0)&&a<Number(b("#external-points-max-amount").val())&&e.increaseCount("checkout:externalPointsRedemption:"+c+":partialRedemption:"+b("#external-points-applied-or-available").val(),1);f.show();b.ajax({type:"POST",url:b("#external-points-redemption-option-update-handler-url").val(),headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"json",
data:b.param({redeemedAmount:a,pointsPaymentInstrumentId:b("#external-points-instrument-id").val(),targetCurrencyCode:b("#external-points-currency-code").val(),maxRedeemableAmount:b("#external-points-max-amount").val(),isClientTimeBased:b("input[name\x3duseCtb]").val(),conversionRate:b("#external-points-conversion-rate").val(),loyaltyProgram:b("#loyalty-program-name").val(),hasWorkingJavascript:1},!0),success:function(a,f,n){l(b("#submit-external-points-for-redemption"));k(b("#external-points-redemption-success-block"));
e.increaseCount("checkout:externalPointsRedemption:"+c+":purchaseDocUpdateSuccess",1);g.redirect(d.jsonify(a))},error:function(a,b,d){e.increaseCount("checkout:externalPointsRedemption:"+c+":purchaseDocUpdateFailure",1);g.ajaxRedirect(a,b,d)}})},showApplyButtonAndHideAppliedMessage:function(){k(b("#submit-external-points-for-redemption"));l(b("#external-points-redemption-success-block"))}}});"use strict";h.when("jQuery","load").register("widgets/availableExternalPoints/inputUtils",function(a){return{getUnifiedExternalPointsRedemptionInputLiteral:function(){return a("#external-points-use-alternative-input-parsing").length&&
"true"===a("#external-points-use-alternative-input-parsing").val()?a("input[name\x3dexternalPointsRedemptionInputValue]").val().replace(/,/g,"@").replace(/\./g,",").replace(/@/g,"."):a("input[name\x3dexternalPointsRedemptionInputValue]").val()},updatePrefilledAmount:function(){var b=a("input[name\x3dexternalPointsRedemptionInputValue]").val();a("#external-points-use-alternative-input-parsing").length&&"true"===a("#external-points-use-alternative-input-parsing").val()&&(b=b.replace(/\./g,","));a("input[name\x3dexternalPointsRedemptionInputValue]").val(b)}}});
"use strict";h.when("A","count-down-controller","weblab-helper","ready").register("widgets/commons/countDownTimer",function(a,b,d){a.on("checkout:reload:spc",function(){if(d.isLightningDealJavaExperienceEnabled()){var e=document.querySelectorAll('[data-messageid\x3d"rcx-checkout-gold-box-place-order-rec-discount"] .amazon-api-rc-count-down-timer');a.each(e,function(a){b.countDown(a)})}})});"use strict";h.when("A","DeferredDeliveryConfig","client-side-metrics","page-conductor").execute("deferredDeliverySlotPersistenceEvent",
function(a,b,d,e){a.on(b.EVENTS.SLOT_CONFIRMATION_EVENT,function(g){var f=a.$;f=f("#"+g.calendarId+"-deferred-delivery-persistence-info").children("script");try{var c=JSON.parse(f.text())}catch(p){d.logError("Failed to parse payload for DeferredDelivery info persistence","FATAL"),d.increaseCount(b.METRICS.FAILED_TO_PARSE_DEFD_INFO_PERSISTENCE),e.ajaxSorryPage()}g.selectedSlots&&0<g.selectedSlots.length?c.data.postdata.deliveryPersistenceInformation.DeferredDeliveryPersistenceInfo.slotId=g.selectedSlots[0]:
(d.logError("No selected slot in DeferredDelivery info persistence","WARN"),d.increaseCount(b.METRICS.NO_SLOT_IN_DEFD_INFO_PERSISTENCE));c.data.isselected=!1;d.increaseCount(b.METRICS.SUCCEEDED_TO_TRIGGER_DEFD_INFO_PERSISTENCE);a.trigger("checkout-select-delivery-slots",c.data)})});"use strict";h.register("DeferredDeliveryConfig",function(){return{METRICS:{FAILED_TO_PARSE_DEFD_INFO_PERSISTENCE:"Checkout:DeferredDeliveryTriggerInfoPersistence:Failure:Parsing",NO_SLOT_IN_DEFD_INFO_PERSISTENCE:"Checkout:DeferredDeliveryTriggerInfoPersistence:Error:NoSlotId",
SUCCEEDED_TO_TRIGGER_DEFD_INFO_PERSISTENCE:"Checkout:DeferredDeliveryTriggerInfoPersistence:Success"},EVENTS:{SLOT_CONFIRMATION_EVENT:"defd:unifiedcalendar:confirmslotevent"}}});"use strict";h.register("FreePalletDeliveryConfig",function(){return{METRICS:{FAILED_TO_PARSE_FPD_INFO_PERSISTENCE:"Checkout:FreePalletDeliveryTriggerInfoPersistence:Failure:Parsing",NO_SLOT_IN_FPD_INFO_PERSISTENCE:"Checkout:FreePalletDeliveryTriggerInfoPersistence:Error:NoSlotId",SUCCEEDED_TO_TRIGGER_FPD_INFO_PERSISTENCE:"Checkout:FreePalletDeliveryTriggerInfoPersistence:Success"},
SCHEDULED_PALLET_DELIVERY_GDO_IDS:["std-pallet-us","std-pallet"]}});"use strict";h.when("A","FreePalletDeliveryConfig","client-side-metrics","page-conductor").execute("freePalletDeliverySlotPersistenceEvent",function(a,b,d,e){b.SCHEDULED_PALLET_DELIVERY_GDO_IDS.forEach(function(g){a.on(g+":unifiedcalendar:confirmslotevent",function(f){var c=a.$;c=c("#"+f.calendarId+"-"+g+"-amazonbusinesscalendar-persistence-info").children("script");try{var p=JSON.parse(c.text());f.selectedSlots&&0<f.selectedSlots.length?
p.data.postdata.deliveryPersistenceInformation.FreePalletDeliveryPersistenceInfo.slotId=f.selectedSlots[0]:(d.logError("No selected slot in Free Pallet Delivery info persistence","WARN"),d.increaseCount(b.METRICS.NO_SLOT_IN_FPD_INFO_PERSISTENCE))}catch(l){d.logError("Failed to parse payload for Free Pallet Delivery info persistence","FATAL"),d.increaseCount(b.METRICS.FAILED_TO_PARSE_FPD_INFO_PERSISTENCE),e.ajaxSorryPage()}p.data.isselected=!1;d.increaseCount(b.METRICS.SUCCEEDED_TO_TRIGGER_FPD_INFO_PERSISTENCE);
a.trigger("checkout-select-delivery-slots",p.data)})})});"use strict";h.when("A","jQuery","weblab-helper","gift-utility","a-checkbox","page-transition-controller","a-truncate","a-popover-base","email-validation","gift-contact-picker","utils/smsMessageValidator","client-side-metrics").register("widgets/giftOptions/giftOptions",function(a,b,d,e,g,f,c,p,l,k,n,r){function t(a){this._domElement=a}function A(a){this._domElement=a}function L(a){this._domElement=a;this.isInputValid=function(){return M()?
P(this._domElement.val())||l(this._domElement.val()):l(this._domElement.val())};this.toggleValidationError=function(a){var b=M()?"#gcx-egift-warning-no-contact-details-":"#egift-recipient-email-warning-";B(m.find(b+this.getLineItemIndex()),a);y(this._domElement,a,"")}}function Y(a){this._domElement=a;this.isInputValid=function(){if(!M()||!P(this._domElement.val()))return!0;var a=pa(this._domElement.val());return a.isValid?!0:"gcx-egift-warning-not-valid-mobile-"!==a.warningKey};this.toggleValidationError=
function(a){B(m.find("#gcx-egift-warning-not-valid-mobile-"+this.getLineItemIndex()),a);y(this._domElement,a,"-phone")}}function D(a){this._domElement=a;this.isInputValid=function(){if(!M()||!P(this._domElement.val()))return!0;var a=pa(this._domElement.val());return a.isValid?!0:"gcx-egift-warning-not-supported-mobile-"!==a.warningKey};this.toggleValidationError=function(a){B(m.find("#gcx-egift-warning-not-supported-mobile-"+this.getLineItemIndex()),a);y(this._domElement,a,"-region")}}function Q(a){this._domElement=
a;this.isInputValid=function(){return R(this.getLineItemIndex()).senderNameIsOptional||b.trim(this._domElement.val())};this.toggleValidationError=function(a){B(m.find("#sender-name-empty-warning-"+this.getLineItemIndex()),a);y(this._domElement,a,"-empty");if(qa()){var b="sender-name-empty-warning-"+this.getLineItemIndex();S(this._domElement,a,b)}}}function T(a){this._domElement=a;this.isInputValid=function(){return!e.valueContainsUrl(b.trim(this._domElement.val()))}}function ra(a){T.call(this,a);
this.toggleValidationError=function(a){B(m.find("#sender-name-url-warning-"+this.getLineItemIndex()),a);y(this._domElement,a,"-url");if(qa()){var b="sender-name-url-warning-"+this.getLineItemIndex();S(this._domElement,a,b)}}}function sa(a){T.call(this,a);this.toggleValidationError=function(a){B(m.find("#message-url-warning-"+this.getLineItemIndex()),a);y(this._domElement,a,"-url");if(N()){var b="message-url-warning-"+this.getLineItemIndex();S(this._domElement,a,b)}}}function ta(a){this._domElement=
a;var b=this.getLineItemIndex();this.isInputValid=function(){var a=!1;if(n&&0<m.find('[id^\x3d"message-invalid-chars-warning-"]').length){a=z(b).val();var c=E(b).val();a+=U(c);a=P(I(b).val())&&!n.isValid(a)}return!a};this.toggleValidationError=function(a){B(m.find("#message-invalid-chars-warning-"+b),a);y(this._domElement,a,"-chars")}}function ua(a){this._domElement=a;this.isInputValid=function(){var a=this.getLineItemIndex(),b=R(a),c=z(a).val();a=E(a).val();c+=U(a);a=e.getLineCount(c,b.maxLineLength);
var d=c.length;return a<=b.maxLines&&d<=b.maxChars&&!(512<v.unescape(encodeURIComponent(c)).length)};this.toggleValidationError=function(a){var b=this.getLineItemIndex();B(m.find("#message-length-warning-"+b),a);y(this._domElement,a,"-length");y(m.find("#gift-message-sender-input-"+b),a,"-length");fa(b,!a)}}function va(a){this._domElement=a;this.isInputValid=function(){var a=this.getLineItemIndex(),b=R(a),c=z(a).val();a=E(a).val();c+=U(a);return c.length<=b.maxChars&&!(512<v.unescape(encodeURIComponent(c)).length)};
this.toggleValidationError=function(a){var b=this.getLineItemIndex();B(m.find("#message-and-sender-name-length-warning-"+b),a);y(this._domElement,a,"-length");y(m.find("#gift-message-sender-input-"+b),a,"-length");fa(b,!a);b="message-and-sender-name-length-warning-"+this.getLineItemIndex();S(this._domElement,a,b)}}function wa(a){this._domElement=a;this.isInputValid=function(){var a=this.getLineItemIndex(),b=R(a),c=z(a).val();a=E(a).val();c+=U(a);return e.getLineCount(c,b.maxLineLength)<=b.maxLines||
c.length>b.maxChars};this.toggleValidationError=function(a){var b=this.getLineItemIndex();B(m.find("#message-and-sender-name-lines-warning-"+b),a);y(this._domElement,a,"-lines");fa(b,!a);b="message-and-sender-name-lines-warning-"+this.getLineItemIndex();S(this._domElement,a,b)}}function xa(a){this._domElement=a;this.isInputValid=function(){return l(this._domElement.val())};this.toggleValidationError=function(a){var b=this.getLineItemIndex();B(m.find("#recipient-not-email-warning-"+b),a);y(this._domElement,
a,"")}}function z(a){return m.find("#message-area-"+a)}function ha(a){return m.find("#message-counter-"+a)}function Z(a){return g("#gift-wrap-checkbox-"+a,m)}function J(a){return g("#digital-gift-message-checkbox-"+a,m)}function ya(a){return m.find("#digital-gift-message-input-wrapper-"+a)}function K(a){return m.find("#digital-gift-message-text-input-"+a)}function I(a){return m.find("#egift-recipient-text-input-"+a)}function E(a){return m.find("#gift-message-sender-input-"+a)}function ia(a){return g("#toggle-gift-item-checkbox-"+
a,m)}function aa(a){return m.find("#gift-wrap-selection-"+a)}function ba(){return m.find("#delivery-option-physical")}function ca(){return m.find("#delivery-option-sbm")}function za(){return m.find("#egift-preview-message")}function Aa(){return m.find("#egift-gift-option-message")}function Ba(){return m.find("#delivery-options-on-gift-options").get(0)}function F(a){a.addClass("aok-hidden")}function C(a){a.removeClass("aok-hidden")}function B(a,b){b?C(a):F(a)}function H(a){a.prop("disabled",!0);a.removeClass("a-form-normal").addClass("a-form-disabled")}
function G(a){a.prop("disabled",!1);a.removeClass("a-form-disabled").addClass("a-form-normal")}function Ca(a){F(a.find(".gift-options-summary-header"));C(a.find(".gift-options-expanded-header"))}function V(a){return 0!==J(a).size()}function R(a){return z(a).closest("[data-message-validation-options]").data("messageValidationOptions")}function P(a){return/^\+?[()\s.0-9-]*$/.test(a)&&9<a.length&&19>a.length}function pa(a){var b=String(a);if(!b)return{isValid:!1,warningKey:"gcx-egift-warning-not-valid-mobile-"};
a="+"===b[0]?b:"+1"+b;if(11!==(a.match(/\d/g)||[]).length||!/^(\+[1-9][\s.-]?)?(\(\d{3}\)|\d{3})[\s.-]?\d{3}[\s.-]?\d{4}$/.test(b))return{isValid:!1,warningKey:"gcx-egift-warning-not-valid-mobile-"};if("1"!==a[1])return{isValid:!1,warningKey:"gcx-egift-warning-not-supported-mobile-"};a=a.slice(2).replace(/[()\s-.]/g,"");return/(?:2(?:0[1-35-9]|1[02-9]|2[03-589]|3[149]|4[08]|5[1-46]|6[0279]|7[0269]|8[13])|3(?:0[1-57-9]|1[02-9]|2[01356]|3[0-24679]|4[167]|5[12]|6[014]|8[056])|4(?:0[124-9]|1[02-579]|2[3-5]|3[0245]|4[023578]|58|6[39]|7[0589]|8[04])|5(?:0[1-47-9]|1[0235-8]|20|3[0149]|4[01]|5[19]|6[1-47]|7[0-5]|8[056])|6(?:0[1-35-9]|1[024-9]|2[03689]|[34][016]|5[0179]|6[0-279]|78|8[0-29])|7(?:0[1-46-8]|1[2-9]|2[04-7]|3[1247]|4[037]|5[47]|6[02359]|7[0-59]|8[156])|8(?:0[1-6]|1[02-8]|2[08]|3[0-289]|4[03578]|5[046-9]|6[02-5]|7[028])|9(?:0[134689]|1[02-9]|2[0589]|3[0146-8]|4[01579]|5[12469]|7[0-389]|8[04-69]))[2-9]\d{6}$/.test(a)?
{isValid:!0,warningKey:q}:{isValid:!1,warningKey:"gcx-egift-warning-not-supported-mobile-"}}function ja(){var a=Ba();return a&&a.dataset&&"sbmOnGoPageEnabled"===a.dataset.sbm}function qa(){var a=m.find('[id^\x3d"message-area-label"]').get(0);return a&&a.dataset&&a.dataset.enablegiftoptionsa11yphaseone}function N(){var a=m.find('[id^\x3d"message-and-sender-name-length-warning"]');return a&&a.length}function M(){return document.getElementById("gcx-egift-warning-no-contact-details-0")}function Da(a,
b,c){var d=ha(a).find("."+b+"-counter");a=d.find(".count");b=d.find(".message");var e=Math.abs(c);d=d.data("messageData");c=0<c?"remaining":"over";var f=1===e?"single":"multiple";a.text(e);b.text(d[c][f])}function fa(a,b){ha(a).find(".counter-text").toggleClass("a-color-error",!b)}function U(a){return a?"\n"+Array(Ea+1).join("X")+a:""}function w(a,b){var c=!0;Array.isArray(a)&&a.forEach(function(a){a.validate(b)||(c=!1)});return c}function Fa(a){var b=[];Array.isArray(a)&&a.forEach(function(a){a.validate(!1)||
b.push(a)});return b}function ka(a,b){if(0<z(a).size()){var c=R(a),d=z(a).val(),f=E(a).val();d+=U(f);b=N()&&"keyup"===b;f=e.getLineCount(d,c.maxLineLength);f=c.maxLines-f;Da(a,"lines",f);Da(a,"chars",c.maxChars-d.length);b&&(a=ha(a),f!==Ga?(Ga=f,a.attr("role","status"),a.attr("aria-live","polite")):(a.removeAttr("role","status"),a.removeAttr("aria-live","polite")))}}function W(a){var b=m.find("#notification-preview-"+a);if(b){var c=z(a).val(),d=E(a).val(),e=I(a).val();a=m.find("#notification-preview-wrap-image-"+
a);M()&&P(e)?(F(a),c.length>u.maxGiftMessageLengthForSMS&&(c=c.substr(0,u.maxGiftMessageLengthForSMS)+"..."),d.length>u.maxSenderNameLengthForSMS&&(d=d.substr(0,u.maxSenderNameLengthForSMS)+"..."),c=u.sentByStringSMS.replace(u.placeholderChar,d)+"\n"+u.exampleURL+"\n"+c+"\n"+u.acceptByStringSMS.replace(u.placeholderChar,u.expireDateSMS)):(C(a),c=c+"\n"+Ha.replace(u.placeholderChar,d)+"\n"+u.acceptByStringEmail.replace(u.placeholderChar,u.expireDateEmail));b.text(c)}}function y(a,b,c){a.toggleClass("gift-input-error"+
c,b)}function S(a,b,c){b?(a.attr("aria-invalid",!0),a.attr("aria-describedby",c)):a.attr("aria-describedby")===c&&(a.removeAttr("aria-invalid"),a.removeAttr("aria-describedby"))}function la(a){var c=a.val();c!==b.trim(c)&&a.val(b.trim(c))}function Ia(a,c){if(m&&0!==b("#item-"+c.itemId).length){var d=a.parent().find(".selected");Ja(d);a=a.find(".gw-card");Ka(a);m.find('input[name\x3d"wrap.'+c.itemId+'"]').val(c.wrapNo)}}function Ka(a){a.addClass("selected");a.attr("aria-pressed","true")}function Ja(a){a.removeClass("selected");
a.attr("aria-pressed","false")}function La(){var a=document.querySelectorAll(".gw-card");0!==a.length&&(h.when("a-carousel-framework").execute(function(a){a.createAll();a.initializeAll()}),v.NodeList&&!NodeList.prototype.forEach&&(a=Array.prototype.slice.call(a)),a.forEach(function(a){function c(){d.classList.remove("active");d.style.removeProperty("background-position")}a.addEventListener("keydown",function(a){if("keydown"===a.type){var c=a.which||a.keyCode;if(32===c||13===c)a.preventDefault(),c=
a.target.dataset,Ia(b(a.target).parents("li"),{itemId:c.itemId,wrapNo:c.wrapId})}});a=a.querySelector(".gw-card-header");var d=a.querySelector(".gw-hover-zoom");a.addEventListener("mousemove",function(a){var b=a.currentTarget.offsetWidth,c=a.currentTarget.offsetHeight;d.classList.add("active");c=a.offsetY/c*100;d.style.setProperty("background-position","".concat(a.offsetX/b*100,"% ").concat(c,"%"))});a.addEventListener("pointerup",c);a.addEventListener("pointerleave",c);a.addEventListener("pointercancel",
c)}))}function ma(a){var b=a.val(),c=b.replace(/[\u2018\u2019\u0060\u00B4]/g,"'").replace(/[\u201C\u201D]/g,'"');c!==b&&a.val(c)}function na(){return document.getElementById("gcx-egift-warning-no-contact-details-0")}var m,Ea=5,Ha="",Ga=0,u={localizedFromString:"",acceptByStringEmail:"",acceptByStringSMS:"",sentByStringSMS:"",exampleURL:"",expireDateEmail:"",expireDateSMS:"",maxGiftMessageLengthForSMS:168,maxSenderNameLengthForSMS:20,placeholderChar:"@"};t.prototype.getLineItemIndex=function(){var a=
this._domElement.attr("id").split("-");if(2>a.length)throw Error("Expected DOM element id to be suffixed with -lineItemIndex");return a[a.length-1]};t.prototype.validate=function(a){a=this._domElement.prop("disabled")||this.isInputValid();this.toggleValidationError(!a);return a};A.prototype=new t;A.prototype.validate=function(a){var b=this._domElement.prop("disabled")||this.isInputValid();a&&!b||this.toggleValidationError(!b);return b};L.prototype=new A;Y.prototype=new A;D.prototype=new A;Q.prototype=
new A;T.prototype=new t;ra.prototype=new T;sa.prototype=new T;ta.prototype=new t;ua.prototype=new t;va.prototype=new t;wa.prototype=new t;xa.prototype=new A;var x=[],da={},ea={},X={},O={},oa=function(e){m=b(e||"#giftOptions-contains");x=[];m.find(".a-truncate").each(function(){c.get(this).update()});m.find(".toggle-gift-checkbox").trigger("change");m.find(".gift-message-textarea textarea").trigger("change");m.find(".digital-gift-message-checkbox").trigger("change");(e=a.state("giftPageState"))&&e.localizedFromStringLength&&
(Ea=e.localizedFromStringLength);e&&e.notificationPreviewAcceptByStringSMS&&(u.acceptByStringEmail=e.notificationPreviewAcceptByStringEmail,u.acceptByStringSMS=e.notificationPreviewAcceptByStringSMS,u.sentByStringSMS=e.notificationPreviewSentByStringSMS,u.exampleURL=e.notificationPreviewExampleURL,u.expireDateEmail=e.notificationPreviewExpireDateEmail,u.expireDateSMS=e.notificationPreviewExpireDateSMS,u.maxGiftMessageLengthForSMS=e.notificationPreviewMaxGiftMessageSMS,u.maxSenderNameLengthForSMS=
e.notificationPreviewMaxSenderNameSMS,u.placeholderChar=e.placeholderChar,Ha=e.localizedFromString);m.find(".recipient-contact-details-input").bind("paste",function(){var a=this;v.setTimeout(function(){b(a).parent().trigger("change")},0)});La();d.isEGiftOptionsActive()&&k.isEnabled()&&h.when("mash").execute(function(){C(m.find(".chewbacca-gift-options-contact-picker-button"))});b(m.find(".recipient-contact-details-input")).each(function(){var a=b(this);a.is("input")||(a=a.find("input"));if(a.attr("id").match("^egift")){var c=
new L(a),d=new Y(a);a=new D(a);ea[c.getLineItemIndex()]=[c,d,a];x.push(c);x.push(d);x.push(a)}else c=new xa(a),d=c.getLineItemIndex(),X[d]=[c],x.push(c)});b(m.find(".sender-name-text-input")).each(function(){var a=b(this);a.is("input")||(a=a.find("input"));var c=new Q(a);a=new ra(a);var d=a.getLineItemIndex();da[d]=[c,a];x.push(c);x.push(a)});b(m.find(".gift-message-textarea").find("textarea")).each(function(){var a=b(this),c=new sa(a),d=new ua(a);N()&&(d=new va(a));var e=new ta(a),f=d.getLineItemIndex();
O[f]=[c,d,e];x.push(c);x.push(d);x.push(e);N()&&(a=new wa(a),O[f].unshift(a),x.unshift(a))});m.find('.chewbacca-enabled-save-gift-options-button input[type\x3d"submit"]').bind("click touchend",function(a){if(N()){var b=x;var c=!0;if(Array.isArray(b))for(var d=0;d<b.length;d++){var e=b[d];if(!e.validate(!1)){c=!1;e._domElement&&e._domElement.focus();break}}b=c}else b=w(x,!1);b||(a.preventDefault(),a.stopImmediatePropagation())});m.find("#giftForm").hasClass("checkout-page-form")&&m.find('.chewbacca-save-gift-options-buttons input[type\x3d"submit"]').bind("click touchend",
function(a){if(!w(x,!1)){a.preventDefault();a.stopImmediatePropagation();var b=[];a=Fa(x);a.forEach(function(a){var c=a._domElement.closest(".a-expander-container"),d=c.find(".a-expander-section-header");c.find(".gift-options-expanded-header").hasClass("aok-hidden")&&!b.includes(a.getLineItemIndex())&&(d.click(),b.push(a.getLineItemIndex()))});N()&&a.length&&a[0]._domElement.focus()}});ja()&&Ba()&&r.increaseCount("checkout:giftOptions:deliveryOptionsRendered",1)};a.declarative("chewbacca-toggle-gift-item",
"change",function(a){a=a.data.lineItemIndex;if(ia(a).isChecked()){G(z(a));var b=E(a);b&&G(b);V(a)&&(J(a).enable(),J(a).isChecked()&&G(K(a)));0!==Z(a).size()&&Z(a).enable();b=m.find('input[name\x3d"wrap.'+a+'"]');0!==b.size()&&b.prop("disabled",!1);0!==aa(a).size()&&aa(a).prop("disabled",!1);ja()&&(ba().prop("disabled",!1),b=ca(),b.prop("disabled",!1),b.is(":checked")&&G(I(a)),C(m.find("#egift-options-box-"+a)));C(m.find("#gift-options-box-"+a))}else{H(z(a));(b=E(a))&&H(b);V(a)&&(b=J(a),b.uncheck(),
b.disable(),H(K(a)));0!==Z(a).size()&&(b=Z(a),b.uncheck(),b.disable());b=m.find('input[name\x3d"wrap.'+a+'"]');0!==b.size()&&(m.find("#gift-wrap-radio-"+a+"-none").click(),b.prop("disabled",!0));if(0!==aa(a).size()){var c=m.find("#gift-wrap-carousel-"+a);if(0!==c.length){var e=c.find(".selected");Ja(e);e=c.find(".gw-none").parent();Ka(e);m.find('input[name\x3d"wrap.'+a+'"]').val("");c=c.find(".a-carousel-restart");0<c.length&&c.click()}c=aa(a);b.prop("disabled",!0);c.prop("disabled",!0)}ja()&&(ba().prop("disabled",
!0),ca().prop("disabled",!0),H(I(a)),F(m.find("#egift-options-box-"+a)));F(m.find("#gift-options-box-"+a))}b=z(a);c=E(a);e=J(a);(d.isEGiftOptionsActive()&&0<I(a).size()?0:0<ia(a).size()&&!ia(a).isChecked())?(H(b),H(c),e.disable()):(G(b),G(c),e.enable());w(X[a],!1);w(da[a],!1);w(O[a],!1)});a.declarative("chewbacca-gift-message-textarea","change keyup click focus",function(a){if("textarea"===a.targetTag&&m){var b=a.data.lineItemIndex;if(na()){var c=z(b);ma(c)}W(b);ka(b,a.type);w(O[b],!0)}});a.declarative("chewbacca-sender-name-input",
"change blur focusout",function(a){var b=a.data.lineItemIndex;if(na()){var c=E(b);ma(c)}W(b);w(da[b],!1);ka(b,a.type);w(O[b],!1)});a.declarative("chewbacca-sender-name-input","keyup",function(a){var b=a.data.lineItemIndex;if(na()){var c=E(b);ma(c)}W(b);w(da[b],!0);ka(b,a.type);w(O[b],!0)});a.declarative("chewbacca-digital-gift-message-checkbox","change",function(a){a=a.data.lineItemIndex;V(a)&&J(a).isChecked()?(G(K(a)),G(ya(a))):(H(K(a)),H(ya(a)));w(X[a],!0)});a.declarative("chewbacca-recipient-contact-details",
"change blur focusout",function(a){a=a.data.lineItemIndex;la(K(a));w(X[a],!1)});a.declarative("chewbacca-recipient-contact-details","keyup",function(a){w(X[a.data.lineItemIndex],!0)});d.isEGiftOptionsActive()&&a.declarative("chewbacca-egift-recipient-contact-details","change blur focusout",function(a){var b=a.data.lineItemIndex;"change"===a.type&&(la(I(b)),W(b));w(ea[b],!1)});d.isEGiftOptionsActive()&&k.isEnabled()&&a.declarative("chewbacca-gift-options-contact-picker","click",function(a){var b=a.data.lineItemIndex;
a=["emails"];M()&&a.push("phoneNumbers");k.selectContact({contactFields:a,onSuccess:function(a){var c=I(b);c.val(a.value);la(c);W(b);w(ea[b],!1)}})});a.declarative("chewbacca-egift-recipient-contact-details","keyup",function(a){w(ea[a.data.lineItemIndex],!0)});a.declarative("chewbacca-gift-options-submit","submit",function(a){if(w(x,!1))f.showPageTransition();else{a.$event.preventDefault();var b=[];Fa(x).forEach(function(a){var c=a._domElement.closest(".a-expander-container"),d=c.find(".a-expander-section-header");
c.find(".gift-options-expanded-header").hasClass("aok-hidden")&&!b.includes(a.getLineItemIndex())&&(d.click(),b.push(a.getLineItemIndex()))})}});a.declarative("chewbacca-gift-options-popover-submit","submit",function(a){a=a.$target.closest(".a-popover").data("a-popover-id");p.hide(a)});a.on("a:expander:chewbacca-gift-options-expander:toggle:collapse",function(a){a=a.expander.$expander;var b=a.data("lineitemindex");var c=z(b).val();c=!c||10>=c.length?c||"":c.substring(0,10)+"...";var d=0<c.length;
b=m.find('input[name\x3d"wrap.'+b+'"]:checked').val()||"";d||b?(C(a.find(".gift-options-summary-header")),F(a.find(".gift-options-expanded-header")),B(a.find(".gift-message-summary"),d),a.find(".gift-message-preview").text(c),F(a.find(".gift-wrap-summary")),C(a.find(".gift-wrap-summary-"+b.replace(/#/g,"\\#")))):Ca(a)});a.on("a:expander:chewbacca-gift-options-expander:toggle:expand",function(a){Ca(a.expander.$expander)});a.on("checkout:reload:giftselect",function(){oa()});a.on("checkout:reload:spp-giftoptions",
function(){oa()});h.when("giftOptionsPopoverData").execute(function(b){for(var c=0;c<b.lineItemCount;++c)(function(b){a.on("a:popover:show:changeGiftOptionsPopover"+b,function(){oa("#giftOptions-contains"+b)})})(c)});a.declarative("gift-wrap-selected","click",function(a){Ia(a.$target.parents("li"),{itemId:a.data.itemId,wrapNo:a.data.wrapId})});b("#eShipping-how-it-works-link").click(function(a){r.increaseCount("checkout:giftOptions:howItWorksLinkClicked",1)});a.declarative("select-physical-delivery",
"click touchend",function(a){a=a.data.lineItemIndex;r.increaseCount("checkout:giftOptions:physicalAddressSelected",1);ca().prop("checked",!1);ba().prop("checked",!0);var b=m.find("#egift-input-widget");H(I(a));F(b);b=za();F(b);b=Aa();F(b);b=m.find("#dgm-option");V(a)&&(J(a).enable(),J(a).isChecked()&&G(K(a)));C(b)});a.declarative("select-ship-by-message","click touchend",function(a){if("a"!==a.targetTag){a=a.data.lineItemIndex;r.increaseCount("checkout:giftOptions:shipByMessageSelected",1);ca().prop("checked",
!0);ba().prop("checked",!1);var b=m.find("#egift-input-widget");G(m.find("#egift-recipient-input-wrapper-"+a));G(I(a));C(b);b=za();C(b);b=Aa();C(b);b=m.find("#dgm-option");F(b);V(a)&&(J(a).disable(),H(K(a)))}});a.declarative("page-transit-add-gift-options","click touchend",function(a){a.data&&a.data.scrollToId&&document.getElementById(a.data.scrollToId).scrollIntoView({block:"start",behavior:"smooth"})})});h.when("A").register("gift-contact-picker",function(a){function b(b){return b&&0<=a.indexOfArray(l,
b)}function d(a,b,c,d){a.permissions.requireForFeature({featureID:"eshipping",requestID:"eshipping_contacts_permission"}).onPermissionGranted(function(){f(a,b,c,d)}).onPermissionDenied(d)}function e(b,c){var d=[];a.each(c,function(c){a.each(b[c]||[],function(a){d.push(a.value)})});return d}function g(b){function c(){a.delay(function(){e.remove()},100)}if(a.capabilities.android){var d=a.$,e=d('\x3cscript id\x3d"stop-mash-reappear" type\x3d"application/x-amzn-empty" /\x3e');d(document.body).append(e);
a.delay(function(){b(c)})}else b(k)}function f(a,b,d,f){g(function(g){a.showContactPicker({fields:b,successCallback:function(k){g();k=e(k,b);0===k.length?f():1===k.length?d({value:k[0]}):c(a,k,d,f)},failCallback:function(){g();f()}})})}function c(a,b,c,d){a.showChooser({buttonTitles:b,successCallback:function(a){a<b.length&&0<=a?c({value:b[a]}):d()},failCallback:d})}function p(){return a.capabilities.isAmazonApp}var l="phoneNumbers emails ims photos categories urls".split(" "),k=function(){};return{selectContact:function(c){var e=
c.onSuccess,g=c.onError||k,n=a.filter(c.contactFields||[],b);p()&&e&&0!==n.length?h.now("mash").execute(function(a){a?a.permissions&&a.permissions.available?d(a,n,e,g):f(a,n,e,g):g()}):g()},isEnabled:p}});"use strict";h.when("A","a-sheet","client-side-metrics").execute(function(a,b,d){a.declarative("gift-wrap-bottom-sheet","click",function(a){var e=a.data.giftWrapId;a="gift-image-zoom-"+a.data.lineItemIndex;e&&(a=a+"-"+e);e=b.create({name:a,preloadDomId:a,closeType:"icon"});e._autoHeight=!0;b.showSheet(e);
d.increaseCount("checkout:giftOptions:giftWrapImageZoomMobile",1)})});h.when("A","client-side-metrics").execute(function(a,b){a.declarative("gift-wrap-zoom-desktop","click",function(a){null!=a.$target[0].closest(".chewbacca-gift-popover-container")?a.$event.stopPropagation():b.increaseCount("checkout:giftOptions:giftWrapImageZoomDesktop",1)});a.on("a:popover:show",function(a){(a=a.popover)&&a.name&&a.name.includes("changeGiftOptionsPopover")&&(a=a.$popover[0].querySelector(".gift-wrap-image-hover"),
null!=a&&(a.style.cursor="auto"))})});"use strict";h.when("A","jQuery","components/PrimaryActionBlockerCheckbox","weblab-helper","client-side-metrics").register("widgets/purchaseLevelMessages/blockingConfirmationMessages",function(a,b,d,e,g){function f(){e.isPyoClientSideInitiationEnabled()||d.create({$el:b('#purchase-level-messages [data-client-component\x3d"PrimaryActionBlockerCheckbox"]')})}a.each(["checkout:reload:spc","checkout:reload:spclite","checkout:reload:spp-revieworder","checkout:reload:spp-collapsed"],
function(b){a.on(b,f)})});"use strict";h.when("A","weblab-helper","a-form-checkbox","client-side-metrics").execute(function(a,b,d,e){if(b.isIMBSaveABDefaultsCheckboxPersistEnabled())a.on("checkout:reload",function(){var b=new d("[id\x3db2bSetPurchasePreferenceCheckbox]");if(b.isHidden())a.state("persist-checkbox-b2bSetPurchasePreferenceCheckbox",{checkboxWasChecked:!1});else{var f=a.state("persist-checkbox-b2bSetPurchasePreferenceCheckbox");f&&f.checkboxWasChecked&&(b.check(),e.increaseCount("checkout:saveABDefautls:checkboxWasChecked",
1));b.on("change",function(){a.state("persist-checkbox-b2bSetPurchasePreferenceCheckbox",{checkboxWasChecked:b.isChecked()})})}})});h.when("A","jQuery","components/Component","components/PrimaryActionBlockerCheckbox","verification-checkbox-controller").register("widgets/pyoButton/PyoButton",function(a,b,d,e,g){return d.extend({onInit:function(){var b=e.getState();this.block(b);a.on(e.events.blockingStateChanged,this.block)},block:function(a){a&&g.updatePyo(a)}})});"use strict";h.when("A","jQuery",
"client-side-metrics","weblab-helper","ready").register("widgets/pyoButton/newCheckoutExperience/pyoButton",function(a,b,d,e){function g(){b(".checkout-imb-checkbox-value").each(function(a,b){b.remove()});b('#checkout-experience-container .a-alert .a-alert-container input[type\x3d"checkbox"]').each(function(a,d){var c=document.createElement("input");c.type="hidden";c.name=d.name;c.value=!0===d.checked?"1":"0";c.classList.add("checkout-imb-checkbox-value");b("form#spc-form").each(function(a,b){b.appendChild(c.cloneNode())})})}
function f(a){(e.isPyoButtonAddCheckboxesDataOnclickEnabled()||e.isSavePaymentMethodConsentIMBEnabled())&&g()}a.declarative("checkout-place-your-order-action",["click"],function(a){d.setCountValue("checkout:newCheckoutExperience:clickPlaceYourOrderButton",1)});a.declarative("place-order",q,f);a.declarative("checkout-place-your-order-action",q,f)});"use strict";h.when("A","jQuery","widgets/subscribeAndSave/snsCommon","weblab-helper").register("widgets/subscribeAndSave/setSnSOptions",function(a,b,d,
e){function g(a,b,c,e,g){var k=d.getSnSItemData(a);a={asin:k.asin,encodedLineItemId:k.lineItemId,encryptedMerchantId:k.encryptedMerchantId,merchantSku:k.merchantSku,couponId:f(a),redeemCoupon:d.convertToPerlBoolean(e),optedIn:d.convertToPerlBoolean(b),customerSelectedRecurrencePeriod:c};d.updatePurchase([a],q,g)}function f(a){return b("#sns-item-discount-"+a).data("couponId")}function c(a){var b=a.data.index,c=d.isCustomerOptedIn("#sns-item-checkbox-",b);a=a.data.callbackUrl;var e=d.getSnSItemData(b);
b={asin:e.asin,encodedLineItemId:e.lineItemId,encryptedMerchantId:e.encryptedMerchantId,merchantSku:e.merchantSku,couponId:f(b),redeemCoupon:d.convertToPerlBoolean(!1),optedIn:d.convertToPerlBoolean(c),changeOrderType:d.convertToPerlBoolean(!0),customerSelectedRecurrencePeriod:q};d.updatePurchase([b],q,a)}a.declarative("sns-item-checkbox","change",function(a){var b=a.data.index,c=d.isCustomerOptedIn("#sns-item-checkbox-",b),e=d.getActiveSubscriptionRecurrencePeriod("#sns-recurrence-period-selector-",
b);g(b,c,e,!0,a.data.callbackUrl)});e.isSnsChangeOrderTypeEnabled()&&a.declarative("sns-change-order-type","click",c);a.on("a:accordion:sns-recurrence-period-accordion:select",function(a){a=a.selectedRow.$row.data();var b=a.index,c=d.isCustomerOptedIn("#sns-item-checkbox-",b);c?g(b,c,a.recurrencePeriod,!1,a.callbackUrl):d.setActiveSubscriptionRecurrencePeriod("#sns-recurrence-period-selector-",a)})});"use strict";h.when("jQuery","page-transition-controller","page-conductor","client-side-metrics",
"a-dropdown").register("widgets/subscribeAndSave/snsCommon",function(a,b,d,e,g){function f(a){a||(e.increaseCount("checkout:sns:updatePurchaseInvokedWithoutUrl",1),a="/gp/buy/spc/handlers/set-subscribe-and-save-options.html?ref_\x3dchk_spc_set_sns_options");return a}return{convertToPerlBoolean:function(a){return a?1:0},getSnSItemData:function(a){return document.getElementById("sns-item-"+a).dataset},getSnSItemDataV2:function(a){return document.getElementById("sns-item-v2-"+a).dataset},isCustomerOptedIn:function(b,
d){return a(b+d).is(":checked")},updatePurchase:function(c,g,l){var k=d.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});b.show();a.ajax({type:"POST",url:f(l),contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:{subscriptionParameters:JSON.stringify(c)},dataType:"text",cache:!1,async:!0,headers:k,success:function(a,c,f){"function"===typeof g&&(g(),b.hide());e.increaseCount("checkout:sns:gurupa:setter:successful",1);d.ajaxUpdatePage(a,c,f)},error:function(a,b,c){e.increaseCount("checkout:sns:gurupa:setter:failed",
1);d.ajaxRedirect(a,b,c)}})},setActiveSubscriptionRecurrencePeriod:function(b,d){a(b+d.index).text(d.recurrencePeriodText).data("activeRecurrencePeriod",d.recurrencePeriod)},getActiveSubscriptionRecurrencePeriod:function(b,d){return a(b+d).data("activeRecurrencePeriod")},getActiveSubscriptionRecurrencePeriodV2:function(a,b){return g.getSelect(a+b).val()},setSubscribeAndSave:function(c,f,g){var k=d.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});b.show();a.ajax({type:"POST",
url:g,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:a.param({subscribeAndSaveInput:JSON.stringify(c)}),cache:!1,async:!0,headers:k,success:function(a,c,g){"function"===typeof f&&f();b.hide();e.increaseCount("checkout:sns:chewbacca:setter:successful",1);d.ajaxUpdatePage(a,c,g)},error:function(a,c,f){b.hide();e.increaseCount("checkout:sns:chewbacca:setter:failed",1);d.ajaxRedirect(a,c,f)}})}}});"use strict";h.when("A","client-side-metrics").execute("widgets/takeBack/redirectRecyclePage",
function(a,b){a.declarative("widget-takeback-redirect-recycle-page","click",function(a){var d=a&&a.data&&a.data.url||"";a=a&&a.data&&a.data.viewType||"";d?(v.open(d,"_blank","width\x3d850,height\x3d750,scrollbars\x3d1"),b.increaseCount("checkout:"+a+":takeBack:redirect",1)):b.logError("TAKE_BACK_REDIRECT_URL_EMPTY","unexpected empty takeBack url","widget/takeBack/redirectRecyclePage","ERROR")})});"use strict";h.when("A","page-spinner-controller").execute(function(a,b){a.declarative("ingress-internal-launch-opt-out",
"click",function(a){a=function(a,b,d,e){a=[a+"\x3d"+b];d&&(b=new Date,b.setTime(b.getTime()+864E5*d),a.push("expires\x3d"+b.toGMTString()));a.push("path\x3d/");e&&a.push("domain\x3d"+e);document.cookie=a.join("; ")};var d=function(){var a=/:\/\/([^:/]+)/.exec(v.location.href)[1].split("."),b=a.length-2;"co"!==a[b]&&"com"!==a[b]||b--;for(var d=[];b<a.length;b++)d.push(a[b]);return d.join(".")}(),g=function(a){return(a=(new RegExp(a+"\x3d([^;]+)")).exec(document.cookie))?a[1]:""}("checkout-dyn-config").split("\x26");
g[g.length]="escapeingress:1";a("checkout-dyn-config","",-1,d);a("checkout-dyn-config",g.join("\x26"),365,d);b.show();location.reload()})});"use strict";h.when("A","jQuery","a-modal","page-conductor","widgets/installmentsSelectorCommon","client-side-metrics").register("widgets/installmentsSelector",function(a,b,d,e,g,f){a.declarative("installments-save-change",["click"],function(a){g.saveSelection(a,"installments_modal_checkbox_");d.get("installments_selection_modal_"+a.data.itemId).hide()});a.declarative("installments-cancel-change",
["click"],function(a){d.get("installments_selection_modal_"+a.data.itemId).hide();f.increaseCount("Checkout:Tango:Installments:CancelChange")});a.on("checkout:afterReload",function(){b("[id^\x3dinstallments_selection_modal_]").each(function(){var a=d.get(b(this).attr("id"));a&&d.remove(a)})})});"use strict";h.when("A","jQuery","page-conductor","client-side-metrics").register("widgets/installmentsSelectorCommon",function(a,b,d,e){return{saveSelection:function(a,f){var c=(f=b('[id\x3d"'+f+a.data.itemId+
'"]').is(":checked"))?"Checkout:Tango:Installments:OptIn":"Checkout:Tango:Installments:OptOut";f!==a.data.isSelected?d.ajaxUpdate(a.data.setUrl,{itemId:a.data.itemId,programId:f?a.data.programId:""},{pushNewFrame:"true"}).done(function(){e.increaseCount(c+":UpdateSuccess",1)}).fail(function(){e.increaseCount(c+":UpdateFailure",1)}):e.increaseCount(c+":UnchangedSelection",1)}}});"use strict";h.when("A","jQuery","widgets/installmentsModal/state","installments-service").register("widgets/installmentsModal",
function(a,b,d,e){a.on("a:popover:dismiss:installmentsModal",function(a){e.sendReftag("installments_bundle_modal_cancelled_asin_"+d.asin+"_bundle_asin_"+d.bundleAsin)});a.on("a:popover:hide:installmentsModal",function(a){d.$target.prop("checked",!d.isChecked)});a.declarative("installments-confirm","click",function(a){e.sendReftag("installments_bundle_modal_confirm_removal_asin_"+d.asin+"_bundle_asin_"+d.bundleAsin);e.call(d.itemId,d.programId,d.handlerData,d.purchaseId);a.$target.closest(".a-popover").find(".a-icon-close").click()});
a.declarative("installments-cancel","click",function(a){e.sendReftag("installments_bundle_modal_cancelled_asin_"+d.asin+"_bundle_asin_"+d.bundleAsin);a.$target.closest(".a-popover").find(".a-icon-close").click()})});"use strict";h.register("widgets/installmentsModal/state",function(){return{asin:"",bundleAsin:"",itemId:"",program:"",handler:null,$target:"",isChecked:"",purchaseId:""}});"use strict";h.when("A","page-transition-controller","page-conductor","utils/createClass","weblab-helper","client-side-metrics",
"ready").register("retail-installments-contract-base-controller",function(a,b,d,e,g,f){var c=a.$;return e({config:null,ricPageWrapper:null,hasConsentedToAtLeastOneRic:!1,hasMultipleRics:!1,FROM_CURRENT_CONFIG:"current",FROM_DEFAULT_CONFIG:"default",REFTAG_URL:"/hctp/log/refMarker?ref_\x3d",REFTAG_MOBILE_BACK:"back",REFTAG_MOBILE_CANCEL:"cancel",REFTAG_ESIGN_Y:"esign_y",REFTAG_ESIGN_N:"esign_n",REFTAG_ESIGN_LINK:"esign_link",REFTAG_ESIGN_PDF:"esign_pdf",REFTAG_RIC_CHANGE:"ric_change",REFTAG_RIC_CHANGE_OPEN:"ric_change_open",
REFTAG_RIC_CHANGE_OPEN_SECONDARY:"ric_change_open_secondary",REFTAG_RIC_Y:"ric_y",REFTAG_RIC_N:"ric_n",REFTAG_RIC_LINK:"ric_link",REFTAG_RIC_REMOVE:"ric_remove",REFTAG_RIC_CONSENT:"ric_consent",init:function(){this.config=c.extend(a.state("ricPageState"),a.state("ricCustomerInfoState"));this.hasMultipleRics=2<this.config.ricWidgetViews.length;this.getElements();this.bindEvents()},bindEvents:function(){c("body").delegate(".customerInfoUpdateBtn","click",c.proxy(this.handleCustomerInfoUpdate,this));
c("body").delegate(".useBillingInfo","click",c.proxy(function(a){a.preventDefault();this.resetCustomerInfoUpdateForm(this.FROM_DEFAULT_CONFIG)},this))},declineAll:function(){var a="";c.each(this.config.installmentsAgreementsList,function(b,c){a+=btoa(c.lineItemId)+","});var b={token:this.ricPageWrapper.find('input[name\x3d"csrfToken"]').val(),unsetLineItemIds:a.slice(0,-1)};this.doSubmit(b)},doReftag:function(a){a&&(g.isInHouseInstallmentsRecordCsmEnabled()?f.increaseCount("Checkout:RetailInstallmentContract:"+
this.REFTAG_BASE_PREFIX+":"+a,1):c.get(this.REFTAG_URL+this.REFTAG_BASE_PREFIX+a))},doSubmit:function(a){function e(a){d.redirect(a)}function k(a){d.redirect(a)}b.show();var n=c("#gurupaRicCSRFToken").val();a.gurupaRicCSRFToken=n;g.isInHouseInstallmentsTangoEnabled()?d.ajaxUpdate(this.config.gurupaRicSubmitUrl,a,{pushNewFrame:"true"}).done(function(){f.increaseCount("Checkout:RetailInstallmentContract:UpdateSuccess",1)}).fail(function(){f.increaseCount("Checkout:RetailInstallmentContract:UpdateFailure",
1)}):c.ajax({type:"POST",url:this.config.gurupaRicSubmitUrl,data:a,async:!0,cache:!1,headers:d.setAjaxTransitionHeader(),success:e,error:k})},getRicByLineItemId:function(a){var b=null;a=a.replace(/(\.|#)/g,"");c.each(this.config.installmentsAgreementsList,function(c,d){(c=d.lineItemId===a)||(c=d.lineItemId,c=-1!==c.indexOf(a,c.length-a.length));if(c)return b=d,!1});return b},handleCustomerInfoUpdate:function(a){a.preventDefault();var b=c(a.currentTarget).closest("form");a=b.serializeArray();var d=
!1;c.each(a,c.proxy(function(a,e){if(""===c.trim(e.value)&&"customerPhoneNumber"!==e.name)return b.find('input[name\x3d"'+e.name+'"]').addClass("a-form-error"),b.find("#"+e.name+"Alert").removeClass("aok-hidden"),d=!0,!1;a=c("\x3cdiv\x3e").text(e.value).html();this.config[e.name]=a},this));d||(c("body").find(".ricCustomerName").html(this.config.customerName),c("body").find(".ricCustomerPhone").html(this.config.customerPhoneNumber),c("body").find(".ricCustomerAddress").html(this.config.customerAddress),
this.closeCustomerInfoUpdateView(),this.handleCustomerInfoUpdateFormClose(),this.doReftag(this.REFTAG_RIC_CHANGE))},handleFormAlertToggle:function(a){a=c(a.currentTarget);var b=a.closest("form");a.hasClass("a-form-error")&&(a.removeClass("a-form-error"),b.find("#"+a.attr("name")+"Alert").addClass("aok-hidden"))},prepareCustomerAgreementsAndSubmit:function(){var a="",b="";c.each(this.config.installmentsAgreementsList,function(d,e){-1!==e.customerAgreementsList.indexOf(!1)&&(a+=btoa(e.lineItemId)+",");
b+=btoa(e.lineItemId)+":";c.each(e.customerAgreementsList,function(a,c){b+=c?"1":"0";b+=","});b=b.slice(0,-1);b+="~"});var d={token:this.ricPageWrapper.find('input[name\x3d"csrfToken"]').val(),customerAddress:this.config.customerAddress,customerName:this.config.customerName,customerPhoneNumber:this.config.customerPhoneNumber,eSignConsentAgreement:this.config.eSignConsentAgreement?"1":"0",installmentsAgreementsList:b.slice(0,-1),unsetLineItemIds:a.slice(0,-1)};this.doReftag(this.REFTAG_RIC_CONSENT);
this.doSubmit(d)},resetCustomerInfoUpdateForm:function(b){var d=a.state("ricCustomerInfoState"),e=c(".customerInfoUpdateForm");e.find(".updateInfoBrief").each(function(a,b){c(b).addClass("aok-hidden")});var f="";f=this.hasMultipleRics?this.hasConsentedToAtLeastOneRic?".multipleHasConsent":".multiplePendingConsent":this.hasConsentedToAtLeastOneRic?".singleHasConsent":".singlePendingConsent";c(f).removeClass("aok-hidden");e.find(".a-alert-inline").each(function(a,b){c(b).addClass("aok-hidden")});e.find("input").each(function(a,
b){c(b).removeClass("a-form-error")});b=b===this.FROM_DEFAULT_CONFIG?d:this.config;e.find('input[name\x3d"customerAddress"]').val(b.customerAddress);e.find('input[name\x3d"customerName"]').val(b.customerName);e.find('input[name\x3d"customerPhoneNumber"]').val(b.customerPhoneNumber)},validateInstallmentsAgreements:function(){var a=!0;c.each(this.config.installmentsAgreementsList,c.proxy(function(b,c){if(!this.validateCustomerAgreements(c))return a=!1},this));return a&&this.config.eSignConsentAgreement},
validateCustomerAgreements:function(a){var b=!0;c.each(a.customerAgreementsList,function(a,c){if(!c)return b=!1});return b}})});"use strict";h.when("A","a-modal","a-popover-base","retail-installments-contract-base-controller","ready").register("retail-installments-contract-controller",function(a,b,d,e){var g=a.$;return e.extend({continueButton:null,continueButtonWithToolTip:null,currentCardIndex:0,indexOfFirstPaymentTerms:null,REFTAG_BASE_PREFIX:"co_lti_",ESIGN_CARD_INDEX:0,init:function(a,b){this.initArrays();
this.indexOfFirstPaymentTerms=b?1:0;this._super()},initArrays:function(){this.cardHeaders=[];this.cardBodies=[];this.cardCompletedHeaders=[];this.cardDeclinedHeaders=[];this.consentButtons=[];this.declineButtons=[];this.declinedCardIndices=[];this.cardIndicesAwaitingResponse=[]},getElements:function(){this.ricPageWrapper=g(".ricPageWrapper");var a=this.ricPageWrapper.find("[class*\x3dagreement-header]");g.each(a,g.proxy(function(b){this.cardHeaders.push(g(a[b]));this.cardBodies.push(this.ricPageWrapper.find(".agreement-body-"+
b));this.cardCompletedHeaders.push(this.ricPageWrapper.find(".agreement-complete-"+b));this.cardDeclinedHeaders.push(this.ricPageWrapper.find(".agreement-declined-"+b));this.consentButtons.push(this.ricPageWrapper.find(".consent-button-"+b));this.declineButtons.push(this.ricPageWrapper.find(".decline-button-"+b));this.cardIndicesAwaitingResponse.push(b)},this))},bindEvents:function(){0!==this.indexOfFirstPaymentTerms?(this.consentButtons[this.ESIGN_CARD_INDEX].click(g.proxy(this.handleEConsentYes,
this)),this.declineButtons[this.ESIGN_CARD_INDEX].click(g.proxy(this.handleEConsentNo,this))):this.config.eSignConsentAgreement=!0;g.each(this.cardHeaders,g.proxy(function(a,b){b.click(g.proxy(this.toggleCard,this,a))},this));g.each(this.consentButtons.slice(this.indexOfFirstPaymentTerms),g.proxy(function(a,b){b.click(g.proxy(this.handleMonthlyPaymentsConsentEvent,this,a+this.indexOfFirstPaymentTerms,!0))},this));g.each(this.declineButtons.slice(this.indexOfFirstPaymentTerms),g.proxy(function(a,b){b.click(g.proxy(this.handleMonthlyPaymentsConsentEvent,
this,a+this.indexOfFirstPaymentTerms,!1))},this));g(".esignModal").click(g.proxy(function(){this.doReftag(this.REFTAG_ESIGN_LINK)},this));g("body").delegate(".a-popover-modal .downloadPdf a","click",g.proxy(function(){this.doReftag(this.REFTAG_ESIGN_PDF)},this));g(".ricWrapper .customerInfoUpdateLink").click(g.proxy(function(){this.doReftag(this.REFTAG_RIC_CHANGE_OPEN)},this));g("body").delegate(".a-popover-modal .customerInfoUpdateLink","click",g.proxy(function(){this.doReftag(this.REFTAG_RIC_CHANGE_OPEN_SECONDARY)},
this));g(".mpaConsentWrapper a").click(g.proxy(function(){this.doReftag(this.REFTAG_RIC_LINK)},this));g("body").delegate("input.ricInput","focus",g.proxy(this.handleFormAlertToggle,this));g("body").delegate(".closeModalButton","click",g.proxy(this.closeAllModals,this));a.on("a:popover:beforeShow:customerInfoInputModal",g.proxy(function(){this.resetCustomerInfoUpdateForm(this.FROM_CURRENT_CONFIG)},this));this._super()},declineAll:function(){this.doReftag(this.REFTAG_RIC_REMOVE);this._super()},handleCustomerInfoUpdateFormClose:function(){this.resetRICCards();
g.each(this.config.installmentsAgreementsList,function(a,b){g.each(b.customerAgreementsList,function(a){b.customerAgreementsList[a]=!1})});a.delay(g.proxy(function(){this.openCard(this.indexOfFirstPaymentTerms)},this),500)},handleEConsentNo:function(){this.doReftag(this.REFTAG_ESIGN_N);this.declineAll()},handleEConsentYes:function(){this.doReftag(this.REFTAG_ESIGN_Y);this.config.eSignConsentAgreement=!0;this.cardIndicesAwaitingResponse[0]===this.ESIGN_CARD_INDEX&&this.cardIndicesAwaitingResponse.shift();
this.updateCardStatus(this.ESIGN_CARD_INDEX,!0);this.openCard(this.indexOfFirstPaymentTerms);this.ricPageWrapper.find(".mpaConsentWrapperShroud").hide()},handleMonthlyPaymentsConsentEvent:function(a,b,d){var c=g(d.currentTarget);d=b?this.REFTAG_RIC_Y:this.REFTAG_RIC_N;c=c.closest(".mpaConsentWrapper").attr("id").split("_");var e=this.getRicByLineItemId(c[0]);this.doReftag(d);e.customerAgreementsList[c[1]]=b;this.hasConsentedToAtLeastOneRic=this.hasConsentedToAtLeastOneAgreement();this.updateCardStatus(a,
b);a=this.cardIndicesAwaitingResponse.indexOf(a);-1!==a&&this.cardIndicesAwaitingResponse.splice(a,1);0<this.cardIndicesAwaitingResponse.length?this.openCard(this.cardIndicesAwaitingResponse[0]):!0===this.config.eSignConsentAgreement&&0===this.cardIndicesAwaitingResponse.length&&this.prepareCustomerAgreementsAndSubmit()},hasConsentedToAtLeastOneAgreement:function(){var a=null;g.each(this.config.installmentsAgreementsList,function(b,d){g.each(d.customerAgreementsList,function(b,c){if(c)return a=!0,
!1});if(null!==a)return!1});return null!==a},toggleContinueButtons:function(b){b?(this.continueButtonWithToolTip.addClass("aok-hidden"),this.continueButton.removeClass("aok-hidden")):(this.continueButtonWithToolTip.hasClass("aok-hidden")&&this.continueButtonWithToolTip.removeClass("aok-hidden"),this.continueButton.hasClass("aok-hidden")||this.continueButton.addClass("aok-hidden"));a.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")},closeCustomerInfoUpdateView:function(){this.closeAllModals()},
closeAllModals:function(){g(".a-popover-modal .a-button-close").each(function(){g(this).click()})},closeCard:function(a){this.cardBodies[a].addClass("aok-hidden");this.currentCardIndex=null},openCard:function(a){null!=this.currentCardIndex&&this.closeCard(this.currentCardIndex);this.cardBodies[a].removeClass("aok-hidden");this.currentCardIndex=a},toggleCard:function(a){a in this.declinedCardIndices||(this.currentCardIndex===a?this.closeCard(a):this.openCard(a))},updateCardStatus:function(a,b){!0===
b?!0===this.cardCompletedHeaders[a].hasClass("aok-hidden")&&this.cardCompletedHeaders[a].removeClass("aok-hidden"):(!1===this.cardCompletedHeaders[a].hasClass("aok-hidden")&&this.cardCompletedHeaders[a].addClass("aok-hidden"),this.cardDeclinedHeaders[a].removeClass("aok-hidden"),this.declinedCardIndices[a]=!0)},resetRICCards:function(){this.cardIndicesAwaitingResponse=[];g.each(this.cardHeaders.slice(this.indexOfFirstPaymentTerms),g.proxy(function(a){a+=this.indexOfFirstPaymentTerms;this.cardIndicesAwaitingResponse.push(a);
!1===this.cardCompletedHeaders[a].hasClass("aok-hidden")&&this.cardCompletedHeaders[a].addClass("aok-hidden");!1===this.cardDeclinedHeaders[a].hasClass("aok-hidden")&&this.cardDeclinedHeaders[a].addClass("aok-hidden")},this));this.declinedCardIndices=[]}})});"use strict";h.when("A","page-conductor","utils/auiComponentHelper","widgets/relatedItems/newCheckoutExperience/deleteTogetherPopoverHelper","a-stepper","page-spinner-controller").register("widgets/itemBlocks/newCheckoutExperience/itemBlocks",
function(a,b,d,e,g,f){function c(a,c,d,f,k,p,D){f&&0===a?e.showPopover(k):b.ajaxUpdate(c,d);"T3"===p&&D&&(g.getStepper(D).setStatus("normal"),D.css("z-index",h).css("position","static"));l=!1}var h,l=!1;a.declarative("item-block-change-quantity-form-submit","change",function(b){var c=b.data,d=c.currentQuantity,g=c.showDeleteTogetherPopover;c=c.deleteTogetherBottomSheetData||c.deleteTogetherPopoverData;var f=b.$target,k=f.find(":selected").val();g&&"0"===k.toString()?(e.showPopover(c),b=e.getHideEventName(c),
a.off(b),a.on(b,function(){f.val(d).change()})):k.toString()!==d.toString()&&a.trigger("a:declarative:checkout-page-form-submit:change",b)});a.declarative("item-block-change-quantity","click",function(a){d.showDropDownList(a.data.dropDownId)});a.on("a:stepper:value:change:checkout-quantity-stepper",function(a){var b=a.$stepperElement,d=parseInt(a.newValue),e=b.data("quantityupdateurl"),n=parseInt(b.data("valuemin")),p=b.data("showdeletetogetherpopover"),D=b.data("deletetogetherbottomsheetdata")||
b.data("deletetogetherpopoverdata");b=b.data("quantitysteppertreatment");d<n&&(d=0);n={quantity:d};if("T2"===b||"T3"===b){a=a.$stepperElement;var Q=g.getStepper(a);Q.setValue(d);Q.setStatus("loading");"T3"!==b||l||(h=a.css("z-index"),f.show(),l=!0,a.css("z-index",2005).css("position","relative"));k(d,e,n,p,D,b,a)}else c(d,e,n,p,D,b)});a.declarative("item-block-delete-fixed-item","click",function(a){a=a.data;c(0,a.quantityUpdateUrl,{quantity:0},a.showDeleteTogetherPopover,a.deleteTogetherBottomSheetData||
a.deleteTogetherPopoverData)});var k=function(a,b){var c;return function(){var d=this,e=arguments;clearTimeout(c);c=setTimeout(function(){a.apply(d,e)},b)}}(c,750)});"use strict";h.when("A","jQuery","client-side-metrics","configurations/keys","configurations/newCheckoutExperienceConfig","page-conductor","weblab-helper","utils/auiComponentHelper","checkout-view-modal-handler").register("widgets/itemBlocks/newCheckoutExperience/shipOptions",function(a,b,d,e,g,f,c,h,l){function k(a){if(a.deliveryPersistenceInformation)try{a.deliveryPersistenceInformation=
JSON.stringify(a.deliveryPersistenceInformation)}catch(t){d.logError(t,"Error when processing delivery persistence info","checkout:newCheckoutExperience:deliveryPersistenceInfo:invalid","FATAL"),f.ajaxSorryPage()}}function n(b,c,e,g,n){e=b.isselected;g=b.postdata;var t=b.setactionurl;if((b=b.getdata)&&b.url){if(n){a:{if(n&&(c=n.$target.closest("fieldset"),0===c.length&&(c=n.$target.closest(".a-form-control-group")),c=c.find('[data-isselected\x3d"true"] input'),c.length)){c=c[0];break a}c=null}c&&
(c.checked=!0);n.$target.attr("executed","false")}a.capabilities.mobile?f.redirect({conductoraction:{url:b.url}}):(n.data=b,l.createCheckoutViewModal(n))}else k(g),e||(d.setCountValue(c,1),f.ajaxUpdate(t,g))}a.declarative("checkout-extra-scheduled-slot-expander-action","click",function(a){d.setCountValue("checkout:newCheckoutExperience:extraScheduledDeliverySlotsExpander:clicked",1);var c=a.data,e=b("#"+c.widgetId).find(".rcx-checkout-extra-scheduled-slots.rcx-checkout-extra-scheduled-slots-hidden.dynamic-class");
b("#checkout-extra-scheduled-slots-expander-link-"+c.widgetId).addClass("rcx-checkout-extra-scheduled-slots-hidden");e.each(function(){b(this).removeClass("rcx-checkout-extra-scheduled-slots-hidden");b(this).addClass("rcx-checkout-extra-scheduled-slots-shown")});a.$event.preventDefault();a.$event.stopPropagation()});a.declarative("checkout-select-ship-option-delivery-slot","click",function(a){var b=a.data,c=b.setActionUrl,e=b.postData;a.$event.preventDefault();a.$event.stopPropagation();k(e);b.isSelected||
(d.setCountValue("checkout:newCheckoutExperience:selectScheduledDeliveryOption:attempted",1),f.ajaxUpdate(c,e))});a.on("checkout-select-delivery-slots",function(a){a&&n(a,"checkout:newCheckoutExperience:selectDeliverySlots:attempted","checkout:newCheckoutExperience:selectDeliverySlots:failed","SelectDeliverySlots:Failed")});a.declarative("checkout-select-ship-option-radio","change",function(a){var b=a.$target;if(0!==b.length)if("true"===b.attr("executed"))d.increaseCount("checkout:newCheckoutExperience:selectShipOption:duplicated",
1,1);else if(b.attr("executed","true"),b=h.getRadioButtonData(b))a.$event.preventDefault(),n(b,"checkout:newCheckoutExperience:selectShipOption:attempted","checkout:newCheckoutExperience:selectShipOption:failed","SelectShipOption:Failed",a)});a.declarative("checkout-select-group-delivery-option-category","click",function(a){try{if(d.setCountValue("checkout:newCheckoutExperience:selectDeliveryOptionCategory:attempted",1),a&&a.$target&&a.$target.data()){var b=a.$target.closest("#col-delivery-group"),
c=a.$target.data(),e=b.find(".gdo-category-content-"+c.category+' input[type\x3d"radio"][value\x3d"'+c.category_default_ship_option+'"]');e&&0<e.length&&(d.setCountValue("checkout:newCheckoutExperience:selectDeliveryOptionCategory:clicked:"+c.category,1),e.click())}}catch(Y){d.logError(Y,"Error clicking group delivery option category button","checkout:newCheckoutExperience:selectDeliveryOptionCategory:failed","WARN")}})});"use strict";h.when("A","ready").register("widgets/itemBlocks/newCheckoutExperience/fastTrackCountdown",
function(a){function b(){d();var a=k("#checkout-item-block-panel");if(0===a.length&&(a=k("#checkout-combined-delivery-address-item-block-panel"),0===a.length))return;a=a.find(".checkout-fast-track-text");0!==a.length&&(e(),a.each(function(){var a=k(this),b=a.attr("id"),c=a.attr("data-expiration-time"),d=a.attr("data-suppress-cutoff-timer");b!==q&&c!==q&&(c=parseInt(c,10),isNaN(c)||("true"!==d&&a.find(".checkout-fast-track-available").show(),g(a,b,c)))}))}function d(){for(var a in r)clearTimeout(r[a]);
r={}}function e(){n.days={plural:k("#checkout-fast-track-days").html(),singular:k("#checkout-fast-track-day").html()};n.hours={plural:k("#checkout-fast-track-hours").html(),singular:k("#checkout-fast-track-hour").html()};n.minutes={plural:k("#checkout-fast-track-minutes").html(),singular:k("#checkout-fast-track-minute").html()};n.seconds={plural:k("#checkout-fast-track-seconds").html(),singular:k("#checkout-fast-track-second").html()};n.and=k("#checkout-fast-track-and").html()}function g(b,c,d){var e=
Math.round(a.now()/1E3);e=d-e;if(0>=e)b.find(".checkout-fast-track-available").hide(),b.find(".checkout-fast-track-expired").show(),delete r[c];else{var k=e,n=Math.floor(k/86400);k-=86400*n;var h=Math.floor(k/3600);k-=3600*h;var t=Math.floor(k/60);k-=60*t;var p=f(n,h,t,k);b.find('span[data-countdown\x3d"fastTrackCountdown"]').html(p);e=l(e,n,h,t,k);r[c]=setTimeout(function(){g(b,c,d)},e)}}function f(a,b,d,e){return 0<a?2<=a?h(a,"days"):c(a,"days",b,"hours"):0<b?c(b,"hours",d,"minutes"):0<d?5<=d?h(d,
"minutes"):c(d,"minutes",e,"seconds"):h(e,"seconds")}function c(a,b,c,d){a=h(a,b);0<c&&(a+=" ",0<n.and.length&&(a+=n.and+" "),a+=h(c,d));return a}function h(a,b){return a.toString()+" "+(1<a?n[b].plural:n[b].singular)}function l(a,b,c,d,e){var g=1;0<b?g=2<=b?g+(a-86400*b):g+(60*d+e):0<c?g+=e:0<d&&5<=d&&(g+=e);return 1E3*g}var k=a.$,n={},r={};a.on("checkout:reload:spc",b);b();return{setTimeUnitStrings:e,getFastTrackCountdownDisplayText:f,getDelayForCountdownChangeInMilliseconds:l}});"use strict";h.when("A",
"ready").execute("checkout:reload:spc",function(a){(a=a.state("scroll-to-item-block-state"))&&!0===a.scrollToItemBlock&&(a=document.getElementById("checkout-item-block-panel"))&&a.scrollIntoView({behavior:"smooth",block:"start"})});"use strict";h.when("A","jQuery").register("widgets/itemselect/itemSelect",function(a,b){function d(a,b){var d=e(),f=h(d,a);f===q?(f=c(a),f.quantity=b,d.push(f)):f.quantity=b;g(d)}function e(){if(f())return[];var a=b("#stmaRequests").val();return""===a?[]:JSON.parse(a)}
function g(a){f()?(b("#singleStmaRequest").val(JSON.stringify(a)),b("#single-continue-form").submit()):b("#stmaRequests").val(JSON.stringify(a))}function f(){var a=b("#isSTMAT2Enabled");return a!==q&&null!==a&&"1"===a.val()}function c(a){return{lineItemId:a,quantity:q,destinationid:q}}function h(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(d.lineItemId===b)return d}return q}function l(a){var c="#line-item-group-display-"+a.replace("\x3d\x3d","\\\x3d\\\x3d");a="#line-item-group-removed-"+a.replace("\x3d\x3d",
"\\\x3d\\\x3d");b(c).addClass("aok-hidden");b(a).removeClass("aok-hidden")}a.declarative("item-select-address-change","change",function(a){var b=a.data.lineitemid;a=a.$target.find(":selected").val();var d=e(),f=h(d,b);f===q?(f=c(b),f.destinationid=a,d.push(f)):f.destinationid=a;g(d)});a.declarative("item-select-delete-linegroup","click",function(a){a=a.data.lineitemid;d(a,0);l(a)});a.on("a:stepper:value:change:stma-checkout-quantity-stepper",function(a){var b=a.stepper,c=a.$stepperElement;a=parseInt(a.newValue);
var e=parseInt(c.data("valuemin"));c=c.data("lineitemid");a<e&&(a=0);b.setValue(a);d(c,a);0===a&&l(c)})});"use strict";h.when("A","jQuery","a-modal","page-conductor").register("widgets/relatedItems/newCheckoutExperience/deleteTogetherPopover",function(a,b,d,e){var g="a:declarative:".concat("checkout-page-form-submit",":change");a.declarative("delete-together-popover-hide","click",function(a){d.get(a.data.popoverName).hide()});a.declarative("delete-together-popover-submit","click",function(f){f=f.data;
var c=f.enableAUIQuantityStepper;d.get(f.popoverName).hide();c?e.ajaxUpdate(f.updateItemQuantityUrl,{quantity:0}):(f=b("#".concat(f.quantityChangeDropdownId)),f={$event:new b.Event(g),$target:f,action:"checkout-page-form-submit",type:"change"},a.trigger(g,f))})});"use strict";h.when("jQuery","a-modal").register("widgets/relatedItems/newCheckoutExperience/deleteTogetherPopoverHelper",function(a,b){return{showPopover:function(a){var d=b.get(a.name);d||(a={name:a.name,dataStrategy:"preload",width:650},
d=b.create(document.createElement("div"),a));d.show()},getHideEventName:function(a){return"a:popover:afterHide:".concat(a.name)}}});"use strict";h.when("A","jQuery","client-side-metrics","ready").register("widgets/paymentMethods/deferred-payment-method",function(a,b,d){a.declarative("show-deferredpayment-alert-action","click",function(){b("#deferredpayment-alert").removeClass("aok-hidden");d.increaseCount("checkout:deferredPaymentExperience:changePaymentMethod:click",1);if(a.state("deferred-payment-state")){var e=
a.state("deferred-payment-state");e.CustomerJourney="CustomerJourney";e.producerId="payments";e.schemaId="Payments.CustomerJourney.3";e.timestamp=(new Date).toISOString();e.metricName="checkout:deferredPaymentExperience:customerEngagement";e.weblabName="";e.weblabTreatment="";e.clientReference="";"undefined"!==typeof v.ue&&"undefined"!==typeof v.ue.event&&v.ue.event(e,e.producerId,e.schemaId)}});a.declarative("show-deferredpayment-alert-action-or-forward-trigger","click",function(b){null!==document.getElementById("deferredpayment-alert")?
a.trigger("a:declarative:show-deferredpayment-alert-action:click"):a.trigger("a:declarative:page-transit-no-update-action:click",b)})});"use strict";h.when("A","jQuery","client-side-metrics","widgets/pointsRedemption/pointsRedemptionCommon","load").register("widgets/pointsRedemption/pointsRedemption",function(a,b,d,e){function g(){b("#partial-redemption-points-input").bind("keydown",c);b("#partial-redemption-points-input").bind("input",e.inputPointsOnInput)}function f(){if(e.isInputPointsValid("desktop",
h))e.onSubmitClick(Number(e.getPartialRedemptionInputValue()),"desktop")}function c(a){if("Enter"===a.key||13===a.keyCode)return f(),a.preventDefault(),!1}var h=/^\d+(\.\d{0,2})?$/;e.emitWidgetLoadMetric("desktop");a.declarative("submit-points-for-redemption-action","click",f);a.on("checkout:reload:spc",g);g()});"use strict";h.when("A","jQuery","page-transition-controller","page-conductor","page-detector-current-page","client-side-metrics","ajax-utility","widgets/pointsRedemption/pointsRedemptionMarketplaceConfig",
"load").register("widgets/pointsRedemption/pointsRedemptionCommon",function(a,b,d,e,g,f,c,h){function l(a){a.addClass("aok-hidden")}function k(a){a.removeClass("aok-hidden")}function n(a){return a.find(".offscreen-points-redemption-error")}function p(){return b("#partial-redemption-points-input").length?b("#partial-redemption-points-input").val():b("#tango-points-redemption-currency-input").val()}function t(a,c){A();k(a);l(b("#tango-input-points-applied-label"));"mobile"!==c&&"mobile:tango"!==c||
L("error");c=a.find(".visible-points-redemption-error").text();n(a).text(c)}function A(a){var c=b("#input-points-exceeds-redeemable-error");l(c);n(c).empty();c=b("#input-points-invalid-error");l(c);n(c).empty();k(b("#tango-input-points-applied-label"));"mobile"!==a&&"mobile:tango"!==a||L("normal")}function L(a){var c=b("#partial-redemption-points-input").parent(".a-input-text-wrapper");c&&0<c.length&&("error"===a?c.addClass("a-form-error"):"normal"===a&&c.removeClass("a-form-error"))}function q(a,
k){return{url:b("#redemption-option-update-handler-url").val(),headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},data:{redeemedAmount:a,pointsPaymentInstrumentId:b("#points-instrument-id").val(),targetCurrencyCode:b("#currency-code").val(),maxRedeemableAmount:b("#redeemable-points-amount").val(),isClientTimeBased:b("input[name\x3duseCtb]").val(),hasWorkingJavascript:1},beforeRequest:function(){"mobile:tango"===k&&f.resetMetrics();d.show()},onSuccess:function(a,b,d){f.increaseCount("checkout:pointsRedemption:"+
k+":purchaseDocUpdateSuccess",1);"mobile:tango"===k?e.ajaxUpdatePage(a,b,d):e.redirect(c.jsonify(a))},onFailure:function(a,b,c){f.increaseCount("checkout:pointsRedemption:"+k+":purchaseDocUpdateFailure",1);"mobile:tango"===k?(a=g.getCurrentPage(),e.loadPage(a,a,null,null,location.href)):e.ajaxRedirect(a,b,c)}}}function D(a,g){return{url:b("#redemption-option-update-handler-url").val(),headers:{"x-amz-checkout-page":"spc"},data:{jpPointsCustomerRequestedAmount:a,jpPointsPaymentInstrumentId:b("#points-instrument-id").val(),
jpPointsTargetCurrencyCode:b("#currency-code").val(),jpPointsAvailablePoints:b("#redeemable-points-amount").val(),isClientTimeBased:b("input[name\x3duseCtb]").val(),hasWorkingJavascript:1},beforeRequest:function(){d.show()},onSuccess:function(a,b,d){f.increaseCount("checkout:pointsRedemption:"+g+":purchaseDocUpdateSuccess",1);f.increaseCount("checkout:pointsRedemption:"+g+":redirectOnSuccess",1);e.redirect(c.jsonify(a))},onFailure:function(a,b,c){f.increaseCount("checkout:pointsRedemption:"+g+":purchaseDocUpdateFailure",
1);e.ajaxRedirect(a,b,c)}}}return{hideAllErrors:A,hideFormElement:l,showFormElement:k,getOffscreenErrorMessage:n,isInputPointsValid:function(a,c){var d=p();if(!c.test(d))return f.increaseCount("checkout:pointsRedemption:"+a+":inputPointsInvalidError",1),t(b("#input-points-invalid-error"),a),!1;if(Number(d)>Number(b("#redeemable-points-amount").val()))return f.increaseCount("checkout:pointsRedemption:"+a+":inputPointsExceedsRedeemableError",1),t(b("#input-points-exceeds-redeemable-error"),a),!1;A(a);
return!0},getPartialRedemptionInputValue:p,inputPointsOnInput:function(){A("desktop");l(b("#input-points-apply-success"));k(b("#submit-points-for-redemption"))},emitWidgetLoadMetric:function(a){f.increaseCount("checkout:pointsRedemption:"+a+":spcWidgetLoad",1)},onSubmitClick:function(a,c){a="true"===b("#is-points-redemption-setter-migration-enabled").val()?q(a,c):D(a,c);a.beforeRequest();b.ajax({type:"POST",url:a.url,headers:a.headers,async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
dataType:"text",data:b.param(a.data,!0),success:a.onSuccess,error:a.onFailure})},marketplaceConfig:h}});"use strict";h.when("A","load").register("widgets/pointsRedemption/pointsRedemptionMarketplaceConfig",function(a){return{pointsInputPattern:/^\d+(\.\d{0,2})?$/}});"use strict";h.when("A","jQuery","a-modal","client-side-metrics").register("widgets/productInformation/quicklookEventHandler",function(a,b,d,e){a.declarative("a-modal","click",function(d){if(d.$target.hasClass("cpx-quicklook-open-link")){e.increaseCount("checkout:quicklook:universal:modalLinkClick",
1);d=d.data;if(!d)throw e.increaseCount("checkout:quicklook:universal:eventDataUndefined",1),Error("[Modal] Event data is undefined");d=d.lineItemIndex;if(!d)throw e.increaseCount("checkout:quicklook:universal:lineItemIndexMissing",1),Error("[Modal] LineItemIndex is missing from event data");a.loadImageManually(b("#quicklook-modal-manual-image-"+d))}})});"use strict";h.when("A","page-transition-controller","page-conductor","client-side-metrics").register("checkout-vas-notification-preferences",function(a,
b,d,e){function g(){l(".notification-preferences-widget :checkbox").change(f)}function f(){this.checked?e.increaseCount(k.CHECKBOX.SELECTED,1):e.increaseCount(k.CHECKBOX.DESELECTED,1);c(l(this),this.checked)}function c(a,c){var g=d.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"}),f=h(a,c);l.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/notification-preferences.html",headers:g,async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",data:l.param(f,
!0),beforeSend:function(){b.show()},success:function(a,c,d){e.increaseCount(k.PURCHASE_UPDATE.SUCCESS);b.hide()},error:function(d,g,f){e.increaseCount(k.PURCHASE_UPDATE.FAIL);e.logError(f,"notification preference AJAX update call failed","checkout-vas-notification-preferences","ERROR");a.prop("checked",!c);b.hide()}})}function h(a,b){var c={};c[a.closest(".a-checkbox").attr("data-name")]=b?1:0;a.closest(".notification-preferences-widget").find("input:hidden").each(function(){var a=l(this);c[a.attr("data-name")]=
a.val()});return c}var l=a.$,k={CHECKBOX:{SELECTED:"checkout:np:checkbox:selected",DESELECTED:"checkout:np:checkbox:deselected"},PURCHASE_UPDATE:{SUCCESS:"checkout:np:purchaseUpdate:success",FAIL:"checkout:np:purchaseUpdate:fail"}};a.each(["checkout:reload:spc","checkout:reload:spp-revieworder"],function(b){a.off(b,g);a.on(b,g)})});h.when("A","ready").register("widgets/invoiceAddress/invoiceAddressSelect",function(){});h.when("A","jQuery","a-checkbox","client-side-metrics","ready").register("widgets/invoiceAddress/invoiceAddressSelectCommon",
function(a,b,d,e){return{handleSelectInvoiceAddressFormSubmit:function(a){var g=b('[name\x3d"select_invoice_address"]'),c=d("#purchaseLevelSetInvoiceAddress").isChecked();e.increaseCount("checkout:selectinvoiceaddress:purchaselevel","true"===c?1:0);if(null!==c||""!==c||"undefined"!==c)c=b("\x3cinput\x3e").attr("type","hidden").attr("name","isPurchaseLevelSetInvoiceAddressSelected").val(c),g.append(c);null!==a||""!==a||"undefined"!==a?(a=b("\x3cinput\x3e").attr("type","hidden").attr("name","encryptedTaxId").val(a),
g.append(a)):e.increaseCount("checkout:selectinvoiceaddress:taxidnotfound",1)},getEncryptedTaxId:function(b){var d=a.state("selectInvoiceAddressParams");if(d===q)return e.increaseCount("checkout:selectinvoiceaddress:getEncryptedTaxId:emptyinvoiceaddressparams",1),"";d=d.taxRegistrations;b=b.stateOrRegion;if(null!==b&&""!==b&&"undefined"!==b)return b=d[b.toUpperCase()],b===q?(e.increaseCount("checkout:selectinvoiceaddress:getEncryptedTaxId:taxidnotfoundforstate",1),""):b;e.increaseCount("checkout:selectinvoiceaddress:getEncryptedTaxId:statenotfound",
1);return""}}});"use strict";h.when("A","jQuery","page-transition-controller","ajax-utility","page-conductor","page-detector","client-side-metrics","weblab-helper").register("widgets/financialOfferCheckbox/financingCheckboxCommon",function(a,b,d,e,g,f,c,h){return{clickFinancingCheckbox:function(a){a.preventDefault();g.isSPP()?(d.blockAllActions(),h.isAffordUpsellCheckboxMigrationEnabledInTangoDesktop()?d.showTransitionInContainer(b("#checkout-payment-option-panel")):d.showTransitionInContainer(b("#payment"))):
d.show();a={paymentMethodId:b("#payment-method-id").val(),paymentMethodType:b("#payment-method-type").val(),rewardAccountId:b("#reward-account-id").val(),rewardAccountAmount:b("#reward-account-amount").val(),rewardAccountRate:b("#reward-account-rate").val(),useGCBalance:b("#use-gc-balance").val(),financialOfferId:b("#financial-offer-id").val(),returnFullHTML:1,returnjson:1,hasWorkingJavascript:1,isClientTimeBased:b("input[name\x3duseCtb]").val()};if(h.isChewbaccaAffordUpsellCheckboxMigrationEnabledUsingAjaxUpdate()){var f=
b("#set-financial-offer-url").val();g.ajaxUpdate(f,a).done(function(){c.increaseCount("checkout:financingCheckbox:purchaseDocUpdateSuccess",1)}).fail(function(){c.increaseCount("checkout:financingCheckbox:purchaseDocUpdateFailure",1)})}else f={"x-amz-checkout-page":"spc"},f=g.setAjaxTransitionHeader(f),b.ajax({type:"POST",url:"/gp/buy/payselect/handlers/continue.html",data:b.param(a,!0),dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:f,
success:function(a,b,d){c.increaseCount("checkout:financingCheckbox:purchaseDocUpdateSuccess",1);d.getResponseHeader("x-amz-checkout-page")?g.ajaxUpdatePage(a,b,d):(a=e.jsonify(a),g.redirect(a))},error:function(a,b,d){c.increaseCount("checkout:financingCheckbox:purchaseDocUpdateFailure",1);g.ajaxRedirect(a,b,d)}})}}});"use strict";h.when("A","jQuery","client-side-metrics","widgets/financialOfferCheckbox/financingCheckboxCommon").execute("widgets/financialOfferCheckbox/financingCheckbox",function(a,
b,d,e){a.declarative("click-financing-checkbox","click",function(a){var b=a.data.click;b&&null!==b&&(d.increaseCount("checkout:spp-payment:clickFinancingCheckbox",1),e.clickFinancingCheckbox(a.$event))})});"use strict";h.when("A","jQuery","page-transition-controller","page-conductor","client-side-metrics").register("widgets/devicePreregistration/devicePreregistration",function(a,b,d,e,g){function f(a,f,h){d.show();b.ajax({type:"POST",url:"/gp/buy/devices/preregistration/handlers/set-item-preregistration.html",
data:{csrfToken:a,lineItemId:f,isChecked:h},dataType:"text",async:!0,cache:!1,headers:e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"}),success:function(a,b,c){g.increaseCount("checkout:devicePreregistration:ajaxSuccess",1);e.ajaxUpdatePage(a,b,c,{pushNewFrame:"false"})},error:function(a,b,c){g.increaseCount("checkout:devicePreregistration:ajaxError",1);e.ajaxRedirect(a,b,c)}})}a.declarative("mako-rcx-prereg-declarative","change",function(a){var c=b("[name\x3dcsrfToken]").val(),d=null==a.data?
q:a.data.lineItemId;(a=a.$target.is(":checked"))?g.increaseCount("checkout:devicePreregistration:checked",1):g.increaseCount("checkout:devicePreregistration:unchecked",1);f(c,d,a)})});"use strict";h.when("A","jQuery","a-sheet","a-checkbox","page-conductor","page-spinner-controller","client-side-metrics","ready").register("widgets/devicePreregistration/devicePreregistrationBottomsheet",function(a,b,d,e,g,f,c){function h(a,d,e){var k=e?"SELECTED":"UNSELECTED";a+="\x26lineItemId\x3d"+d+"\x26checkboxState\x3d"+
k;f.show();b.ajax({type:"POST",url:a,dataType:"text",headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},success:function(a,b,d){f.hide();c.increaseCount("checkout:mobile:devicePreregistrationPanel:ajaxSuccess:"+k,1);g.ajaxUpdatePage(a,b,d,{pushNewFrame:"false",mixedContentFallback:"reload"})},error:function(a,b,d){f.hide();c.increaseCount("checkout:mobile:devicePreregistrationPanel:ajaxError",1);g.ajaxRedirect(a,b,d)}})}a.on("a:sheet:beforeShow",function(a){if(a.sheet&&a.sheet._preloadDomId&&
0===a.sheet._preloadDomId.indexOf("device-preregistration")){var c="#"+a.sheet._preloadDomId;b(c).data().isdevicepreregistrationbottomsheet&&(a="#"+b(c).data().checkboxidentifier,c=b(c).data().isstateselectedinorderdoc,a=e(a),c?a.check():a.uncheck())}});a.declarative("dms-rcx-prereg-bottomsheet-continue","click",function(a){var b=e("#"+a.data.checkBoxIdentifier),c=d.get(a.data.bottomSheetName),f=a.data.isStateSelectedInOrderDoc;f=b.isChecked()!==f;var g=a.data.url;a=a.data.lineItemId;f&&h(g,a,b.isChecked());
d.hideSheet(c)})});"use strict";h.when("A","jQuery","a-modal","a-checkbox","page-conductor","page-spinner-controller","client-side-metrics","ready").register("widgets/devicePreregistration/devicePreregistrationModal",function(a,b,d,e,g,f,c){function h(a){return a?"SELECTED":"UNSELECTED"}function l(a,d,e){var k=h(e);a+="\x26lineItemId\x3d"+d+"\x26checkboxState\x3d"+k;f.show();b.ajax({type:"POST",url:a,dataType:"text",headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},success:function(a,
b,d){f.hide();c.increaseCount("checkout:desktop:devicePreregistrationPanel:ajaxSuccess:"+k,1);g.ajaxUpdatePage(a,b,d,{pushNewFrame:"false",mixedContentFallback:"reload"})},error:function(a,b,d){f.hide();c.increaseCount("checkout:desktop:devicePreregistrationPanel:ajaxError",1);g.ajaxRedirect(a,b,d)}})}a.on("a:popover:beforeShow",function(a){if(a&&a.popover&&a.popover.name&&0===a.popover.name.indexOf("device-preregistration-enabled-modal")){c.increaseCount("checkout:desktop:devicePreregistrationPanel:ModalOpen",
1);var d="#"+a.popover.name;b(d).data().isdevicepreregistrationmodal&&(a="#"+b(d).data().checkboxidentifier,d=b(d).data().isstateselectedinorderdoc,a=e(a),d?a.check():a.uncheck())}});a.declarative("dms-rcx-prereg-modal-continue","click",function(a){var b=e("#"+a.data.checkBoxIdentifier),f=d.get(a.data.modalName),g=a.data.isStateSelectedInOrderDoc;g=b.isChecked()!==g;var k=a.data.url;a=a.data.lineItemId;g&&(c.increaseCount("checkout:desktop:devicePreregistrationPanel:stateChangeTo:"+h(b.isChecked()),
1),l(k,a,b.isChecked()));f.hide()})});"use strict";h.when("A","jQuery","client-side-metrics","ready").register("widgets/devicePreregistration/reftagHelper",function(a,b,d){function e(a){a&&b.get("/hctp/log/refMarker?ref_\x3d"+a)}function g(){Object.keys(f).forEach(function(a){a="PREREGISTRATION_"+a+"_C_PC_"+f[a];d.increaseCount("checkout:device:preregistration:registerState:success",1);e(a)})}var f={};return{registerState:function(a,h,l,k){null!=a&&null!=h&&null!=l&&null!=k?(h="E_"+(h?"CHECKED":"UNCHECKED"),
l&&(h="D_"+(k?"GIFTED":"OTHER")),l=h,f[a]!==l&&(f[a]=l,e("PREREGISTRATION_"+a+"_C_"+f[a])),b('input[name\x3d"placeYourOrder1"]').unbind("click",g).bind("click",g),d.increaseCount("checkout:device:preregistration:registerState:success",1)):d.increaseCount("checkout:device:preregistration:registerState:failed",1)}}});h.when("A","client-side-metrics").execute("updp-fallback-auto-click",function(a,b){function d(){var d=a.$("#prime-updp-fallback-button");d.length&&a.delay(function(){b.increaseCount("checkout:updp:fallback:clickedContinue",
1);d.click()},100)}a.on("load",d);a.on("checkout:afterReload",d)});"use strict";h.when("A","jQuery").register("widgets/customizationDetails/customizationDetails",function(a,b){a.declarative("additional-customization-details-action","click",function(a){a.$currentTarget.closest(".sc-customization-details-list").find(".sc-customization-details-additional").removeClass("aok-hidden");a.$currentTarget.closest(".sc-customization-details-see-more").hide();a.$event.preventDefault()})});"use strict";h.when("A",
"ready").register("widgets/progressIndicator/progressIndicator",function(){});"use strict";h.when("A","jQuery","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor","client-side-metrics").register("widgets/concealment/concealmentPopover",function(a,b,d,e,g,f,c){function h(){b("#spc-orders").find(".concealment-widgets-desktop").removeClass("no-js-hide");a.defer(function(){b("spc-orders").find(".concealment-popover-link").each(function(){b(this).data("action")&&b(this).removeAttr("href").attr("tabindex",
0)})})}function l(a){a.keyup(function(a){13===a.which&&b(a.target).trigger("click")})}function k(a){return a.is("input")?a:a.find("input")}function n(a){var e=a.data.popover.$popover,h="";a&&a.data&&a.data.lineItemId&&(h+="lineItemId\x3d"+a.data.lineItemId+"\x26");var n=k(e.find(".conceal-item-checkbox")).is(":checked");h=n?h+"concealmentOption\x3dCONCEALED\x26":h+"concealmentOption\x3dNOT_CONCEALED\x26";a=k(e.find(".concealment-setter-url")).val();n?c.increaseCount("CPEX.Checkout.Select.Concealment",
1):c.increaseCount("CPEX.Checkout.Cancel.Concealment",1);f.isSPP()&&(e.find(".a-button-close").trigger("click"),e=b("#setOrderingPrefsCheckbox"),e.length&&e.is(":checked")&&(h+="\x26saveAsDefaultsSelected\x3d1"));d.show();b.ajax({type:"POST",url:a,data:h,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,b,d){c.increaseCount("CPEX.Checkout.Concealment.ConcealmentEntity.Success",
1);d.getResponseHeader("x-amz-checkout-page")&&f.isSPP()?f.ajaxUpdatePage(a,b,d):(a=g.jsonify(a),f.redirect(a))},error:function(a,b,d){c.increaseCount("CPEX.Checkout.Concealment.ConcealmentEntity.Fatal",1);f.ajaxRedirect(a,b,d)}})}var r,t;b(document).delegate(".concealment-popover-link, .concealment-options-button","click",function(){c.increaseCount("CPEX.Checkout.ConcealmentOption.Button.click",1)});a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealmentPopover-")&&
(f.isSPP()&&c.increaseCount("checkout:spp-revieworder:concealment_pop_cancel_sec",1),k(r.find(".conceal-item-checkbox")).removeAttr("checked"))});a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealmentPopover-")){r=a.popover.$popover;t=a.popover;e.showSpinner(r.find(".popover-content-main"),!1,t);r.find(".content-container").css("visibility","hidden");var b=t.data.lineItemId,c=r.find(".set-concealment-options-button input");c.unbind("click").bind("click",
{lineItemId:b,popover:a.popover},n);l(c);r.find(".content-container").css("visibility","visible");e.hideSpinner(r.find(".popover-content-main"))}});a.on("checkout:reload:spc",h);a.on("checkout:reload:spp-revieworder",h)});"use strict";h.when("A","jQuery","page-transition-controller","ajax-utility","page-conductor","client-side-metrics").register("widgets/concealment/concealmentDropdown",function(a,b,d,e,g,f){a.declarative("click-concealment-dropdown","change",function(a){var c=a.data.name,e=b("[name\x3d"+
c+"-line-item-id]").val();a="CONCEALED"===a.$target.find(":selected").val();e="lineItemId\x3d"+e+"\x26";a?(e+="concealmentOption\x3dCONCEALED\x26",f.increaseCount("CPEX.Checkout.Select.Concealment",1)):(e+="concealmentOption\x3dNOT_CONCEALED\x26",f.increaseCount("CPEX.Checkout.Cancel.Concealment",1));c=b("[name\x3d"+c+"-concealment-setter-url]").val();d.show();b.ajax({type:"POST",url:c,data:e,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},
contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(){f.increaseCount("CPEX.Checkout.Concealment.ConcealmentEntity.Success",1);d.hide()},error:function(a,b,c){f.increaseCount("CPEX.Checkout.Concealment.ConcealmentEntity.Fatal",1);g.ajaxRedirect(a,b,c)}})})});"use strict";h.when("A","jQuery","client-side-metrics").execute(function(a,b,d){b(".rush-ispu-view-details-link.checkout-chewbacca-pickup-ship-option").live("click",function(){var a=b(this).data("url"),g=b(this).data("locationtype"),
f=b(this).data("bottomsheetid");a!==q&&f!==q&&b.ajax({url:a,method:"get",contentType:"application/x-www-form-urlencoded;charset\x3dUTF-8",success:function(a){b(".a-sheet-content-container #"+f).html(a);d.setCountValue("checkout:inStorePickup:"+g+":bottomSheetRenderSuccess",1)},error:function(a){b(".a-sheet-content-container #"+f).html(a.responseText);d.setCountValue("checkout:inStorePickup:"+g+":bottomSheetRenderSuccess",0)},traditional:!0})})});"use strict";h.when("A","jQuery","client-side-metrics").execute(function(a,
b,d){b(".mfn-ispu-view-details-link.checkout-chewbacca-pickup-ship-option").live("click",function(){var a=b(this).data("url"),g=b(this).data("locationtype"),f=b(this).data("bottomsheetid");a!==q&&f!==q&&b.ajax({url:a,method:"get",contentType:"application/x-www-form-urlencoded;charset\x3dUTF-8",success:function(a){b(".a-sheet-content-container #"+f).html(a);d.setCountValue("checkout:mfnInStorePickup:"+g+":bottomSheetRenderSuccess",1)},error:function(a){b(".a-sheet-content-container #"+f).html(a.responseText);
d.setCountValue("checkout:mfnInStorePickup:"+g+":bottomSheetRenderSuccess",0)},traditional:!0})})});"use strict";h.when("A","jQuery","a-sheet","page-spinner-controller","page-conductor","client-side-metrics","configurations/keys","configurations/newCheckoutExperienceConfig").register("widgets/concealment/concealmentBottomsheet",function(a,b,d,e,g,f,c,h){var l=h.getConfiguration(c.CONTAINER_SELECTOR);a.declarative("click-concealment-radiogroup","change",function(a){var c=a.data.name,h=b("[name\x3d"+
c+"-line-item-id]").val(),k=b("[name\x3d"+c+"-concealment-setter-url]").val(),l="CONCEALED"===a.$target[0].value;a="";var p=d.get(c),q=b("[id\x3d"+c+"-concelment-can-overwrap-concealed-text]"),v=b("[id\x3d"+c+"-concelment-can-overwrap-text]");a+="lineItemId\x3d"+h+"\x26";l?(a+="concealmentOption\x3dCONCEALED\x26",f.setCountValue("CPEX.NewCheckoutExp.Select.Concealment",1)):(a+="concealmentOption\x3dNOT_CONCEALED\x26",f.setCountValue("CPEX.NewCheckoutExp.Cancel.Concealment",1));e.show();b.ajax({type:"POST",
url:k,data:a,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(){f.setCountValue("CPEX.NewCheckoutExp.Concealment.ConcealmentEntity.Success",1);d.hideSheet(p);q.toggleClass("aok-hidden",!l);v.toggleClass("aok-hidden",l);e.hide()},error:function(a,b,c){f.setCountValue("CPEX.NewCheckoutExp.Concealment.ConcealmentEntity.Fatal",1);d.hideSheet(p);g.ajaxRedirect(a,
b,c)}})});a.on("a:sheet:beforeShow",function(c){if(c.sheet&&c.sheet._name&&0===c.sheet._name.indexOf("concealmentbottomsheet-")){var d=c.sheet.getContentContainer();c="#"+c.sheet._name+"-concealment-bottom-sheet-content";d=d.find(c);var e=a.$(l).find(c).html();e!==q&&null!==e&&(d.empty(),d.html(e),b(c).remove())}})});"use strict";h.when("A","jQuery","page-conductor","client-side-metrics").register("widgets/concealment/concealmentDropdownNewExp",function(a,b,d,e){a.declarative("click-concealment-dropdown-newexp",
"change",function(a){var f=a.data.name,c=b("[name\x3d"+f+"-line-item-id]").val();f=b("[name\x3d"+f+"-concealment-setter-url]").val();a="CONCEALED"===a.$target.find(":selected").val();c="lineItemId\x3d"+c+"\x26";a?(c+="concealmentOption\x3dCONCEALED\x26",e.setCountValue("CPEX.NewCheckoutExp.Select.Concealment",1)):(c+="concealmentOption\x3dNOT_CONCEALED\x26",e.setCountValue("CPEX.NewCheckoutExp.Cancel.Concealment",1));d.ajaxUpdate(f,c).done(function(){e.setCountValue("CPEX.NewCheckoutExp.Concealment.ConcealmentEntity.Success",
1)}).fail(function(){e.setCountValue("CPEX.NewCheckoutExp.Concealment.ConcealmentEntity.Fatal",1)})})});"use strict";h.when("A","jQuery","client-side-metrics","ready").register("widgets/taxRegistration/taxRegistration",function(a,b,d){function e(){var a=b(k.taxRegistrationNumberInput).val();b(k.taxRegistrationNumberInput).val(a.replace(l,""))}function g(){var a=b(k.businessLegalNameInput).val();b(k.businessLegalNameInput).val(a.trim())}function f(a){return!a||0===a.toString().length}function c(){var a=
b(k.taxRegistrationNumberInput).val();var c=b(k.businessLegalNameInput).val().trim();if(f(a)&&f(c))a=!0;else{var d=b(k.taxAddressRadio).length?b(k.taxAddressRadio+":checked").val():b(k.taxAddressSelection).val();a=f(a)||!h.test(a)||f(c)||f(d)?!1:!0}a?b(k.continueButton).removeClass("a-button-disabled").find('input[type\x3d"submit"]').removeAttr("disabled"):b(k.continueButton).addClass("a-button-disabled").find('input[type\x3d"submit"]').attr("disabled","disabled")}var h=/^\d{11}$/,l=/\s+/g,k={taxAddressForm:"#taxAddressFormId",
taxRegistrationNumberInput:"#tax-registration-number-field-tr",businessLegalNameInput:"#business-legal-name-tr",taxAddressRadio:'input:radio[name\x3d"taxaddressid"]',taxAddressSelection:"#taxaddressid",continueButton:"span.#continue-submit-span"};a.declarative("tax-registration-number-input","click keyup",function(a){e();g();c()});a.declarative("tax-registration-legal-name-input","click keyup",function(a){e();c()});a.declarative("tax-registration-form","submit",function(a){f(b(k.taxRegistrationNumberInput).val())&&
f(b(k.businessLegalNameInput).val())&&(a=b(k.taxAddressForm).attr("action"),b(k.taxAddressForm).attr("action",a.split("?")[0]),d.increaseCount("checkout:taxRegistrationForm:emptyValues",1));g()})});"use strict";h.when("A","jQuery","client-side-metrics","page-conductor").register("widgets/taxExemptionPreference/taxExemptionPreference",function(a,b,d,e){function g(a,b,g){e.ajaxUpdate(b,{lineItemId:a,optOut:g}).done(function(){d.increaseCount("checkout:selectTaxExemptionPreference:purchaseDocUpdateSuccess",
1)}).fail(function(){d.increaseCount("checkout:selectTaxExemptionPreference:purchaseDocUpdateFailed",1)})}a.declarative("change-tax-exemption-preference",["click","touchend"],function(a){g(a.data.lineItemId,a.data.setActionUrl,"APPLIED"===a.data.taxExemptionAppliedStatus)})});"use strict";h.when("A","client-side-metrics","weblab-helper","ready").register("widgets/warrantyTermsAndConditions/warrantyTermsAndConditions",function(a,b,d){d.isWarrantyTermsAndConditionsEnabled()&&a.declarative("checkout-warranty-tnc-click",
"click",function(a){b.increaseCount("checkout:spc:warrantyTermsAndConditions:"+a.data.documentType+":click",1)})});"use strict";h.when("jQuery","ready").register("widgets/secureDelivery/recommenderOverlay",function(a){a(document.documentElement).delegate("#secureDeliveryRecommenderMessageBodyContent a","click",function(b){a("#secure-delivery-recommender-modal-trigger").click();b.preventDefault()})});"use strict";h.when("A","widgets/secureDelivery/recommenderSendUpdateCommon","ready").register("widgets/secureDelivery/recommenderCheckbox",
function(a,b){function d(){return JSON.parse(e('input[name\x3d"secureDeliveryRecommenderLineItems"]').val()||"[]")}var e=a.$;a.on("checkout:reload",function(){var a=d().some(function(a){return a.isPincodeRequired});e("#secureDeliveryRecommenderMessageCheckbox").prop("checked",a)});e(document.documentElement).delegate("#secureDeliveryRecommenderMessageCheckbox","click",function(a){var f=d().reduce(function(b,d){b[d.base64EncodedMIQ]=e(a.currentTarget).is(":checked");return b},{});b.sendUpdate(f)})});
"use strict";h.when("jQuery","page-conductor","page-spinner-controller").register("widgets/secureDelivery/recommenderSendUpdateCommon",function(a,b,d){return{sendUpdate:function(e){var g=a('input[name\x3d"setSecureDeliveryPreferenceUrl"]').val(),f=Object.keys(e).filter(function(a){return!0===e[a]}).join(),c=Object.keys(e).filter(function(a){return!1===e[a]}).join();d.show();return a.ajax({type:"POST",url:g,data:{enableOtpRecommenderLineItems:f,disableOtpRecommenderLineItems:c},dataType:"text",headers:b.setAjaxTransitionHeader(),
success:function(a,c,d){b.ajaxUpdatePage(a,c,d)},error:function(a,c,d){b.ajaxRedirect(a,c,d)}})}}});"use strict";h.when("A","a-sheet","ready").register("widgets/unifiedFinancingOffers/orderSummaryBottomsheet",function(a,b){var d=a.$;a.on("a:sheet:beforeShow:installmentPlanBottomSheet",function(a){if(a.sheet&&a.sheet._name&&"installmentPlanBottomSheet"===a.sheet._name){a=a.sheet.getContentContainer().find("#installment-plan-details-bottom-sheet");var b=d("#installment-plan-messages-order-summary").find("#installment-plan-details-bottom-sheet").html();
b!==q&&null!==b&&(a.empty(),a.html(b),d("#installment-plan-details-bottom-sheet").remove())}})});"use strict";h.when("A").register("widgets/unattendedAlcoholDelivery/unattendedAlcoholDeliveryCheckbox",function(a){});"use strict";h.when("jQuery").register("widgets/unattendedAlcoholDelivery/unattendedAlcoholDeliverySendUpdate",function(a){});"use strict";h.when("A","count-down-controller","weblab-helper","ready").register("widgets/itemBlocks/itemDealBadge",function(a,b,d){a.on("checkout:reload:spc",
function(){if(d.isDealBadgeEnabled()||d.isDealBadgeEnabledForIngress()){var e=document.querySelectorAll('[data-component\x3d"deal-badge"] .amazon-api-rc-count-down-timer');a.each(e,function(a){b.countDown(a)})}})});"use strict";h.when("A","a-sheet").execute("ReturnPolicyBadgeBottomSheet",function(a,b){a.declarative("return-policy-badge-bottom-sheet","click",function(a){a=b.create({name:"return-policy-badge-bottom-sheet",preloadDomId:"return-policy-badge-bottom-sheet-content",height:1,closeType:"icon"});
b.showSheet(a)});a.on("a:sheet:afterShow:return-policy-badge-bottom-sheet",function(a){a.sheet.changeHeight({height:200,duration:.1})});a.on("a:sheet:afterHide:return-policy-badge-bottom-sheet",function(a){a.sheet.changeHeight({height:1})})})});