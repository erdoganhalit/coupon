(function(l){var m=window.AmazonUIPageJS||window.P,g=m._namespace||m.attributeErrors,a=g?g("VasCheetahAssets",""):m;a.guardFatal?a.guardFatal(l)(a,window):a.execute(function(){l(a,window)})})(function(l,m,g){l.register("VasConfig",function(){return{EVENTS:{BOTTOM_SHEET_AFTER_HIDE_EVENT_PREFIX:"a:sheet:afterHide:",RTU_SLOT_CONFIRM_EVENT:"uds:unifiedcalendar:confirmslotevent",SERVICES_SLOT_CONFIRM_EVENT:"services:unifiedcalendar:confirmslotevent",CHECKOUT_SHIP_OPTION_EVENT:"checkout-select-delivery-slots",
CALENDAR_BOTTOM_SHEET_HIDE_EVENT:"a:sheet:afterHide:unified-calendar-sheet",SERVICE_ADDONS_CALENDAR_LINK_EVENT:"service-addons-calendar-link",SERVICE_ADDONS_SLOT_CONFIRM_EVENT:"serviceAddons:unifiedCalendar:confirmSlotEvent",SERVICE_ADDONS_CHECKBOX_EVENT:"service-addons-checkbox",SERVICE_ADDONS_UPDATE_ORDER_EVENT:"service-addons-update-order",RTU_SERVICES_PERSISTENCE_EVENT:"rtu:servicesPersistence",SERVICE_ADDONS_LINK_EVENT:"service-addons-link",SERVICE_SCOPE_OF_WORK_DETAILS_EVENT:"service-scope-of-work-details",
NOTIFICATION_PREFERENCES_CHECKBOX_EVENT:"notification-preferences-checkbox"},METRICS:{EVENT_UNDEFINED:"checkout:vas:eventUndefined",EVENT_DATA_UNDEFINED:"checkout:vas:eventDataUndefined",GET_SERVICE_DEFAULTING_DELIVERY_OPTION_STATE_FAILED_COUNTER:"Checkout:VasDeliveryOptionDefaulting:GetDeliveryOptionState:Failed",GET_SERVICE_DEFAULTING_SET_ACTION_URL_FAILED_COUNTER:"Checkout:VasDeliveryOptionDefaulting:GetSetActionUrl:Failed",CREATE_SERVICE_DEFAULTING_PAYLOAD_FAILED_COUNTER:"Checkout:VasDeliveryOptionDefaulting:CreatePayload:Failed",
SET_SERVICE_DEFAULTING_AJAX_CALL_COUNTER:"Checkout:VasDeliveryOptionDefaulting:ajaxCall",SET_SERVICE_DEFAULTING_AJAX_CALL_SUCCESS_COUNTER:"Checkout:VasDeliveryOptionDefaulting:ajaxCall:Success",SET_SERVICE_DEFAULTING_AJAX_CALL_FAILED_COUNTER:"Checkout:VasDeliveryOptionDefaulting:ajaxCall:Failed",SERVICE_DEFAULTING_AJAX_CALL_MAX_RETRY_BREACHED_COUNTER:"Checkout:VasDeliveryOptionDefaulting:ajaxCall:MaxRetryBreached",SERVICE_DEFAULTING_AJAX_CALL_RETRIED_COUNTER:"Checkout:VasDeliveryOptionDefaulting:ajaxCall:Retried",
SERVICE_DEFAULTING_AJAX_CALL_TIMEOUT_BREACHED_COUNTER:"Checkout:VasDeliveryOptionDefaulting:ajaxCall:TimeoutBreached",BATCH_SETTER_REDIRECTED_TO_SORRY_PAGE:"Checkout:VasDeliveryOptionDefaulting:RedirectedToSorryPage",SERVICES_DELIVERY_INFO_PERSISTENCE_TRIGGER_SUCCESS:"Checkout:VasDeliveryInfoPersistenceTrigger:Services:Success",SERVICES_DELIVERY_INFO_PERSISTENCE_TRIGGER_FAIL:"Checkout:VasDeliveryInfoPersistenceTrigger:Services:Failed",RTU_DELIVERY_INFO_PERSISTENCE_TRIGGER_SUCCESS:"Checkout:VasDeliveryInfoPersistenceTrigger:RTU:Success",
RTU_DELIVERY_INFO_PERSISTENCE_TRIGGER_FAIL:"Checkout:VasDeliveryInfoPersistenceTrigger:RTU:Failed",RTU_PERSISTENCE_GDO_POSTDATA_PARSING_FAILURE:"checkout:vasDeliveryInfoPersistenceTrigger:RTU:gdoPersistenceInfoParsing:failure",RTU_PERSISTENCE_SELECTED_SLOT_IDS_MISSING:"checkout:vasDeliveryInfoPersistenceTrigger:RTU:slectedSlotIdsMissing",SERVICE_ADDON_ATTRIBUTE_UNDEFINED:"checkout:serviceAddons:attributeUndefined",SERVICE_ADDON_SELECTED_SLOT_IDS_EMPTY:"checkout:serviceAddons:selectedSlotIdsEmpty",
SERVICE_ADDON_PERSISTENCE_INFO_PARSING_ERROR:"checkout:serviceAddons:persistenceInfo:parsingFailure",SERVICE_SCOPE_OF_WORK_BASE_SHEET_UNDEFINED:"checkout:serviceScopeOfWork:baseSheetUndefined",NOTIFICATION_PREFERENCES_CHECKBOX_TRIGGERED:"checkout:notificationPreferences:checkbox:triggerred",NOTIFICATION_PREFERENCES_CHECKBOX_SELECTED:"checkout:notificationPreferences:checkbox:selected",NOTIFICATION_PREFERENCES_CHECKBOX_DESELECTED:"checkout:notificationPreferences:checkbox:deselected"},ERRORS:{DEFAULTING_AJAX_CALL_FAILED_ERROR:"Defaulting Batch Setter Ajax Call Failed",
DEFAULTING_AJAX_CALL_TIMEOUT_BREACHED_ERROR:"Timeout breached for defaulting batch setter ajax call",DEFAULTING_AJAX_CALL_MAX_RETRY_ATTEMPT_BREACHED_ERROR:"Max Retry Attempt Breached for defaulting batch setter ajax call for input: ",DEFAULTING_PAYLOAD_CREATION_FAILED_ERROR:"Failed to create payload for services defaulting batch setter ajax call",DEFAULTING_UNKNOWN_EXCEPTION:"Unknown exception occurred for defaulting for input: "},TIMEOUTS:{BATCH_SETTER_AJAX_TIMEOUT_IN_MILLIS:4E4}}});"use strict";
l.when("A").register("vas-logger",function(a){return{logMetric:function(a,c){if("undefined"!==typeof m.ue&&"undefined"!==typeof a&&"undefined"!==typeof m.ue.count){var d=m.ue.count(a)||0;m.ue.count(a,d+(c||1))}},logException:function(a,c){"undefined"!==typeof m.ueLogError&&m.ueLogError(a,c);m.console&&m.console.error&&m.console.error(a,c.attribution)},LOG_LEVELS:{ERROR:"ERROR",FATAL:"FATAL"}}});"use strict";l.when("A","jQuery","vas-logger","VasConfig").register("service-addons-helper",function(a,
h,c,d){function f(a){try{var b=JSON.parse(a.getAttribute("data-postdata"))}catch(k){c.logException(k,{name:"service-addons-error",logLevel:"FATAL",attribution:"service-addons-error",message:"Error while parsing persistence info for service addons"}),c.logMetric(d.METRICS.SERVICE_ADDON_PERSISTENCE_INFO_PARSING_ERROR,1)}return b}function e(a,b,k){a=a[b];a===g&&(c.logException(["serviceAddOnsEvent",b,"validation"].join(" "),{name:["serviceAddOnsEventData",b,"undefined"].join(" "),logLevel:"ERROR",attribution:"service-addons-error",
message:b.concat("is undefined")}),c.logMetric([d.METRICS.SERVICE_ADDON_ATTRIBUTE_UNDEFINED,b,k].join(":"),1));return a}return{getLineItemIndex:function(a,b){return e(a.data,"lineItemIndex",b)},getServiceAddonVariant:function(a,b){return e(a.data,"serviceAddonVariant",b)},getCalendarId:function(a,b){return e(a.data,"calendarId",b)},getSlotIdToSlotMap:function(a,b){return e(a.data,"slotIdToSlotMap",b)},getSelectedSlotId:function(a,b){return a===g?(c.logException("serviceAddOnsEvent selectedSlotIds validation",
{name:"serviceAddOns-selectedSlotIds-undefined",logLevel:"ERROR",attribution:"service-addons-error",message:"selectedSlotIds are undefined"}),c.logMetric([d.METRICS.SERVICE_ADDON_ATTRIBUTE_UNDEFINED,"selectedSlotIds",b].join(":"),1),g):0===a.length?(c.logException("serviceAddOnsEvent selectedSlotIds validation",{name:"serviceAddOns-selectedSlotIds-empty",logLevel:"ERROR",attribution:"service-addons-error",message:"selectedSlotIds are empty"}),c.logMetric([d.METRICS.SERVICE_ADDON_SELECTED_SLOT_IDS_EMPTY,
b].join(":"),1),g):a[0]},getPersistenceInfo:function(a){var b={services:[]};h(a).each(function(a,c){a=h("#".concat(c.id,"-container"))[0];(a=f(a))&&a.services&&(b.services=b.services.concat(a.services))});return b},updateSelectedSlots:function(a,b){if(b&&0<b.length){var c=h(["#service-addons-checkbox",a,"container"].join("-"))[0],d=f(c);d&&d.services&&0<d.services.length&&(d.services.forEach(function(c){var d=btoa(c.serviceId).replace(/=/g,"");0<=a.indexOf(d)&&(c.slotIds=b)}),c.setAttribute("data-postdata",
JSON.stringify(d)))}}}});"use strict";l.when("vas-logger","VasConfig").register("vas-event-helper",function(a,h){return{isInvalidEvent:function(c,d){return c===g?(a.logException("Event validation",{name:"event-undefined",logLevel:"ERROR",attribution:"vas-event-error",message:"event undefined"}),a.logMetric([h.METRICS.EVENT_UNDEFINED,d].join(":"),1),!0):c.data===g?(a.logException("EventData validation",{name:"event-data-undefined",logLevel:"ERROR",attribution:"vas-event-error",message:"event data undefined"}),
a.logMetric([h.METRICS.EVENT_DATA_UNDEFINED,d].join(":"),1),!0):!1}}});"use strict";l.register("vas-rtu-helper",function(){return{getConsolidatedPostData:function(a,h){a=JSON.parse(JSON.stringify(a));if(a.deliveryPersistenceInformation===g)return a.deliveryPersistenceInformation={ReadyToUseServicePersistenceInfo:h},a;if(a.deliveryPersistenceInformation.ReadyToUseServicePersistenceInfo===g)return a.deliveryPersistenceInformation.ReadyToUseServicePersistenceInfo=h,a;if(a.deliveryPersistenceInformation.ReadyToUseServicePersistenceInfo.services===
g)return a.deliveryPersistenceInformation.ReadyToUseServicePersistenceInfo.services=h.services,a;a.deliveryPersistenceInformation.ReadyToUseServicePersistenceInfo.services=a.deliveryPersistenceInformation.ReadyToUseServicePersistenceInfo.services.concat(h.services);return a}}});"use strict";l.when("A","jQuery","VasConfig","vas-logger","page-conductor","vas-rtu-helper").register("events/groupDeliveryOption/rtuDeliveryInfoPersistenceEvents",function(a,h,c,d,f,e){a.on(c.EVENTS.RTU_SLOT_CONFIRM_EVENT,
function(e){var b=h("#"+e.calendarId+"-vas-uds-delivery-persistence-info").children("script");try{var k=JSON.parse(b.text())}catch(u){d.logException(u,{name:"vas-checkout-rtu-delivery-info-persistence-error",logLevel:"FATAL",attribution:"vas-checkout-rtu-delivery-info-persistence",message:"Failed to create payload for RTU delivery info persistence"}),d.logMetric(c.METRICS.RTU_DELIVERY_INFO_PERSISTENCE_TRIGGER_FAIL,1),f.ajaxSorryPage()}k.data.postdata.deliveryPersistenceInformation.UnifiedDeliveryAndServicePersistenceInfo.slotIds=
e.selectedSlots;k.data.isselected=!1;d.logMetric(c.METRICS.RTU_DELIVERY_INFO_PERSISTENCE_TRIGGER_SUCCESS,1);a.trigger(c.EVENTS.CHECKOUT_SHIP_OPTION_EVENT,k.data)});a.on(c.EVENTS.RTU_SERVICES_PERSISTENCE_EVENT,function(g){var b=g.rtuPersistenceInfo,k=h("#service-addons-gdo-persistence-info-".concat(g.lineItemIndex));g=k.attr("data-setactionurl");try{var l=JSON.parse(k.attr("data-postdata"))}catch(n){d.logException(n,{name:"rtu-delivery-info-persistence-error",logLevel:"FATAL",attribution:"rtu-persistence-error",
message:"Failed to create payload for rtu delivery info persistence"});d.logMetric(c.METRICS.RTU_PERSISTENCE_GDO_POSTDATA_PARSING_FAILURE,1);f.ajaxSorryPage();return}b=e.getConsolidatedPostData(l,b);a.trigger(c.EVENTS.CHECKOUT_SHIP_OPTION_EVENT,{isSelected:!1,setactionurl:g,postdata:b})})});"use strict";l.when("A","jQuery","VasConfig","vas-logger","page-conductor").register("events/groupDeliveryOption/serviceDeliveryInfoPersistenceEvents",function(a,h,c,d,f){a.on(c.EVENTS.SERVICES_SLOT_CONFIRM_EVENT,
function(e){var g=h("#"+e.calendarId+"-vas-services-delivery-persistence-info").children("script");try{var b=JSON.parse(g.text())}catch(k){d.logException(k,{name:"vas-checkout-services-delivery-info-persistence-error",logLevel:"FATAL",attribution:"vas-checkout-services-delivery-info-persistence",message:"Failed to create payload for Services delivery info persistence"}),d.logMetric(c.METRICS.SERVICES_DELIVERY_INFO_PERSISTENCE_TRIGGER_FAIL,1),f.ajaxSorryPage()}b.data.postdata.deliveryPersistenceInformation.ServicePersistenceInfo.slotIds=
e.selectedSlots;b.data.isselected=!1;d.logMetric(c.METRICS.SERVICES_DELIVERY_INFO_PERSISTENCE_TRIGGER_SUCCESS,1);a.trigger(c.EVENTS.CHECKOUT_SHIP_OPTION_EVENT,b.data)})});"use strict";l.when("A","jQuery","VasConfig","vas-event-helper","service-addons-helper","unifiedCalendarInstanceManager","ready").register("events/serviceAddons",function(a,g,c,d,f,e){function h(a){a=["#service-addons-content-",a," input[type\x3dcheckbox]:checked"].join("");return f.getPersistenceInfo(a)}a.declarative(c.EVENTS.SERVICE_ADDONS_CHECKBOX_EVENT,
"change",function(b){var e=c.EVENTS.SERVICE_ADDONS_CHECKBOX_EVENT.concat(":Desktop");d.isInvalidEvent(b,e)||(b=f.getLineItemIndex(b,e),e=h(b),a.trigger(c.EVENTS.RTU_SERVICES_PERSISTENCE_EVENT,{lineItemIndex:b,rtuPersistenceInfo:e}))});a.declarative(c.EVENTS.SERVICE_ADDONS_CALENDAR_LINK_EVENT,"click",function(b){var k=c.EVENTS.SERVICE_ADDONS_CALENDAR_LINK_EVENT.concat(":Desktop");if(!d.isInvalidEvent(b,k)){b.$event.stopPropagation();e.showCalendar(b);var l=f.getServiceAddonVariant(b,k),m=f.getLineItemIndex(b,
k),t=f.getCalendarId(b,k);a.off(c.EVENTS.SERVICE_ADDONS_SLOT_CONFIRM_EVENT);a.on(c.EVENTS.SERVICE_ADDONS_SLOT_CONFIRM_EVENT,function(){var b=e.getSelectedSlotIds(t),d=["#service-addons-checkbox",l].join("-"),k=g(d).is(":checked"),q=f.getPersistenceInfo(d);d=h(m);k||(d.services=d.services.concat(q.services));0<q.services.length&&d.services.forEach(function(a){a.serviceId===q.services[0].serviceId&&(a.slotIds=b)});a.trigger(c.EVENTS.RTU_SERVICES_PERSISTENCE_EVENT,{lineItemIndex:m,rtuPersistenceInfo:d})})}})});
"use strict";l.when("A","jQuery","page-transition-controller","page-conductor","VasConfig","vas-logger","ready").register("events/defaulting/defaultingSetterController",function(a,h,c,d,f,e){function l(a,b,c){c===g&&(c="Defaulting Batch Setter Exception");e.logException(c,{name:"vas-checkout-services-defaulting-batch-setter",logLevel:b,attribution:"vas-checkout-services-defaulting-batch-setter-error",message:a})}function b(a,b,c){l(a,b,c);e.logMetric(f.METRICS.BATCH_SETTER_REDIRECTED_TO_SORRY_PAGE,
1);d.ajaxSorryPage()}function k(a){return-1===a.indexOf("eligibleshipoption")?(e.logMetric(f.METRICS.GET_SERVICE_DEFAULTING_SET_ACTION_URL_FAILED_COUNTER,1),""):a.replace("eligibleshipoption","eligibleshipoptions")}function m(a){["lineItems","parameters"].forEach(function(b){a.hasOwnProperty(b)&&"string"===typeof a[b]&&(a[b]=JSON.parse(a[b]))});return a}function n(){var a=[],b="",c={payload:[],setActionUrl:""};try{var d=h("[data-action\x3d'checkout-select-ship-option-radio'] div[data-isselected\x3d'true']");
if(0===d.length)return e.logMetric(f.METRICS.GET_SERVICE_DEFAULTING_DELIVERY_OPTION_STATE_FAILED_COUNTER,1),c;d.each(function(b,c){a.push(m(JSON.parse(c.getAttribute("data-postdata"))))});0<d.length&&(b=k(d[0].getAttribute("data-setactionurl")));return{payload:JSON.stringify(a),setActionUrl:b}}catch(w){return l(f.ERRORS.DEFAULTING_PAYLOAD_CREATION_FAILED_ERROR,e.LOG_LEVELS.ERROR,w),c}}function r(){try{if(0<h("input[name\x3d'needServiceOptionsUpdate'][value\x3d'true']").length){p+=1;1<p&&e.logMetric(f.METRICS.SERVICE_DEFAULTING_AJAX_CALL_RETRIED_COUNTER.concat(":",
p),1);var a=n();3<p&&(e.logMetric(f.METRICS.SERVICE_DEFAULTING_AJAX_CALL_MAX_RETRY_BREACHED_COUNTER,1),b(f.ERRORS.DEFAULTING_AJAX_CALL_MAX_RETRY_ATTEMPT_BREACHED_ERROR+JSON.stringify(a),e.LOG_LEVELS.FATAL));e.logMetric(f.METRICS.SET_SERVICE_DEFAULTING_AJAX_CALL_COUNTER,1);var g=setInterval(function(){d.isAnimating()||(clearInterval(g),c.hide(),c.show())},50),k=setTimeout(function(){clearInterval(g);e.logMetric(f.METRICS.SERVICE_DEFAULTING_AJAX_CALL_TIMEOUT_BREACHED_COUNTER,1);b(f.ERRORS.DEFAULTING_AJAX_CALL_TIMEOUT_BREACHED_ERROR,
e.LOG_LEVELS.FATAL)},f.TIMEOUTS.BATCH_SETTER_AJAX_TIMEOUT_IN_MILLIS);d.ajaxUpdate(a.setActionUrl,{requests:a.payload}).done(function(){clearInterval(g);clearTimeout(k);c.hide();e.logMetric(f.METRICS.SET_SERVICE_DEFAULTING_AJAX_CALL_SUCCESS_COUNTER,1)}).fail(function(){e.logMetric(f.METRICS.SET_SERVICE_DEFAULTING_AJAX_CALL_FAILED_COUNTER,1);b(f.ERRORS.DEFAULTING_AJAX_CALL_FAILED_ERROR,e.LOG_LEVELS.FATAL)})}else p=0}catch(v){b(f.ERRORS.DEFAULTING_UNKNOWN_EXCEPTION+JSON.stringify(a),e.LOG_LEVELS.FATAL,
v)}}var p=0;a.each(["checkout:reload:spc","checkout:reload:spp-revieworder"],function(b){a.off(b,r);a.on(b,r)})});"use strict";l.when("A","jQuery","VasConfig","vas-logger","page-conductor").register("events/notificationPreferences/notificationPreferencesConsent",function(a,h,c,d,f){a.declarative(c.EVENTS.NOTIFICATION_PREFERENCES_CHECKBOX_EVENT,["change"],function(a){d.logMetric(c.METRICS.NOTIFICATION_PREFERENCES_CHECKBOX_TRIGGERED,1);var e=a.$target.context.checked;e?d.logMetric(c.METRICS.NOTIFICATION_PREFERENCES_CHECKBOX_SELECTED,
1):d.logMetric(c.METRICS.NOTIFICATION_PREFERENCES_CHECKBOX_DESELECTED,1);try{var b=a.data.preferenceId.split("#")[1];if(b===g||""===b)throw Error("ChannelType id is undefined");}catch(n){d.logException(n,{name:"notificationPreferencesEventData-channelType-undefined",logLevel:"ERROR",attribution:"vas-checkout-notification-preferences-error",message:"channelType is undefined while invoking notification preferences setter"}),f.ajaxSorryPage()}var k=a.data.actionUrl;k===g&&(d.logException("notification preferences actionUrl validation",
{name:"notificationPreferencesEventData-actionUrl-undefined",logLevel:"ERROR",attribution:"vas-checkout-notification-preferences-error",message:"actionUrl is undefined while invoking notification preferences setter"}),f.ajaxSorryPage());try{var h=a.data.preferenceId.split("#")[0];if(h===g||""===h)throw Error("lineItemId id is undefined");}catch(n){d.logException(n,{name:"notificationPreferencesEventData-lineItemId-undefined",logLevel:"ERROR",attribution:"vas-checkout-notification-preferences-error",
message:"lineItemId is undefined while invoking notification preferences setter"}),f.ajaxSorryPage()}f.ajaxUpdate(k,{id:b,lineItemId:h,isCustomerOptedIn:e})})})});