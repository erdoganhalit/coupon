(function(c){var g=window.AmazonUIPageJS||window.P,h=g._namespace||g.attributeErrors,a=h?h("WidgetStreamer",""):g;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,g,h){c.when("jQuery","widget-streamer-action-ws-append","widget-streamer-action-ws-prepend","widget-streamer-action-ws-update","widget-streamer-action-ws-event").register("widget-streamer-actions",function(a,d,f,b,e){var c={"ws-append":d,"ws-prepend":f,"ws-update":b,"ws-event":e},k={execute:a.noop};
return{create:function(e){var b=k;if(a.isArray(e)&&e.length&&e[0]){b=e[0];var f=c[b];var d="widget-streamer-action-"+b;if("function"!==typeof f)throw Error("Action: "+b+" is not supported. Register component "+d+" to handle this action");b=f(e)}return b}}});"use strict";c.register("widget-streamer-jquery-action",function(){return function(a,d,f){if(!a||3>a.length)throw Error("Can not create update action, insufficient data in chunk: "+JSON.stringify(a));var b=a[1];var e=a[2];return{execute:function(a){var c=
a._$target.find(b).add(a._$target.filter(b));a._isTargetUpdated?f(c,e):d(c.get(0),e)}}}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-update",function(a){return function(d){return a(d,function(a,b){a.innerHTML=b},function(a,b){a.html(b)})}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-append",function(a){return function(d){return a(d,function(a,b){a.innerHTML+=b},function(a,b){a.append(b)})}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-prepend",
function(a){return function(d){return a(d,function(a,b){a.innerHTML=b+a.innerHTML},function(a,b){a.prepend(b)})}});c.register("widget-streamer-action-ws-event",function(){return function(a){var d=a[1];try{var c=JSON.parse(a[2])}catch(b){c=null}return{execute:function(a){a._emitEvent(d,c)}}}});"use strict";c.register("widget-streamer-utils",function(){return{isStreamingAjax:function(a){if(a&&"function"===typeof a.getResponseHeader)a=a.getResponseHeader("Content-Type");else if(a&&a.http&&"function"===
typeof a.http.getResponseHeader)a=a.http.getResponseHeader("Content-Type");else throw Error("Unable to retrive headers for the given xhr object: "+a);return"application/json-amazonui-streaming"===a}}});"use strict";c.when("A","jQuery","widget-streamer-actions").register("widget-streamer",function(a,c,f){function b(a){a=a||{};this._$originalTarget=a.$target;this._$target=a.$target.clone();this._actions=[];this._isExecutable="undefined"===typeof a.immediateExecution||a.immediateExecution;this._onUpdate=
a.onUpdate||c.noop;this._hasExecutionStarted=!1;this._events=a.events||{};this._isTargetUpdated=!1;this._updateTriggerEvent=a.updateTriggerEvent;this.chunkHandler=c.proxy(this.chunkHandler,this)}b.prototype.chunkHandler=function(a){a=f.create(a);this._actions.push(a);this.executeActions()};b.prototype.enableExecution=function(){this._isExecutable=!0;this.executeActions()};b.prototype.executeActions=function(){var a;if(this._isExecutable&&this._actions.length)for(this._hasExecutionStarted||(this._hasExecutionStarted=
!0,this._updateTriggerEvent||this._updateTarget()),a=this._actions.shift();a;)a.execute(this),a=this._actions.shift()};b.prototype._emitEvent=function(a,b){var d=(this._events||{})[a]||c.noop;a===this._updateTriggerEvent&&this._updateTarget(b);d.call(this,b)};b.prototype._updateTarget=function(){this._onUpdate.apply(this,arguments);this._$originalTarget.html(this._$target.html());this._$target=this._$originalTarget;this._isTargetUpdated=!0};return function(a){return new b(a)}})});
/* ******** */
(function(r){var q=window.AmazonUIPageJS||window.P,G=q._namespace||q.attributeErrors,ta=G?G("CheckoutCommonAsset",""):q;ta.guardFatal?ta.guardFatal(r)(ta,window):ta.execute(function(){r(ta,window)})})(function(r,q,G){r.register("polyfill-indexof",function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(a,m){if(null==this)throw new TypeError('"this" is null or not defined');var k=Object(this),e=k.length>>>0;if(0===e)return-1;m=+m||0;Infinity===Math.abs(m)&&(m=0);if(m>=e)return-1;for(m=
Math.max(0<=m?m:e-Math.abs(m),0);m<e;){if(m in k&&k[m]===a)return m;m++}return-1})});"use strict";r.register("polyfill-filter",function(){Array.prototype.filter||(Array.prototype.filter=function(a){if(void 0===this||null===this)throw new TypeError;var m=Object(this),k=m.length>>>0;if("function"!==typeof a)throw new TypeError;for(var e=[],f=2<=arguments.length?arguments[1]:void 0,g=0;g<k;g++)if(g in m){var l=m[g];a.call(f,l,g,m)&&e.push(l)}return e})});"use strict";r.register("polyfill-json-stringify",
function(){"object"!==typeof JSON&&(JSON={});(function(){function a(a){return 10>a?"0"+a:a}function m(){return this.valueOf()}function k(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=v[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function e(a,b){var d=h,c=b[a];c&&"object"===typeof c&&"function"===typeof c.toJSON&&(c=c.toJSON(a));"function"===typeof x&&(c=x.call(b,a,c));switch(typeof c){case "string":return k(c);case "number":return isFinite(c)?
String(c):"null";case "boolean":case "null":return String(c);case "object":if(!c)return"null";h+=p;var l=[];if("[object Array]"===Object.prototype.toString.apply(c)){var f=c.length;for(a=0;a<f;a+=1)l[a]=e(a,c)||"null";b=0===l.length?"[]":h?"[\n"+h+l.join(",\n"+h)+"\n"+d+"]":"["+l.join(",")+"]";h=d;return b}if(x&&"object"===typeof x)for(f=x.length,a=0;a<f;a+=1){if("string"===typeof x[a]){var g=x[a];(b=e(g,c))&&l.push(k(g)+(h?": ":":")+b)}}else for(g in c)Object.prototype.hasOwnProperty.call(c,g)&&
(b=e(g,c))&&l.push(k(g)+(h?": ":":")+b);b=0===l.length?"{}":h?"{\n"+h+l.join(",\n"+h)+"\n"+d+"}":"{"+l.join(",")+"}";h=d;return b}}var f=/^[\],:{}\s]*$/,g=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,l=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,b=/(?:^|:|,)(?:\s*\[)+/g,d=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=m,Number.prototype.toJSON=m,String.prototype.toJSON=m);var h,p,x;if("function"!==typeof JSON.stringify){var v={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};JSON.stringify=
function(a,b,c){var d;p=h="";if("number"===typeof c)for(d=0;d<c;d+=1)p+=" ";else"string"===typeof c&&(p=c);if((x=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return e("",{"":a})}}"function"!==typeof JSON.parse&&(JSON.parse=function(a,d){function e(a,b){var c,h=a[b];if(h&&"object"===typeof h)for(c in h)if(Object.prototype.hasOwnProperty.call(h,c)){var p=e(h,c);p!==G?h[c]=p:delete h[c]}return d.call(a,b,h)}a=String(a);c.lastIndex=0;c.test(a)&&
(a=a.replace(c,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(f.test(a.replace(g,"@").replace(l,"]").replace(b,"")))return a=eval("("+a+")"),"function"===typeof d?e({"":a},""):a;throw new SyntaxError("JSON.parse");})})()});"use strict";r.when("A","jQuery","client-side-metrics","weblab-helper","polyfill-filter","polyfill-json-stringify").register("ajax-wrapper",function(a,m,k,e){function f(a,b){function c(a,b){for(var c=0;c<a._options.length;c++){var d=a._options[c];
if(d=b.call(a,d,"object"===typeof d?d.name:d))return d}}this._options=a instanceof f&&b&&b.length?a._options.concat(b):a instanceof f?a._options:a&&a.length?a:[];this.filter=function(a){var b={};c(this,function(c,d){d in a&&(b[d]=a[d])});return b};this.getOption=function(a){return c(this,function(b,c){if(c===a)return b})};return this}function g(a){this._options=a.allowedOptions;this._messageForViolation=a.messageForViolation;this._messageForViolationWithValue=a.messageForViolationWithValue;this._optionName=
a.optionName;this._valueName=a.valueName;this.validate=function(a){for(var b in a)if(a.hasOwnProperty(b)){var c=this._options.getOption(b);if(!c)throw c=this._messageForViolation.replace(this._optionName,b),Error(c);if("object"===typeof c&&!c.validate(a[b]))throw c=this._messageForViolationWithValue.replace(this._optionName,b),c=c.replace(this._valueName,a[b]),Error(c);}};return this}function l(a){try{K.validate(a)}catch(N){console.error(N)}var c=u.filter(a);c=m.extend(c,b(a));return m.ajax(c)}function b(a){if(a.params){if(a.data&&
a.params)throw Error("The option data can not be present with the emulated params option. Merge both and use just one.");return{data:a.params}}}function d(b){try{M.validate(b)}catch(Q){console.error(Q)}var d={url:G,options:B.filter(b)},n=new m.Deferred;d.url=b.url;if(b.data){if(b.data&&b.params)throw Error("Unsupported options. 'params' and 'data' options are both specified. Remove one of them.");if("object"===typeof b.data)d.options.params=b.data;else if("string"===typeof b.data)e.isSetParamsFormatAsStirngWeblabOn()?
"GET"===b.type?d.url+="?"+b.data:(d.options.params=b.data,d.options.paramsFormat="string"):d.url+="?"+b.data;else throw Error("Unsupported type provided in the 'data' attribute of an AJAX call");}if(b.type){if(b.type&&b.method)throw Error("Unsupported options. 'type' and 'method' options are both specified. Remove one of them.");d.options.method=b.type}if("crossDomain"in b){if("crossDomain"in b&&"withCredentials"in b)throw Error("Unsupported options. 'crossDomain' and 'withCredentials' options are both specified. Remove one of them.");
d.options.withCredentials=b.crossDomain}d=h(d,b,n);d=c(d,b,n);d=x(d,b,n);d=p(d,b,n);d=v(d,b,n);b.beforeSend&&b.beforeSend(d.options);d=y(d,b,n);b=a.ajax(d.url,d.options);return b=n.promise(b)}function c(a,b,d){var c=a.options.success;a.options.success=function(a,b,e){c&&c(a,b,e);d.resolve(a,b,e)};var e=a.options.error;a.options.error=function(a,b,c){e&&e(a,b,c);d.reject(a,b,c)};var h=a.options.abort;a.options.abort=function(a){h&&h(a);d.reject(a,"abort")};return a}function h(a,b){if(!b.complete)return a;
var d=a.options.success;a.options.success=function(a,c,e){d&&d(a,c,e);b.complete(e,"success")};var c=a.options.error;a.options.error=function(a,d,e){c&&c(a,d,e);b.complete(a,"error")};var e=a.options.abort;a.options.abort=function(a){e&&e(a);b.complete(a,"abort")};return a}function p(a,b){var d=a.options.success;a.options.success=function(a,c,e){d&&("text"===b.dataType&&"object"===typeof a&&(a=JSON.stringify(a)),d(a,c,e))};return a}function x(a,b){if(!b.useXMLHttp)return a;var d=a.options.success;
a.options.success=function(a,b,c){c&&(c=c.http);d(a,b,c)};var c=a.options.error;a.options.error=function(a,b,d){a&&(a=a.http);c(a,b,d)};var e=a.options.abort;a.options.abort=function(a){a&&(a=a.http);e(a)};return a}function v(a,b){var d=a.options.success;a.options.success=function(a,b,c){c&&304===c.http.status?d(a,"notmodified",c):d(a,"success",c)};var c=a.options.error;a.options.error=function(a,b,e){a&&a.http.readyState<n.DONE?c(a,"timeout",e):a&&200<=a.http.status&&300>a.http.status&&a.http.readyState===
n.DONE?d(a.http.responseText,"success",a):a&&0==a.http.status?c(a,"abort",e):c(a,"error",e)};return a}function y(a,b){var c=a.options.success;a.options.success=function(a,b,d){w(d,"success");c(a,b,d)};var d=a.options.error;a.options.error=function(a,b,c){w(a,"error");d(a,b,c)};return a}function w(a,b){a?(k.increaseCount("AUI:Ajax:"+b+":xhr:defined"),a.http?k.increaseCount("AUI:Ajax:"+b+":xhr:http:defined"):a.http===G?k.increaseCount("AUI:Ajax:"+b+":xhr:http:undefined"):null===a.http&&k.increaseCount("AUI:Ajax:"+
b+":xhr:http:null")):a===G?k.increaseCount("AUI:Ajax:"+b+":xhr:undefined"):null===a&&k.increaseCount("AUI:Ajax:"+b+":xhr:null")}var n={UNSET:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},u=new f("accepts async beforeSend cache complete contents contentType context converters crossDomain data dataFilter dataType error global headers ifModified isLocal jsonp jsonpCallback method mimeType password processData scriptCharset statusCode success timeout traditional type url username xhr xhrFields".split(" ")),
B=new f("abort accepts cache chunk contentType error headers indicator method params success timeout withCredentials".split(" ")),A=new f(B,[{name:"async",validate:function(a){return a}},"useXMLHttp","beforeSend","complete","crossDomain","dataType","data","type","url"]),t=new f(u,["params"]),M=new g({allowedOptions:A,messageForViolation:"The option %O is not supported in AUI ajax calls and default ajax. Consider using jQuery ajax.",messageForViolationWithValue:"The option %O with value %V is not supported in AUI ajax calls and default ajax. Consider using jQuery ajax.",
optionName:"%O",valueName:"%V"}),K=new g({allowedOptions:t,messageForViolation:"The option %O is not supported in jQuery ajax calls and default ajax. Consider using AUI ajax.",messageForViolationWithValue:"The option %O with value %V is not supported in jQuery ajax calls and default ajax. Consider using AUI ajax.",optionName:"%O",valueName:"%V"}),P=m("meta[name\x3ddefaultAJAX]").attr("content");"jQuery"!==P&&"AUI"!==P&&(P="jQuery");return{default:function(a){try{M.validate(a),K.validate(a)}catch(H){console.error(H)}if("jQuery"===
P)l(a);else if("AUI"===P)d(a);else throw Error("Unknown AJAX method: "+P);},jQuery:l,aui:d,READY_STATE:n}});"use strict";r.when("jQuery").register("weblab-helper",function(a){return{isAJAXWeblabOn:function(){return"1"===a("meta[name\x3dPAGE_CONDUCTOR_AUI_AJAX]").attr("content")},isAjaxStreamingEnabled:function(){return"1"===a("meta[name\x3dENABLE_AJAX_STREAMING]").attr("content")},isNavCFWeblabOn:function(){return"1"===a("meta[name\x3dEMIT_NAV_CF]").attr("content")},isRemoveOrderSummaryPrimaryActionBtnTextWeblabOff:function(){return"1"!==
a("#is-remove-os-pabt").val()},isSetParamsFormatAsStirngWeblabOn:function(){return"1"===a("meta[name\x3dSET_PARAMS_FORMAT_AS_STRING]").attr("content")},disablePrefetchForScheduledDeliveryWeblabOn:function(){return"1"===a("meta[name\x3dDISABLE_PREFETCH_FOR_SCHEDULED_DELIVERY]").attr("content")},isRemoveAddressFormOnDeleteAddressWeblabOn:function(){return"1"===a("meta[name\x3dREMOVE_ADDRESS_FORM_ON_DELETE_ADDRESS]").attr("content")},isSOSPExclusiveJSHandlerWeblabOn:function(){return"1"===a("meta[name\x3dSOSP_EXCLUSIVE_JS]").attr("content")},
sospPartialAvailabilityWeblabOn:function(){return"1"===a("meta[name\x3dSOSP_PARTIAL_UNAVAILABILITY]").attr("content")},refactorExtractURL:function(){return"1"===a("meta[name\x3dREFACTOR_EXTRACT_URL]").attr("content")},showGiftTextAreaOnWarning:function(){return"1"===a("meta[name\x3dSHOW_GIFT_TEXT_AREA_ON_WARNING]").attr("content")},isInterceptionAddressFormWidthFixEnabled:function(){return"1"===a("meta[name\x3dFIX_FIELD_WIDTH_IN_CHECKOUT_INTERCEPTION_FIX_ENABLED]").attr("content")},removesGiftOptionOnRush:function(){return"1"===
a("meta[name\x3dREMOVE_GIFT_OPTION_RUSH]").attr("content")},isSPCMobileDisplayMoreShipOptionsEnabled:function(){return"1"===a("meta[name\x3dSPC_MOBILE_DISPLAY_MORE_SHIP_OPTIONS]").attr("content")},isMCBMultiTenderWeblabEnabled:function(){return"1"===a("meta[name\x3dMCB_MULTI_TENDER_ENABLED]").attr("content")},isCreateAddressLinkForTaxAddressFormWeblabOn:function(){return"1"===a("meta[name\x3dCREATE_ADDRESS_IN_TAX_COLLECTION_ENABLED]").attr("content")},isMfaPSD2DeviceDescriptionCollectionEnabled:function(){return"1"===
a("meta[name\x3dMFA_PSD2_DEVICE_DESCRIPTION_COLLECTION_ENABLED]").attr("content")},isSospCalendarFixEnabled:function(){return"1"===a("meta[name\x3dSOSP_CALENDAR_FIX]").attr("content")},isUpdateMobileNumberEnabled:function(){return"1"===a("meta[name\x3dUPDATE_MOBILE_NUMBER]").attr("content")},isGILCreditCardEnabled:function(){return"1"===a("meta[name\x3dGIL_CREDIT_CARD_PAYMENT_METHOD]").attr("content")},isPyoClientSideInitiationEnabled:function(){return"1"===a("meta[name\x3dPYO_CLIENT_SIDE_INITIATION]").attr("content")},
isTFXCurrencyToggleOnTabletFixed:function(){return"1"===a("meta[name\x3dTFX_CURRENCY_TOGGLE_ON_TABLET_FIXED]").attr("content")},isTFXGuaranteedExchangeFeeEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TFX_GUARANTEED_EXCHANGE_FEE]").attr("content")},isCSMErrorLoggingEnabled:function(){return"1"===a("meta[name\x3dENABLE_CSM_ERROR_LOGGING]").attr("content")},isLogAFFNFallbackEnabled:function(){return"1"===a("meta[name\x3dENABLE_AF_FN_FALLBACK]").attr("content")},isExecutionIdInQueryStringEnabled:function(){return"1"===
a("meta[name\x3dADD_EXECUTION_ID_TO_QUERY_STRING]").attr("content")},isDigitalAsinIndexingFixedOnSOSPEnabled:function(){return"1"===a("meta[name\x3dDIGITAL_ASIN_INDEXING_FIXED_ON_SOSP]").attr("content")},isCvfOldAmazonUiFixesEnabled:function(){return"1"===a("meta[name\x3dCVF_OLD_AUI_FIXES]").attr("content")},isHeadersCleaned:function(){return"1"===a("meta[name\x3dCLEAN_UP_HEADERS]").attr("content")},isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled:function(){return"1"===a("#is-item-assoc-delete-confirmation-popover-for-wireless-plans").val()},
isSsdMdwEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SSD_MDW]").attr("content")},isExcludeMdwFromGoldenCXWidgetRenamingWeblabEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_GOLDEN_CX_WIDGET_RENAMING_EXCLUDE_MDW]").attr("content")},isRemoveDigitalFlagForScheduledDeliveryShipmentEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SD_NOT_DIGITAL]").attr("content")},isEGiftOptionsActive:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_EGIFT_OPTIONS_MOBILE]").attr("content")},
isPipelineDispatchSendHeaderEnabled:function(){return"1"===a("meta[name\x3dSEND_HEADER_FOR_PIPELINE_REQUEST]").attr("content")},isIngressEnabled:function(){return"1"===a("meta[name\x3dINGRESS_ENABLED]").attr("content")},isISPUMasterEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_ISPU_MASTER]").attr("content")},isRushISPUMasterEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_RENDER_RUSH_ISPU_MASTER]").attr("content")},isProgressiveOrderReviewCardAnchorEnabled:function(){return 1===
a("#progressive-order-review-card-anchor").length},isTaxExemptionMessagingFixed:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TAX_EXEMPTION_MSGING]").attr("content")},isProgressiveOrderReviewScrollingFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PROGRESSIVE_SCROLLING_FIX]").attr("content")},isVasTrueSPCEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_VAS_TRUESPC]").attr("content")},isSecureUnifiedDeliveryEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SECURE_UNIFIED_DELIVERY]").attr("content")},
isChooseSDOButtonMultiClickFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TSPC_CHOOSE_SDO_BUTTON_MULTI_CLICK_FIX]").attr("content")},isProgressiveIndicatorScrollingFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PROGRESS_INDICATOR_SCROLLING_FIX]").attr("content")},isOrderSummaryUpsellWidgetUpdateEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PAGE_CONDUCTOR_OSU_WIDGET_UPDATE_ENABLED]").attr("content")},isPIPPresentationLoggingEnabled:function(){return"1"===
a("meta[name\x3dPRIME_PIP_PRESENTATION_LOGGING_ENABLED]").attr("content")},isSnsChangeOrderTypeEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SNS_CHANGE_ORDER_TYPE_ENABLED]").attr("content")},isBRMarketplaceCurrencyFormatEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_BR_MARKETPLACE_CURRENCY_FORMAT]").attr("content")},isProgressIndicatorPaySelectFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PROGRESS_INDICATOR_PSP_FIX_ENABLED]").attr("content")},isAmazonDayDatePickerClickSkipShipOptionChangeEnabled:function(){return"1"===
a("meta[name\x3dAMAZON_DAY_DATE_PICKER_CALENDAR_CLICK_SKIP_SHIP_OPTION_CHANGE]").attr("content")},isAmazonDayIncentiveDetailsLinkRedirectionEnabledOnStripeMsg:function(){return"1"===a("meta[name\x3dIS_AMAZON_DAY_INCENTIVE_DETAILS_LINK_REDIRECTION_ENABLED_ON_STRIPE_MSG]").attr("content")},isChewbaccaAffordUpsellCheckboxMigrationEnabledUsingAjaxUpdate:function(){return"1"===a("meta[name\x3dIS_CHEWBACCA_AFFORD_UPSELL_CHECKBOX_MIGRATION_ENABLED_USING_AJAX_UPDATE]").attr("content")},isAffordUpsellCheckboxMigrationEnabledInTangoDesktop:function(){return"1"===
a("meta[name\x3dIS_AFFORD_UPSELL_CHECKBOX_MIGRATION_ENABLED_IN_TANGO_DESKTOP]").attr("content")},isWarrantyTermsAndConditionsEnabled:function(){return"1"===a("meta[name\x3dIS_WARRANTY_TERMS_AND_CONDITIONS_ENABLED]").attr("content")},isIMBSaveABDefaultsCheckboxPersistEnabled:function(){return"1"===a("meta[name\x3dIS_IMB_SAVE_AB_DEFAULTS_CHECKBOX_PERSIST_ENABLED]").attr("content")},isSubscribeAndSaveV2LineItemUpsellEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SNS_CHECKOUT_UPSELL_TANGO_MOBILE_ASSETS_ENABLED]").attr("content")},
isInHouseInstallmentsRecordCsmEnabled:function(){return"1"===a("meta[name\x3dENABLE_IN_HOUSE_INSTALLMENTS_RECORD_CSM]").attr("content")},isInHouseInstallmentsTangoEnabled:function(){return"1"===a("meta[name\x3dENABLE_IN_HOUSE_INSTALLMENTS_TANGO]").attr("content")},isTangoAlternatePlaceYourOrderButtonBlockerEnabled:function(){return"1"===a("meta[name\x3dENABLE_ALTERNATE_PLACE_ORDER_BUTTON_BLOCKER]").attr("content")},isDealBadgeEnabled:function(){return"1"===a("meta[name\x3dIS_DEAL_BADGE_ENABLED]").attr("content")},
isDealBadgeEnabledForIngress:function(){return"1"===a("meta[name\x3dIS_DEAL_BADGE_ENABLED_FOR_INGRESS]").attr("content")},isLightningDealJavaExperienceEnabled:function(){return"1"===a("meta[name\x3dIS_LIGHTNING_DEAL_JAVA_EXPERIENCE]").attr("content")},isPyoButtonAddCheckboxesDataOnclickEnabled:function(){return"1"===a("meta[name\x3dPAX_AB_TANGO_ADD_CHECKBOXES_DATA_ON_PYO_BUTTON_CLICK]").attr("content")},isSavePaymentMethodConsentIMBEnabled:function(){return"1"===a("meta[name\x3dPAYTECH_PAE_SPC_IMB_PAYMENT_METHOD_CONSENT]").attr("content")},
isCreateNewCheckoutModalTriggerEnabled:function(){return"1"===a("meta[name\x3dDSCX_ARX_KEY_DELIVERY_ADDRESS_EDIT_CONFIRMATION]").attr("content")}}});"use strict";r.when("A","client-side-metrics").register("weekend-availability-expander-helper",function(a,m){function k(a){return(a=l[a])?g("#weekend-availability-expander-header-text-"+a).text():g("#weekend-availability-default").text()}function e(){return 1==g("input[name\x3d'isBusinessDefaultWeekendDeliveryEnabled']").attr("value")?!0:!1}function f(a,
d){return a&&d?"BOTH":a?"SAT":d?"SUN":"NONE"}var g=a.$,l={BOTH:"both",SAT:"sat",SUN:"sun",NONE:"none"};return{isBusinessDefaultWeekendDeliveryViewActive:e,logExpanderState:function(a,d,c,e){m.increaseCount("checkout:delivery-preferences:"+a+":expander:"+d+":"+(c&&e?"neverExpanded":e?"collapsed":"expanded"),1)},stateToCheckboxes:function(a){var b=!1,c=!1;if(e()){if("BOTH"===a||"SAT"===a)b=!0;if("BOTH"===a||"SUN"===a)c=!0}else{if("BOTH"===a||"OTH"===a||"SAT"===a)b=!0;if("BOTH"===a||"OTH"===a||"SUN"===
a)c=!0}return{isSaturdayChecked:b,isSundayChecked:c}},updateAllOptOutMessages:function(a){1==g("input[name\x3d'isSundayDeliveryPreferenceSuppressed']").attr("value")?a.isSaturdayChecked?g(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!0):(g(".weekend-availability-opt-out-message").text(g("#weekend-availability-opt-out-sat-text").text()),g(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):a.isSaturdayChecked||a.isSundayChecked?a.isSaturdayChecked?a.isSundayChecked?
g(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!0):(g(".weekend-availability-opt-out-message").text(g("#weekend-availability-opt-out-sun-text").text()),g(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):(g(".weekend-availability-opt-out-message").text(g("#weekend-availability-opt-out-sat-text").text()),g(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):(g(".weekend-availability-opt-out-message").text(g("#weekend-availability-opt-out-both-text").text()),
g(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1))},updateAllTitles:function(a){a=f(a.isSaturdayChecked,a.isSundayChecked);g(".sat-sun-expander-heading-text").text(k(a))},updateAllWeekendAvailabilityStates:function(a){a=f(a.isSaturdayChecked,a.isSundayChecked);g("input[name\x3d'BusinessHours']").attr("value",a)}}});"use strict";r.when("A","loading-spinner-controller","page-transition-controller","page-conductor","checkout-general-utils","address-utilities","page-detector-current-page",
"client-side-metrics","weblab-helper").register("address-popovers",function(a,m,k,e,f,g,l,b,d){function c(a){(d.isHeadersCleaned()?a.popoverValid:a.getResponseHeader("x-amz-checkout-popover-valid"))||e.redirect({conductoraction:{url:"/gp/cart/view.html",type:"redirect"}})}function h(h,p,n){f.protectAgainstDoubleAction("show-add-address-popover",200)||(M=h.popover,!t('input[name\x3d"preloadAddressPopover"]').length||p.is(":empty")?(p.empty(),p.css("min-height",397),M.updatePosition(!0),m.showSpinner(p,
!1,M),h=(new Date).getTime(),n=l.getCurrentPage(),b.increaseCount("checkout:address-popover-pagetype:".curPage,1),n="itemselect"===n||"spp-itemselect"===n?1:0,d.isHeadersCleaned()?t.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/display.html?cachebuster\x3d"+h,data:{isBilling:O,isMultiAddress:n},dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"itemselect"},success:function(a,b,d){c(a);p.css("min-height",0);u(p,a.popoverContent)},error:e.ajaxRedirect}):t.ajax({type:"POST",
url:"/gp/buy/addressselect/handlers/popover/display.html?cachebuster\x3d"+h,data:{isBilling:O,isMultiAddress:n},async:!0,cache:!1,headers:{"x-amz-checkout-page":"itemselect"},success:function(a,b,d){c(d);p.css("min-height",0);u(p,a)},error:e.ajaxRedirect})):(g.customizeFormFromIdentity(p),g.countrySpecificPopoverOptimizationCheck(t("html")),n&&a.trigger("identity-assets")))}function p(a,h){if(!f.protectAgainstDoubleAction("add-new-address",200)){b.resetMetrics();var p=!1;t(".identity-protect-from-errant").each(function(){var a=
t(this);a=a.is("input")?a:a.find("input:first");-1!==a.val().search(/(\d[ -]?){13}/)&&(p=!0)});if(p){var n=t(".address-form-security-error:first");n.length?alert(n.text()):alert("Please check that the address you have entered is correct.")}else{h.$event.preventDefault();m.showSpinner(a,!1,M);var l=t("#domestic-address-popover-form, #international-address-popover-form, #address-popover-suggestions-form").filter(":visible");n=l.serialize();var g=(new Date).getTime();h=h.$currentTarget.find('input[type\x3d"submit"]').attr("name");
"useSelectedAddress"===h?n+="\x26fromSuggestionPage\x3d1":"fromAddressEditToContinue"===h&&(n+="\x26fromAddressEditToContinue\x3d1");t("#addAddressOnly").length&&(n+="\x26addOnly\x3d1");O&&(n+="\x26isBilling\x3d1");var k="/gp/buy/addressselect/handlers/popover/new.html";if(M){if("domestic-address-popover-form"===l.attr("id")&&(l.find(".enterAddressFormField").blur(),l="#"+a.attr("id")+" div[id^\x3donblur-character-validation-error-]",0<t(l).size())){m.hideSpinner(a);return}k+="/ref\x3dchk_addr_editPopoverSubmit";
e.isSPP()&&(M.lock(11),setTimeout(function(){M.unlock(12)},2E3))}var A=null!==K&&K!==G&&null!==P&&P!==G;"useSelectedAddress"===h&&!O&&A&&(n+="\x26fromSTMAPopover\x3d1");t("#international-address-popover-form").filter(":visible").length&&(n+="\x26showSecondaryForm\x3d1");B()&&H?x(a,g,n):d.isHeadersCleaned()?t.ajax({type:"POST",url:k+"?cachebuster\x3d"+g,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:n,dataType:"json",async:!0,cache:!1,error:e.ajaxRedirect,success:function(b,
d,h){e.isSPP()&&M.unlock(12);c(b);b.newPopoverType?v(b,d,b):b.reloadPopover?u(a,b.popoverContent):A?y(b):w("added",b.popoverContent)}}):t.ajax({type:"POST",url:k+"?cachebuster\x3d"+g,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:n,async:!0,cache:!1,error:e.ajaxRedirect,success:function(b,d,h){e.isSPP()&&M.unlock(12);c(h);h.getResponseHeader("x-amz-checkout-open-new-popover")?v(b,d,h):h.getResponseHeader("x-amz-checkout-reload-popover")?u(a,b):A?y(h):w("added",h)}})}}}function x(a,
b,h){var p=H.getNewTaxAddressPopoverURL();d.isHeadersCleaned()?t.ajax({type:"POST",url:p+"?cachebuster\x3d"+b,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:h,dataType:"json",async:!0,cache:!1,error:e.ajaxRedirect,success:function(b,d,h){e.isSPP()&&M.unlock(12);c(b);b.reloadPopover?u(a,b.popoverContent):b.newAddressId&&(t(".a-button-close").trigger("click"),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"),H.submitTaxAddressFormWithNewAddressId(b.newAddressId))}}):
t.ajax({type:"POST",url:p+"?cachebuster\x3d"+b,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:h,async:!0,cache:!1,error:e.ajaxRedirect,success:function(b,d,h){e.isSPP()&&M.unlock(12);c(h);h.getResponseHeader("x-amz-checkout-reload-popover")?u(a,b):h.getResponseHeader("x-amz-checkout-new-address-id")&&(t(".a-button-close").trigger("click"),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"),b=h.getResponseHeader("x-amz-checkout-new-address-id"),H.submitTaxAddressFormWithNewAddressId(b))}})}
function v(b,c,h){t('input[name\x3d"preloadAddressPopover"]').remove();d.isHeadersCleaned()?(c=h.newPopoverType,"suggestions"===c?(t("#address-suggestions-popover").empty().append(h.popoverContent),t("#address-suggestions-popover-link").trigger("click")):"edit"===c&&(c=t("#edit-address-popover"),c.empty().append(h.popoverContent),t("#edit-address-popover-link").trigger("click"),u(c,h.popoverContent))):(c=h.getResponseHeader("x-amz-checkout-open-new-popover"),"suggestions"===c?(t("#address-suggestions-popover").empty().append(b),
t("#address-suggestions-popover-link").trigger("click")):"edit"===c&&(c=t("#edit-address-popover"),c.empty().append(b),t("#edit-address-popover-link").trigger("click"),u(c,b)));a.trigger("identity-assets")}function y(a){a=d.isHeadersCleaned()?a.newAddressId:a.getResponseHeader("x-amz-checkout-new-address-id");var b=(new Date).getTime();t.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html?cachebuster\x3d"+b,data:{action:"update-address",lineitems:K,quantities:P,addresses:a+".home..",
returnHTML:0},async:!0,cache:!1,error:e.ajaxRedirect,success:function(a,b,c){w("applied",c)}})}function w(b,c){var d=(new Date).getTime();t('input[name\x3d"shipToAddress"]').length?(b=function(){e.isSPP()?(k.blockAllActions(),k.shrinkPanel(t(".spp-panel.expanded"),!0)):k.show()},e.isNonBlockingAnimationEnabled()?a.delay(b,0):b(),b=l.getCurrentPage(),e.loadPage(b,"",G,{refTag:"chk_addr_editPopoverSubmit"},G,c)):(c=e.setAjaxTransitionHeader(),t.ajax({type:"POST",headers:c,url:"/gp/buy/shared/handlers/pipeline-dispatch.html?cachebuster\x3d"+
d,data:{useCase:"multiAddress",showAddressAdded:b,page:"itemselect"},dataType:"text",async:!0,cache:!1,error:e.ajaxRedirect,success:function(a,b,c){e.ajaxUpdatePage(a,b,c);t(".a-button-close").trigger("click");f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}}))}function n(a){a=t("#"+a);a.length&&a.empty()}function u(b,c){b.html(c);g.customizeFormFromIdentity(b);M.updatePosition(!0);a.trigger("identity-assets");g.countrySpecificPopoverOptimizationCheck(t("html"))}function B(){return d.isCreateAddressLinkForTaxAddressFormWeblabOn()&&
0<t("#isTaxAddress").length}function A(){O=t("#isBilling").length?1:0;if(d.isInterceptionAddressFormWidthFixEnabled()){var a=t(".enter-address-form");g.customizeFormFromIdentity(a)}}var t=a.$,M,K,P,O=0,H=null;if(!t("html").hasClass("a-ie6"))return a.on("a:popover:show:add-address",function(a){n("edit-address-popover");n("add-billing-address-popover");O=0;h(a,t("#add-address-popover"),!1)}),a.on("a:popover:show:add-billing-address",function(a){n("edit-address-popover");n("add-address-popover");h(a,
t("#add-billing-address-popover"),!0)}),a.on("a:popover:show:address-suggestions",function(a){M=a.popover}),a.on("a:expander:delivery-expander:toggle:expand",function(a){a=t(".a-expander-content");g.fixOverflow(a)}),a.declarative("close-delete-popover",["click","touchend"],function(a){r.when("a-popover-base").execute(function(b){(b=b.get(a.data.popoverName))&&b.hide()})}),a.declarative("rm-address-action",["click","touchend"],function(a){r.when("a-popover-base").execute(function(b){(b=b.get(a.data.popoverName))&&
b.hide()});d.isRemoveAddressFormOnDeleteAddressWeblabOn()&&(n("edit-address-popover"),n("add-address-popover"),n("add-billing-address-popover"));r.when("page-conductor").execute(function(b){b.continueClicked(null,a.$target)})}),t(document).delegate("a.prevent-default-marker","click",function(a){a.preventDefault()}),a.declarative("select-billing-address-in-popover",["click","touchend"],function(a){a.$event.preventDefault();t("#address-list").submit();r.when("a-popover-base").execute(function(a){a.get("select-billing-address")&&
a.remove("select-billing-address")})}),a.declarative("trigger-popover-from-link",["click","touchend"],function(a){f.protectAgainstDoubleAction("trigger-popover-from-link",200)||(P=K=null,t("#add-address-popover-link").trigger("click"))}),a.declarative("add-address-popover-submit",["click","touchend"],function(a){p(t("#add-address-popover"),a)}),a.declarative("add-billing-address-popover-submit",["click","touchend"],function(a){p(t("#add-billing-address-popover"),a)}),a.declarative("edit-address-popover-submit",
["click","touchend"],function(a){p(t("#edit-address-popover"),a)}),a.declarative("address-suggestions-submit",["click","touchend"],function(a){p(t("#address-suggestions-popover"),a)}),a.declarative("delete-address-popover-submit",["click","touchend"],function(a){a=t("#delete-address-button");0<a.length&&a.click()}),a.declarative("edit-address-suggestions",["click","touchend"],function(a){if(!f.protectAgainstDoubleAction("show-edit-address-popover",200)){var b=t("#address-suggestions-popover");a.$event.preventDefault();
m.showSpinner(b,!1,M);a=t("#address-popover-suggestions-form");var h=a.serialize();a.find('input[type\x3d"radio"]').each(function(){var a=t(this);a.attr("checked")&&(h+="\x26edit_"+a.val()+"\x3d1")});O&&(h+="\x26isBilling\x3d1");M&&e.isSPP()&&(M.lock(11),setTimeout(function(){M.unlock(12)},2E3));a=(new Date).getTime();d.isHeadersCleaned()?t.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+a,data:h,dataType:"json",async:!0,cache:!1,error:e.ajaxRedirect,success:function(a,
b,d){e.isSPP()&&M.unlock(12);c(a);v(a,b,a)}}):t.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+a,data:h,async:!0,cache:!1,error:e.ajaxRedirect,success:function(a,b,d){e.isSPP()&&M.unlock(12);c(d);v(a,b,d)}})}}),a.declarative("add-address-popover-edit",["click","touchend"],function(a){if(!f.protectAgainstDoubleAction("add-address-popover-edit",200)){a.$event.preventDefault();var b=t("#add-address-popover");m.showSpinner(b,!1,M);a=t("#address-popover-suggestions-form").serialize()+
"\x26"+a.$currentTarget.find('input[type\x3d"submit"]').attr("name")+"\x3d1";var h=(new Date).getTime();d.isHeadersCleaned()?t.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+h,data:a,dataType:"json",async:!0,cache:!1,error:e.ajaxRedirect,success:function(a,d,h){c(a);u(b,a.popoverContent)}}):t.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+h,data:a,async:!0,cache:!1,error:e.ajaxRedirect,success:function(a,d,h){c(h);
u(b,a)}})}}),a.declarative("add-address-popover-toggle",["click","touchend"],function(a){f.protectAgainstDoubleAction("add-address-popover-toggle",200)||(a.$event.preventDefault(),a=a.$currentTarget.closest(".enter-address-form"),g.toggleAddressForm(a,a.siblings(".enter-address-form")))}),a.declarative("select-radio-option",["click","touchend"],function(a){a=a.$currentTarget.find(".radio-option");a.find('input[type\x3d"radio"]').attr("checked","checked");a.closest(".radio-option-list").find(".radio-option").removeClass("radio-option-selected");
a.addClass("radio-option-selected")}),a.declarative("trigger-address-popover",["click","touchend"],function(a){f.protectAgainstDoubleAction("trigger-address-popover",200)||t("#add-address-popover-link").trigger("click")}),a.on("checkout:reload:spp-shipaddress",A),a.on("checkout:reload:spp-billing-address",A),a.on("checkout:reload:itemselect",A),a.on("checkout:reload:spp-itemselect",A),{actionTriggerPopoverFromDropdown:function(a){a=a.$currentTarget.closest(".lineitem");K=a.find('input[name^\x3d"lineItemEntityID."]').val();
P=a.find('input[name^\x3d"quantity."]').val();a=t("#add-address-popover-link");a.length?a.trigger("click"):t("#add-new-address-popover").trigger("click")},actionRegisterTaxAddressController:function(a){B()&&!H&&a&&(H=a)}}});"use strict";r.when("A").register("address-book-controller",function(a){function m(){k("div.address-book").unbind("recalculate-address-height").bind("recalculate-address-height",function(){var a,f=k(),g=0,l=k("div.address-book .js-same-height"),b=l.length;l.css({height:"auto"}).each(function(d){var c=
k(this);a=a||c.offset().top;a!==c.offset().top&&(f.height(g),f=k(),g=0,a=c.offset().top);var h=c.height();f=f.add(c);h>g&&(g=h);d===b-1&&0<g&&f.height(g)})}).trigger("recalculate-address-height");k(q).unbind("resize.checkout-as").bind("resize.checkout-as",function(){k("div.address-book").trigger("recalculate-address-height")})}var k=a.$;a.on("checkout:reload:spp-shipaddress",m);a.on("checkout:reload:shipaddressselect",m);a.on("checkout:reload:billingaddressselect",m);a.on("checkout:reload:spp-billing-address",
m)});"use strict";r.when("A","client-side-metrics","weblab-helper").register("address-utilities",function(a,m,k){function e(a){a.find("input").each(function(){var a=b(this),d=a.outerWidth(!0),e=a.parent().outerWidth(!0);d>e&&a.attr("size")&&(document.getElementById(a.attr("id")).removeAttribute("size"),a.width("100%"))})}function f(a){if(b('input[name\x3d"useLiveAUI"]').length)r.when("p-detect").execute(function(c){c.capabilities.inputPlaceholder&&a.find(".field-description").each(function(){var a=
b(this),c=a.text(),d=a.closest(".a-col-right").find(":not(.address-form-skip-js-tweaks):not(.address-form-skip-js-tweaks *) input");d.attr("maxlength")<c.length&&d.attr("size",c.length);d.attr("placeholder",a.text())})}),a.find("input").each(function(){b(this).outerWidth()}),a.find("input[type\x3d'text'], select").each(function(){var a=b(this).closest(".full-width-config"),c=b(this);0===a.find(".a-popover-trigger").length&&(k.isInterceptionAddressFormWidthFixEnabled()?c.addClass("addressform-textfield-width"):
c.width("96%"))});else{r.when("p-detect").execute(function(c){c.capabilities.inputPlaceholder?a.find(".field-description").each(function(){var a=b(this),c=a.text(),d=a.closest(".a-column").find(":not(.address-form-skip-js-tweaks):not(.address-form-skip-js-tweaks *) input");d.attr("maxlength")<c.length&&d.attr("size",c.length);d.attr("placeholder",a.text())}):a.find(".field-description").each(function(){var a=b(this);a.find("br").remove();a.show()})});a.find(".popover-field-label").each(function(){var a=
b(this);a.find("b").each(function(){var a=b(this);a.text(b.trim(a.text()))});a.find("font").each(function(){var a=b(this);"-2"===a.attr("size")&&a.remove()})});var c=b(".enter-address-form");e(c);var d=0;c=a.find(".one-new-address-form-field").first();c.length&&c.find(".a-column").each(function(){d+=b(this).outerWidth()});a.width(0<d?d:"")}}function g(b){function c(){k=e.val();(n=g[k])&&l.find(".learn-more a").text(n.popOverLinkText)}var d=q.P&&q.P.AUI_BUILD_DATE,e=b.find("#enterAddressCountryCode"),
l=b.find(".country-specific-form-input");if(d){var f=l.find("input");var g=b.find(".country-specific-config").data("popovercountryconfig")}else m.increaseCount("removeauijs2"),f=l.find("#"+l.data("inputid")),g=l.find(".country-specific-config").data("popovercountryconfig");if(e.length&&l.length&&f.length&&g){var k=e.val(),n=g[k];e.unbind("change.countryChangeConfigUpdate").bind("change.countryChangeConfigUpdate",c);c();var u=d?"show":"beforeShow";a.on("a:popover:"+u+":checkout-"+l.data("inputid")+
"Name",function(a){"beforeShow"===u&&m.increaseCount("removeauijs3");n&&(a.popover.$popover.find(".a-popover-header h4").html(n.popOverTitle),a.popover.$popover.find(".a-popover-inner").html(n.popOverText),a.popover.updatePosition())})}}function l(a){function c(){var a=e.val();(a=g[a])?(a=(a=a.label)||"",f.attr("placeholder",b("\x3cdiv /\x3e").html(a).text().replace(":","")),l.show()):l.hide()}var d=q.P&&q.P.AUI_BUILD_DATE,e=a.find("#enterAddressCountryCode"),l=a.find(".country-specific-form-input-mobile");
if(d){var f=l.find("input");var g=a.find(".country-specific-config").data("labelcountryconfig")}else m.increaseCount("removeauijs3"),f=l.find("#"+l.data("inputid")),g=l.find(".country-specific-config").data("labelcountryconfig");e.length&&l.length&&f.length&&g&&(e.unbind("change.countryChangeLabelUpdate").bind("change.countryChangeLabelUpdate",function(){l.hasClass("initial-edit-value")?l.removeClass("initial-edit-value"):f.val("");c()}),c())}var b=a.$;r.when("a-checkbox").execute(function(b){a.declarative("delivery-preferences-weekend-availability-checkbox-triggered",
"click",function(a){if("undefined"!==typeof a.$target){var c=a.$target.val();a.$target.is(":checked")&&("NONE"===c?(b("#delivery-preferences-weekend-availability-sat").uncheck(),b("#delivery-preferences-weekend-availability-sun").uncheck()):"SAT"!==c&&"SUN"!==c||b("#delivery-preferences-weekend-availability-none").uncheck())}})});a.declarative("wdp-redesign-addresstype-radio-clicked","click",function(a){var c=a.$target.context.id;a=b(".com-businesshours-text");var d=b("#delivery-preferences-weekend-availability-sat").is(":checked"),
e=b("#delivery-preferences-weekend-availability-sun").is(":checked");"devyPrefs_AddressType_COM"===c?(m.increaseCount("WDPTotalCOMClick"),b(".wdp-res").removeClass("a-color-base-background").addClass("a-color-alternate-background"),b(".wdp-com").removeClass("a-color-alternate-background").addClass("a-color-base-background"),b(".wdp-BusinessHours").removeClass("aok-hidden")):"devyPrefs_AddressType_RES"===c?(m.increaseCount("WDPTotalRESClick"),b(".wdp-com").removeClass("a-color-base-background").addClass("a-color-alternate-background"),
b(".wdp-res").removeClass("a-color-alternate-background").addClass("a-color-base-background"),b(".wdp-BusinessHours").addClass("aok-hidden")):"delivery-preferences-weekend-availability-sat"===c?(m.increaseCount("WDPTotalSATClick"),c=d?e?"BOTH":"SAT":e?"SUN":"OTH",a.addClass("aok-hidden"),b(".com-businesshours-"+c).removeClass("aok-hidden")):"delivery-preferences-weekend-availability-sun"===c&&(m.increaseCount("WDPTotalSUNClick"),c=e?d?"BOTH":"SUN":d?"SAT":"OTH",a.addClass("aok-hidden"),b(".com-businesshours-"+
c).removeClass("aok-hidden"))});return{toggleAddressForm:function(a,c){a.hide();c.find("div.a-alert-error:not(.js-originally-shown-imb)").hide();a.find("input[type\x3d'text'], select, input[type\x3d'radio']:checked, input[type\x3d'hidden']").each(function(){var a=b(this),d=a.attr("name")||a.data("copyto")||a.attr("id");if(!a.is(":disabled")&&!a.find(":selected").is(".js-not-a-value")){var e=c.find("input[name\x3d'"+d+"']");"enterAddressLandmark"===d&&(e=c.find("input[name\x3d'Landmark']"));"Landmark"!==
d||e.length||(e=c.find("input[name\x3d'enterAddressLandmark']"));1<e.length&&a.is("input[type\x3d'radio']")?e.filter("[value\x3d'"+a.val()+"']").attr("checked",!0):e.is("select")?e.find("option[value\x3d'"+a.val()+"']").attr("selected",!0):a.is("input[type\x3d'hidden']")||e.is("input[type\x3d'hidden']")||e.val(a.val())}});c.show();e(c);f(c)},customizeFormFromIdentity:f,fixOverflow:e,countrySpecificLabelOptimizationCheck:function(a){var b=a.find(".enter-address-form");1===b.data("taxidOpt")?setTimeout(function(){l(b)},
100):l(b)},countrySpecificPopoverOptimizationCheck:function(a){var b=a.find(".enter-address-form");1===b.data("taxidOpt")?setTimeout(function(){g(b)},100):g(b)}}});"use strict";r.when("A","page-conductor","page-transition-controller","client-side-metrics","page-detector-current-page","checkout-general-utils").register("address-form-helper",function(a,m,k,e,f,g){function l(a,b,c){p(".a-button-close").trigger("click");p('\x3cinput name\x3d"addressID"/\x3e').val(a).appendTo(c);p('\x3cinput name\x3d"purchaseId"/\x3e').val(b).appendTo(c);
m.continueClicked(null,c)}function b(a,b){b||(b=p("#address-ui-checkout-form"));c(b);var e=(new Date).getTime();p.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html?cachebuster\x3d"+e,data:{action:"update-address",lineitems:x,quantities:v,addresses:a,returnHTML:0},async:!0,cache:!1,error:function(){h(b);m.ajaxRedirect},success:function(a,c,e){d("applied",b)}})}function d(a,b){var c=(new Date).getTime(),d=m.setAjaxTransitionHeader();p.ajax({type:"POST",headers:d,url:"/gp/buy/shared/handlers/pipeline-dispatch.html?cachebuster\x3d"+
c,data:{useCase:"multiAddress",showAddressAdded:a,page:"itemselect"},dataType:"text",async:!0,cache:!1,error:function(){h(b);m.ajaxRedirect},success:function(a,c,d){h(b);m.ajaxUpdatePage(a,c,d);p(".a-button-close").trigger("click");g.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}})}function c(a){m.isSPP()?(k.blockAllActions(),k.showTransitionInContainer(a)):k.show()}function h(a){m.isSPP()?(k.unblockAllActions(),p(a).find("div.section-overwrap").remove()):k.hide()}var p=a.$,x,v;
a.on("a:popover:afterUpdatePosition:edit-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:edit-address",b.popover)});a.on("a:popover:afterUpdatePosition:add-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:add-address",b.popover)});a.on("a:popover:visible:add-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:add-address",b.popover)});a.on("a:popover:beforeShow:add-address",
function(){a.trigger("checkout:popover-beforeShow:add-address")});a.on("a:popover:beforeShow:edit-address",function(){a.trigger("checkout:popover-beforeShow:edit-address")});a.on("a:popover:invisible:add-address",function(){a.trigger("checkout:popover-hide:add-address")});a.on("a:popover:invisible:edit-address",function(){a.trigger("checkout:popover-hide:edit-address")});a.on("checkout:reload:spp-shipaddress",function(){a.trigger("checkout:reload:address-page")});a.declarative("itemselect-update-address",
["change"],function(a){a=a.$currentTarget.closest(".lineitem");x=a.find('input[name^\x3d"lineItemEntityID."]').val();v=a.find('input[name^\x3d"quantity."]').val()});return{setDestination:function(a,c){a||(e.increaseCount("checkout:addressForm:setDestination:noRequest",1),a={});var d=a.addressId;d||e.increaseCount("checkout:addressForm:setDestination:noAddressId",1);var h=a.purchaseId||p("input[name\x3d'purchaseId']").val();h||e.increaseCount("checkout:addressForm:setDestination:noPurchaseId",1);a=
a.ref||"ox_shipaddress_add_new_addr";var g=f.getCurrentPage();if("itemselect"===g||"spp-itemselect"===g)return b(d,c);p('[name\x3d"isBilling"]')&&1==p('[name\x3d"isBilling"]').val()?(a="ox_billing_continue",(c=p("input[name\x3d'paymentInstrumentId']").val())||e.increaseCount("checkout:addressForm:setDestination:noPaymentInstrumentId",1),(g=p("input[name\x3d'paymentMethodCode']").val())||e.increaseCount("checkout:addressForm:setDestination:noPaymentMethodCode",1),a=p("\x3cform/\x3e").attr("action",
"/gp/buy/billingaddressselect/handlers/continue.html/ref\x3d"+a),p('\x3cinput name\x3d"paymentInstrumentId"/\x3e').val(c).appendTo(a),p('\x3cinput name\x3d"paymentMethodCode"/\x3e').val(g).appendTo(a),p('\x3cinput name\x3d"action" value\x3d"select-billing"/\x3e').appendTo(a),p('\x3cinput name\x3d"isAUIWSAddressCreationWorkflow" value\x3d"1"/\x3e').appendTo(a),l(d,h,a)):(a=p("\x3cform/\x3e").attr("action","/gp/buy/addressselect/handlers/continue.html/ref\x3d"+a),p('\x3cinput name\x3d"action" value\x3d"select-shipping"/\x3e').appendTo(a),
l(d,h,a))},onPageTransitionStart:c,onPageTransitionComplete:h}});"use strict";r.when("A","client-side-metrics","weblab-helper").register("action-logger",function(a,m,k){var e=a.$;a.declarative("ue-count",["click","touchend"],function(a){m.increaseCount(a.data.countFlag,a.data.countValue)});return{logUsedPrefetch:function(a,g,l,b){b||(m.increaseCount("Checkout:action-log:MissingRefMarker"),b="");e.ajax({type:"GET",url:"/gp/buy/shared/handlers/log-used-prefetch.html"+b,data:"pageType\x3d"+a+"\x26subPageType\x3d"+
g+"\x26relatedRequestId\x3d"+l,dataType:"text",cache:!1,success:function(a,b,e){a=e.getResponseHeader("x-amz-rid");m.setImpressionRequestId(a)}})}}});"use strict";r.when("A","weblab-helper").register("ajax-utility",function(a,m){return{jsonify:function(k){var e;if(e=m.isAJAXWeblabOn()){e=k instanceof Function;var f=k instanceof Array,g=k instanceof String;e=k instanceof Object&&!f&&!e&&!g}if(e)return k;try{k=a.$.parseJSON(k)}catch(l){k=null}return k}}});"use strict";r.when("A","page-conductor","client-side-metrics",
"weblab-helper").register("button-blocker",function(a,m,k,e){function f(a,b,c,d){m.isSPP()?b.closest("span.a-declarative").data("blockerText",c):b.find("input.a-button-text").data("blockerText",c);g(d);p?(a.addClass("aok-hidden"),b.removeClass("aok-hidden"),l("#hasTVNavigation").length&&r.when("a-tv").execute(function(b){b.remove(a)})):(k.increaseCount("removeauijs10"),a.hide(),b.show(),b.hasClass("aok-hidden")&&b.removeClass("aok-hidden"))}function g(a){var b=l(".continue-button-blocker-text");b.length&&
(a?(b.html(a),b.removeClass("aok-hidden")):(b.addClass("aok-hidden"),b.empty()))}var l=a.$,b={},d=[],c,h,p=q.P&&q.P.AUI_BUILD_DATE,x=!1;e=e.isPyoClientSideInitiationEnabled()?"checkout:unload":"checkout:beforeReload";a.on(e,function(){d=[];b={};c=""});return{show:function(a,e,h){if(!x){var p=l(".continue-button");if(p.length)if(e){var g=l(".continue-button-blocker");if(g.length){h=h||"";var m=b[a]!==G&&b[a].tooltipText!==e,A=b[a]!==G&&b[a].buttonInlineText!==h;if(0===d.length||!b[a]||m||A)f(p,g,e,
h),c=a;b[a]===G&&d.push(a);b[a]={tooltipText:e,buttonInlineText:h}}}else q.console&&q.console.error&&console.error("showBlockerOnContinue should not be called with an empty tooltip."),k.increaseCount("Checkout:ButtonBlocker:EmptyTooltip")}},hide:function(a){if(!x){if(b[a]!==G){delete b[a];var e=l.inArray(a,d);d.splice(e,1)}var h=l(".continue-button");h.length&&(e=l(".continue-button-blocker"),e.length&&(0===d.length?(g(),p?(e.addClass("aok-hidden"),h.removeClass("aok-hidden"),l("#hasTVNavigation").length&&
r.when("a-tv").execute(function(a){a.add(h)})):(k.increaseCount("removeauijs11"),e.hide(),h.show(),h.hasClass("aok-hidden")&&h.removeClass("aok-hidden"))):c===a&&(c=d[0],f(h,e,b[c].tooltipText,b[c].buttonInlineText))))}},lock:function(){x=!0},unlock:function(){x=!1},getButtonBlocker:function(){h||(h=l(".continue-button-blocker"));return h}}});"use strict";r.when("A","button-blocker","client-side-metrics").register("button-blocker-controller",function(a,m,k){function e(a,b){l[a]!==G&&l[a].state!==
b&&(l[a].state=b,f())}function f(){var a=!0,e;g.each(l,function(c,h){e=h.owner;if(h.state===d.DISABLE_CONTINUE)return a=!1,m.show(e,h.toolTipMessage,h.buttonInlineMessage),b||(k.increaseCount("removeauijs12"),g(".continue-button-blocker").css("display","inline-block")),!1});a&&m.hide(e)}var g=a.$,l={},b=q.P&&q.P.AUI_BUILD_DATE,d={ENABLE_CONTINUE:"enableContinue",DISABLE_CONTINUE:"disableContinue"};a.on("checkout:beforeReload",function(){l={}});return{disableContinue:function(a,b,p,g){g=g||"";l[b]===
G&&(p?(l[b]!==G||(l[b]={state:d.ENABLE_CONTINUE,owner:a,toolTipMessage:p,buttonInlineMessage:g}),f()):q.console&&q.console.error&&console.error("_registerElement should not be called with an empty tooltip."));e(b,d.DISABLE_CONTINUE)},enableContinue:function(a){l[a]!==G&&e(a,d.ENABLE_CONTINUE)}}});"use strict";r.when("jQuery").register("cache-page-data-controller",function(a){var m={};return{clearCache:function(){m={}},setCachedPageData:function(k,e,f,g,l){var b=[],d=!0;a(".cacheable-spp-panel").each(function(){var c=
a(this);var e=!c||c.find(".is-scheduled-delivery").length?!1:!0;if(!e)return d=!1;c.find(".expand-panel-button").removeClass("a-button-focus");b.push({id:c.attr("id"),content:c[0].outerHTML})});if(d){var c={panels:b};a(".cacheable-spp-section").each(function(){var b=a(this);c[b.attr("id")]=b[0].outerHTML});m[k+"-"+e]={curPageData:c,state:q.history?history.state:f,page:k,title:document.title||g,url:q.location.href||l}}},getCachedPageData:function(a,e){return m[a+"-"+e]}}});"use strict";r.when("A").register("checkout-general-utils",
function(a){function m(a,b,d,c){var h=f.getAssocParamValuesFromUrl(a);!d&&c?delete h[b]:h[b]=d;b=0<=a.indexOf("?")?a.substring(0,a.indexOf("?")):a;b=b+"?"+e.param(h,1);(a=f.getFragmentFromUrl(a))&&(b+="#"+a);return b}function k(a){a=a||document.location.pathname;e.each(g,function(d,c){if((d=c.validator)&&d.test(a))return b=c,!1});if(!b)var b=g.UNKNOWN;return b.type}var e=a.$,f={moveToNextInput:function(a){a=a.nextAll(":visible").find("input").get(0);a!==[]&&a.focus()},hide:function(a){a.hide()},show:function(a){q.P&&
q.P.AUI_BUILD_DATE&&a.hasClass("aok-hidden")&&a.removeClass("aok-hidden");a.show()},getAssocParamValuesFromUrl:function(a){var b={};if("string"!==typeof a||-1===a.indexOf("?"))return b;a=a.slice(a.indexOf("?")+1);if(!a)return b;-1!=a.indexOf("#")&&(a=a.substring(a,a.indexOf("#")));a=a.split("\x26");for(var d=0;d<a.length;d++){var c=a[d].split("\x3d");b[c[0]]=c[1]}return b},addQueryStringParameter:function(a,b,d){return m(a,b,d,!1)},addQueryStringParameterOrDeleteIfEmpty:function(a,b,d){return m(a,
b,d,!0)},getQueryStringParameter:function(a,b){a=f.getAssocParamValuesFromUrl(a);return b in a?a[b]:G},getFragmentFromUrl:function(a){var b=a.indexOf("#");return-1==b?G:a.substring(b+1)},extractURLParts:function(a){if(!a||"string"!==typeof a)return{};a=/(.*html)(\/ref[^?\n]*)?[?]?(.*)/g.exec(a);var b={};a&&(a[1]&&(b.normalizedUrl=a[1]),a[2]&&(b.refMarker=a[2]),a[3]&&(b.query=a[3]));return b},buildFilteredQueryString:function(a,b){var d="?";if(null==a||null==b)return"";b.forEach(function(b){var c=
f.getQueryStringParameter(a,b);c&&(d=f.addQueryStringParameterOrDeleteIfEmpty(d,b,c))});return"?"===d?"":d},redirectWithJavascript:function(a){q.location=f.addQueryStringParameter(a,"hasWorkingJavascript","1")},bindActionEnterKeyOnButton:function(a){a.keyup(function(a){13===a.which&&e(a.target).trigger("click")})},toggleExpanderContent:function(a){a=a.$target.closest(".a-box");a.hasClass("a-single")?a.removeClass("a-single").addClass("a-first"):a.addClass("a-single").removeClass("a-first")},validateNumber:function(a,
b,d){e.trim(a);return/^\d+$/.test(a)&&a>=b&&a<=d}};f.protectAgainstDoubleAction=function(){var a={};return function(b,d){if(!b)return q.console&&q.console.error&&console.error("Function is not used properly, use a unique owner to identify the caller."),!1;if(a.hasOwnProperty(b))return!0;a[b]=1;setTimeout(function(){delete a[b]},d||100);return!1}}();f.logErrorOnLevel=function(a,b){(q.ueLogError||e.noop)({message:a,logLevel:b});if(q.console){var d={FATAL:q.console.error,"default":q.console.warn};b=
d[b]||d["default"]}else b=e.noop;b.call(q,a)};f.logError=function(a){f.logErrorOnLevel(a,"FATAL")};f.updateCartByMash=function(a){r.when("safe-mash").execute(function(b){null!==a&&a!==G&&"1"===e("#updateCartByMash").attr("content")&&b&&b.cart&&b.cart.didUpdate&&b.cart.didUpdate({newCartQuantity:a})})};f.getPosition=function(a,b,d){for(var c=0,e=a.length,p=0;p<e;p++)if(a.charAt(p)===b&&(c++,c===d))return p;return-1};f.limitInputToNumbers=function(a){var b=a.$event.keyCode;-1!==e.inArray(b,[46,8,9,
37,39])||-1!==e.inArray(b,[65,67,86])&&!0===a.ctrlKey||(a.$event.shiftKey||(48>b||57<b)&&(96>b||105<b))&&a.$event.preventDefault()};f.nukeDropdowns=function(a){r.when("a-popover-base").execute(function(b){e.each(e(a),function(){b.remove(this.name)})})};var g={GURUPA:{type:"gurupa",validator:/.*\/gp\/buy\/.*/},CHEWBACCA:{type:"chewbacca",validator:/.*\/checkout\/p\/.*/},UNKNOWN:{type:"unknown"}};"function"===typeof Object.freeze&&Object.freeze(g);f.getUrlType=k;f.isChewbaccaUrl=function(a){return k(a)===
g.CHEWBACCA.type};a.on("checkout:reload",function(){e('input[name\x3d"useLiveAUI"]').length||a.defer(function(){e(".a-declarative, .a-button").filter("[data-action]").unbind("keypress.checkout-page").bind("keypress.checkout-page",function(a){13===a.which&&e(this).trigger("click")})})});a.on("checkout:beforeLoadPage",function(){e("div.a-popover").find(".a-declarative:first:[data-action\x3dcustom-popover-close|a-popover-close]").click()});return f});"use strict";r.when("A","a-modal","client-side-metrics",
"loading-spinner-controller","weblab-helper").register("checkout-view-modal-handler",function(a,m,k,e,f){function g(){return c?!!c.isActive():!1}function l(){c&&(m.remove(c),c=G,k.increaseCount("checkout:view-modal:dismiss:"+h,1))}function b(b){b.$event.preventDefault();f.isCreateNewCheckoutModalTriggerEnabled()?(l(),a.trigger("checkout:do-open-modal",b)):(c&&(m.remove(c),c=G),d(b))}function d(a){var b={name:"checkout-view-modal",header:a.data.modalTitle||"",url:a.data.url};h=a.data.viewType||"unknown";
c=m.create(a.$target,b);c.show();k.increaseCount("checkout:view-modal:show:"+h,1)}var c,h;a.declarative("checkout-view-modal","click",b);a.on("a:popover:hide:checkout-view-modal",l);if(f.isCreateNewCheckoutModalTriggerEnabled())a.on("checkout:do-open-modal",d);return{isModalActive:g,showModalSpinner:function(){e.showSpinner(c.$popover,!1,c)},hideModalSpinner:function(){e.hideSpinner(c.$popover)},getModalInstance:function(){return g()?c:null},updateModalContent:function(b){g()&&(c.update({content:b}),
a.trigger("checkout:checkoutViewModal:modalContentUpdated",b),k.increaseCount("checkout:view-modal:update:"+h,1))},unloadCheckoutViewModal:function(){if(c){var a=c;c=G;a.hide();m.remove(a);k.increaseCount("checkout:view-modal:unload:"+h,1)}},createCheckoutViewModal:b}});"use strict";r.when("A","jQuery","page-spinner-controller","client-side-metrics","ready").register("checkout-view-overlay-handler",function(a,m,k,e){function f(h){b[h]=!0;a.ajax(h,{success:function(a){b[h]=!1;l[h]=a;c===h&&(c=null,
k.hide(),g(h))},error:function(a){e.increaseCount("checkout:view-overlay:loadError:"+d[h],1);b[h]=!1;k.hide()}})}function g(a){h=a;a=m("\x3cdiv\x3e",{id:"checkout-view-overlay",style:"position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1008;"}).append(l[h]);a.find("#pagelet-layout-section").removeClass("a-padding-base");m("body").append(a);e.increaseCount("checkout:view-overlay:show:"+d[h],1)}var l={},b={},d={},c,h;a.on("checkout:afterReload",function(){var a={};m('.a-declarative[data-action\x3d"checkout-view-overlay"]').each(function(){var b=
m(this).data("checkout-view-overlay"),c=b.url;c?(d[c]=b.viewType,b.prefetchEnabled&&!a[c]&&(f(c),a[c]=!0)):e.increaseCount("checkout:view-overlay:nullUrlOnPrefetchError:"+b.viewType,1)})});a.declarative("checkout-view-overlay","click",function(a){var h=a.data.url;h?(d[h]=a.data.viewType,a.data.prefetchEnabled&&h in l&&0<l[h].length?g(h):(k.show(),c=h,b[h]||f(h))):e.increaseCount("checkout:view-overlay:nullUrlOnClickError:"+a.data.viewType,1)});return{isOverlayVisible:function(){return null!=h},hideOverlay:function(){m("#checkout-view-overlay").remove();
e.increaseCount("checkout:view-overlay:hide:"+d[h],1);h=null}}});"use strict";r.when("A","weblab-helper").register("client-side-metrics",function(a,m){var k=a.$,e=null,f=null,g=0,l,b=a.capabilities&&a.capabilities.isAmazonApp||q.amazon&&q.amazon.mash;a=function(){};var d=q.uet||a,c=q.uex||a,h=!1,p=!1,x=function(a){q.ue&&q.ue.t&&(q.uet(a,e),t("checkout:client-side-metrics:uet:marker:"+a,1,1),null===e&&null===f&&q.ue.isl&&(t("checkout:client-side-metrics:mark:at",1,1),q.uex("at")));"af"===a?h=!0:"fn"===
a&&(p=!0)},v=function(a){q.ue&&q.uex&&(q.uex(a,e),t("checkout:client-side-metrics:uex:marker:"+a,1,1))},y=function(a){q.ue&&q.ues&&q.ues("id",e,a)},w=function(){q.ue&&q.ues&&q.ues("ctb",e,"1")},n=function(){q.ue&&q.ues&&(b&&x("mts",e),q.ues("t0",e,(new Date).getTime()),x("ue"),x("bb"))},u=function(a){a?f="ctbajax"+g++:e="ajax"+g++};a=function(a){e=a};var B=function(){return e},A=function(){return f},t=function(a,b,c){"undefined"!==typeof q.ue&&"undefined"!==typeof q.ue.count&&(b=b?b:1,c?q.ue.count(a,
(q.ue.count(a)||0)+1):q.ue.count(a,b))},M=function(a){if(a&&a.length){var b=e;e=f;y(a);e=b}},K=function(){l===G&&(l=0<k("#transitionLogging").length);return l},P=function(a,b,c,d){q.ueLogError&&q.ueLogError(a,{message:b,attribution:c,logLevel:d})};return{getscope:B,getasyncscope:A,setmarker:x,sendue:v,setrid:y,setctb:w,resetue:n,createscope:u,setscope:a,getScope:B,getAsyncScope:A,setMarker:x,sendUe:v,setRid:y,setImpressionRequestId:function(a){q.ue&&q.ues&&q.ues("id2",e,a);w();v("ld")},setCtb:w,resetUe:n,
createScope:u,setScope:a,increaseCount:t,resetMetrics:function(){e=f;w();n()},setAsyncRequestId:M,sendUEPageLoadStats:function(){!m.isCSMErrorLoggingEnabled()||h&&p||P({message:"Logged ld without both af and fn logged first af:"+h+" fn:"+p},"","checkout-client-side-metrics","WARN");m.isLogAFFNFallbackEnabled()&&(!0===h&&t("checkout:client-side-metrics:page-load-stats:earlyaf",1),t("checkout:client-side-metrics:page-load-stats:af",1),x("af"));m.isLogAFFNFallbackEnabled()&&(!0===p&&t("checkout:client-side-metrics:page-load-stats:earlyfn",
1),t("checkout:client-side-metrics:page-load-stats:fn",1),x("fn"));v("ld");u(1);p=h=!1},isTransitionLoggingEnabled:K,logPageTransition:function(a,b,c,d){if(K()){var e=(new Date).getTime();k.ajax({type:"POST",url:"/gp/buy/shared/handlers/log-page-transition.html?cachebuster\x3d"+e,data:{fromPage:a,toPage:b},async:!0,cache:!1,timeout:1E3,success:function(a,b,d){var e=d.getResponseHeader("x-amz-checkout-requestid");M(e);c&&c.call(this,a,b,d)},complete:function(a,b){d&&d.call(this,a,b)}})}},logError:P,
startWidgetTiming:function(a){d("bb",a,{wb:1})},finishWidgetTiming:function(a){c("ld",a,{wb:1})},setMarkerForWidget:function(a,b){d(a,b,{wb:1})},emitNexusMetrics:function(a,b,c){"undefined"!==typeof q.ue&&"undefined"!==typeof q.ue.event&&q.ue.event(a,b,c)},setCountValue:function(a,b){t(a,b,!1)}}});"use strict";r.register("currency-formatter",function(){function a(m,k){isNaN(k)||(m=Number(m).toFixed(k));m=m.toString();k=0<=m.lastIndexOf(".")?m.lastIndexOf("."):m.length;return 3>=k?m:a(m.substring(0,
k-3),0)+","+m.substring(k-3)}return{getNumberWithSeparators:a}});"use strict";r.when("A","client-side-metrics","page-conductor","page-detector").register("delivery-preferences-csm-helper",function(a,m,k,e){function f(a){var b=k.isSPP()?"spp":"mpp",c="desktop";e.isMobile()?c="mobile":e.isTablet()&&(c="tablet");m.increaseCount("checkout:delivery-preferences:"+c+":"+b+":"+a,1)}function g(a){return 0===a.length?"NoValueSet":a}var l=a.$;return{recordCSM:f,recordCSMWithCurrentFieldValues:function(a,d,c){d=
l("input[name\x3d"+d+"]:checked");d.length&&(d=d.val(),f(a+":preference:"+g(d)));c=l("input[name\x3d"+c+"]");c.length&&f(a+":set-as-default:"+(c.is(":checked")?"yes":"no"))},recordCSMForEligiblePages:function(a){a=a||"";f(a+"eligible-page-displayed");var b=l("input[name\x3ddelivery-preferences-preference-set]");b.length&&f(a+"summary-displayed:preference:"+g(b.val()))}}});"use strict";r.when("A").register("error-feature-detection",function(a){function m(a){q.errorFeatureDetection&&q.errorFeatureDetection.safelyLogError?
q.errorFeatureDetection.safelyLogError(a):(q.ueLogError&&q.ueLogError(a),q.console&&q.console.error&&console.error(a))}try{a.on("page-detector:page-changed",function(){r.now("page-detector-current-page").execute(function(a){if((a=a.getCurrentPage())&&"spc"===a)try{q.errorFeatureDetection&&q.errorFeatureDetection.enableErrorHandling&&q.errorFeatureDetection.enableErrorHandling()}catch(e){m(e)}else try{q.errorFeatureDetection&&q.errorFeatureDetection.disableErrorHandling&&q.errorFeatureDetection.disableErrorHandling()}catch(e){m(e)}})})}catch(k){m(k)}return{registerFeature:function(a,
e){try{q.errorFeatureDetection&&q.errorFeatureDetection.registerFeature&&q.errorFeatureDetection.registerFeature(a,e)}catch(f){m(f)}},markFeatureAvailable:function(a){try{q.errorFeatureDetection&&q.errorFeatureDetection.markFeatureAvailable&&q.errorFeatureDetection.markFeatureAvailable(a)}catch(e){m(e)}},markFeatureUnavailable:function(a){try{q.errorFeatureDetection&&q.errorFeatureDetection.markFeatureUnavailable&&q.errorFeatureDetection.markFeatureUnavailable(a)}catch(e){m(e)}}}});r.when("error-feature-detection").execute(function(a){a.registerFeature("continue-action",
0);a.markFeatureAvailable("javascript-detection");a.markFeatureAvailable("continue-action")});"use strict";r.when("A","page-transition-controller").execute(function(a,m){a=a.$;"1"===a("#showSpinnerOnProceedToCheckout").attr("content")&&(m.show(),r.when("ready").execute(function(){m.hide()}))});"use strict";r.when("A","loading-spinner-controller","ajax-utility","currency-formatter","page-conductor","page-transition-controller").register("inline-points-register-controller",function(a,m,k,e,f,g){function l(a){var b=
new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))}function b(a){var b=v.$popover.find(".rewards-registration");m.hideSpinner(b);b.children("div").hide();b=b.find(".rewards-registration-error");a&&a.error?(a=b.find("[data-error\x3d'"+a.error+"']"),a.length?a.show():b.find("[data-error\x3d'rewards_SystemUnavailable']").show()):
b.find("[data-error\x3d'rewards_SystemUnavailable']").show();b.fadeIn(300)}function d(a){v=a.popover;var c=v.$popover.find(".rewards-registration");m.showSpinner(c,!1,v);a=c.data("issuer-id");var d=c.data("program-id"),e=c.data("cc-issuer"),h=c.data("cc-brand");c=c.data("parent-payment-method-id");var p="/gp/buy/payselect/handlers/get-rewards-configuration.html?cachebuster\x3d"+(new Date).getTime();x.ajax({type:"POST",url:p,data:"programid\x3d"+d+"\x26partner\x3d"+a+"\x26ccpaymentinstrumentid\x3d"+
c+"\x26issuer\x3d"+e+"\x26brand\x3d"+h+"\x26hasWorkingJavascript\x3d1",dataType:"text",async:!0,cache:!1,dataFilter:function(a){return k.jsonify(a)},success:function(a,b,c){b=v.$popover.find(".rewards-registration");m.hideSpinner(b);c=a.fields||{};for(var d in c)if(c.hasOwnProperty(d)){var e=c[d],h=b.find("[data-field\x3d'"+e.type+"']");e.value&&h.filter("input").attr("value",e.value);h.parents(".rewardsfield").show()}a.termshtml&&b.find(".rewardstermstext").html(l(a.termshtml));a.billingzip&&b.find("[data-field\x3dBILLING_POSTAL_CODE]").attr("value",
a.billingzip);if(a.displaydata){d=b.find("[data-field]");for(var n in a.displaydata)a.displaydata.hasOwnProperty(n)&&d.filter("[data-field\x3d"+n+"]").html(a.displaydata[n])}a.marketinglink&&b.find("[data-field\x3d'rewards_marketing_link']").html(a.marketinglink);b.find("#rewards-registration-image").show();b.find(".rewards-registration-main").fadeIn(300);v.updatePosition(!0)},error:function(a){b(a)}})}function c(){if(v){var a=v.$popover.find(".rewards-registration");m.hideSpinner(a);a.find(".rewards-registration-success").hide();
a=a.find(".rewards-registration-error");a.hide();a.find("h4").hide();y&&(g.show(),f.isSPP()?f.reloadPage():x("div.pay").length?f.loadPage("payselect","payselect"):x("div.spc").length&&f.loadPage("spc","spc"))}}function h(a){return a.is("input")?a:a.find("input")}function p(){if(v){var a=v.$popover.find(".rewards-registration");a.find(".rewards-registration-main").hide();a.find("#rewards-registration-image").hide();m.showSpinner(a,!1,v);var c=(new Date).getTime(),d="programid\x3d"+encodeURIComponent(a.data("programId"));
d+="\x26paymentinstrumentid\x3d"+encodeURIComponent(a.data("parent-payment-method-id"))+"\x26hasWorkingJavascript\x3d1\x26returnjson\x3d1\x26cachebuster\x3d"+c;var p=a.find("[data-field]");p.each(function(){var a=x(this).attr("data-field");if("CVV2"===a)d+="\x26registerRewardsCreditCardVerificationNumber\x3d"+encodeURIComponent(x(this).val());else if(x(this).data("entryindex")){if(1===x(this).data("entryindex")){var b=p.filter("[data-field\x3d"+a+"]").sort(function(a,b){return Number(x(a).data("entryindex"))-
Number(x(b).data("entryindex"))});d+="\x26"+a+"\x3d";b.each(function(){d+=encodeURIComponent(x(this).val())})}}else"TERMS_AND_CONDITIONS"===a?h(x(this)).is(":checked")&&(d+="\x26"+a+"\x3dtrue"):d+="\x26"+a+"\x3d"+encodeURIComponent(x(this).val())});c="ox_pay_page_swp_reg_popover_submit";a.data("programId")&&(c+="_"+a.data("programId"));a="/gp/buy/payselect/handlers/register-rewards-account.html/ref\x3d"+c+"?cachebuster\x3d"+(new Date).getTime();x.ajax({type:"POST",url:a,data:d,dataType:"text",async:!0,
cache:!1,dataFilter:function(a){return k.jsonify(a)},success:function(a,c,d){a?a&&0===a.success?b(a):v&&(c=v.$popover.find(".rewards-registration-success"),c.find(".customername").text(a.customername),a.dollarbalancedisplay&&a.pointsbalance&&(c.find("[data-field\x3d'rewardsamount']").html(a.dollarbalancedisplay),c.find("[data-field\x3d'pointsamount']").html(e.getNumberWithSeparators(a.pointsbalance,a.rewardsdecimalplaces)),c.find(".rewardsuccessbalance").show()),a.showwarnmessage&&c.find(".warnmessage").show(),
y=!0,c.fadeIn(300),m.hideSpinner(v.$popover.find(".rewards-registration"))):b()},error:function(a){b(a)}})}}var x=a.$,v,y=!1;a.on("a:popover:show:rewards-registration",d);a.on("a:popover:hide:rewards-registration",c);a.declarative("close-rewards",["click"],function(a){a.$event.preventDefault();a.$target.closest(".a-popover").find(".a-button-close").trigger("click")});a.declarative("rewards-signup",["click"],function(a){a.$event.preventDefault();p(a)});a.declarative("toggle-reward-signup-button","change",
function(a){a=a.$target;var b=v.$popover.find(".rewards-registration");a&&a.is(":checked")?(b.find("#reward-signup-button").removeClass("aok-hidden"),b.find("#disabled-reward-signup-button").addClass("aok-hidden")):(b.find("#reward-signup-button").addClass("aok-hidden"),b.find("#disabled-reward-signup-button").removeClass("aok-hidden"))});a.on("a:popover:beforeShow:cvv2helpcontent",function(a){a.popover.$popover.find(".a-popover-inner").html(x(".cvv2helpcontent").text());a.popover.updatePosition()});
return{displayRewardsRegister:d,hideRewardsRegister:c}});"use strict";r.when("A","error-feature-detection","safe-mash","ready").register("shared-kitchensink",function(a,m,k){var e=a.$;a.on("checkout:reload",function(){(e("body.a-touch").length||e("div.a-touch:first").length)&&e("html").addClass("a-touch");e("form").each(function(){var a=e(this).find('input[name\x3d"hasWorkingJavascript"]');a&&0<a.length?a.val("1"):e(this).append('\x3cinput type\x3d"hidden" name\x3d"hasWorkingJavascript" value\x3d"1" /\x3e')});
k&&(e("div.checkout-tablet a[target\x3d'AmazonHelp']").each(function(){var a=e(this).attr("href");a+=0<=a.indexOf("?")?"\x26app-nav-type\x3dmodal":"?app-nav-type\x3dmodal";a=a.replace("#","");e(this).attr("href",a);e(this).removeAttr("data-action");e(this).removeAttr("data-help-popup");e(this).removeAttr("onclick")}),e("div.checkout.mobile a[target\x3d'AmazonHelp']").each(function(){var a=e(this).attr("href");a=a.replace("#","");e(this).attr("href",a);e(this).removeAttr("data-help-popup");e(this).removeAttr("onclick");
e(this).addClass("a-declarative help-popup");e(this).attr("data-action","help-popup")}));if(0<e("div.checkout-tablet").length)for(var a=document.getElementsByTagName("a"),g=0;g<a.length;g++)a[g].href||(a[g].href="#")});e(document).bind("jsdetection",function(){m.markFeatureAvailable("javascript-detection")})});r.when("A","safe-mash","ready").execute(function(a,m){var k=a.$;a.declarative("mash-navigate",["click"],function(a){a=a.$currentTarget.attr("href");m&&m.navigate?m.navigate({url:a}):q.location.href=
a});a.declarative("expander-scroll-there",["click"],function(a){if("false"!==a.$currentTarget.closest(".a-expander-container").find(".a-expander-content").attr("aria-expanded")){var e=k(q),g=k(document),l=a.$currentTarget.offset().top,b=0,d=0,c=function(){q.setTimeout(function(){e.scrollTop(l);b===g.height()?d++:(d=0,b=g.height());10>d&&c()},10)};c()}})});q.amz_js_PopWin=function(a,m,k){(a=q.open(a,m,k))&&a.focus&&a.focus();return!1};var ta=!1;q.confirmPurchase_onSubmit||(q.confirmPurchase_onSubmit=
function(){return ta?!1:ta=!0});"use strict";r.when("A","error-feature-detection","loading-spinner-spp-controller","loading-spinner-aui-controller").register("loading-spinner-controller",function(a,m,k,e){function f(){return b("#checkout-spinner").length}function g(a){if(d&&c){if(x&&w){a=x.getContent();var e=a.innerHeight();var p=a.innerWidth();var n=a.offset()}else e=a.height(),p=a.width(),n=a.offset();a=c.width();var f=c.height();if(h)n="1"===b("input[name\x3dfromAnywhere]").val()?b(document).height():
b(q).height(),d.width(b(document).width()).height(n).css("left","0px").css("z-index",2E3),c.css("left",p/2-a/2+"px").css("top",e/2-f/2+"px").css("z-index",4E3).show();else{var g=b(q),l=w?g.scrollLeft():0;d.css("position","fixed").width(p).height(e).css("z-index",3E3).css("left",n.left-l).css("top",n.top-g.scrollTop());v?c.css("position","fixed").css("left",n.left-l+(p/2-a/2)+"px").css("top",n.top-g.scrollTop()+(e/2-f/2)+"px").css("z-index",4E3).show():c.css("left",p/2-a/4+"px").css("top",e/2-f/4+
"px").css("z-index",4E3).show()}}}function l(){var a="https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-4x._V391853216_.gif",e=b("#first-pipeline-load-page-spinner-img");e.length&&(a=b.trim(e.attr("src")));1>b("#loading-spinner-blocker-doc").length&&(a=b(['\x3cdiv class\x3d"template loading-spinner" style\x3d"display:none"\x3e\x3cdiv class\x3d"loading-spinner-blocker"\x3e\x3c/div\x3e\x3cdiv class\x3d"loading-spinner-inner"\x3e','\x3cimg id\x3d"loading-spinner-img" class\x3d"loading-spinner-img" src\x3d"'+
a+'"/\x3e','\x3c/div\x3e\x3c/div\x3e\x3cdiv id\x3d"loading-spinner-blocker-doc" class\x3d"loading-spinner-blocker" style\x3d"display:none;"\x3e\x3c/div\x3e\x3cdiv id\x3d"spinner-anchor" class\x3d"spinner-anchor" style\x3d"display:none"\x3e\x3c/div\x3e'].join("")),c=d=p=null,"1"===b("#showSpinnerWithoutBox").attr("content")&&a.find(".loading-spinner-inner").addClass("loading-spinner-inner-no-box"),b("body").prepend(a));b("input[name\x3duseModifiedSpinnerResizeFn]").length&&(v=!0);b("#useRelativeSpinner").length&&
(y=!0);b("#modifiedBlockerDivSize").length&&(w=!0)}var b=a.$,d,c,h,p,x,v=!1,y=!1,w=!1,n=!1;a.on("a:popover:positionUpdated",function(a){if(w&&x&&x.name===a.popover.name&&d&&c){var e=x.getContent();a=e.innerHeight();var h=e.innerWidth();e=e.offset();var p=b(q);d.width(h).height(a).css("left",e.left-p.scrollLeft()).css("top",e.top-p.scrollTop());c.css("left",e.left-p.scrollLeft()+(h/2-c.width()/2)+"px").css("top",e.top-p.scrollTop()+(a/2-c.height()/2)+"px")}});l();a.on("checkout:reload",l);return{showSpinner:function(a,
l,A){if(y&&!l&&w&&v&&A)return n=!0,k.showSpinner(a,A);f()?e.showSpinner():(n=!1,0!==a.length&&(x=(h=l)?G:A,p||(p=b(".loading-spinner.template").clone().removeClass("template"),p.show()),a.append(p),h?(d=b("#loading-spinner-blocker-doc"),a.find(".loading-spinner-blocker").hide()):d=a.find(".loading-spinner-blocker"),d.show(),h&&m.markFeatureUnavailable("continue-action"),c=a.find(".loading-spinner-inner"),g(a)))},hideSpinner:function(a,b){if(f())return e.hideSpinner();if(n)return n=!1,k.hideSpinner(a,
b);n=!1;d&&(h&&(d.hide(),m.markFeatureAvailable("continue-action")),p.detach());b&&a.hide()},adjustSize:function(a){return f()?e.adjustSize():n?k.adjustSize():g(a)}}});"use strict";r.when("A","error-feature-detection").register("loading-spinner-spp-controller",function(a,m){function k(){if(f&&g){var a=b.innerHeight(),d=b.innerWidth();f.width(d).height(a);g.css("left",d/2-g.width()/2+"px").css("top",a/2-g.height()/2+"px")}}var e=a.$,f,g,l,b,d;a.on("a:popover:positionUpdated",function(a){d&&d.name===
a.popover.name&&k()});a.on("checkout:reload",function(){var a="https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-4x._V391853216_.gif",b=e("#first-pipeline-load-page-spinner-img");b.length&&(a=e.trim(b.attr("src")));1>e(".loading-spinner-spp").length&&(a=e(['\x3cdiv class\x3d"template loading-spinner-spp" style\x3d"display:none"\x3e\x3cdiv class\x3d"loading-spinner-spp-blocker"\x3e\x3c/div\x3e\x3cdiv class\x3d"loading-spinner-spp-inner"\x3e','\x3cimg class\x3d"loading-spinner-spp-img" src\x3d"'+
a+'"/\x3e',"\x3c/div\x3e\x3c/div\x3e"].join("")),g=f=l=null,"1"===e("#showSpinnerWithoutBox").attr("content")&&a.find(".loading-spinner-inner").addClass("loading-spinner-inner-no-box"),e("body").prepend(a))});return{showSpinner:function(a,h){0!==a.length&&(d=h,b=a,l||(l=e(".loading-spinner-spp.template").clone().removeClass("template"),l.show()),h.getContent().before(l),b.prepend(l),f=b.find(".loading-spinner-spp-blocker"),f.show(),g=b.find(".loading-spinner-spp-inner"),k())},hideSpinner:function(a,
b){f&&l.detach();b&&a.hide()},adjustSize:k}});"use strict";r.when("A","error-feature-detection").register("loading-spinner-aui-controller",function(a,m){function k(){return e("#checkoutDisplayPage").outerHeight()}var e=a.$;return{showSpinner:function(){m.markFeatureUnavailable("continue-action");var f=e("#checkout-spinner");a.show(e("#checkout-spinner-overwrap").height(k()));f.attr("aria-busy","true");a.show(f)},hideSpinner:function(){m.markFeatureAvailable("continue-action");var f=e("#checkout-spinner");
a.hide(e("#checkout-spinner-overwrap"));f.attr("aria-busy","false");a.hide(f)},adjustSize:function(){var f=e("#checkout-spinner-overwrap");f.is(":visible")&&a.show(f.height(k()))}}});"use strict";r.when("A","page-transition-controller","ajax-utility","page-detector-current-page","checkout-general-utils","client-side-metrics","safe-mash","cache-page-data-controller","ajax-wrapper","widget-streamer","widget-streamer-utils","weblab-helper","payment-marketplace-helper","pipeline-dispatch-endpoint","a-modal",
"checkout-view-modal-handler").register("page-conductor",function(a,m,k,e,f,g,l,b,d,c,h,p,x,v,y,w){function n(a){q.ueLogError&&q.ueLogError({message:a},{logLevel:"WARN",attribution:"CheckoutCommonAsset-PageConductor"})}function u(){var a=document.querySelector("meta[name\x3d'anti-csrftoken-a2z']");return a?a.getAttribute("content"):""}function B(a){""!==u()&&(a?a["anti-csrftoken-a2z"]=u():a={"anti-csrftoken-a2z":u()});ja&&(a?(a["x-amz-checkout-transition"]||(a["x-amz-checkout-transition"]="ajax"),
a["x-amz-checkout-type"]||(a["x-amz-checkout-type"]="spp")):a={"x-amz-checkout-transition":"ajax","x-amz-checkout-type":"spp"});p.isPipelineDispatchSendHeaderEnabled()&&(a?a["x-amz-checkout-transition"]||(a["x-amz-checkout-transition"]="ajax"):a={"x-amz-checkout-transition":"ajax"});return a}function A(a){""!==u()&&(a?a["anti-csrftoken-a2z"]=u():a={"anti-csrftoken-a2z":u()});ja&&a&&(a["x-amz-checkout-type"]?a={"x-amz-checkout-type":"spp"}:a["x-amz-checkout-type"]="spp");return a}function t(){T=!1;
ea=null;Ba=0;Ca=null;Ea=!1;ua=za=Fa=null}function M(a){var b=parseInt(F("#checkoutDisplayPage").data("delaySetTitle"),10)||0;b?q.setTimeout(function(){document.title=a},b):document.title=a}function K(b){"function"===typeof a.state.parse&&a.state.parse();a.trigger("checkout:beforeReload");a.trigger("checkout:reload");b&&("spp-revieworder"===b?a.trigger("checkout:reload:spc"):a.trigger("checkout:reload:"+b));a.trigger("checkout:afterReload")}function P(a){m.show();var b="/gp/buy/addtocart/handlers/display.html";
a&&(b+="?errorType\x3d"+a);q.location=b}function O(b){(b=F("#pageTypeRedirectedTo").text())&&a.trigger("checkout:reload:"+b)}function H(b,c){if(c.getResponseHeader("x-amz-force-full-page-update"))N(b);else{if(c.getResponseHeader("x-amz-checkout-redirect-addtocart")){(c=k.jsonify(b))?P(c.errorCode):P();return}var d=Ka(b)}b=F("#pipelinedPageTitle").text();M(b);var e=c.getResponseHeader("x-amz-checkout-page");ja?a.delay(function(){K(e)},d):K(e)}function N(a){g.increaseCount("Checkout:PageConductor:FullPageUpdateForced");
var b=document.open("text/html","replace");b.write(a);b.close()}function Q(b,c,d){try{if(c.getResponseHeader("x-amz-force-full-page-update"))N(b);else{if(!La)throw Error("Member _updateDisplayPageContent not set in page-conductor. Make sure 'initFunc' is called.");a.trigger("checkout:updateDisplayPageContent:before");La(b,d);a.trigger("checkout:updateDisplayPageContent:after")}}catch(xa){b="Error while replacing page content.",xa.message&&(b+="  Error message: "+xa.message),r.error(b,"page-conductor",
"replaceDisplayPage",xa)}b=F("#pipelinedPageTitle").text();M(b);c=c.getResponseHeader("x-amz-checkout-page");K(c)}function S(a){var b=parseInt(F("#showPageTransition").attr("content"),10);(b=isNaN(b)?1:b)||m.hide();b="/gp/buy/shared/handlers/dispatch.html";a&&(a.conductoraction&&a.conductoraction.url?b=a.conductoraction.url:a.pipedata&&a.pipedata.conductoraction&&a.pipedata.conductoraction.url&&(b=a.pipedata.conductoraction.url));b=0<b.indexOf("?")?b+"\x26":b+"?";F("input[name\x3dfromAnywhere][value\x3d1]").length&&
(b+="fromAnywhere\x3d1");b=ma(b);l&&F("html").hasClass("a-tablet")&&-1<b.indexOf("/gp/cart/view.html")&&(b="/gp/aw/c?app-action\x3dcart");q.location=b}function R(a,c,d,e,h){e=e||{};e.pushNewFrame=e.pushNewFrame||"true";e.anchor=e.anchor||G;e.isBackButtonClicked=e.isBackButtonClicked||"false";t();"true"===e.pushNewFrame&&l&&l.navigate&&F("#checkoutDisplayPage").data("useMashNavigateForTransitions")?l.navigate({url:null,transitionEffect:"slide",successCallback:function(){W(a,c,d,e,h)},failCallback:function(a){}}):
W(a,c,d,e,h);e.keepCachedPagesData||b.clearCache()}function J(){var a=F("input#isPipelinedPage");return f.isChewbaccaUrl()||0<a.length&&"1"===a.val()}function V(a){return p.isExecutionIdInQueryStringEnabled()?a?a.getResponseHeader("x-amz-checkout-executionid"):f.getQueryStringParameter(q.location.href,"executionId"):F("input#executionId").val()}function W(b,c,d,l,m){function u(a){var b=d.getResponseHeader(a);null==b&&(g.increaseCount("Checkout:PageConductor:Ajax:Update:MissingHeader"),g.increaseCount("Checkout:PageConductor:Ajax:Update:MissingHeader:"+
a),n("performUpdatePageFromResponse is missing required header "+a));return b}function B(a){var b=/^\s*<(?:!doctype|html)/;if("string"===typeof a&&a.match(b)){b=(new DOMParser).parseFromString(a,"text/html");var c=F(b).find("#checkoutDisplayPage");if(0<c.length)return g.increaseCount("Checkout:PageConductor:Ajax:Update:CenterContentExtracted"),c[0].outerHTML;b=F(b).find("body");if(0<b.length)return g.increaseCount("Checkout:PageConductor:Ajax:Update:BodyExtracted"),b[0].outerHTML}return a}l=l||{};
l.pushNewFrame=l.pushNewFrame||"true";l.anchor=l.anchor||G;l.isBackButtonClicked=l.isBackButtonClicked||"false";l.mixedContentFallback=l.mixedContentFallback||"fallback";var t=u("x-amz-checkout-page"),x=u("x-amz-checkout-requestid"),T=e.getCurrentPage();e.setCurrentPage(t);if(l.freshLoad)l.freshLoad=!1,r.when("first-load-dependencies").execute(function(a){W(b,c,d,l)});else if(t){F("head .aui-page-asset").removeAttr("disabled");F("head .old-pipeline-asset").removeAttr("disabled");g.setAsyncRequestId(x);
var aa=d.getResponseHeader("x-amz-checkout-redirect");if(aa)S({conductoraction:{url:aa,type:"redirect"}});else if(f.isChewbaccaUrl(document.location.pathname)&&"reload"==l.mixedContentFallback)g.increaseCount("Checkout:PageConductor:mixedContentFallback:"+l.mixedContentFallback),location.reload();else{p.isIngressEnabled()&&(b=B(b));if(p.isAJAXWeblabOn()&&h.isStreamingAjax(d))p.isAjaxStreamingEnabled()?K(t):(O(d),E(b,t));else if(a.trigger("checkout:unload"),aa=u("x-amz-checkout-url"),0<F("#checkoutDisplayPage").length?
Q(b,d,t!==T):(ka()||va())&&null==k.jsonify(b)?Q(b,d):"addressintercept"===t?q.location=aa:H(b,d),p.isAjaxStreamingEnabled()&&J()){T=F("#pipelinedPageTitle").text();var A=d.getResponseHeader("x-amz-checkout-additional-page-args");X(t,T,aa,V(d),A,l)}!p.isAjaxStreamingEnabled()&&J()&&(T=F("#pipelinedPageTitle").text(),aa=u("x-amz-checkout-url"),A=d.getResponseHeader("x-amz-checkout-additional-page-args"),X(t,T,aa,V(d),A,l));ja||ha(t);l.anchor&&(t=F(l.anchor),0===t.length&&(t=l.anchor.replace("#",""),
t=F(document.getElementsByName(t))),t.length&&F(document).scrollTop(t.offset().top));l.logUsedPrefetch&&r.when("action-logger").execute(function(a){a.logUsedPrefetch(u("x-amz-checkout-page-type"),u("x-amz-checkout-sub-page-type"),x,m)})}}else{if(q.getOldAjaxSuccessCallback)return q.getOldAjaxSuccessCallback("ajaxConductor","generalErrorHandling","generalErrorHandling")(b,c,d);b=k.jsonify(b);S(b)}}function X(a,b,c,d,e,h){if(!w.isModalActive()){var n=h.anchor,g=h.pushNewFrame;h=h.isBackButtonClicked;
b&&c&&q.history&&q.history.pushState&&(p.isExecutionIdInQueryStringEnabled()?"true"!==g||history.state&&history.state.page===a||(c=ma(c),n&&(c+=n),d&&(c=f.addQueryStringParameterOrDeleteIfEmpty(c,"executionId",d)),history.pushState({page:a,additionalURLArgs:e},b,c)):(c=ma(c),n&&(c+=n),d&&(c=f.addQueryStringParameter(c,"executionId",d)),history.state&&history.state.page!==a&&("true"===g&&history.pushState({page:a,additionalURLArgs:e},b,c),"false"===g&&"true"===h&&f.isChewbaccaUrl(document.location.pathname)&&
ja&&!ka()&&!va()&&history.replaceState({page:a,additionalURLArgs:e},b,c))))}}function ha(a){var b=F("#checkoutDisplayPage");if(b.length){var c=0<=document.location.search.indexOf("pipelineType\x3dChewbacca")?"multi-page-pipeline-chewbacca":ja?"single-page":"multi-page";b.attr({"data-checkout-pipeline":c,"data-checkout-page":a||""})}}function E(a,b){a.executeActions();a=F("#pipelinedPageTitle").text();M(a);K(b)}function U(){Ma?q.location="/gp/buy/addtocart/handlers/display.html":(g.increaseCount("Checkout:PageConductor:RedirectToSorryPage"),
q.location="/gp/buy/payselect/handlers/error.html")}function Y(b,c,e,n,g,l){n=n||{};n.refTag=n.refTag||"";n.pushNewFrame=n.pushNewFrame||"true";n.anchor=n.anchor||G;n.isBackButtonClicked=n.isBackButtonClicked||"false";n.refTag&&0!==n.refTag.indexOf("/ref\x3d")&&(n.refTag="/ref\x3d"+n.refTag);var k="";g&&f.isChewbaccaUrl(g)||(k="fromPage\x3d"+b+"\x26page\x3d"+c);(b=V(l))&&(k+="\x26executionId\x3d"+b);e&&(k+="\x26"+e);c=v.get(g||"/gp/buy/shared/handlers/pipeline-dispatch.html",{nextPage:c});f.isChewbaccaUrl(c)||
(c+=n.refTag);e=function(){};g=function(){};"function"===typeof n.resultscallback?(b=function(a,b,c){n.resultscallback(a,b,c)},l=function(a,b,c){n.resultscallback(G,b,a)}):(e=function(b){a.trigger("checkout:beforeLoadPage");Ga&&Ga.abort();Ga=b},b=function(a,b,c){p.isAJAXWeblabOn()&&h.isStreamingAjax(c)||n.callbackBeforePageUpdate&&n.callbackBeforePageUpdate();R(a,b,c,n);n.callbackAfterPageUpdate&&n.callbackAfterPageUpdate()},l=function(a,b,c){"abort"!==b&&("error"===b&&a.readyState===d.READY_STATE.UNSET?
r.when("a-tv","mash").execute(function(a,b){q.cordova.exec(null,null,"MASHDisplayErrorPlugin","execute",{})}):(ba(a,b),U()))},g=function(a){Ga=null});k={type:"GET",url:c,data:k,dataType:"text",async:!0,beforeSend:e,success:b,error:l,complete:g,cache:!1};if(ka()&&!f.isChewbaccaUrl(c)||va())k.headers=A();else if(ja||p.isPipelineDispatchSendHeaderEnabled())k.headers=B({"x-amz-checkout-transition":"ajax"});ca(k);return p.isAJAXWeblabOn()?(k.useXMLHttp=!0,c=Da(n),k=Z(k,c),d.aui(k)):F.ajax(k)}function Z(b,
d){b.timeout=5E4;b.data=z(b.data,"acceptsStreaming\x3d1");var n=b.data.match(/.*isAsync=1.*/)?!0:!1,g=d.callbackBeforePageUpdate;ya=c({$target:F("#checkoutDisplayPage"),updateTriggerEvent:"pageReady",immediateExecution:!n,updateTarget:F("#checkoutDisplayPage"),onUpdate:function(b){"function"===typeof g&&g();a.trigger("checkout:unload");M(b.title);d.pushNewFrame=d.pushNewFrame||"true";X(b.page,b.title,b.url,b.executionId,b.additionalURLArgs,d);e.setCurrentPage(b.page)}});b.chunk=ya.chunkHandler;if(!p.isAjaxStreamingEnabled()){var f=
b.success;b.success=function(a,b,c){f&&h.isStreamingAjax(c)?f(ya,b,c):f&&f(a,b,c)}}return b}function z(a,b){return a?a+"\x26"+b:b}function ca(a){if(a.data.match(/.*isAsync=1.*/))return a.headers?a.headers["x-amzn-tiertwo"]="yes":a.headers={"x-amzn-tiertwo":"yes"},g.increaseCount("Checkout:PageConductor:Prefetch:Tagging:T"),!0;g.increaseCount("Checkout:PageConductor:Prefetch:Tagging:C");return!1}function ba(a,b){g.increaseCount("Checkout:PageConductor:Ajax:Error");p.isAJAXWeblabOn()?(a?(g.increaseCount("Checkout:AUI:Ajax:jqXHR:defined"),
n("jqXHR defined throw CheckoutErrorAW under AJAX Weblab, textStatus:"+b+" stateCode:"+a.state+" readyState:"+a.readyState)):a===G?(g.increaseCount("Checkout:AUI:Ajax:jqXHR:undefined"),n("jqXHR undefined throw CheckoutErrorAW under AJAX Weblab")):null===a&&(g.increaseCount("Checkout:AUI:Ajax:jqXHR:null"),n("jqXHR null throw CheckoutErrorAW under AJAX Weblab")),g.increaseCount("Checkout:AUI:Ajax:Error:textStatus:"+b),g.increaseCount("Checkout:AUI:Ajax:Error:statusCode:"+a.status),g.increaseCount("Checkout:AUI:Ajax:Error:readyState:"+
a.readyState)):(a?(g.increaseCount("Checkout:jQuery:Ajax:jqXHR:defined"),n("jqXHR defined throw CheckoutErrorAW using jQuery, textStatus:"+b+" stateCode:"+a.state+" readyState:"+a.readyState)):a===G?(g.increaseCount("Checkout:jQuery:Ajax:jqXHR:undefined"),n("jqXHR undefined throw CheckoutErrorAW using jQuery")):null===a&&(g.increaseCount("Checkout:jQuery:Ajax:jqXHR:null"),n("jqXHR null throw CheckoutErrorAW using jQuery")),g.increaseCount("Checkout:jQuery:Ajax:Error:textStatus:"+b),g.increaseCount("Checkout:jQuery:Ajax:Error:statusCode:"+
a.status),g.increaseCount("Checkout:jQuery:Ajax:Error:readyState:"+a.readyState))}function ia(a,b,c,e){function h(){var c=a;b+="\x26"+a.substring(u+1);a=a.substring(0,u);c=f.buildFilteredQueryString(c,ta);""===c?g.increaseCount("Checkout:PageConductor:submitAjax:url:hasNoAllowlistedQueryParameter"):g.increaseCount("Checkout:PageConductor:submitAjax:url:hasAllowlistedQueryParameter");a+=c}var l=a;b=z(b,"isClientTimeBased\x3d1");if(p.refactorExtractURL()){var k=f.extractURLParts(a);a=k.normalizedUrl;
if(!a)return g.increaseCount("Checkout:PageConductor:submitAjax:url:missingHtml:T1"),n("Unable to normalize url ["+l+"]. Ajax request aborted."),!1;var m=a.indexOf("/gp/buy/");0<m?(a=a.substring(m),g.increaseCount("Checkout:PageConductor:submitAjax:url:removedGpBuy:T1")):g.increaseCount("Checkout:PageConductor:submitAjax:url:missingGpBuy:T1");k.query?(b+="\x26"+k.query,g.increaseCount("Checkout:PageConductor:submitAjax:url:hasQueryPart:T1")):g.increaseCount("Checkout:PageConductor:submitAjax:url:missingQueryPart:T1");
k=k.refMarker;k||(g.increaseCount("Checkout:PageConductor:submitAjax:url:missingRefMarker:T1"),k="");k&&-1===k.indexOf("ref\x3d")&&(g.increaseCount("Checkout:PageConductor:submitAjax:url:refMarkerMalformed:T1"),k="")}else{var u=a.indexOf("?"),t=f.isChewbaccaUrl(a);0<u?(h(),g.increaseCount("Checkout:PageConductor:submitAjax:url:hasQueryPart:C")):g.increaseCount("Checkout:PageConductor:submitAjax:url:missingQueryPart:C");m=a.indexOf("/gp/buy/");0<m?(a=a.substring(m),g.increaseCount("Checkout:PageConductor:submitAjax:url:removedGpBuy:C")):
g.increaseCount("Checkout:PageConductor:submitAjax:url:missingGpBuy:C");if(t)a=a.slice(a.indexOf("/checkout/p/p-")),g.increaseCount("Checkout:PageConductor:submitAjax:url:chewbacca:C");else{if(-1===a.indexOf(".html"))return g.increaseCount("Checkout:PageConductor:submitAjax:url:missingHtml:C"),n("url ["+l+"] is missing html extension and not a chewbacca call. Ajax request aborted."),!1;l=a.indexOf(".html");k=a.substring(l+5);a=a.substring(0,l+5)}k||g.increaseCount("Checkout:PageConductor:submitAjax:url:missingRefMarker:C");
k&&-1===k.indexOf("ref\x3d")&&(g.increaseCount("Checkout:PageConductor:submitAjax:url:refMarkerMalformed:C"),k="")}t||(b+="\x26handler\x3d"+a);l="";l=v.get(t?a:"/gp/buy/shared/handlers/async-continue.html"+k);c={type:"POST",url:l,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:B({"x-amz-checkout-transition":"ajax"}),data:b,dataType:"text",async:!0,success:c,error:function(a,b,c){"abort"!==b&&("error"===b&&a.readyState===d.READY_STATE.UNSET?r.when("a-tv","mash").execute(function(a,
b){q.cordova.exec(null,null,"MASHDisplayErrorPlugin","execute",{})}):"function"===typeof e&&(ba(a,b),e()))},cache:!1};ca(c);return p.isAJAXWeblabOn()?(c.useXMLHttp=!0,Z(c,{}),d.aui(c)):F.ajax(c)}function aa(a,b,c,d,e){e=e&&e.action?e.action:a.attr("action");a=a.serialize();d&&(a+="\x26isAsync\x3d1");return ia(e,a,b,c)}function C(a,b,c,d){a=ma(a.attr("href"));d&&(a+="\x26isAsync\x3d1");return ia(a,"",b,c)}function qa(a){a=a||{};a.logUsedPrefetch=1;R(ea.data,ea.status,ea.response,a,ea.refMarker)}function ma(a){-1===
a.toLowerCase().indexOf("hasworkingjavascript")&&(a+=(0<=a.indexOf("?")?"\x26":"?")+"hasWorkingJavascript\x3d1");return a}function I(a){Ea=!1;var b=e.getCurrentPage(),c=ua-za,d=Ba,h=a.data("pushNewFrame"),n=function(a,b,c){"boolean"===typeof h&&!1===h?R(a,b,c,{pushNewFrame:"false"}):R(a,b,c)};Aa&&clearTimeout(Aa);if(a.is("form"))ra(a)?(qa(),g.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+d+":Success"),g.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+d+":TimeSaved",c)):(aa(a,n,U),
g.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+d+":Failure:Invalid"));else if(a.is("a"))if(sa(a)){var p;1===parseInt(a.data("keepCachedPagesData"),10)&&(p={keepCachedPagesData:1});qa(p);g.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+d+":Success");g.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+d+":TimeSaved",c)}else C(a,n,U),g.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+d+":Failure:Invalid");else g.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+d+":Failure:NoTrigger"),
r.error("function called without a trigger","page-conductor","handleContinueAction")}function ra(a){return a.is("form")&&null!==ea&&ea.serializedValue===a.serialize()}function sa(a){return a.is("a")&&null!==ea&&ma(ea.serializedValue)===ma(a.attr("href"))}function la(a){return Ia&&(a.is("form")&&Ia!==a.serialize()||a.is("a")&&ma(Ia)!==ma(a.attr("href")))}function na(a,b,c,d,n){function l(e,f,l){var x=!0;if("success"===f){if(!p.isAJAXWeblabOn()||!h.isStreamingAjax(l)){var K=k.jsonify(e);null!==K&&K&&
K.result&&"noPrefetch"===K.result&&(ea=null,x=!1)}x&&(ea={},ea.serializedValue=B,ea.data=e,ea.status=f,ea.response=l,ea.refMarker=t,null==ua&&(ua=(new Date).getTime()))}else ea=null,g.increaseCount("Checkout:"+u+":PageConductor:Prefetch:"+Ba+":Failure:Response");T=!1;ja&&r.when("spp-button-blocker").execute(function(a){a.hideDefaultContinueBtnBlocker()});if("function"===typeof Ca&&Ca())return!0;if(Ea)return I(Fa),!0;if(x){var aa=function(){d?na(a,b,c,!0,n):da(a)};if(null===ea||"form"===m&&ea.serializedValue!==
a.serialize())return aa(),!0;b&&(0===b?g.increaseCount("checkoutPrefetchTimeoutSetToZero",1):Aa=setTimeout(function(){ea=null;aa()},1E3*b))}return!0}if(!J()||0===a.length)return!1;var m=a.get(0).tagName.toLowerCase();if("form"!==m&&"a"!==m||"function"===typeof n&&!n(m))return!1;b=b||0;c=c||0;d=d||!1;if(T||Ba>=c)return!1;T=!0;r.when("link-prefetch").execute(function(a){a.isClearCacheEnabled()&&a.clearCache()});ja&&r.when("spp-button-blocker").execute(function(a){a.showDefaultContinueBtnBlocker()});
Ba++;var u=e.getCurrentPage();za=(new Date).getTime();ua=null;g.increaseCount("Checkout:"+u+":PageConductor:Prefetch:"+Ba+":Attempted");Aa&&clearTimeout(Aa);var t=f.extractURLParts("form"===m?a.attr("action"):a.attr("href")).refMarker,B=null;if("form"===m){B=a.serialize();var x=p.isAJAXWeblabOn()?aa(a,l,l,!0):aa(a,null,null,!0)}else"a"===m&&(B=ma(a.attr("href")),x=p.isAJAXWeblabOn()?C(a,l,l,!0):C(a,null,null,!0));p.isAjaxStreamingEnabled()&&B&&(Ia=B);"object"!==typeof x||"function"!==typeof x.always||
p.isAJAXWeblabOn()||x.always(l)}function da(a){var b=parseInt(a.data("prefetchTimeout"),10),c=parseInt(a.data("maxPrefetches"),10);return na(a,b,c,!1,function(b){if(a.find("input:checked").hasClass("no-prefetch"))return!1;if(p.disablePrefetchForScheduledDeliveryWeblabOn()){var c=a.find("div.one-shipment:not(:hidden)").find("input:checked");if(c.parents('[data-a-input-name\x3d"'+c.attr("name")+'"]').hasClass("no-prefetch"))return!1}return"1"===F("input#block-prefetch").val()||"1"===F("input#block-all-prefetch").val()||
"form"===b&&!a.data("checkoutFormReady")?!1:!0})}function fa(a){return/.*\/checkout\/p\/.*\/spc/.test(a||q.window.location.pathname)}function ka(){return ja&&0<F(".checkout-experience-page-content").length}function va(){return ja&&0<F(".checkout-spp-non-panel-page-content").length}function oa(b,c){T&&null==ua&&(ua=(new Date).getTime());b&&b.preventDefault();var d=b?F(b.currentTarget):c;b=function(){var a=ka()&&"spc"===e.getCurrentPage();if(w.isModalActive())w.showModalSpinner();else if(ja&&!a){m.blockAllActions();
var b=d.data("shrink-panel");a=d.data("loading-text");(b=F("#"+b))&&b.length?b.hasClass("expanded")||m.shrinkPanel(F(".spp-panel.expanded"),!1):b=F(".spp-panel.expanded");m.shrinkPanel(b,!0,a)}else m.show()};g.resetMetrics();!pa||ra(d)||sa(d)?b():a.delay(b,0);try{Ea=!0,Fa=d,Ca=null,p.isAjaxStreamingEnabled()&&ya&&!la(d)&&ya.enableExecution(),T||I(d)}catch(xa){b="An error occurred while clicking the continue button.",xa.message&&(b+="  Error message: "+xa.message),r.error(b,"page-conductor","continueClicked",
xa)}}function wa(){F("#checkout-btf-spinner").addClass("aok-hidden")}function Da(a){var b={callbackBeforePageUpdate:a.callbackBeforePageUpdate,isBackButtonClicked:a.isBackButtonClicked};p.isAjaxStreamingEnabled()&&(b.anchor=a.anchor,b.pushNewFrame=a.pushNewFrame);return b}var F=a.$,T,za,ua,Ga,ea,Ba,Ea,Fa,Ca,Aa,Oa,La,Ia,Ka=function(b){if(!Oa)throw Error("Member _updatePageContent not set in page-conductor. Make sure 'initFunc' is called.");a.trigger("checkout:updatePageContent:before");b=Oa(b);a.trigger("checkout:updatePageContent:after");
return b},ja=!1,Ma=!1,Ja=!1,pa=!1,Pa=!1,ya,ta=["sif_profile","referrer","ref_"];t();a.declarative("page-transit-no-update-action","click",function(c){if(!Ja){c.$event.preventDefault();g.resetMetrics();var d=c.data.targetDeclarativeActionId;if(d&&(d=F("#"+d),d.length)){d.trigger("click");return}var h=c.data.toPage;d=c.data.fromPage||e.getCurrentPage();var n=c.data.refTag||"chk_"+d+"_cancel_pri",l=c.data.args,k=c.$currentTarget.find("a.checkout-pipeline-pref-link"),u=ka()&&"payselect"===d,B=ja&&"function"===
typeof x.isIN&&x.isIN();ja&&(u||B&&("spp-payment"===d||"spp-rxselect"===d)?("spp-payment"==d&&g.increaseCount("checkout:trueSPC:disableCachingPSP:"+h,1),"spp-rxselect"==d&&g.increaseCount("checkout:trueSPC:disableCachingRxSelect:"+h,1),u&&g.increaseCount("checkout:TangoDesktop:disableCachingPaySelect:"+h,1)):b.setCachedPageData(d,h));if(b.getCachedPageData(h,d)){g.increaseCount("checkout:"+d+":cancelpri",1);var T=b.getCachedPageData(h,d);t();e.setCurrentPage(T.page);var aa=p.isAJAXWeblabOn()?Ka(T.curPageData):
Ka(JSON.stringify(T.curPageData));if(ja)if(g.isTransitionLoggingEnabled()){var A=(new Date).getTime();g.logPageTransition(d+"-cached",h,G,function(b){b=(new Date).getTime()-A;b<aa?a.delay(function(){K(h)},aa-b):K(h)})}else a.delay(function(){K(h)},aa);else K(h);T.title&&T.url&&q.history&&q.history.pushState&&history.state&&history.state.page!==T.page&&history.pushState(T.state,T.title,T.url)}else k.length?oa(null,k):(g.increaseCount("checkoutSPPCancelNoCachedData",1),B&&"spp-payment"===h&&g.increaseCount("checkout:trueSPC:emptyPSPCacheFrom:"+
d,1),B&&ka()&&"payselect"===h&&g.increaseCount("checkout:TangoDesktop:emptyPSPCacheFrom:"+d,1),k=function(){if(ja)if(m.blockAllActions(),c.data.noShrink)m.show();else{var a=c.data.loadingText,b=F("#"+c.data.shrinkPanel);b.length||(b=c.$currentTarget.closest("div.spp-panel"));m.shrinkPanel(b,!0,a)}else m.show()},pa?a.delay(k,0):k(),(k=c.$currentTarget.find("a").attr("href"))&&f.isChewbaccaUrl(k)&&(T=k.substring(k.indexOf("/checkout/p/p-")),l=""),Y(d,h,l,{refTag:n,keepCachedPagesData:1},T))}});p.isAjaxStreamingEnabled()&&
(a.on("checkout:page:atf",function(){m.hide();F("#checkout-btf-spinner").removeClass("aok-hidden")}),a.on("checkout:page:end",function(){wa()}));a.on("ready",function(){pa=0<F("#executeNonBlockingAnimations").length;Pa=0<F("#prefetchFromAddressEnabled").length});a.on("checkout:tangoDesktop:fallback:complete",function(){Pa=0<F("#prefetchFromAddressEnabled").length});a.on("checkout:afterReload",function(){m.hide();p.isAjaxStreamingEnabled()&&wa();a.delay(g.sendUEPageLoadStats);if(J()){var c=F("form.checkout-page-form:not(:disabled):first"),
d=F("a.checkout-continue-link:not(:disabled):first");F("#useFirstActivePrefetch").length&&(d=F("a.checkout-continue-link:not(:disabled)").filter(function(){return 0<(parseInt(F(this).data("maxPrefetches"),10)||0)}).first());var e=!1;c.length&&(e=da(c));!e&&d.length&&(e=da(d));!e&&ja&&(c=F("a.checkout-pipeline-pref-link:not(:disabled):first"),c.length&&(d=c.data("fromPage"),e=c.data("toPage"),b.getCachedPageData(e,d)||(e=da(c))))}});return{ajaxUpdatePage:R,ajaxRedirect:S,ajaxSorryPage:U,isPageLoadRequestInProgress:function(){return Ga?
1:0},submitFormAjax:aa,reloadPage:function(){var a=e.getCurrentPage();Y(a,a)},loadPage:Y,usePrefetch:qa,makePrefetch:da,makePrefetchWithParams:na,isPrefetchValidFor:function(a,b){if(null!==ea){var c=ea.response.getResponseHeader("x-amz-checkout-page");if(b){var d=ea.response.getResponseHeader("x-amz-checkout-url");d=f.getUrlType(d);b=f.getUrlType(b);return a===c&&d===b}return a===c}return!1},redirect:S,continueClicked:oa,initFunc:function(a,b){Oa=a;La=b},overrideIsSPP:function(a){ja=a},isSPP:function(){return ja},
overrideAddToCart:function(a){Ma=a},isAnimating:function(){return Ja},overrideIsAnimating:function(a){Ja=a},setAjaxTransitionHeader:B,isPipeliningOn:J,disablePageNoUpdateTransition:function(){ka()?m.disableAllPanelActions():r.when("a-button").execute(function(a){var b=F(".spp-panel.expanded").data("stepIndex");F(".expand-collapsed-panel-trigger").each(function(){var c=F(this),d=c.parents(".spp-panel").data("stepIndex");if(!b||!d||d>b)c.filter(".clickable-heading").removeClass("clickable-heading").addClass("off-clickable-heading"),
a(c.filter(".expand-panel-button")).disable(),c.filter("a.expand-panel-button").addClass("disabled-link"),c.parents(".a-declarative").addClass("off-declarative").removeClass("a-declarative")});F(".panel-cancel-row").hide()})},enablePageNoUpdateTransition:function(){ka()?m.enableAllPanelActions():r.when("a-button").execute(function(a){F(".off-clickable-heading").addClass("clickable-heading").removeClass("off-clickable-heading");a(".expand-collapsed-panel-trigger.expand-panel-button").enable();F(".off-declarative").addClass("a-declarative").removeClass("off-declarative")})},
isNonBlockingAnimationEnabled:function(){return pa},isPrefetchFromAddressEnabled:function(){return Pa},getExecutionId:V,isPrefetchRequestInProgress:function(){return T},isRequestMixedContent:function(a,b){return fa(b)&&/data-checkout-page/.test(a)},isTangoSpc:fa,ajaxUpdate:function(b,c,d){d=d||{};"undefined"===typeof d.pushNewFrame&&(d.pushNewFrame=!1);"boolean"===typeof d.pushNewFrame&&(d.pushNewFrame=d.pushNewFrame.toString());var e="";c&&"object"===typeof c?e=a.map(c,function(a,b){return b+"\x3d"+
a}).join("\x26"):"string"===typeof c&&(e=c);Aa&&clearTimeout(Aa);g.resetMetrics();m.show();return ia(b,e,function(a,b,c){R(a,b,c,d)},U)},registerPrefetchCallback:function(a){if(T)if("function"===typeof a)Ea=!1,Fa=null,Ca=a;else{if("undefined"===typeof a||null===a)Ca=null}else"function"===typeof a&&a()},getAlternateDispatchUrl:function(a,b){var c="";if(f.isChewbaccaUrl(b)&&ja&&!ka()&&!va())return c;f.isChewbaccaUrl(b)&&(b=a.indexOf("/checkout/p/p-"),0<=b&&(c=a.substring(b)));return c}}});r.when("A",
"jQuery","page-transition-controller","ajax-utility","page-detector-current-page","checkout-general-utils","page-conductor","cache-page-data-controller","client-side-metrics","weblab-helper","ready").execute(function(a,m,k,e,f,g,l,b,d,c){if(l.isPipeliningOn()){q.history&&m(q).bind("popstate",function(){var a=this.history.state,b=f.getCurrentPage();if(a&&a.page&&b&&(a.page!==b||l.isPageLoadRequestInProgress()))if(k.show(),b=m("#checkoutDisplayPage"),b.data("wipeOnPipelineBackTransition")&&b.empty(),
d.resetMetrics(),m("#useFastBackButton").length&&l.isPrefetchValidFor(a.page,document.location.pathname))l.usePrefetch({pushNewFrame:!1});else{var c="spc"===a.page?"":a.page,e={refTag:"pipelinedBackButton",pushNewFrame:"false",isBackButtonClicked:"true"},h=l.getAlternateDispatchUrl(document.location.href,document.location.pathname);l.registerPrefetchCallback(function(){l.loadPage(f.getCurrentPage(),c,a.additionalURLArgs,e,h);return!0})}});m(document).delegate("form.checkout-page-form","change",function(a){m(a.target).parent().hasClass("no-prefetch-on-change")||
(a=m(a.currentTarget),l.makePrefetch(a))});m(document).delegate("form.checkout-page-form","submit",function(a){l.continueClicked(a)});m(document).delegate("a.checkout-continue-link","click",function(a){l.continueClicked(a)});a.declarative("checkout-page-form-submit","change",function(a){a=a.$target.closest("form.checkout-page-form");var b=a.attr("data-push-new-frame");"undefined"!==typeof b&&""!==b||a.attr("data-push-new-frame","false");a.submit()});m(document).delegate("form.checkout-page-form .submit-button-with-name",
"click",function(a){a=m(a.currentTarget);m("\x3cinput\x3e").attr({type:"hidden",name:a.attr("name"),value:a.val()}).appendTo(a.closest("form.checkout-page-form"))});var h=!1;m(document).delegate("a.pipeline-link, div.pipeline-link, span.pipeline-link a","touchmove",function(a){h=!0});m(document).delegate("a.pipeline-link, div.pipeline-link, span.pipeline-link a","click keypress touchend",function(a){if(h)h=!1,a.preventDefault();else if(g.protectAgainstDoubleAction("pipeline-link"))a.preventDefault();
else if("keypress"!==a.type||13===a.which){var c=m(a.currentTarget),e=c.data("pipelineLinkFromPage"),p=c.data("pipelineLinkToPage"),f=c.data("pipelineLinkAnchor"),n=c.data("pipelineLinkRef");n||((n=g.extractURLParts(c.attr("href")).refMarker)?d.increaseCount("Checkout:PageConductor:LoadPage:AddedRefMarker"):d.increaseCount("Checkout:PageConductor:LoadPage:NoRefMarkerInUrl"));var u=c.data("pipelineLinkArgs");p&&(d.resetMetrics(),a.preventDefault(),l.isSPP()&&b.setCachedPageData(e,p),k.show(),a={refTag:n,
anchor:f},l.isSPP()&&(a.keepCachedPagesData=1),f="",(c=c.attr("href"))&&g.isChewbaccaUrl(c)&&(f=c.substring(c.indexOf("/checkout/p/p-")),u=""),l.loadPage(e,p,u,a,f))}});m(document).delegate("a.spclite-dispatch-link","click keypress touchend",function(a){if("keypress"!==a.type||13===a.which){var b=m(a.currentTarget),c=b.data("spcliteLinkFromPage"),d=b.data("spcliteLinkToPage");b.data("spcliteLinkAnchor");var e=b.data("spcliteLinkRef");b=b.data("spcliteLinkArgs");var h=m("input#executionId").val();
b=b?b+("\x26executionId\x3d"+h):"executionId\x3d"+h;d&&(a.preventDefault(),k.show(),l.loadPage(c,d,b,{refTag:e},"/gp/buy/shared/handlers/spclite-dispatch.html"))}})}m(document).delegate("input.submit","click touchend",function(){d.resetMetrics()});m(document).delegate("form","submit",function(){d.resetMetrics()});m(document).delegate(".panel-cancel-row a, .clickable-heading","click",function(){d.isTransitionLoggingEnabled()&&d.resetMetrics()});c.isExecutionIdInQueryStringEnabled()&&(m.ajaxSetup({beforeSend:function(a,
b){b.url&&(a=g.getQueryStringParameter(q.location.href,"executionId"),b.url=g.addQueryStringParameterOrDeleteIfEmpty(decodeURIComponent(b.url),"executionId",a));return!0}}),m(document).ajaxSuccess(function(a,b,c){if(c&&c.url&&c.url.match(/\/async-continue|\/set-|\/update-|\/new/i)&&(a=b.getResponseHeader("x-amz-checkout-sub-page-type")||"Unknown",!a.match(/^p-/))){c=l.getExecutionId(b);if(q.history&&q.history.replaceState){var e=g.addQueryStringParameterOrDeleteIfEmpty(q.location.href,"executionId",
c,!0);q.history.replaceState(q.history.state,"",e)}else d.increaseCount("Checkout:PageConductor:NoReplaceState");c||(b=b.getResponseHeader("x-amz-checkout-page-type")||"Unknown",d.increaseCount("Checkout:PageConductor:"+(null===c?"ExecutionIdIsNotSet":"ExecutionIdIsEmpty")+":"+b+":"+a,1))}}))});"use strict";r.when("A","a-popover-base","a-popover-util").register("checkout-modal-popover",function(a,m,k){function e(b){return b.disableHide?function(){}:function(){var c=this;c.animating=!0;a.fadeOut(this.$popover,
250);b.secondaryPopover||d("#a-popover-modal").hide();a.delay(function(){c.animating=!1},250)}}function f(a,b){var d=e(b);a=a.$event.triggerPositioningElement?a.$event.triggerPositioningElement:a.$declarativeParent;(c=m.show({$trigger:a,name:b.name,skin:p(b.header,b.closeButton,b.closeTextOverride),content:b.content,url:b.url,data:b.data,update:v,alone:b.alone?"true"===b.alone:!0,position:b.position||"triggerVertical",hide:d}))&&c.$trigger!==a&&(c.$trigger=a,c.updatePosition())}function g(a,b){b.disableHide=
!0;var c=e(b);h=!1;(b=m.show({$trigger:a.$declarativeParent,skin:x(b.header,b.footer,b.closeButton,b.contentClass),name:b.name,requestURL:b.url,position:"windowCenter",update:v,data:b.data,updatePosition:b.allowScrollOnPage?y:w,modal:!0,alone:b.alone?"true"===b.alone:!0,show:function(){this.animating=!0;this.$popover.show();d("#a-popover-modal").show();this.animating=!1},hide:c}))&&b.$trigger!==a.$declarativeParent&&(b.$trigger=a.$declarativeParent,b.updatePosition())}function l(c){var d=c.$declarativeParent;
a.delay(function(){b(c,d)},250)}function b(d,e){c&&(k.eventOccursWithin(d,e)||k.eventOccursWithin(d,c.$popover))?a.delay(function(){b(d,e)},250):m.hide(e)}var d=a.$,c,h=!1,p=function(a,b,c){return function(e){var h=c;c===G&&(h=d("input#closeButtonText").val()||"");var n="";h&&(n='\x3ca href\x3d"#" data-action\x3d"custom-popover-close" class\x3d"a-declarative popover-close-link"\x3e'+h+"\x3c/a\x3e\x26nbsp;");h="false"===b?"":['\x3cdiv class\x3d"popover-close-section"\x3e',n,'\x3c/div\x3e\x3cbutton data-action\x3d"custom-popover-close" class\x3d"a-button-close a-declarative" role\x3d"button"\x3e\x3ci class\x3d"a-icon a-icon-close"\x3e\x3c/i\x3e\x3c/button\x3e'].join("");
return['\x3cdiv class\x3d"a-popover"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e',a||h?['\x3cdiv class\x3d"a-popover-header"\x3e\x3ch4\x3e',a,"\x3c/h4\x3e",h,"\x3c/div\x3e"].join(""):"",'\x3cdiv class\x3d"a-popover-inner"\x3e',e,'\x3c/div\x3e\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")}},x=function(a,b,c,e){return function(h){var n=d("input#closeButtonText").val()||"",f="";n&&(f='\x3ca href\x3d"#" data-action\x3d"custom-popover-close" class\x3d"a-declarative popover-close-link"\x3e'+
n+"\x3c/a\x3e\x26nbsp;");n="false"===c?"":['\x3cdiv class\x3d"popover-close-section"\x3e',f,'\x3c/div\x3e\x3cbutton data-action\x3d"custom-popover-close" class\x3d"a-button-close a-declarative" role\x3d"button"\x3e\x3ci class\x3d"a-icon a-icon-close"\x3e\x3c/i\x3e\x3c/button\x3e'].join("");n=a||n?['\x3cdiv class\x3d"a-popover-header huawei-device-header-fix"\x3e\x3ch4\x3e',a,"\x3c/h4\x3e",n,"\x3c/div\x3e"].join(""):"";f="";if(b){var g=d("#a-popover-footer-"+b);0<g.length&&(f=['\x3cdiv class\x3d"a-popover-footer"\x3e',
g.html(),"\x3c/div\x3e"].join(""))}return['\x3cdiv class\x3d"a-popover a-popover-modal"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e',n,'\x3cdiv class\x3d"a-popover-inner ',e,'"\x3e',h,"\x3c/div\x3e",f,'\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")}};a.declarative("custom-popover-close",["click","touchend"],function(b){b.$event.preventDefault();var c=b.$target;d("html").hasClass("a-ie6")||d("html").hasClass("a-ie7")||
d("html").hasClass("a-ie8")?c.closest(".a-popover").hide():a.fadeOut(c.closest(".a-popover"),250);d("#a-popover-modal").hide();a.trigger("a:declarative:a-popover-close:click",{$target:c,$event:b.$event,$currentTarget:b.$currentTarget})});a.on("a:popover:positionUpdated",function(a){a=a.popover.$popover;0>a.offset().left&&a.offset({left:0});0>a.offset().top&&a.offset({top:0})});a.on("a:popover:show",function(a){if(a.popover&&a.popover.$trigger){var b=a.popover.$trigger.data("aCheckoutModalPopover");
b&&b.allowScrollOnPage&&a.popover.$popover.css("position","absolute")}});var v=function(a){d(".a-popover-inner",this.$popover).html(a)},y=function(a){if(!h||a)w.call(this,!0),h=!0},w=function(a){var b=d(q),c=b.height()/2,e=b.width()/2,h=this.$popover.height()/2,n=this.$popover.width()/2;c-=h;if(a||"fixed"!==this.$popover.css("position"))c+=b.scrollTop();a=Math.max(0,e-n);c=Math.max(0,c);this.$popover.css({top:c,left:a})};a.declarative("a-checkout-popover",["click","mouseenter","mouseleave","keyup",
"touchend"],function(a){a.data.showOnHover&&"touchend"!==a.type?"mouseenter"===a.type||"click"===a.type?f(a,a.data):"mouseleave"===a.type&&l(a):("click"===a.type||"touchend"===a.type||"keyup"===a.type&&a.$event.manualTrigger)&&f(a,a.data)});a.declarative("a-checkout-modal-popover",["click","keyup","touchend"],function(a){("click"===a.type||"touchend"===a.type||"keyup"===a.type&&a.$event.manualTrigger)&&g(a,a.data)});a.on("checkout:reload",function(){a.defer(function(){0===d("#a-popover-modal").length&&
d("body").append('\x3cdiv id\x3d"a-popover-modal" /\x3e')})});return{hideById:function(a){m.hide(a)},createModal:g}});"use strict";(function(){var a=!1;r.when("A").register("page-detector",function(m){function k(){return e("checkout-as")}function e(a){d||(d={});d.hasOwnProperty(a)||(d[a]=0<b("div."+a).length);return d[a]}function f(){return e("checkout.pay")}function g(){return e("checkout.spc")||-1<q.location.href.search(/\/checkout\/p\/p[-\d]+\/spc.*/)?!0:!1}function l(){return m.capabilities.mobile}
var b=m.$,d;m.on("checkout:reload",function(){d={};a||r.when("page-detector-current-initializer").execute(function(a){a.initializeDetectorWithCurrentPage(null)})});return{isAddressSelect:k,isAddressTranslation:function(){return e("translate-address-form")},isDesktopPayment:function(){return f()&&e("pay-desktop")},isDesktopSpc:function(){return g()&&e("spc-desktop")},isMobileAddressSelect:function(){return k()&&e("checkout-as-mobile")},isMobilePayment:function(){return f()&&e("pay-mobile")},isMobileSpc:function(){return g()&&
l()},isTabletAddressSelect:function(){return k()&&e("checkout-as-tablet")},isTabletPayment:function(){return f()&&e("pay-tablet")},isTabletSpc:function(){return g()&&e("spc-tablet")},isSpcLite:function(){return g()&&e("spclite")},isPayment:f,isSosp:function(){return e("checkout.sosp")},isSpc:g,isPip:function(){return e("checkout.pip")},isOffers:function(){return 0<b("div#checkout-offers").length},isMobile:l,isTablet:function(){return m.capabilities.tablet}}});r.register("page-detector-current-initializer",
function(){return{initializeDetectorWithCurrentPage:function(m){if(!a){var k=m;r.register("page-detector-current-page",function(){return{getCurrentPage:function(){return k},setCurrentPage:function(a){var e=k;k=a;r.when("A").execute(function(f){f.trigger("page-detector:page-changed",e,a)})}}});a=!0}}}})})();"use strict";r.when("jQuery","loading-spinner-controller").register("page-spinner-controller",function(a,m){function k(){"function"===typeof y.blockAllActions&&y.blockAllActions()}function e(){"function"===
typeof y.unblockAllActions&&y.unblockAllActions()}function f(a){"function"===typeof y.showTransitionInContainer&&y.showTransitionInContainer(a)}function g(){var b=a(q).width(),c=a(q).height(),d=a(q),e=0;null!==v&&(e=v.outerHeight()-a(q).scrollTop(),0>e&&(e=0));p.css("top",d.scrollTop()+e+"px").css("left",d.scrollLeft()+"px").width(b).height(c);"1"!==a("input[name\x3dfromAnywhere]").val()&&a("#loading-spinner-blocker-doc").css("top",d.scrollTop()+e+"px").css("left",d.scrollLeft()+"px").width(b).height(c)}
function l(){var b=document.activeElement?a(document.activeElement):a(":focus:first");b.is("button, a, input:enabled")&&b.blur()}function b(){if(w){k();r.when("spp-button-blocker").execute(function(a){a.hideContinueBtnBlocker()});var b=a(".spp-panel.expanded");if(0<b.length&&b.is(":visible")){f(b,1);return}}if(x)return p.length&&p.find(".loading-spinner-inner").show(),!1;x=!0;l();p=a("#spinner-anchor");p.find(".loading-spinner-inner").show();a("#unblockHeader").length&&(v=a("#header"));c=p.css("z-index");
a(q).unbind("scroll.checkout-page-spinner").bind("scroll.checkout-page-spinner",function(a){h&&q.clearTimeout(h);h=setTimeout(function(){g();h=null},50)});a(q).unbind("resize.checkout-page-spinner").bind("resize.checkout-page-spinner",function(){g();m.adjustSize(p)});a(q).unbind("orientationchange.checkout-page-spinner").bind("orientationchange.checkout-page-spinner",function(){g();m.adjustSize(p)});g();p.show();p.css("z-index",2E3);m.showSpinner(p,!0);return!0}function d(){if(w)e(),"function"===
typeof y.hideSpinner&&y.hideSpinner();else{a("#first-pipeline-load-page-spinner").remove();if(!x)return!1;x=!1;p.length&&p.find(".loading-spinner-inner").show();p&&(a(q).unbind(".checkout-page-spinner"),p.hide(),p.css("z-index",c),m.hideSpinner(p));return!0}}var c,h=null,p,x=!1,v=null,y={},w=!1;return{show:b,showPageTransition:function(){return"0"===a("#showPageTransition").attr("content")?!1:b()},hide:d,hidePageTransition:function(){"0"===a("#showPageTransition").attr("content")&&d();return!0},hideAnimatedSpinnerImage:function(){p.length&&
p.find(".loading-spinner-inner").hide()},initFunc:function(a){null!==a&&(y=a,w=!0)},blockAllActions:k,unblockAllActions:e,disableAllPanelActions:function(){"function"===typeof y.disableAllPanelActions&&y.disableAllPanelActions()},enableAllPanelActions:function(){"function"===typeof y.enableAllPanelActions&&y.enableAllPanelActions()},showTransitionInContainer:f,shrinkPanel:function(a,b,c){"function"===typeof y.shrinkPanel&&y.shrinkPanel(a,b,c)},clearFocus:l}});"use strict";r.when("A").execute(function(a){a=
a.$;var m="";m="mash-transitions"===a("input[name\x3dpageTransitionType]").val()?"page-mash-transition-controller":"page-spinner-controller";r.when(m).register("page-transition-controller",function(a){r.when("A").execute(function(e){e.declarative("page-spinner-show",["click"],{allowLinkDefault:!0},function(e){e=e.$target;e.hasClass("a-button-disabled")||e.closest(".a-button-disabled").length||a.showPageTransition()})});r.when("A").execute(function(e){e.declarative("page-spinner-show-on-submit",["submit"],
{allowLinkDefault:!0},function(e){a.showPageTransition()})});return{show:a.show,hide:a.hide,showPageTransition:a.showPageTransition,hidePageTransition:a.hidePageTransition,blockAllActions:a.blockAllActions,unblockAllActions:a.unblockAllActions,showTransitionInContainer:a.showTransitionInContainer,shrinkPanel:a.shrinkPanel,disableAllPanelActions:a.disableAllPanelActions,enableAllPanelActions:a.enableAllPanelActions}})});"use strict";r.when("A","page-conductor","client-side-metrics","page-detector-current-page",
"a-popover","ready").execute(function(a,m,k,e){function f(a,d,c){m.isSPP()&&k.setmarker&&k.setmarker("af");k.sendUEPageLoadStats()}var g=a.$,l=!1;a.on("a:popover:afterHide",function(a){a.popover&&(l=!1)});a.on("a:popover:beforeShow",function(a){var b=a.popover;b&&(l=!0,b.$trigger.find(".modal-parameters").each(function(){g.each(g(this).data(),function(a,d){b.attrs(a,d)})}))});a.on("a:popover:dismiss",function(a){a=a.popover;if(k.isTransitionLoggingEnabled()&&a&&l){l=!1;if("prime-acquisition-spc-popover"===
a.name){var b="prime-acquisition";var c=e.getCurrentPage()}b||c||!a.attrs||(b=a.attrs("returnfrom"),c=a.attrs("returnto"));b&&c&&(k.resetMetrics(),k.logPageTransition(b,c,f))}})});"use strict";r.when("A","page-detector-current-page","checkout-general-utils","client-side-metrics").register("first-load-dependencies-base",function(a,m,k,e){function f(){"function"===typeof q.uet&&"function"===typeof q.uex&&(q.uet("cf","first-load-dependencies-ready",{wb:1}),q.uex("ld","first-load-dependencies-ready",
{wb:1}));e.startWidgetTiming("first-load-dependencies:checkout:beforeReload");a.trigger("checkout:beforeReload");e.finishWidgetTiming("first-load-dependencies:checkout:beforeReload");e.startWidgetTiming("first-load-dependencies:checkout:reload");a.trigger("checkout:reload");e.finishWidgetTiming("first-load-dependencies:checkout:reload");var b;l&&(b="spp-revieworder"===l?"spc":l);b&&(e.finishWidgetTiming("first-load-dependencies:checkout:reload:"+b),a.trigger("checkout:reload:"+b),e.finishWidgetTiming("first-load-dependencies:checkout:reload:"+
b));e.startWidgetTiming("first-load-dependencies:checkout:afterReload");a.trigger("checkout:afterReload");e.finishWidgetTiming("first-load-dependencies:checkout:afterReload");setTimeout(function(){var a=g("#first-pipeline-load-page-spinner");a.is(":visible")&&(a.remove(),e.increaseCount("checkout:pageload:timeout"),k.logError("The page has taken more than 90 seconds to load, or there was a JS error preventing it from loading, hiding page spinner."))},9E4)}var g=a.$,l=m.getCurrentPage();"function"===
typeof q.uet&&q.uet("bb","first-load-dependencies-ready",{wb:1});return{allDependenciesCheck:function(a){if(a&&a.length){var b=!1,c={};g.each(a,function(a,b){e.startWidgetTiming("checkout:dependency:"+b+":ready");c[b]=1;r.when(b).execute(function(){e.finishWidgetTiming("checkout:dependency:"+b+":ready");delete c[b]})});var h=function(a){a="Page ("+l+") is missing dependencies ["+a.join(", ")+"] after 5 secs.";e.increaseCount("checkout:dependency:missed:regular-page:error");k.logErrorOnLevel(a,"ERROR")},
p=setTimeout(function(){if(!b){var a=[];g.each(c,function(b){e.increaseCount("checkout:dependency:"+b+":missed");a.push(b)});e.increaseCount("checkout:dependency:missed");0<g("#assets-prefetch").length?e.increaseCount("checkout:dependency:missed:assets-prefetch"):(e.increaseCount("checkout:dependency:missed:regular-page"),h(a));f()}},5E3);r.when.apply(r,a).execute(function(){b=!0;q.clearTimeout&&p&&q.clearTimeout(p);f()})}else f()}}});"use strict";r.when("A","page-detector","client-side-metrics").register("gift-utility",
function(a,m,k){var e=a.$,f=/[^\s\u0020-\u007E\u00A0-\u00FF]/g,g=q.P&&q.P.AUI_BUILD_DATE,l=/((?:file|https?|ftps?|sip):\/\/)/im,b=/((?:\b|[\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?])www\.(?:(?:[^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?]+\.[^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?]+))+)(?:[\s!@#$%^&*()_=+[\]{}\|;:'",<>\?]|$|\b)/im,d=/([^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?\/]+\.(?:[a-z][a-z]|aero|arpa|asia|biz|cat|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|om|pro|qa|tel|travel|xxx)(?:\b|$))/im,c=/^\S+\@\S+\.\S+$/im;
return{getInput:function(a){return a.is("input")?a:a.find("input")},getCharCount:function(a,b){return b?q.unescape(encodeURIComponent(a)).length:a.length},getLineCount:function(a,b){var c=a.split("\n").length;b=Math.floor(b);a=a.split("\n");for(var d=0;d<a.length;d++)a[d].length>b&&(c+=Math.floor(a[d].length/b),0===a[d].length%b&&c--);return c},getNameWithNoTitle:function(a){var b=!1;a=a.split(" ");/^(?:Dr|Mr|Mrs|Ms|Mme|Lt|Attn|Attn:|Prof|Pt|The)\.?$/i.test(a[0])&&(b=!0);b&&a.shift();return a.join(" ")},
getFirstName:function(a){var b=!1;a=a.split(" ");/^(?:Dr|Mr|Mrs|Ms|Mme|Lt|Attn|Attn:|Prof|Pt|The)\.?$/i.test(a[0])&&(b=!0);b&&a.shift();return a.shift()},toggleGiftMessageWarning:function(a,b){var c=b.find(".gift-message-warning");if(f.test(a.val())){var d=b.find(".gift-message-preview-trigger"),h=a.val().replace(f,"?");g?r.when("a-popover").execute(function(a){var b=a.get(d);b?b.update({content:h}):a.create(d,{inlineContent:h,position:"triggerVertical",closeButton:"false"})}):(k.increaseCount("removeauijs13"),
d.unbind("click.preview").bind("click.preview",function(a){r.when("a-popover-base").execute(function(b){var c=e(a.target);c.data("popoverid")&&(b=b.get(c.data("popoverid")))&&(b.update(h),b.updatePosition())})}));a.addClass("a-form-error");c.show()}else a.removeClass("a-form-error"),c.hide()},valueContainsUrl:function(a){return l.test(a)||b.test(a)||d.test(a)},isValidEmail:function(a){return c.test(""+a)}}});"use strict";r.when("A","page-detector","safe-mash","client-side-metrics").register("help-popup",
function(a,m,k,e){function f(){if(g("div#help-popover").length){g(q).unbind("resize.checkout-help-popover");var a=g("#help-popover-frame")[0];g(a.contentWindow?a.contentWindow:a.contentDocument.defaultView).undelegate("a","click");g("div#help-popover").remove()}}var g=a.$;m=m.isMobile();e=g("input#isPipelinedPage");e=0<e.length&&"1"===e.val();var l=m&&e&&k&&k.navigate;a.declarative("help-popup",["click"],function(a){if(!g(".a-touch").length||l){a.$event.preventDefault();a.data&&"1"===a.data.stopPropagation&&
a.$event.stopPropagation();var b=a.$target.closest("a").attr("href");a=a.data;l?k.navigate({url:b,transitionEffect:"slide"}):(a.width||(a.width="340"),a.height||(a.height="340"),q.open(b,"AmazonHelp","width\x3d"+a.width+",height\x3d"+a.height+",left\x3d10,top\x3d10,resizable\x3dyes,scrollbars\x3dyes,menubar\x3dno,toolbar\x3dyes,location\x3dno,directories\x3dno,status\x3dyes"))}else q.open(a.$target.closest("a").attr("href"),"AmazonHelp")});if(l)a.on("checkout:reload",f)});"use strict";r.execute("persistent-order-controller",
function(){return{}});"use strict";r.when("jQuery","page-conductor").register("quantity-service",function(a,m){function k(e,f){f=f||{};if(f.additionalData)var g=f.additionalData;var l="/gp/buy/pipeline/handlers/update-quantity.html",b={returnFullHTML:1,cachebuster:(new Date).getTime(),isClientTimeBased:0,hasWorkingJavascript:1};g&&g.deletePrimeMembership&&g.primeMembershipASIN&&(b.deletePrimeMembershipItemIn=g.deletePrimeMembership,b.deletedPrimeMembershipASINIn=g.primeMembershipASIN);f.ref&&(l+=
"/ref\x3d"+f.ref,delete f.ref);g=f.success;delete f.success;var d=m.ajaxRedirect;f.error&&(d=f.error,delete f.error);a.extend(b,f);f=[];for(var c in e)e[c]!==G&&(f.push(c),b[c]=e[c]);b.entityids=f;e=m.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});a.ajax({type:"POST",url:l,data:a.param(b,!0),dataType:"text",async:!0,cache:!1,headers:e,success:g,error:d})}return{callBatch:function(a,f){k(a,f)},call:function(a,f,g){var e={};e[a]=f;k(e,g)}}});"use strict";r.when("jQuery").register("scroll-controller",
function(a){return{scrollToTop:function(){a(q).scrollTop(0)},toggleScrollOn:function(){a(document).unbind("touchmove")},toggleScrollOff:function(){a(document).bind("touchmove",function(a){a.preventDefault()})}}});"use strict";r.when("A","checkout-general-utils","ready").execute(function(a,m){var k=a.capabilities&&a.capabilities.isAmazonApp,e=q.amazon&&q.amazon.mash;a=a.$("#checkout-mash-will-load").length;k||e||a?r.when("mash").execute(function(a){if("object"===typeof a)var e=a;else q.amazon&&q.amazon.mash&&
(e=q.amazon.mash);"object"!==typeof e?m.logError("MASH is expected but can't be found!"):(r.register("safe-mash",function(){return e}),q.ue&&q.ue.tag&&q.ue.tag("safe-mash:mash"))}):(r.register("safe-mash",function(){}),q.ue&&q.ue.tag&&q.ue.tag("safe-mash:no-mash"));q.ue&&q.ue.tag&&(k&&q.ue.tag("safe-mash:A.capabilities.isAmazonApp"),e&&q.ue.tag("safe-mash:window.amazon.mash"),a&&q.ue.tag("safe-mash:checkout-mash-will-load"),!k&&e&&q.ue.tag("safe-mash:fallback:window.amazon.mash"),k||e||!a||q.ue.tag("safe-mash:fallback:checkout-mash-will-load"))});
"use strict";r.when("A","scheduled-delivery-external-interface","shipping-speed-selection-controller","page-detector","ready").register("scheduled-delivery-controller",function(a,m,k,e){var f=a.$,g={};k=function(){g={};f("div.fake-label input[type\x3d'radio']:checked").each(function(){var a=f(this),b=a.closest("div.fake-label");(b=m.getSdWidgetRootId(b))&&(g[a.attr("name")]=b)})};a.on("checkout:reload:shipoptionselect",k);a.on("checkout:reload:spp-revieworder",k);e.isSosp()&&k();f(document).delegate("div.fake-label",
"click",function(){if(e.isSosp()){var l=f(this),b=l.find("input[type\x3d'radio']");b.attr("disabled")||(b=b.attr("name"),l=m.getSdWidgetRootId(l),a.trigger("scheduled-delivery:ship-option-changed",{current:l,previous:g[b]}),g[b]=l)}});f(document).delegate(".ship-option.is-scheduled-delivery","click",function(){if(e.isSpc()){var g=f(this);g.find("input[type\x3d'radio']").attr("disabled")||(g=m.getSdWidgetRootId(g))&&a.trigger("scheduled-delivery:ship-option-changed",{current:g,previous:null})}});a.on("scheduled-delivery:unblock-continue",
function(){r.when("button-blocker").execute(function(a){a.hide("scheduled-delivery")})});a.on("scheduled-delivery:block-continue",function(a){r.when("button-blocker").execute(function(b){b.show("scheduled-delivery",a)})});a.on("scheduled-delivery:disable-ship-option",function(a,b){a=f("#"+a);if(0!==a.length){if(e.isSpc())a=a.closest(".shipping-speed");else if(e.isSosp())a=a.closest("div.fake-label.a-box");else return;var d=a.find("input[type\x3d'radio']");d.attr("disabled",!0);d.is(":checked")&&b&&
(b=f("input[name\x3d"+d.attr("name")+"]:radio:not(:disabled):first"),b.prop("checked",!0),b.trigger("change"));a.addClass("sd-disabled")}});a.on("scheduled-delivery:enable-ship-option",function(a){a=f("#"+a);if(0!==a.length){if(e.isSpc())a=a.closest(".shipping-speed");else if(e.isSosp())a=a.closest("div.fake-label.a-box");else return;a.find("input[type\x3d'radio']").removeAttr("disabled");a.removeClass("sd-disabled")}})});"use strict";r.when("A","ready").register("mobile-nav-bar-back-controller",
function(a){a.capabilities.history&&(a=a.$,a=a("#mobile-top-bar-navigation-back"),1<=a.length&&a.click(function(a){a.preventDefault();q.history.back()}))});"use strict";r.when("A","page-spinner-controller","page-detector","page-conductor","weblab-helper","ready").execute(function(a,m,k,e,f){function g(a,b){var c=[];a.addressId||c.push("addressId");a.slotKey||c.push("slotKey");a.shippingOfferingId||c.push("shippingOfferingId");a.conflictItems&&!p.isArray(a.conflictItems)&&c.push("conflictItems");if(0<
c.length){a="Error calling fresh widget callback on "+b+": Bad or Missing Input: "+c[0];for(b=1;b<c.length;b++)a+=", "+c[b];console.error(a);return 0}return 1}function l(){p("#freshSlotKey").val("");p("#freshAddressId").val("");p("#freshReservationToCancel").val("");p("#freshConflictingItems").val("");p("#freshShipOfferingId").val("")}function b(a){var b="",c=f.sospPartialAvailabilityWeblabOn();if(a&&p.isArray(a)&&0<a.length){b=a[0].asin+":"+a[0].merchantId+(c?"|"+a[0].maxQtyAvailable:"");for(var d=
1;d<a.length;d++)b+="-"+a[d].asin+":"+a[d].merchantId+(c?"|"+a[d].maxQtyAvailable:"")}return b}function d(a){var c="page\x3dspc\x26returnFullHTML\x3d1\x26callSetters\x3d1\x26freshSlotKey\x3d"+a.addressId;c+="\x26freshAddressId\x3d"+a.slotKey;a.reservationToCancel&&(c+="\x26freshReservationToCancel\x3d"+a.reservationToCancel);(a=b(a.conflictItems))&&(c+="\x26freshConflictingItems\x3d"+a);a=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});m.show();p.ajax({type:"POST",url:"/gp/buy/shared/handlers/handle-fresh-widget-results.html/ref\x3dset-fresh-information",
data:c,dataType:"text",async:!0,cache:!1,headers:a,success:function(a,b,c){return c.getResponseHeader("x-amz-checkout-page")?e.ajaxUpdatePage(a,b,c):e.redirect(a)},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}function c(){p(".sosp-continue-button").removeClass("js-hide").removeClass("aok-hidden");p(".continue-button-blocker").addClass("aok-hidden")}function h(){p(".sosp-continue-button").addClass("aok-hidden");p(".continue-button-blocker").removeClass("aok-hidden")}var p=a.$;a.on("handle-fresh-results",
function(a){if(p("#isfresh").val())if(a)if(k.isSosp())if(g(a,"sosp")){p("#freshSlotKey").val(a.slotKey);p("#freshAddressId").val(a.addressId);p("#freshReservationToCancel").val(a.reservationToCancel);var f=b(a.conflictItems);p("#freshConflictingItems").val(f);p("#freshShipOfferingId").val(a.shippingOfferingId);f&&0<f.length?p("input#block-prefetch").val(1):p("input#block-prefetch").val(0);f=p("#shippingOptionFormId");a.conflictItems&&0<a.conflictItems.length||e.makePrefetch(f);c()}else l(),h();else k.isSpc()?
g(a,"spc")&&d(a):console.error("remote fresh widget JS callback called on unsupported page.");else console.error("remote fresh widget JS callback called with empty data.");else console.error("remote fresh widget JS callback called without isfresh flag on page")});a.on("block-continue",function(a){p("#isfresh").val()?a?"undefined"===typeof a.blockContinue?console.error("block continue callback - missing blockContinue"):k.isSosp()?1===a.blockContinue?(h(),l()):0===a.blockContinue?c():console.error("block continue callback - invalid value"):
console.error("block continue callback called on unsupported page."):console.error("block continue callback called with no argument"):console.error("block continue callback called without isfresh flag on page")});a.on("confirm-and-continue",function(){p("div.sosp-fresh #shippingOptionFormId").submit()});a.on("redirect-to-spc",function(){e.redirect({conductoraction:{url:'/gp/buy/spc/handlers/display.html/ref\x3d"cancel-fresh-address-select"',type:"redirect"}})})});"use strict";r.when("A","ready").execute(function(a){function m(){(0<
k(".change-preference-block").length||0<k(".mobile-change-preference-block").length)&&!1===e&&(r.register("loadVasRcxCheckoutAsset",function(){}),e=!0)}var k=a.$,e=!1;m();a.on("checkout:reload:spc",m);a.on("checkout:reload:shipoptionselect",m);a.on("checkout:reload:spp-revieworder",m);a.on("checkout:reload:spp-special-delivery-options",m)});"use strict";r.register("time-left-formatter",function(){function a(a,e,f,g,l){return 0>=e?a:a+e+" "+(1===e?l.HOUR:l.HOURS)+(!g&&0<f?" "+l.AND+" ":"")}function m(a,
e,f,g,l){return 0>=e?a:a+e+" "+(1===e?l.MINUTE:l.MINUTES)+(!g&&1>f?" "+l.AND+" ":"")+(1===g&&1>f?" ":"")}return{getTimeLeftFormatted:function(k,e,f){var g="",l=86400<k?(k-k%86400)/86400:0,b=3600<k?(k-k%3600)/3600:0;k-=3600*b;var d=60<k?(k-k%60)/60:0;k-=60*d;if(e&&0<l)return g+l+" "+(1===l?f.DAY:f.DAYS);if(e&&0<b)return a(g,b,d,e,f);if(e&&5<=d)return m(g,d,b,e,f);g=a(g,b,d,e,f);g=m(g,d,b,e,f);1<=b||(g=g+k+" "+(1===k?f.SECOND:f.SECONDS));return g}}});"use strict";r.register("email-validation",function(){function a(a){if(1!==
a.length)throw Error("Invalid length for character");return a}var m={isISOControl:function(k){"string"===typeof k&&(a(k),k=k.charCodeAt(0));return 31>=k||127===k},isWhitespace:function(k){k=a(k);return null!==k.match(/\s/g)},isLetterOrDigit:function(k){k=a(k);return null!==k.match(/[A-Za-z0-9]/g)}};return function(a){var e;if(!a||64<a.length)return!1;for(e=0;e<a.length;e++)if(127<a.charCodeAt(e))return!1;e=a.indexOf("@");if(e!==a.lastIndexOf("@")||1>e||e===a.length-1)return!1;var f=a.substring(0,
e),g=a.substring(e+1);if("."===g.charAt(0)||"."===g.charAt(g.length-1)||g.match(/[a-zA-Z\d\-.]+/)[0]!==g)return!1;for(e=0;e<g.length;e++)if(a=g.charAt(e),e<g.length-1&&"."===a&&"."===g.charAt(e+1))return!1;if(-1===g.indexOf("."))return!1;var l=g=!1;for(e=0;e<f.length;e++)if(a=f.charAt(e),g){switch(a){case "\\":l=!l;break;case '"':l||(g=!1);break;default:if(l&&!m.isLetterOrDigit(a))return!1;l=!1;if(m.isISOControl(a))return!1}if(!g&&('"'===f.charAt(e-1)||f.length-1!==e&&"."!==f.charAt(e+1)))return!1}else switch(a){case '"':if(0!==
e&&"."!==f.charAt(e-1))return!1;g=!0;break;case ".":if(0===e)return!1;break;case "(":case ")":case "\x3c":case "\x3e":case "[":case "]":case "\\":case ":":case ";":case ",":return!1;default:if(m.isISOControl(a)||m.isWhitespace(a))return!1}return!0}});"use strict";r.when("A","page-transition-controller","checkout-general-utils","page-detector","page-detector-current-page","safe-mash","loading-spinner-controller","weblab-helper").register("shipoptionselect-controller",function(a,m,k,e,f,g,l,b){function d(a){var b=
w(".delivery-window-groups .more-window");l.showSpinner(b,!1);a=a.$currentTarget.closest(".delivery-window-groups").data("orderid");b=w("input[name\x3dlineItemEntityIds_"+a+"]").attr("value");w.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/long-calendar-content.html",data:"lineitemids\x3d"+b+"\x26orderid\x3d"+a+"\x26isMobile\x3d1\x26fromPage\x3dsosp",dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:function(a){l.hideSpinner();if(a&&a.deliveryWindowGroups){var b=
w(".delivery-window-groups .a-box-group");b.empty();w.each(a.deliveryWindowGroups,function(a,c){b.append(c)});a=w(".delivery-window-groups .selected-group");a.length&&a.trigger("click")}}})}function c(a,b){var c=w("div.one-shipment:visible");a=t?w("div.one-shipment").slice(parseInt(a,10),parseInt(b,10)+1):w("div.one-shipment#"+a);u&&0!==a.size()&&c.last().attr("id")!==a.last().attr("id")&&(c.hide(),a.show(),w(q).scrollTop(0),c=w(document.activeElement),c.is("button, a, input:enabled")&&c.blur())}
function h(){if(u){var a=(location.hash?location.hash.replace("#",""):"0-"+A).split("-");2===a.length&&c(a[0],a[1])}}function p(){function d(a,b){w.ajax({type:"POST",url:"/gp/buy/gift/handlers/remove-gift-option.html",data:b,dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:a,error:function(a,b,c){m.hide()}})}function p(a){var b=a.closest("div."+k);a.is(":checked")?(b.siblings("div."+k+".selected").removeClass("selected").find(".a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"),
b.addClass("selected").find(".a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active")):b.removeClass("selected").find(".a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");v("triggerChangeEvent",[a])}0<w(".prime-calendar-container").length&&w(".prime-calendar-container").contents().each(function(a,b){8===b.nodeType&&w(b).replaceWith(b.nodeValue)});var l=w(".delivery-window-groups .selected-group");
l.length&&l.trigger("click");n=w(".sosp-continue-button");u="1"===w("#isClientSidePagingEnabled").val()?1:0;A=b.isDigitalAsinIndexingFixedOnSOSPEnabled()?(w("div.shipment-with-ship-options:visible").length-1).toString():(w("div.one-shipment:visible").length-1).toString();B="1"===w("#useMashNavigateForClientSidePaging").val()?1:0;t="1"===w("#collapseDigitalShipmentsEnabled").val()?1:0;var k=(l=q.P&&q.P.AUI_BUILD_DATE)?"selectable-box":"fake-label";u&&(w(".one-shipment:gt("+A+")").hide(),h());n.bind("click",
function(d){function h(a,b){var c=f.getCurrentPage();if(q.history&&q.history.pushState){var d=location.href;0<d.indexOf("#")&&(d=d.substring(0,d.indexOf("#")));d+="#"+a.attr("id")+"-"+b.attr("id");history.pushState({page:c,id:a.attr("id")},w("title"),d)}}var p=w("div.one-shipment:visible input[id\x3d'fresh-block-continue']");if(p){if("1"===p.val())return a.trigger("f3:fresh-sosp-continue:blocked"),d.preventDefault(),!1;"0"===p.val()&&a.trigger("f3:fresh-sosp-continue:allowed")}var n=!1;w("div.one-shipment:visible input[type\x3d'radio'][checked]").each(function(){if(w(this).data("blockingOn"))return alert(w(this).data("blockingOn")),
d.preventDefault(),n=!0,!1});if(n)return!1;if(b.removesGiftOptionOnRush()&&e.isMobile()&&null!=M){p=w("div.one-shipment:visible");var l=p.find("input[type\x3d'radio']:checked").closest(".shipping-option");if("1"===p.find("input[type\x3dhidden][name\x3disGiftWrapped]").attr("value")&&1===l.data("nosupportforgiftoption"))return M.show(),!1}x();p=w("div.one-shipment:visible");l=p.nextAll("div.one-shipment:hidden");if(0<l.length){d.preventDefault();var k=l.first(),m=k;t&&(m=l.filter(".shipment-with-ship-options"),
m=1<m.length?m.eq(1).prev():l.last());B&&g&&g.navigate?g.navigate({url:null,transitionEffect:"slide",successCallback:function(){h(k,m)},failCallback:function(a){}}):h(k,m);c(k.attr("id"),m.attr("id"));a.trigger("active-shipment-changed")}y("logInlineCalMetrics",[p])});w(".gift-option-removal-cancel-button").bind("click",function(a){M.hide()});w(".gift-option-removal-confirm-button").bind("click",function(a){m.show();M.hide();a="lineItemsToRemoveGiftOptionFrom\x3d"+w("div.one-shipment:visible").find("input[name^\x3dlineItemEntityIds_]").attr("value");
var b=w("div.one-shipment:visible"),c=b.nextAll("div.one-shipment:hidden");d(function(a,d,e){b.find("input[type\x3dhidden][name\x3disGiftWrapped]").each(function(){w(this).remove()});0<c.length?(n.click(),m.hide()):w(".checkout-page-form").submit()},a)});w(q).bind("popstate",function(a){e.isSosp()&&h()});w(document).delegate("div."+k,"click",function(a){a=w(this);a.find("input[type\x3d'radio']").trigger("change",["setActive"]);a.parent().hasClass("timeslot-picker")&&(a=a.find(".a-button-selected").length,
n&&n.length&&(a?n.removeClass("a-button-disabled").addClass("a-button-primary").find("input").prop("disabled",!1):n.removeClass("a-button-primary").addClass("a-button-disabled").find("input").prop("disabled",!0)))});var r;a.declarative("faster-than-same-day-sosp-save",["click","submit"],function(){var b="lineItemsToRemoveGiftOptionFrom\x3d"+r.closest(".one-shipment").find("input[name^\x3dlineItemEntityIds_]").attr("value");a.$("div.a-popover button.a-button-close").trigger("click");m.show();d(function(a,
b,c){r.closest(".one-shipment").find(".isGiftWrapped").each(function(){w(this).remove()});r.attr("checked",!0);p(r);m.hide()},b)});w(document).delegate("div."+k+" input[type\x3d'radio']","change",function(a,c){a=w(this);if("setActive"===c&&!a.attr("disabled")&&b.removesGiftOptionOnRush()&&0<a.closest(".one-shipment").find(".isGiftWrapped").length&&1==a.data("nosupportforgiftoption"))r=a,a.is(":checked")&&(c=a.closest("div."+k).siblings("div."+k+".selected").find('input[type\x3d"radio"]'),r.attr("checked",
!1),c.attr("checked",!0)),setTimeout(function(){w("#faster-than-same-day-sosp-popover").trigger("click")},10);else{if("setActive"===c){if(a.attr("disabled"))return;a.attr("checked",!0)}if("disabling"===c)if(a.attr("disabled",!0),a.is(":checked"))a.removeAttr("checked");else return;p(a)}});w("div."+k+" input[type\x3d'radio']:checked").change();w("h3").children().removeAttr("style");0===w("div."+k+".scheduled-delivery").length&&w("form.checkout-page-form").data("checkoutFormReady",!0).change();l&&w(document).delegate(".a-touch-radio a",
"click",function(a){if(!b.isSOSPExclusiveJSHandlerWeblabOn()||e.isSosp()){var c=w(a.target).attr("href");!c||c.startsWith("#")||c.toLowerCase().startsWith("javascript:")||(g&&g.navigate?g.navigate({url:c,transition:"slide"}):a.preventDefault=!1)}})}function x(){if(1===w("div.store-upsell-ship-options").length){var a="/gp/buy/shared/handlers/store-upsell-async.html",b="ox_store_upsell_continue_",c=w("div.ship-speed, div.store-upsell-ship-options").find("input.shipping-option, input.store-upsell-ship-option"),
d=[],e;w.each(c,function(a,c){a=w(c);c=a.attr("value");d.push(c.toLowerCase());a.is(":checked")&&(e=a.attr("value"),b=a.hasClass("store-upsell-ship-option")?b+"success":b+"failure")});a=k.addQueryStringParameter(a,"ref",b);w.ajax({url:a,type:"POST",async:!0,data:{shown:d.toString(),clicked:e}})}}function v(a,b){r.when("checkout-federation-wrapper","shipspeed-provider").execute(function(c,d){c.wrap(function(){d&&!w.isEmptyObject(d)&&"function"===typeof d[a]&&d[a].apply(this,b)},"VasCheckoutShipSpeedProvider")})}
function y(a,b){r.when("checkout-federation-wrapper","sd-methods").execute(function(c,d){c.wrap(function(){d&&!w.isEmptyObject(d)&&"function"===typeof d[a]&&d[a].apply(this,b)},"CricketInlineCalendarHeavyBulkyIN")})}var w=a.$,n,u,B,A,t=0,M;a.declarative("sosp-change-quantity-link",["click"],function(a){var b=a.$currentTarget,c=w("\x3cinput type\x3d'hidden' /\x3e").attr("name","change-quantities-or-delete").val("1");b.hasClass("pipeline-link")?(a.$event.preventDefault(),b.closest("form").removeClass("checkout-page-form").append(c).find(".sosp-continue-button:first").trigger("click")):
b.closest("form").removeClass("checkout-page-form").append(c).find(".sosp-continue-button:first").trigger("click").end().trigger("submit")});r.when("A","a-sheet").register("shipoptionselect-gift-removal-controller-mobile",function(a,b){M=b.create({name:"gift-removal-popover",height:220,preloadDomId:"gift-option-removal-message",closeType:"icon",sheetType:"web"})});a.declarative("sosp-extender-toggle",["click","touchend"],function(a){if(!k.protectAgainstDoubleAction("sosp-extender-toggle")){var b=
a.$target.closest("a"),c=w(".delivery-window-groups .a-box-group").find(".lazy-loaded");if(b.hasClass("aui-extender"))c.length?c.remove():d(a);else{var e=b.find("i");b=b.closest("div.extender-section");e.hasClass("a-icon-extender-expand")?(b.find(".collapsed").hide(),b.find(".expanded").slideDown("fast"),e.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse"),d(a)):(b.find(".collapsed").show(),b.find(".expanded").slideUp("fast"),e.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"),
c.length&&c.remove())}}});a.declarative("sosp-select-prime-slot",["click","touchend"],function(a){if(!k.protectAgainstDoubleAction("sosp-select-prime-slot")){a=a.$currentTarget;var b=a.closest(".valid-slot");if(b.closest(".prime-calendar").hasClass("long-calendar")){var c=b.closest(".prime-calendar").data("orderid"),d=w("#calendar-"+c);c=w("#calendar-delivery-message-"+c);var e=a.closest(".long-calendar");e.find(".selected-slot").removeClass("selected-slot");0<b.length&&b.addClass("selected-slot");
w(".a-button-close").trigger("click");b=a.data("slotid");b=d.find(".slot-"+b);if(0<b.length)d.show(),c.parent().hide(),b.closest(".prime-calendar").find(".selected-slot").removeClass("selected-slot"),b.closest(".valid-slot").addClass("selected-slot");else{var h=a.parent()[0],f=a.parent().parent().find(".rhead")[0];b=f.innerText;b||(b=f.textContent);h=h.cellIndex;e=e.find("th")[h];h=e.innerText;h||(h=e.textContent);c.text(h+" "+b);d.hide();c.parent().show()}}else c=b.closest(".prime-calendar-container").data("orderid"),
d=w("#calendar-"+c).find(".selected-slot"),0<d.length&&(d.removeClass("selected-slot"),0<b.length&&b.addClass("selected-slot"));d=a.closest(".prime-calendar-container").data("orderid");a.data("key")&&w("#order_"+d+"_ShippingSpeed").val(a.data("key"));a.data("isscheduleddeliveryslot")&&w("#sdData"+d).val(a.data("sddatastring"))}});a.declarative("sosp-select-delivery-window",["click","touchend"],function(a){if(!k.protectAgainstDoubleAction("sosp-select-delivery-window")){a=a.$currentTarget;a.length&&
!a.hasClass("dwg-button")&&(a=a.find(".dwg-button"));w(".dwg-button").removeClass("selected-dwg-button");a.addClass("selected-dwg-button");var b=a.closest(".delivery-window-groups").data("orderid"),c=a.data("key");!c&&a.find("button").length&&(c=a.find("button").data("key"));c&&w("#order_"+b+"_ShippingSpeed").val(c);c=a.data("isscheduleddeliveryslot");!c&&a.find("button").length&&(c=a.find("button").data("isscheduleddeliveryslot"));c&&(c=a.data("sddatastring"),!c&&a.find("button").length&&(c=a.find("button").data("sddatastring")),
w("#sdData"+b).val(c))}});a.on("checkout:reload:shipoptionselect",p);a.on("checkout:reload:spp-shipoption",p);a.on("checkout:reload:spp-f3-sosp",p);if(b.isVasTrueSPCEnabled())a.on("checkout:reload:spp-special-delivery-options",p)});r.when("jQuery","page-detector").register("deliv-prefs-sosp",function(a,m){function k(){a(".sosp .order-delivery-time-preference").each(function(){var e=a(this);e.bind("selectionChanged",function(){0===e.find(".delivery-time-preference-group").length?e.hide():(e.show(),
0===e.find("input:checked").length&&e.find("input:first").trigger("change",["setActive"]))}).bind("empty",function(){e.find(".delivery-time-preference-group").detach()});var f=e.closest(".one-shipment").find("input.shipping-option");e.find(".delivery-time-preference-group").each(function(){var f=a(this),l=f.data("shippingoptionid");l=a("#"+l);f.is(".template")&&f.detach().removeClass("template");l.change(function(){e.trigger("empty");f.appendTo(e);e.trigger("selectionChanged")}).addClass("hasDeliveryTimePreference")});
f.not(".hasDeliveryTimePreference").change(function(f,l){"disabling"===l||a(this).is(":disabled")||(e.trigger("empty"),e.trigger("selectionChanged"))});e.trigger("selectionChanged")})}r.when("A").execute(function(a){a.on("checkout:reload:shipoptionselect",k)})});r.when("A","shipoptionselect-controller").execute(function(a){var m=a.$,k={},e={};a.on("checkout:reload:shipoptionselect",function(){var a=m("#shippingOptionFormId"),g=a.find("input[name\x3dtrialKey]");if(1===g.length){for(var l in k)k.hasOwnProperty(l)&&
(k[l].abort(),delete k[l]);k={};e={};var b=function(a){return a.join("::").replace(/\s+/g,"_")},d=function(){return m.map(a.find("input[type\x3dradio]:checked"),function(a){return a.name})},c=function(){return m.map(a.find("input[type\x3dradio]:checked"),function(a){return a.value})},h=function(a,b){if(k.hasOwnProperty(a)||e.hasOwnProperty(a))return!1;console.debug('initiating ajax call for trial key "'+a+'"');b=m.ajax({type:"POST",url:"/gp/buy/shipoptionselect/handlers/launch-delivery-trial.html",
contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:{"x-amz-checkout-transition":"ajax"},data:b,dataType:"json",async:!0,success:function(b){b?console.debug('trial "'+a+'" success'):console.debug('trial "'+a+'" failed');e[a]=b;delete k[a]},error:function(b,c,d){delete k[a];"abort"!==d&&(console.debug("trial "+a+" error"),r.error("issue with set-delivery-options trial: "+c,d))},cache:!1});k[a]=b;return!0},p=function(){var a=c();a=b(a);for(var d=Object.keys(k),e=0;e<d.length;++e){var h=
d[e];h!==a&&(console.debug('removing ajax call for trial key "'+h+'"'),k[h].abort(),delete k[h])}};m(document).delegate("#shippingOptionFormId","change",function(e){e=c();if(b(e)!==g.val())a:{p(),e=d();var f=c(),l=b(f);g.val(l);var k=h(l,a.serialize());l=0;k&&++l;for(var n=0;n<e.length;++n)for(var u=a.find('input[type\x3dradio][name\x3d"'+e[n]+'"][value!\x3d"'+f[n]+'"]'),B=0;B<u.length;++B){var A=u[B];k=f.slice(0);k[n]=A.value;k=b(k);var t=A.name;A=A.value;for(var x=a.serializeArray(),K=0;K<x.length;++K)x[K].name===
t&&(x[K].value=A),"trialKey"===x[K].name&&(x[K].value=k);t=m.param(x);if((k=h(k,t))&&5===++l)break a}}});m(document).delegate("#shippingOptionFormId","submit",function(a){p()})}})});r.when("A","button-blocker","page-detector").register("scheduled-delivery-readiness-checker",function(a,m,k){function e(){k.isMobile()&&k.isSosp()&&l("div.scheduled-delivery").length&&(l(document).delegate("div."+d+":visible input[type\x3d'radio'].shipping-option","change",function(){g(l(this).closest("div."+d))}),a.on("active-shipment-changed",
g))}function f(a){b||(a.hasClass("scheduled-delivery-loading")?b=a.find(".loading-tooltip").text():a.hasClass("scheduled-delivery-picking")&&(b=a.find(".picking-tooltip").text()))}function g(a){b=null;a?f(a):l("div.one-shipment:visible div."+d+".scheduled-delivery").each(function(){var a=l(this);a.find("input").is(":checked")&&f(a)});b?m.show("scheduled-delivery",b):m.hide("scheduled-delivery")}var l=a.$,b,d=q.P&&q.P.AUI_BUILD_DATE?"selectable-box":"fake-label";if(k.isMobile())a.on("checkout:reload:shipoptionselect",
e);return{check:g}});"use strict";r.when("A","quantity-service","page-conductor","page-detector","ajax-utility","page-transition-controller","gift-utility","client-side-metrics").register("gift-form-base-controller",function(a,m,k,e,f,g,l,b){function d(a){a.is(":checked")||(ca?a.is(":checked")||a.closest("label").click():(b.increaseCount("removeauijs4"),a.attr("checked",!0).trigger("change")))}function c(a){a.attr("disabled","disabled");ca&&a.closest("div").bind("click.disable",function(a){a.stopPropagation()})}
function h(a){a.removeAttr("disabled");ca&&a.closest("div").unbind("click.disable")}function p(){r.when("a-dropdown").execute(function(a){var b=z(".select-recipient");b.empty();for(var c=0;c<U.length;c++){var d=z("\x3coption/\x3e").attr({value:U[c].value}).text(U[c].text);b.append(d)}b.each(function(){var b=z(this).closest(".gift-connection-section"),c=b.find(".include-gift-connection-checkbox").is(":checked"),d=b.find(".item-id").val(),e=b.find(".item-giftlist-type-id").val(),h;!e||"0"!==e&&"1"!==
e&&"2"!==e?e&&"3"===e&&(h=b.find(".item-giftlist-id").val()):h=e;!h&&c&&(c=b.find(".item-registry-id").val())&&Z&&Z[c]&&(h=Z[c]);h&&(a.setValue(z(this).attr("id"),h),(e&&"1"===e||"2"===e)&&b.find(".gift-connection-recipient-extra").removeClass("aok-hidden").show(),A(d))})})}function x(){z(".gift-connection-recipient-section").unbind("click").bind("click",function(){if(!Y)return z(this).find(".select-recipient-spinner").removeClass("aok-hidden").show(),!1});z(".select-recipient").each(function(){z(this).unbind("change").bind("change",
function(){var a=z(this),b=a.next().find(".a-dropdown-prompt"),c=z("\x3cdiv/\x3e").html(a.find(":selected").text()).clone().html();setTimeout(function(){b.html(c)},0)})});r.when("a-dropdown").execute(function(a){z(".gift-connection-section").each(function(){var b=z(this),c=b.find(".item-id").val(),d=b.find(".item-giftlist-type-id").val();b.find(".item-giftlist-id").val();var e=b.find(".item-occasion-id").val(),h=b.find(".item-occasion-month").val(),f=b.find(".item-occasion-day").val(),g=b.find(".item-age").val();
b.find("#input-recipient-first-name-"+c).unbind("keyup").keyup(function(){A(c)});b.find("#input-recipient-last-name-"+c).unbind("keyup").keyup(function(){A(c)});if("1"===d||"2"===d)a.setValue(b.find(".select-recipient").attr("id"),d),b.find(".gift-connection-recipient-extra").removeClass("aok-hidden").show();a.setValue(b.find(".select-occasion").attr("id"),e);a.setValue(b.find(".select-occasion-month").attr("id"),h);a.setValue(b.find(".select-occasion-day").attr("id"),f);a.setValue(b.find(".select-occasion-age").attr("id"),
g);if("1"===e||"2"===e)b.find(".gift-connection-occasion-extra").removeClass("aok-hidden").show(),"2"===d&&b.find(".select-occasion-age-row").removeClass("aok-hidden").show();"1"!==e&&"2"!==e&&"3"!==e&&A(c)})});var a="/gp/buy/pipeline/handlers/list-of-giftlists.html",b=z(".item-registry-id").map(function(){if(z(this).val())return z(this).val()}).get().join();b&&(a+="?fromRegistryIds\x3d"+b);U?(p(),z(".select-recipient-spinner").hide(),Y=!0):(Y=!1,z.ajax({type:"POST",url:a,dataType:"json",async:!0,
cache:!1,timeout:5E3,success:function(a){!U&&a.options&&0<a.options.length&&(U=a.options);a.registryIdMapping&&(Z=a.registryIdMapping);U&&p();z(".select-recipient-spinner").hide();Y=!0},error:function(a,b,c){z(".select-recipient-spinner").hide();Y=!0}}))}function v(){ha=[];a.state("giftNotificationEmailConstraints",[]);a.state("giftDeliveryDateConstraints",[]);z('[data-action\x3d"gift-form-element"]').each(function(){var a=z(this);a.is("span")?a.find("input, textarea, select:first").trigger({type:"change",
isInit:!0}):a.trigger({type:"change",isInit:!0})});z("textarea").unbind("keyup.gift-textarea click.gift-textarea").bind("keyup.gift-textarea click.gift-textarea",function(){z(this).trigger("change")});0<z(".enable-gift-connections").length&&x()}function y(a,b){var c=31;if("1"===b)c=0===a%4&&0!==a%100||0===a%400?29:28;else if("3"===b||"5"===b||"8"===b||"10"===b)c=30;return c}function w(a,b,c){a=f.jsonify(a);k.redirect(a)}function n(a){r.when("a-dropdown").execute(function(b){z(".gift-connection-recipient-extra-"+
a).hide();b.setValue("select-recipient-"+a,"0");z("#input-recipient-first-name-"+a).val("");z("#input-recipient-last-name-"+a).val("")})}function u(a){r.when("a-dropdown").execute(function(b){z(".gift-connection-occasion-extra-"+a).hide();b.setValue("select-occasion-"+a,"0");b.setValue("select-occasion-month-"+a,"0");b.setValue("select-occasion-day-"+a,"0");b.setValue("select-occasion-age-"+a,"-1");z("#occasion-has-reminder-checkbox-"+a).attr("checked",!0)})}function B(a,b){r.when("a-dropdown").execute(function(c){for(var d=
0;d<U.length;d++)b&&b===U[d].value&&U[d].bMonth&&U[d].bDay&&(c.setValue("select-occasion-month-"+a,U[d].bMonth),c.setValue("select-occasion-day-"+a,U[d].bDay))})}function A(a){r.when("a-dropdown").execute(function(b){var c=z("#select-recipient-"+a).find(":selected").val();"0"!==c&&("1"!==c&&"2"!==c||z("#input-recipient-first-name-"+a).val()||z("#input-recipient-last-name-"+a).val())?b.updateSelect("select-occasion-"+a,{status:"enabled"}):(u(a),b.updateSelect("select-occasion-"+a,{status:"disabled"}))})}
function t(a,b,c){"1"===b&&"2"===c?z("#select-occasion-age-row-"+a).removeClass("aok-hidden").show():z("#select-occasion-age-row-"+a).hide()}function M(){var a=z("#hidePricesCheckbox"),c=z("#kindle-reg-radio-your-account");ca?c.is(":checked")?z("#kindle-reg-radio-another-account").closest("label").click():a.is(":checked")||a.closest("label").click():(b.increaseCount("removeauijs6"),a.is(":checked")||a.attr("checked","checked").trigger("change"),c.is(":checked")&&(c.removeAttr("checked").trigger("change"),
z("#kindle-reg-radio-another-account").attr("checked","checked").trigger("change")))}function K(){var a=z("#hidePricesCheckbox"),c=z("#kindle-reg-radio-another-account");ca?c.is(":checked")?z("#kindle-reg-radio-your-account").closest("label").click():a.is(":checked")&&a.closest("label").click():(b.increaseCount("removeauijs7"),a.is(":checked")&&a.removeAttr("checked").trigger("change"),c.is(":checked")&&(c.removeAttr("checked").trigger("change"),z("#kindle-reg-radio-your-account").attr("checked",
"checked").trigger("change")))}function P(){z("#hidePricesCheckboxLabel").hide();var a=z("#hidePricesCheckbox");ca&&(a.is(":checked")||a.closest("label").click());a.attr("disabled",!0).hide().trigger("change");z("#kindle-reg-radio-another-account").attr("disabled",!0).trigger("change");z("#kindle-reg-radio-your-account").attr("disabled",!0).trigger("change");z("#hidePricesDisabledMessage").show();z("#hidePricesDisabledMessage").removeClass("aok-hidden");ca&&(z("label.a-touch-checkbox.hide-prices-checkbox").addClass("a-touch-selector-disabled").bind("click.disable",
function(a){a.stopPropagation()}),z("label.a-touch-radio.kindle-reg-option").addClass("a-touch-selector-disabled").bind("click.disable",function(a){a.stopPropagation()}))}function O(a){var b=!1;z(".afn-wrap-checkbox").each(function(){var a=z(this);a=a.is("input")?a:a.find("input");if(a.is(":checked"))return b=!0,!1});z(".mfn-no-wrap-radio").each(function(){var a=z(this);a=a.is("input")?a:a.find("input");if(!a.is(":checked"))return b=!0,!1});if(b)M(),P();else if(z("#hidePricesCheckbox").is(":disabled"))z("#hidePricesCheckboxLabel").show(),
z("#hidePricesCheckbox").removeAttr("disabled").show().trigger("change"),z("#kindle-reg-radio-another-account").removeAttr("disabled").trigger("change"),z("#kindle-reg-radio-your-account").removeAttr("disabled").trigger("change"),z("#hidePricesDisabledMessage").hide(),ca&&(z("label.a-touch-checkbox.hide-prices-checkbox").removeClass("a-touch-selector-disabled").unbind("click.disable"),z("label.a-touch-radio.kindle-reg-option").removeClass("a-touch-selector-disabled").unbind("click.disable"));else if(a.is("input")||
(a=a.find("input")),"hidePricesCheckbox"===a.attr("id"))a.is(":checked")?M():K();else if("kindle-reg-radio-another-account"===a.attr("id")||"kindle-reg-radio-your-account"===a.attr("id"))z("#kindle-reg-radio-your-account").is(":checked")?K():M()}function H(a){var b=z("#giftwrap-carousel-wrap-pane-"+a+" ul li").size();b&&(z("#giftwrap-carousel-wrap-holder-"+a).css("width",90*b),z("#giftwrap-carousel-wrap-pane-"+a).css("width",90*E));N(a)}function N(a){z("#giftwrap-carousel-wrap-holder-"+a).find("ul li, ol li").each(function(b,
c){b=z(c);b.find("input").is(":checked")&&Q(b,{itemId:a})})}function Q(a,b){a.parent().find(".selected-giftwrap-image").removeClass("selected-giftwrap-image");a.find(".giftwrap-carousel-item-image").addClass("selected-giftwrap-image");a.parent().find(".wrap.a-button-selected").removeClass("a-button-selected");a.addClass("a-button-selected");var c=b.itemId;b=b.wrapNo;var d=k.isSPP(),e=a.find("input[type\x3dradio]");e.attr("checked",!0);d||(d=a.data("giftwrap-id"),e.val(d).change());e=a.data("wrap-no");
d=z("#giftwrap-option-preview-imagearea-default-"+c);var h=z("#giftwrap-option-preview-imagearea-image-"+c),f=z(".selectedWrapLargeLink","#item-"+c);c=z(".wrapNo-"+c+"-"+b);a.hasClass("none-wrap")?(d.removeClass("aok-hidden"),h.addClass("aok-hidden"),f.length&&(f.addClass("aok-hidden"),f.removeClass("selectedWrapLargeLink"))):(a=a.find("img").attr("src"),h.find("img").attr("src",a),d.addClass("aok-hidden"),h.removeClass("aok-hidden"),f.length&&(f.addClass("aok-hidden"),f.removeClass("selectedWrapLargeLink")),
c.length&&(c.addClass("selectedWrapLargeLink"),c.removeClass("aok-hidden")));a=z(".selectedWrapLargeLink");c=z(".larger-image-link-carousel-"+e);a.removeClass("selectedWrapLargeLink").addClass("aok-hidden");c.removeClass("aok-hidden").addClass("selectedWrapLargeLink")}function S(a,b){var c=b.itemId;b=z("#giftwrap-option-preview-imagearea-default-"+c);c=z("#giftwrap-option-preview-imagearea-image-"+c);a.hasClass("none-wrap")?(b.removeClass("aok-hidden"),c.addClass("aok-hidden")):(a=a.find("img").attr("src"),
c.find("img").attr("src",a),b.addClass("aok-hidden"),c.removeClass("aok-hidden"))}function G(a,b){var c=b.itemId;b=z("#giftwrap-option-preview-imagearea-default-"+c);c=z("#giftwrap-option-preview-imagearea-image-"+c);if(a.parent().find(".selected-giftwrap-image").parents("li").hasClass("none-wrap"))b.removeClass("aok-hidden"),c.addClass("aok-hidden");else{var d=".selected-giftwrap-image img";k.isSPP()&&(d="img.selected-giftwrap-image");a=a.parent().find(d).attr("src");c.find("img").attr("src",a);
b.addClass("aok-hidden");c.removeClass("aok-hidden")}}function J(a,b){var c=a.find(".empty-message-warning"),d=a.find(".no-receipt-warning"),e=a.find("textarea");a=a.find(".message-counter");b&&!d.is(":visible")?(a.hide(),c.show(),e.addClass("gift-warning")):(c.hide(),e.removeClass("gift-warning"),a.show())}function V(a){var b=z("#"+a.id),c=l.getCharCount(b.val(),a.useByteSize);b=l.getLineCount(b.val(),a.maxChars/a.maxLines);return{length:c,charDelta:a.maxChars-c,lineDelta:a.maxLines-b}}function W(a,
b){b=z("#item-"+b.itemId);var c=a.is(":checked")&&!a.hasClass("mfn-no-wrap-radio");k.isSPP()&&z("#carouselGiftWrap").length&&(c=!a.hasClass("mfn-no-wrap-radio"));c?(b.find(".gift-message-pslip").hide(),b.find(".gift-message-card").show()):(b.find(".gift-message-card").hide(),b.find(".gift-message-pslip").show())}function X(b,c){var d=c.itemId;c=k.isSPP()?c.currentTab:b.data("current-tab");var e=z("#afn-gift-options-wrapper-"+d).data("active-tab");c!==e&&(b.parent().find(".selected-giftwrap-tab").removeClass("selected-giftwrap-tab"),
b.addClass("selected-giftwrap-tab"),z("#afn-gift-options-wrapper-"+d).data("active-tab",c),b="#item-"+d,e=k.isSPP()?z("#giftwrap-carousel-wrap-holder-"+d,b):b,e.length&&a.trigger("checkout:gift:changeCarouselWrapOptions",e,c,d),c=z(".none-wrap",z(b)).find("input"),c.prop("checked",!0),c.val("").change(),k.isSPP()?(c=z("#afn-gift-options-wrapper-"+d),c.length&&(c=c.data("active-tab"),a.trigger("checkout:gift:adaptCarouselGiftPanel",d,c))):a.trigger("checkout:gift:adaptCarousel",d),z("#giftwrap-carousel-wrap-holder-"+
d).removeClass("a-button-selected").find(".selected-giftwrap-image").removeClass("selected-giftwrap-image"),z("#giftwrap-carousel-item-image-"+d).addClass("selected-giftwrap-image").parents(".wrap").addClass("a-button-selected"),z("#giftwrap-option-preview-imagearea-default-"+d).removeClass("aok-hidden"),z("#giftwrap-option-preview-imagearea-image-"+d).addClass("aok-hidden"),c=z(".selectedWrapLargeLink"),c.length&&(c.addClass("aok-hidden"),c.removeClass("selectedWrapLargeLink")),c=k.isSPP(),b="#item-"+
d,z("#gift-message-noshi-warning-"+d).addClass("aok-hidden"),z("#includeMessageCheckbox-"+d).removeAttr("disabled"),c?z("#afn-message-span-"+d,z(b)).removeClass("aok-hidden"):(z("#afn-message-span",z(b)).removeClass("disable-message-area").addClass("enable-message-area"),z("#gift-message-heading-"+d).removeClass("disable-message-area").addClass("enable-message-area"),z("#message-area-"+d).removeAttr("disabled")))}var ha,E=4,U,Y=!1,Z,z=a.$,ca=q.P&&q.P.AUI_BUILD_DATE&&e.isMobile(),ba=l.getInput;a.declarative("save-gift-for-later",
["click"],function(a){g.show();a=a.$currentTarget.data("entityId")||a.data.entityId;m.call(a,0,{success:w})});r.register("gift-base/init-carousel",function(){return H});r.register("gift-base/set-carousel-size",function(){return function(a){E=a}});var ia={toggleGiftDataAndDeliveryOptions:function(a){a=a.closest(".gift-options-wrapper");var b=ba(a.find(".includeMessageCheckbox"));b&&b.is(":checked")?(a.find(".gift-delivery-option").show(),a.find(".item-wrap-span").show(),a.find(".item-wrap-row").show(),
a.find(".item-gift-message-span").show()):(a.find(".gift-delivery-option").hide(),a.find(".item-wrap-span").hide(),a.find(".item-wrap-row").hide(),a.find(".item-gift-message-span").hide())},toggleGiftDeliveryOptions:function(a){var b=a.closest(".gift-options-wrapper");a.is("input[type\x3dcheckbox]")?a.is(":checked")?b.find(".gift-notification-email").removeClass("a-form-disabled"):b.find(".gift-notification-email").addClass("a-form-disabled"):(b.find(".gift-notification-email").removeClass("a-form-disabled"),
a=b.find(".includeMessageCheckbox"),d(a.find("input[type\x3dcheckbox]")),ca&&(a=a.find("i.a-icon"),a.length&&(a.removeClass("a-icon-checkbox-inactive"),a.removeClass("a-icon-touch-checkbox-inactive"),a.addClass("a-icon-checkbox-active"),a.addClass("a-icon-touch-checkbox-active"))))},initGiftNotificationEmail:function(b){var c=a.state("giftNotificationEmailConstraints");c.push({id:b.attr("id")});a.state("giftNotificationEmailConstraints",c)},initGiftDeliveryDate:function(b){var c=a.state("giftDeliveryDateConstraints");
b.hasClass("year-select")||(b=b.parents("div.del-opt-date-section").find("select.year-select:first"));c.push({id:b.attr("id")});a.state("giftDeliveryDateConstraints",c)},updateDateDropdown:function(a){var b=a.closest(".gift-options-wrapper");a=b.find(".month-select").val();var c=b.find(".day-select");c.val();b=b.find(".year-select").val();var d=y(b,a);if(c.hasClass("a-native-dropdown"))r.when("a-dropdown").execute(function(a){a=a.getSelect(c);if(a.getOptions().size()>d)for(var b=a.getOptions().size()-
1;b>=d;b--)a.removeOption(b);else for(b=a.getOptions().size();b<d;b++)a.addOption({text:b+1,value:b+1},b)});else{if(c.find("option").length>d)c.find("option:gt("+(d-1)+")").remove();else for(a=c.find("option").length+1;a<=d;a++)c.append(z("\x3coption\x3e",{value:a}).text(a));c.trigger("change")}},initSelectedTabAndWrapHolderWidth:H,initGiftMessage:function(a,b){ca&&!a.is("textarea")&&(a=a.find("textarea"));ha.push({id:a.attr("id"),maxChars:parseInt(b.maxChars,10),maxLines:parseInt(b.maxLines,10),
useByteSize:b.useByteSize});ba(a.closest(".gift-options-wrapper").find(".includeMessageCheckbox")).is(":checked")||a.addClass("a-form-disabled");"1"===z("#multipleAFNGiftWrapOption").val()&&(a=a.attr("id").substring(a.attr("id").lastIndexOf("-")+1,a.attr("id").size),H(a))},enforceSelectorParity:O,enforceGiftReceiptParity:function(a,b){a=z("#item-"+b.itemId);if(0!==a.length){b=a.find(".item-receipt-row label");var e=ba(a.find(".includeReceiptCheckbox")),f=a.find(".mfn-hide-price-row label"),g=ba(a.find(".mfnHidePriceCheckbox")),
p=a.find(".item-message-row label"),l=ba(a.find(".includeMessageCheckbox")).is(":checked"),n=!1;0<a.find(".afn-wrap-checkbox").length?ba(a.find(".afn-wrap-checkbox")).is(":checked")&&(n=!0):0<a.find(".mfn-no-wrap-radio").length&&(ba(a.find(".mfn-no-wrap-radio")).is(":checked")||(n=!0));if(n||l)d(e),d(g);n||l&&p.is(":visible")?(c(e),b.addClass("checkout-gift-option-disabled"),c(g),f.addClass("checkout-gift-option-disabled")):(h(e),h(g),b.removeClass("checkout-gift-option-disabled"),f.removeClass("checkout-gift-option-disabled"))}},
enforceHidePriceParity:function(a){var b=!1;z(".includeReceiptCheckbox").each(function(){if(ba(z(this)).is(":checked"))return b=!0,!1});var c=!1;z(".mfnHidePriceCheckbox").each(function(){if(ba(z(this)).is(":checked"))return c=!0,!1});b||c?(M(),z(".kindle-reg-msg-your-account").hide(),z(".kindle-reg-msg-another-account").show()):(K(),z(".kindle-reg-msg-another-account").hide(),z(".kindle-reg-msg-your-account").show())},toggleNoReceiptWarning:function(a){var c=ba(a).is(":checked"),e=a.closest(".gift-options-wrapper");
a=e.find(".no-receipt-warning");var h=e.find(".empty-message-warning");e=e.find(".item-message-row").find(".includeMessageCheckbox");var f=ba(e);c?(a.hide(),e.is(":visible")||d(f)):(h.hide(),a.show(),f.is(":checked")&&(ca?f.is(":checked")&&f.closest("label").click():(b.increaseCount("removeauijs5"),f.removeAttr("checked").trigger("change"))))},toggleMessageArea:function(a){var b=a.closest(".gift-options-wrapper");if(a.is("textarea"))b=ba(b.find(".includeMessageCheckbox")),d(b);else{a=ba(b.find(".includeMessageCheckbox")).is(":checked");
var c=b.find(".item-message-row label").is(":visible"),e=0<b.find(".empty-message-warning").length,h=b.find("textarea"),f=h.data("default-text"),g=0<h.val().length;a?(b.find(".gift-message-edit").show(),b.find(".gift-message-label").removeClass("a-color-secondary"),h.removeClass("a-form-disabled"),f&&h.val(f)):(c&&b.find(".gift-message-edit").hide(),b.find(".gift-message-label").addClass("a-color-secondary"),h.addClass("a-form-disabled"),f&&h.val(""));e&&(a&&g?J(b,!1):J(b,!0))}},toggleMessageLocationText:W,
toggleMessageBoxDisplay:function(b,e){var f=z("#item-"+e.itemId);if(0!==f.length){var g=f.find(".item-message-row");e=f.find(".item-receipt-row");var p=f.find(".gift-message-on-card"),n=f.find(".gift-message-on-receipt"),l=g.find("label");g=ba(g.find(".includeMessageCheckbox"));var k=a.trim(f.find(".gift-message-default-placeholder").text()),m=a.trim(f.find(".gift-message-with-wrap-placeholder").text());f=f.find("textarea");var t=b.hasClass("mfn-no-wrap-radio")||b.closest("div").hasClass("mfn-no-wrap-radio");
ba(b).is(":checked")&&!t?(n.hide(),p.show(),f.attr("placeholder",m),e.is(":visible")&&(d(g),l.is(":visible")&&(c(g),l.addClass("checkout-gift-option-disabled")))):(p.hide(),n.show(),f.attr("placeholder",k),h(g),l.removeClass("checkout-gift-option-disabled"))}},updateContinueButtons:function(){for(var b=!0,c,d=0;d<ha.length;d++)if(c=z("#"+ha[d].id),c.closest(".gift-options-wrapper").find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]').is(":checked")&&(c=V(ha[d]),0>c.charDelta||0>c.lineDelta))b=
!1;b?(z(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").show(),z(".save-gift-button-box span.a-button-disabled").hide()):(z(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").hide(),b=z(".save-gift-button-box span.a-button-disabled"),b.removeClass("aok-hidden"),b.show());a.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")},updateMessageCounter:function(a){ca&&!a.is("textarea")&&(a=a.find("textarea"));for(var b,c=0;c<ha.length;c++)a.attr("id")===
ha[c].id&&(b=V(ha[c]));if(b){a=a.closest(".gift-options-wrapper");c=a.find(".message-counter");c.find(".remaining-count").hide();if(0<a.find(".empty-message-warning").length){if(0===b.length){J(a,!0);return}J(a,!1)}(-1>b.charDelta?c.find(".remaining-char-over-multiple").show():0>b.charDelta?c.find(".remaining-char-over-single").show():1===b.charDelta?c.find(".remaining-char-single").show():c.find(".remaining-char-multiple").show()).find(".chars-remaining").html(Math.abs(b.charDelta));(-1>b.lineDelta?
c.find(".remaining-line-over-multiple").show():0>b.lineDelta?c.find(".remaining-line-over-single").show():1===b.lineDelta?c.find(".remaining-line-single").show():c.find(".remaining-line-multiple").show()).find(".lines-remaining").html(Math.abs(b.lineDelta));c.show()}},updateSelectedGiftWrap:Q,clearGiftConnection:function(a,b){z("#include-gift-connection-checkbox-"+b.itemId).is(":checked")||(n(b.itemId),A(b.itemId))},toggleGiftConnectionAgeDropdown:t,toggleGiftConnectionRecipientArea:function(a,b){a=
z("#select-recipient-"+b.itemId).find(":selected").val();var c=z("#select-occasion-"+b.itemId).find(":selected").val();!a||"1"!==a&&"2"!==a?(z(".gift-connection-recipient-extra-"+b.itemId).hide(),"1"===c&&a&&B(b.itemId,a)):z(".gift-connection-recipient-extra-"+b.itemId).removeClass("aok-hidden").show();t(b.itemId,c,a);A(b.itemId)},toggleGiftConnectionOccasionArea:function(a,b){a=z("#select-occasion-"+b.itemId).find(":selected").val();var c=z("#select-recipient-"+b.itemId).find(":selected").val();
!a||"1"!==a&&"2"!==a?z(".gift-connection-occasion-extra-"+b.itemId).hide():("1"===a&&c&&"1"!==c&&"2"!==c&&B(b.itemId,c),z(".gift-connection-occasion-extra-"+b.itemId).removeClass("aok-hidden").show());t(b.itemId,a,c)},includeGiftConnection:function(a,b){(a=z("#select-recipient-"+b.itemId).find(":selected").val())&&"0"===a||z("#include-gift-connection-checkbox-"+b.itemId).attr("checked",!0)},updateGiftOptionsTabSelection:X,updatePreviewImageOnMouseEnter:S,updatePreviewImageOnMouseLeave:G,toggleGiftMessageWarning:function(a){var b=
z("#"+a.attr("id"));l.toggleGiftMessageWarning(b,a.closest(".item-gift-message-span"))}};a.declarative("gift-form-element",["change"],function(a){var b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(ia[b[c]])ia[b[c]](a.$target,a.data)});a.declarative("gift-form-element","click mouseenter mouseleave",function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(ia[b[c]])ia[b[c]](a.$currentTarget,
a.data,a)});a.declarative("select-gift-wrap","click",function(a){Q(a.$target.parents("li"),{itemId:a.data.itemId,wrapNo:a.data.wrapNo});O(a.$target);var b=a.$target.parents("li").find(".gift-hidden-radio");W(b,{itemId:a.data.itemId})});a.declarative("select-gift-wrap","mouseenter",function(a){S(a.$target.parents("li"),a.data)});a.declarative("select-gift-wrap","mouseleave",function(a){G(a.$target.parents("li"),a.data)});a.declarative("update-gift-options-tab-selection",["click"],function(a){var b=
a.$target.parents("li");b.attr("data",a.data);X(b,a.data)});a.on("checkout:reload:giftselect",v);a.on("checkout:reload:spp-giftoptions",v);return{extendFunctions:function(a){z.extend(ia,a)}}});"use strict";r.when("A","page-transition-controller","page-conductor").register("gift-form-del-opt-controller",function(a,m,k){function e(a){var b=a.closest(".expando-box");b&&(b=b.find(".a-expander-header"),a.closest(".expando-content").is(":hidden")&&b.click())}function f(a){var b=a.closest(".gift-options-wrapper"),
d=b.find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]');if(d&&!d.is(":checked"))return!0;d=b.find(".email-error-selector");b.find(".gift-notification-email-error").hide();d.removeClass("a-form-error");if(64<q.unescape(encodeURIComponent(a.val())).length)return d.addClass("a-form-error"),b.find(".gift-notification-email-length-exceeded-error").removeClass("aok-hidden").show(),!1;if(/^\S+[@]\S+[.]\S+$/.test(a.val()))return!0;d.addClass("a-form-error");b.find(".gift-notification-invalid-email-error").removeClass("aok-hidden").show();
return!1}function g(){b("#giftForm").find(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").unbind("click").bind("click",function(a){a.preventDefault();l(a)});b(".checkout-gift-image-preview-trigger \x3e a").show();b("#gift-kindle-imb").show()}function l(d){d=b("#giftForm");var c=d.find('input[name\x3d"hidePrices"]'),h=c.is(":disabled");h&&c.removeAttr("disabled");for(var g=!0,l=a.state("giftNotificationEmailConstraints"),v=a.state("giftDeliveryDateConstraints"),y=0;y<l.length;y++){var w=
b("#"+l[y].id);f(w)||(g=!1,e(w))}for(l=0;l<v.length;l++){y=b("#"+v[l].id);w=y.closest(".gift-options-wrapper");var n=w.find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]');if(n&&!n.is(":checked"))w=!0;else{var u=w.find(".month-select").val(),B=w.find(".day-select").val();n=w.find(".year-select");var A=n.val(),t=w.find("#current-date").val().split("-");u=new Date(A,u,B);t=new Date(t[0],t[1]-1,t[2]);B=new Date(t.getTime());B.setMonth(B.getMonth()+12);w.find(".gift-delivery-date-error").hide();
A=w.find(".date-error-selector");n=n.hasClass("a-native-dropdown")?"error-border a-form-error":"a-form-error";A.removeClass(n);u>=B||u<t?(w.find(".gift-delivery-date-error").removeClass("aok-hidden").show(),A.addClass(n),w=!1):w=!0}w||(g=!1,e(y))}a.state("continueAction",{enable:g});if(a.state("continueAction").enable)k.isSPP()||m.showPageTransition(),d.submit();else return b("html, body").animate({scrollTop:b(".a-form-error").closest("div").offset().top},500),!1;h&&c.attr("disabled",!0)}var b=a.$;
a.declarative("submit-gift-options","click",function(a){l(a)});a.declarative("discard-gift-options","click",function(a){b('#giftForm input[type\x3d"checkbox"]').prop("checked",!1);b("#giftForm textarea").addClass("a-form-disabled");l(a)});a.on("checkout:reload:giftselect",g);a.on("checkout:reload:spp-giftoptions",g)});"use strict";r.when("A").register("teen-message-controller",function(a){var m=a.$;a.declarative("teen-message-form-element","click keyup",function(a){a=a.data.maxChars;var e=m("#teen-message-box").val(),
f=e.match(/(\r\n|\n|\r)/g),g=0;f&&(g=f.length);e=e.length+g;m(".remaining-char").text(Math.max(a-e,0))});m("#aui-teen-message-box").length&&m(".remaining-char").length&&r.when("A").execute(function(a){function e(a){a=a.val();var b=(a.match(/(\r\n|\n|\r|\n\r)/g)||{}).length||0;return a.length+b}a=a.$;var f=a("#aui-teen-message-box");f.bind("change keypress",function(a){return e(f)>=l?(a.preventDefault(),!1):!0});f.bind("paste",function(a){if(a&&a.originalEvent&&a.originalEvent.clipboardData&&a.originalEvent.clipboardData.getData("Text")){var b=
a.originalEvent.clipboardData.getData("Text"),c=e(f);if(c+b.length>=l)return b=b.substring(0,l-c),b=f.val()+b,f.attr("value",b),a.preventDefault(),!1}return!0});f.bind("click keyup",function(){var a=Math.max(l-e(f),0);g.text(a)});var g=a(".remaining-char");var l=f.parent().data("maxchars")})});"use strict";r.when("A","page-transition-controller","page-conductor","loading-spinner-controller","client-side-metrics").register("concealment-form-del-opt-controller",function(a,m,k,e,f){function g(a){var c=
b("#concealmentForm");c.find("input:checked").length?(a=a.data.saveConcealmentRefTag,f.increaseCount("CPEX.Checkout.Select.Concealment",1)):(a=a.data.cancelConcealmentRefTag,f.increaseCount("CPEX.Checkout.Cancel.Concealment",1));c.find("input[name\x3dref]").val(a);c.attr("action",c.attr("action")+"/ref\x3d"+a)}function l(a){a=b("#concealmentForm");k.isSPP()||m.showPageTransition();a.submit()}var b=a.$;a.declarative("submit-concealment-options","click",function(a){g(a);l(a)});a.declarative("discard-concealment-options",
"click",function(a){b('#concealmentForm input[type\x3d"checkbox"]').prop("checked",!1);g(a);l(a)});a.declarative("submit-concealment-form","click",function(a){g(a);a.$target.closest(".a-button").addClass("a-button-disabled");e.showSpinner(a.$target.closest("form"))})});"use strict";r.when("A","page-transition-controller","page-conductor","address-popovers","checkout-general-utils","a-popover","client-side-metrics","weblab-helper","ajax-utility").register("itemselect-address-controller",function(a,
m,k,e,f,g,l,b,d){function c(){v(".lineitem").each(function(a,b){a=v(b);a.find(".no-js-address-dropdown").remove();a.find(".no-js-address-select").remove();a.find(".js-address-dropdown").prop("disabled",!1);a.find(".address-dropdown").removeClass("a-button-disabled")});v("#suppressAddAddressPopover").val()&&v('select[name^\x3d"addressID."]').find("option").each(function(){var a=v(this);"New"===a.val()&&a.closest("optgroup").remove()})}function h(a){var c=(new Date).getTime(),e=k.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});
b.isHeadersCleaned()?v.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+c,data:a,dataType:"text",headers:e,error:k.ajaxRedirect,success:function(a,b,c){var e=c.getResponseHeader("x-amz-checkout-fatal-error");if(null!==e&&e!==G)q.location=e;else if(p(a)){a=d.jsonify(a);x(a,c);c=u.find('input[name^\x3d"previousAddress."]');if(null!==c||c!==G)var h=w||c.val();var g=u.find('select[name^\x3d"addressID."]');null===g&&g===G||r.when("a-dropdown").execute(function(a){a.setValue(g.attr("id").replace(/\./g,
"\\."),h);g.find("option").removeAttr("selected");g.find('option[value\x3d"'+h+'"]').attr("selected","selected")});m.hide()}else k.ajaxUpdatePage(a,b,c),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}}):v.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+c,data:a,dataType:"text",headers:e,error:k.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-fatal-error");if(null!==d&&d!==G)q.location=
d;else if(p(c)){x(a,c);a=u.find('input[name^\x3d"previousAddress."]');if(null!==a||a!==G)var e=w||a.val();var h=u.find('select[name^\x3d"addressID."]');null===h&&h===G||r.when("a-dropdown").execute(function(a){a.setValue(h.attr("id").replace(/\./g,"\\."),e);h.find("option").removeAttr("selected");h.find('option[value\x3d"'+e+'"]').attr("selected","selected")});m.hide()}else k.ajaxUpdatePage(a,b,c),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}})}function p(a){if(b.isHeadersCleaned()){if(a=
d.jsonify(a))var c=a.showAddonWarning}else c=a.getResponseHeader("x-amz-checkout-show-addon-warning");return null!==c&&c!==G}function x(a,c){b.isHeadersCleaned()?(c=a.showAddonWarning,a=a.asins):c=c.getResponseHeader("x-amz-checkout-show-addon-warning");v(".item-list").hide();a.trim().split(",").forEach(function(a){v('[data-asin\x3d"'+a+'"]').show()});a=v("#addon-warning-"+c+"-launcher");a.length&&(v(".delete-title").hide(),v(".reduce-title").hide(),v(".select-address-title").show(),v("input[name\x3duseLiveAUI]").length?
g.get(a).attrs({$trigger:n,position:"triggerHorizontal"}).show():(c=v.Event("keyup",{triggerPositioningElement:n,manualTrigger:!0}),a.trigger(c)))}var v=a.$,y,w,n,u;a.declarative("itemselect-get-address",["click","touchend"],function(a){f.protectAgainstDoubleAction("itemselect-get-address",200)||(w=a.$currentTarget.find(".js-address-dropdown").val())});a.declarative("itemselect-update-address",["change"],function(a){if(!f.protectAgainstDoubleAction("itemselect-update-address",200)){l.resetMetrics();
var b=a.$currentTarget.is("select")?a.$currentTarget:a.$currentTarget.find("select");y=b.val();if("New"===y)e.actionTriggerPopoverFromDropdown(a),r.when("a-dropdown").execute(function(a){a.setValue(b.attr("id").replace(/\./g,"\\."),w)});else{m.show();u=b.closest(".lineitem");var c,d;if(u){var g=u.find('input[name^\x3d"lineItemEntityID."]');g&&(c=g.val());(g=u.find('input[name^\x3d"quantity."]'))&&(d=g.val());(g=u.find(".js-address-dropdown"))&&(y=g.val())}n=a.$currentTarget.is("select")?a.$currentTarget.closest(".address-dropdown"):
a.$currentTarget;a=0;g=v("#addon-indicator");g.length&&"true"===g.attr("data-has-addon-items")&&(a=1);h({lineitems:c,addresses:y,quantities:d,isTrial:a})}}});a.declarative("itemselect-update-pantry-address",["change"],function(a){if(!f.protectAgainstDoubleAction("itemselect-update-pantry-address",200)){y=a.$currentTarget.val();m.show();var b="";a=a.$currentTarget.closest(".pantry-row");v(a).find(".pantry-item").each(function(a,c){a=v(c);b+="lineitems\x3d"+a.find('input[name^\x3d"lineItemEntityID."]').val()+
"\x26";b+="addresses\x3d"+y+"\x26";b+="quantities\x3d"+a.find('input[name^\x3d"quantity."]').val()+"\x26"});h(b)}});a.declarative("addon-delete-items",["click","touchend"],function(a){if(n!==G&&null!==n&&!f.protectAgainstDoubleAction("itemselect-delete-addons",200)){v(".a-button-close").trigger("click");m.show();a=(new Date).getTime();var b=v("#useCase").val(),c=k.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"}),d=u.find('input[name^\x3d"lineItemEntityID."]').val(),e=u.find('input[name^\x3d"quantity."]').val();
v.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+a,data:{lineitems:d,addresses:y,quantities:e,isTrial:0,deleteAddons:1,returnHTML:1,useCase:b},headers:c,error:k.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==d&&d!==G?q.location=d:(d=c.getResponseHeader("x-amz-checkout-fatal-error"),null!==d&&d!==G?q.location=d:(k.ajaxUpdatePage(a,b,c),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}});
a.on("checkout:reload:itemselect",c);a.on("checkout:reload:spp-itemselect",c)});"use strict";r.when("A","page-transition-controller","page-conductor","checkout-general-utils","a-popover","client-side-metrics","weblab-helper","ajax-utility").register("itemselect-delete-controller",function(a,m,k,e,f,g,l,b){function d(a,b){c(a,null===b||b===G?a.$currentTarget.closest(".lineitem"):b)}function c(a,b){a.$event.preventDefault();if(!e.protectAgainstDoubleAction("itemselect-delete-single-item",200)){g.resetMetrics();
m.show();w=b;u=a.$currentTarget.is("select")?a.$currentTarget.closest(".quantity-dropdown"):a.$currentTarget;a=w.find('input[name^\x3d"lineItemEntityID."]').val();b=0;(new Date).getTime();var c=y("#addon-indicator");c.length&&"true"===c.attr("data-has-addon-items")&&(b=1);p({lineitems:a,isTrial:b})}}function h(a,b){a.$event.preventDefault();if(!e.protectAgainstDoubleAction("itemselect-delete-multiple-items",200)){m.show();n=b;u=a.$currentTarget;var c="";a=0;b=y("#addon-indicator");b.length&&"true"===
b.attr("data-has-addon-items")&&(a=1);b=n.hasClass("pantry-row")?!0:!1;n.find(b?".pantry-item":".lineitem").each(function(a,b){c+="lineitems\x3d"+y(b).find('input[name^\x3d"lineItemEntityID."]').val()+"\x26"});p(c+"isTrial\x3d"+a)}}function p(a){var b=(new Date).getTime(),c=y('input[name\x3d"useCase"]').val(),d=k.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});y.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3ddelete\x26useCase\x3d"+c+"\x26cachebuster\x3d"+
b,data:a,dataType:"text",headers:d,error:k.ajaxRedirect,success:x})}function x(a,c,d){var h=d.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==h&&h!==G?(q.location=h,h=!0):h=!1;if(!h)if(h=d.getResponseHeader("x-amz-checkout-fatal-error"),null!==h&&h!==G)q.location=h;else{if(l.isHeadersCleaned()){if(h=b.jsonify(a))var f=h.showAddonWarning}else f=d.getResponseHeader("x-amz-checkout-show-addon-warning");f=null!==f&&f!==G?!0:!1;f?(v(a,d),m.hide()):(k.ajaxUpdatePage(a,c,d),e.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}}
function v(a,c){l.isHeadersCleaned()?(a=b.jsonify(a),c=a.showAddonWarning,a=a.asins):c=c.getResponseHeader("x-amz-checkout-show-addon-warning");y(".item-list").hide();a.trim().split(",").forEach(function(a){y('[data-asin\x3d"'+a+'"]').show()});a=y("#addon-warning-"+c+"-launcher");a.length&&(y(".delete-title").show(),y(".reduce-title").hide(),y(".select-address-title").hide(),y("input[name\x3duseLiveAUI]").length?f.get(a).attrs({$trigger:u,position:"triggerHorizontal"}).show():(c=y.Event("keyup",{triggerPositioningElement:u,
manualTrigger:!0}),a.trigger(c)))}var y=a.$,w,n,u;a.declarative("itemselect-delete-item",["click","touchend"],d);a.declarative("itemselect-delete-item-row",["click","touchend"],function(a){h(a,a.$currentTarget.closest(".item-row"))});a.declarative("addon-delete-items",["click","touchend"],function(a){if(u!==G&&!e.protectAgainstDoubleAction("itemselect-delete-addons",200)){y(".a-button-close").trigger("click");m.show();var b="";null!==n&&n!==G?(a=n.hasClass("pantry-row")?n.find(".pantry-item"):n.find(".lineitem"),
y(a).each(function(a,c){b+="lineitems\x3d"+y(c).find('input[name^\x3d"lineItemEntityID."]').val()+"\x26"})):null!==w&&w!==G&&(b+="lineitems\x3d"+w.find('input[name^\x3d"lineItemEntityID."]').val()+"\x26");p(b+"isTrial\x3d0\x26deleteAddons\x3d1")}});a.declarative("itemselect-delete-pantry-item",["click","touchend"],function(a){c(a,a.$currentTarget.closest(".pantry-item"))});a.declarative("itemselect-delete-pantry",["click","touchend"],function(a){h(a,a.$currentTarget.closest(".pantry-row"))});a.declarative("itemselect-delete-popover-item",
["click","touchend"],function(a){var b=a.$currentTarget.data("entityidtodelete");h(a,y('a[data-entityid\x3d"'+b+'"]').closest(".item-row"))});return{actionDeleteItem:d}});"use strict";r.when("A","page-transition-controller","page-conductor","itemselect-delete-controller","checkout-general-utils","a-popover","client-side-metrics","weblab-helper","ajax-utility").register("itemselect-quantity-controller",function(a,m,k,e,f,g,l,b,d){function c(){n(".lineitem, .pantry-item").each(function(a,b){a=n(b);
a.find(".no-js-quantity").remove();b=a.find(".quantity-dropdown");b.is(":visible")?(a.find(".js-select").prop("disabled",!1),b.removeClass("a-button-disabled")):(a=a.find(".quantity-input"),a.prop("disabled",!1),a.removeClass("a-form-disabled"))})}function h(a){a.find(".quantity-input").val(a.find('input[name^\x3d"previousQuantity."]').val())}function p(a){var b=a.$currentTarget.closest(".quantity-text-field").find(".update-quantity-link"),c=a.$currentTarget.is("input")?a.$currentTarget.val():a.$currentTarget.find("input").val();
var d="itemselect-show-update-pantry-button"===a.action?".pantry-item":".lineitem";0===parseInt(c,10)||""===c?("change"===a.type&&h(a.$currentTarget.closest(d)),b.hide()):(a=a.$currentTarget.closest(d).find('input[name^\x3d"previousQuantity."]').val(),c!==a?b.show():b.hide())}function x(a){a.$event.preventDefault();if(!f.protectAgainstDoubleAction("itemselect-update-quantity",200)){l.resetMetrics();A=a.$currentTarget.closest("itemselect-update-pantry-quantity"===a.action||"itemselect-update-pantry-quantity-text-field"===
a.action?".pantry-item":".lineitem");var c=A.find(".js-address-dropdown").val(),g=a.$currentTarget.find("select"),p=g.length?g:a.$currentTarget;u=p.is("select")?p.val():A.find(".quantity-input").val();if(0===parseInt(u,10)||""===u)h(A);else if("Delete"===u)r.when("a-dropdown").execute(function(a){a.setValue(p.attr("id").replace(/\./g,"\\."),B)}),e.actionDeleteItem(a,A);else{m.show();a=A.find('input[name^\x3d"lineItemEntityID."]').val();g=0;var x=(new Date).getTime(),M=n("#useCase").val(),Q=n("#addon-indicator");
t=p.is("select")?p.parent():A.find(".quantity-input");Q.length&&"true"===Q.attr("data-has-addon-items")&&(g=1);Q=k.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});b.isHeadersCleaned()?n.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+x,data:{lineitems:a,quantities:u,address:c,isTrial:g,returnHTML:1,useCase:M},dataType:"text",headers:Q,error:k.ajaxRedirect,success:function(a,b,c){var e=c.getResponseHeader("x-amz-checkout-fatal-error");
null!==e&&e!==G?q.location=e:y(a)?(a=d.jsonify(a),w(a,c),v(B===G?A.find('input[name^\x3d"previousQuantity."]').val():B,c),m.hide()):(k.ajaxUpdatePage(a,b,c),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}}):n.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+x,data:{lineitems:a,quantities:u,address:c,isTrial:g,returnHTML:1,useCase:M},dataType:"text",headers:Q,error:k.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-fatal-error");
null!==d&&d!==G?q.location=d:y(c)?(w(a,c),v(B===G?A.find('input[name^\x3d"previousQuantity."]').val():B,c),m.hide()):(k.ajaxUpdatePage(a,b,c),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}})}}}function v(a,b){10>a?(r.when("a-dropdown").execute(function(b){var c=A.find('select[name^\x3d"quantity."]');b.setValue(c.attr("id").replace(/\./g,"\\."),a);c.find("option").removeAttr("selected");c.find('option[value\x3d"'+a+'"]').attr("selected","selected")}),A.find(".quantity-dropdown").show(),
A.find(".quantity-text-field").hide(),A.find(".js-select").prop("disabled",!1),A.find(".quantity-input").prop("disabled",!0)):(A.find(".quantity-dropdown").hide(),A.find(".quantity-text-field").show(),A.find(".update-quantity-link").hide(),A.find(".js-select").prop("disabled",!0),A.find(".quantity-input").prop("disabled",!1));A.find(".quantity-input").val(a);A.find('input[name^\x3d"previousQuantity."]').val(a)}function y(a){if(b.isHeadersCleaned()){if(a=d.jsonify(a))var c=a.showAddonWarning}else c=
a.getResponseHeader("x-amz-checkout-show-addon-warning");return null!==c&&c!==G?!0:!1}function w(a,c){b.isHeadersCleaned()?(c=a.showAddonWarning,a=a.asins):c=c.getResponseHeader("x-amz-checkout-show-addon-warning");n(".item-list").hide();a.trim().split(",").forEach(function(a){n('[data-asin\x3d"'+a+'"]').show()});a=n("#addon-warning-"+c+"-launcher");a.length&&0<a.length&&(n(".reduce-title").show(),n(".delete-title").hide(),n(".select-address-title").hide(),n("input[name\x3duseLiveAUI]").length?g.get(a).attrs({$trigger:t}).show():
(c=n.Event("keyup",{triggerPositioningElement:t,manualTrigger:!0}),a.trigger(c)))}var n=a.$,u,B,A,t;a.declarative("itemselect-get-quantity",["click","touchend"],function(a){f.protectAgainstDoubleAction("itemselect-get-quantity",200)||a.$currentTarget.find("select").length&&(B=a.$currentTarget.find("select").val())});a.declarative("itemselect-update-quantity",["change"],x);a.declarative("itemselect-update-pantry-quantity",["change"],x);a.declarative("addon-delete-items",["click","touchend"],function(a){if(t!==
G&&!f.protectAgainstDoubleAction("itemselect-delete-addons",200)){n(".a-button-close").trigger("click");m.show();a=A.find('input[name^\x3d"lineItemEntityID."]').val();var b=(new Date).getTime(),c=n("#useCase").val(),d=k.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});n.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+b,data:{lineitems:a,quantities:u,isTrial:0,deleteAddons:1,returnHTML:1,useCase:c},headers:d,error:k.ajaxRedirect,
success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==d&&d!==G?q.location=d:(d=c.getResponseHeader("x-amz-checkout-fatal-error"),null!==d&&d!==G?q.location=d:(k.ajaxUpdatePage(a,b,c),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}});a.declarative("itemselect-sanitize-input",["keydown"],function(a){f.limitInputToNumbers(a)});a.declarative("itemselect-update-quantity-text-field",["click","touchend"],x);a.declarative("itemselect-update-pantry-quantity-text-field",
["click","touchend"],x);a.declarative("itemselect-show-update-button",["change","keyup"],p);a.declarative("itemselect-show-update-pantry-button",["change","keyup"],p);a.on("checkout:reload:itemselect",c);a.on("checkout:reload:spp-itemselect",c)});"use strict";r.when("A","page-transition-controller","page-conductor","checkout-general-utils","client-side-metrics").register("itemselect-ship-to-multiple-controller",function(a,m,k,e,f){var g=a.$;a.declarative("itemselect-ship-to-multiple",["click","touchend"],
function(a){a.$event.preventDefault();f.resetMetrics();if(!e.protectAgainstDoubleAction("itemselect-ship-to-multiple",200)){m.show();var b=null,d=null,c=null;a.$currentTarget.closest(".item-row").find(".lineitem").each(function(a,e){a=g(e);e=a.find('select[name^\x3d"quantity."]');var h=a.find('input[type\x3d"number"]');if(a.find(".quantity-dropdown").is(":visible")&&1<e.val())return b=a.find('input[name^\x3d"lineItemEntityID."]').val(),d=e.val(),c=a.find(".js-address-dropdown").val(),!1;if(a.find(".quantity-text-field").is(":visible")&&
1<h.val())return b=a.find('input[name^\x3d"lineItemEntityID."]').val(),d=h.val(),c=a.find(".js-address-dropdown").val(),!1});if(null!==b){a=(new Date).getTime();var h=k.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});g.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dship-to-multiple\x26cachebuster\x3d"+a,data:{lineitem:b,quantity:d,address:c},headers:h,dataType:"text",error:k.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-fatal-error");
null!==d&&d!==G?q.location=d:(k.ajaxUpdatePage(a,b,c),e.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}})}}})});"use strict";r.when("A").register("safe-apx-helper",function(a){var m={},k=a.$;return{get:function(a){return m[a]},set:function(){1===arguments.length?m=k.extend(m,arguments[0]):2===arguments.length?m[arguments[0]]=arguments[1]:q.console&&q.console.error&&q.console.error("Unexpected number of arguments: %d. Expected 1 or 2.",arguments.length)}}});"use strict";r.when("A",
"weblab-helper").register("mobile-carrier-billing-util",function(a,m){var k=!1;return{determineIsMCBEnabled:function(a){k=0<a.paymentRows.find('input[type\x3d"radio"][name\x3dpaymentMethod]').filter("[value^\x3dMCB]").size()},toggleGCForMCB:function(a,f){if(!m.isMCBMultiTenderWeblabEnabled()&&k&&(a=a.find('input[type\x3d"radio"][name\x3dpaymentMethod]'),a.length)){var e=f.paymentRows.find('input[type\x3d"checkbox"][name\x3duseAvailableBalance]');e=f.existingBalance||e;var l=0<f.paymentRows.find('input[type\x3d"hidden"][name\x3d"gcBalance"]').length,
b="paymentsForm"in f&&0<f.paymentsForm.find('input[type\x3d"hidden"][name\x3d"gcBalance"]').length;l=l||b;0<a.filter("[value^\x3dMCB]").size()&&l?(e.length&&(e.prop("checked",!1),e.prop("disabled",!0)),f.mcbBalanceWarning&&f.mcbBalanceWarning.show()):(e.length&&e.prop("disabled",!1),f.mcbBalanceWarning&&f.mcbBalanceWarning.hide())}},showMCBWarningMessageForPoints:function(a){k&&a.mcbPointsWarning&&a.mcbPointsWarning.show()},hideMCBWarningMessageForPoints:function(a){k&&a.mcbPointsWarning&&a.mcbPointsWarning.hide()}}});
"use strict";r.when("A").register("emi-utils",function(a){return{}});"use strict";r.when("A").register("emi-helper",function(a){return{}});"use strict";r.when().register("instant-bank-discount-helper",function(){return{showInstantBankDiscountAmazonPayDeselected:function(){},showInstantBankDiscountAmazonPaySelected:function(){}}});"use strict";r.when("A","page-detector","checkout-general-utils").register("pay-common-lib",function(a,m,k){function e(a,b){b.attr("name")&&(a[b.attr("name")]=b.val());b.attr("id")&&
(a[b.attr("id")]=b.val())}function f(a,b){if(!b)return a;for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function g(a,b,d){l.each(b,function(b,c){a[b]=d?d.find(c):l(c)})}var l=a.$,b="checkbox hidden password radio text number tel month".split(" "),d={};a.declarative("move-to-next-field",["keypress"],function(a){13===a.$event.charCode&&(k.moveToNextInput(a.$declarativeParent),a.$event.preventDefault())});a.declarative("scroll-to-input",["keypress"],function(a){13===a.$event.charCode&&(l(q).scrollTop(a.$declarativeParent.offset().top),
a.$event.preventDefault())});return{getAttributeData:function(a,b){if(a)return a.attr(b)||a.attr("data-"+b)||a.data(b)},getElements:function(a,b){var c={};g(c,a,b);return c},getInputValues:function(a){var c=a.find(".data-row").data()||{};a.find("input").each(function(){var a=l(this),d=a.attr("type");("radio"!==d&&"checkbox"!==d||a.is(":checked"))&&-1<l.inArray(d,b)&&e(c,a)});a.find("select").each(function(){e(c,l(this))});return c},isDesktopCX:m.isDesktopPayment,isMobileCX:m.isMobilePayment,isPayPage:m.isPayment,
isTouchCX:m.isTabletPayment,mergeFrom:function(a,b){b=f({},b);return f(b,a)},prop:function(a,b,e){if(a){if(1<arguments.length)return b===G?delete d[a]:d[a]={isOneTime:e?1:0,value:b},b;var c=d[a];if(c)return c.isOneTime&&delete d[a],c.value}},refreshElements:g,scrollTopTo:function(a){a&&a.length&&l("html,body").animate({scrollTop:a.offset().top-20},"fast")},selectDefaultPaymentMethodIfNotSelected:function(){var a=l("#existing-payment-methods .payment-row").find('input[type\x3d"radio"][name\x3d"paymentMethod"]'),
b=a.closest("div.payment-selected");b&&0<b.length||(a=a.closest("div.default-payment-marker"))&&a.length&&(a.addClass("payment-selected"),a.find("[name\x3dpaymentMethod]").attr("checked",!0))},processSubmissionParameters:function(a){for(var b={},c=0;c<a.length;c++)b[a[c].name]=a[c].value;return b}}});"use strict";r.when("A","pay-common-lib","a-popover-base","ajax-utility","loading-spinner-controller","page-conductor","page-transition-controller").register("pay-desktop-util",function(a,m,k,e,f,g,l){function b(a){a.$event.preventDefault();
a.$target.closest(".a-popover").hide();a.$target.siblings("span.error-message").hide()}function d(a){a.preventDefault();var b=B(a.currentTarget),c=b.closest("div.expando-section");a=c.find("div.expando-content");c=c.find("div.expando-reverse-content");var d=a.is(":visible"),e=function(){var a=b.find("i");a.hasClass("a-icon-collapse")||a.hasClass("a-icon-expand")?d?(a.removeClass("a-icon-collapse").addClass("a-icon-expand"),b.find("div.expando-toggle-text-show").show(),b.find("div.expando-toggle-text-hide").hide()):
(a.removeClass("a-icon-expand").addClass("a-icon-collapse"),b.find("div.expando-toggle-text-show").hide(),b.find("div.expando-toggle-text-hide").show()):d?(a.removeClass("a-icon-section-collapse").addClass("a-icon-section-expand"),b.find("div.expando-toggle-text-show").show(),b.find("div.expando-toggle-text-hide").hide()):(a.removeClass("a-icon-section-expand").addClass("a-icon-section-collapse"),b.find("div.expando-toggle-text-show").hide(),b.find("div.expando-toggle-text-hide").show())};d?(c.slideDown("fast"),
a.slideUp("fast",e)):(c.slideUp("fast"),a.slideDown("fast",e))}function c(a){var b=a.$target.closest("a");a=b.closest("div.extender-section");b=b.find("i");b.hasClass("a-icon-extender-expand")?(a.find(".collapsed").hide(),a.find(".expanded").slideDown("fast"),b.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse")):(a.find(".collapsed").show(),a.find(".expanded").slideUp("fast"),b.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"))}function h(a){P.msgPopovers.filter(":visible").hide();
a.$event.preventDefault();a.$event.stopPropagation();a=a.$target.parent().find(".a-popover");a.is(":visible")||a.show()}function p(a,b,c){var d=a||{},e="string"===typeof a;c=c&&c.useSif?B('input[type\x3d"hidden"][name\x3d"isAmazonApp"]').val():0;e?(d+="\x26ajaxResponse\x3d1\x26returnjson\x3d1",c&&(d+="\x26isAmazonApp\x3d1")):(d.ajaxResponse=1,d.returnjson=1,c&&(d.isAmazonApp=1));for(c=0;c<K.length;c++){var h=K[c],f=B("input[name\x3d"+h+"]").val();e?-1===b.search(h)&&-1===a.search(h)&&(d=d+"\x26"+
h+"\x3d"+f):d[h]=f}return d}function x(a,b){if(0>a)return 0;isNaN(b)||(a=Number(a).toFixed(b));a=a.toString();b=0<=a.lastIndexOf(".")?a.lastIndexOf("."):a.length;return 3>=b?a:x(a.substring(0,b-3),0)+","+a.substring(b-3)}function v(a,b,c,d){a="timeout"===b?"pay-ajax-timeout":"abort"===b?"pay-ajax-abort":"abort-for-cleanup"===b?"pay-ajax-abort-for-cleanup":"parsererror"===b?"pay-ajax-parsererror":500===a.status?"pay-ajax-500":"pay-ajax-error";if(c){a=c=-1===c.lastIndexOf(".html?")?c+("?ref\x3d"+a):
c+("\x26ref\x3d"+a);P.pageContainer.find("#tempForm").remove();c=B('\x3cform id\x3d"#tempForm" method\x3d"post"\x3e\x3c/form\x3e');c.attr("action",a);if("string"===typeof d){a={};b=d.split("\x26");for(var e=0;e<b.length;e++){var h=b[e].split("\x3d");2===h.length&&(a[h[0]]=h[1])}}else a=d;for(var f in a)"ajaxResponse"!==f&&"returnjson"!==f&&(a=B('\x3cinput type\x3d"hidden"/\x3e').attr("name",f).val(d[f]),c.append(a));P.pageContainer.append(c);c.submit()}}function y(a,b,c,d){var h=g.setAjaxTransitionHeader({"x-amz-checkout-page":"payselect"});
h={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:p(b,a,d),dataType:"text",headers:h,timeout:t,type:"POST",url:a,beforeSend:function(a,b){c&&c.beforeHandler&&c.beforeHandler(a,b)},complete:function(a,b){c&&c.completeHandler&&c.completeHandler(a,b)},error:function(d,e){c&&c.errorHandler?c.errorHandler(d,e):v(d,e,a,b)},success:function(a,b,d){var h=d.getResponseHeader("x-amz-checkout-page");if("payselect"!==h&&"spp-payment"!==h)return a=e.jsonify(a),g.redirect(a);c&&c.successHandler?
c.successHandler(a,b,d):g.ajaxUpdatePage(a,b,d)}};B.extend(h,d);q.push(B.ajax(h))}function w(a,b,c,d){var e=g.setAjaxTransitionHeader({"x-amz-checkout-page":"payselect"});e={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:p(b,a,d),dataType:"text",headers:e,timeout:t,type:"POST",url:a,error:function(d,e){c&&c.errorHandler?c.errorHandler(d,e):v(d,e,a,b)},success:function(a,b,d){var e=d.getResponseHeader("x-amz-checkout-page");"payselect"!==e&&"spp-payment"!==e&&c&&c.pageUpdater?
c.pageUpdater(a):g.ajaxUpdatePage(a,b,d)}};B.extend(e,d);q.push(B.ajax(e))}function n(){t=parseInt(B("input[type\x3d'hidden'][name\x3d'paypageTimeoutValue']").val(),10);t=isNaN(t)?1E4:t;m.isMobileCX()?A&&(A=!1):(P=m.getElements(r),A&&(a.declarative("close-popover",["click"],b),a.declarative("toggle-msg-popover",["click"],h),a.declarative("a-extender-toggle",["click"],c),A=!1),P.pageContainer.undelegate(".expando-link","click").delegate(".expando-link","click",d),P.pageContainer.find("form select.a-touch-select-input").unbind("change",
u).bind("change",u),B(".a-dropdown-container").each(function(){k.remove(B(this).find("select").attr("name"))}),B(document).bind("click",function(a){a.isPropagationStopped()||0===B(a.target).closest(".pay-popover-msg").length&&P.msgPopovers.filter(":visible").hide()}))}function u(a){var b=B(a.currentTarget);a=b.siblings("a.a-placeholder");b=b.find(":selected").text();a.html(b);return!1}var B=a.$,A=!0,t,q=[],K=["forceResponsive","fromAnywhere","hasWorkingJavascript"],P={},r={msgPopovers:"div.pay-popover-msg",
pageContainer:"div.a-container"};a.on("checkout:reload:payselect",n);a.on("checkout:reload:spp-payment",n);return m.mergeFrom({decodeJSONResponse:function(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))},elements:P,getNumberWithSeparators:x,handleForm:function(a,b,c){a.$event.preventDefault();
var d=a.$declarativeParent;d.is("span")&&(d=d.find("form"));d=d.serializeArray();d=m.processSubmissionParameters(d);y(a.data.action,d,b,c)},makeAjaxCall:y,handleAjaxError:v,handlePaymentsPortalForm:function(a,b,c,d){a=m.processSubmissionParameters(a.submissionParameters);y(b,a,c,d)},handlePaymentsPortalRedeemClaimCodeTransition:function(a,b,c,d){a=m.processSubmissionParameters(a.submissionParameters);a.embedOnlyData=1;w(b,a,c,d)}},m)});"use strict";r.when("A","pay-common-lib","page-transition-controller").register("pay-mobile-util",
function(a,m,k){function e(a,b,c){a=a||{};var d=y.fromAnywhereField.val(),e=c&&c.useSif?p('input[type\x3d"hidden"][name\x3d"isAmazonApp"]').val():0,h=l();"string"===typeof a?(a=a+"\x26ajaxResponse\x3d1\x26currentPage\x3d"+h,-1===b.search("fromAnywhere")&&-1===a.search("fromAnywhere")&&(a=a+"\x26fromAnywhere\x3d"+d),e&&(a+="\x26isAmazonApp\x3d1")):(a.ajaxResponse=1,a.currentPage=h,-1===b.search("fromAnywhere")&&(a.fromAnywhere=d),e&&(a.isAmazonApp=1),c&&c.isAddCardAndContinueEnabled&&(a.isHideSpinnerDisabled=
!0));return a}function f(){x&&x.abort("abort-for-cleanup");x=null}function g(a,b,d,e){a=a&&a.status;b="timeout"===b?"pay-ajax-timeout":"abort"===b?"pay-ajax-abort":"abort-for-cleanup"===b?"pay-ajax-abort-for-cleanup":"parsererror"===b?"pay-ajax-parsererror":500===a?"pay-ajax-500":"unknown"===a?"pay-unknown-page":"pay-ajax-error";d&&(d=-1===d.lastIndexOf(".html?")?d+("?ref\x3d"+b):d+("\x26ref\x3d"+b),c(d,e))}function l(){var a;p.each(v,function(b,c){if(c.pageId&&p(c.pageId).is(":visible"))return a=
b,!1});return a}function b(a){(a=v[a]&&v[a].componentId)&&r.when(a).execute(function(a){a.init&&a.init()})}function d(a,c,d,h,f){f&&f.suppressSpinner||k.show();f={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:e(c,a,h),dataType:"text",timeout:u,type:"POST",url:a,beforeSend:function(a,b){d&&d.beforeHandler&&d.beforeHandler(a,b)},complete:function(a,b){d&&d.completeHandler&&d.completeHandler(a,b);c&&c.isHideSpinnerDisabled||k.hide()},error:function(b,e){d&&d.errorHandler?d.errorHandler(b,
e):g(b,e,a,c)},success:function(e,h,f){var l=f.getResponseHeader("x-amz-checkout-pay-page-name");if(l){var n=f.getResponseHeader("x-amz-checkout-pay-page-title");n&&y.pageTitle.text(decodeURIComponent(n));d&&d.successHandler?d.successHandler(e,h,f):y.pageContainer.html(e);b(l)}else g(null,"unknown",a,c)}};p.extend(f,h);x=p.ajax(f)}function c(a,b,c){var d=p("#tempForm",y.pageContainer);0<d.length&&d.remove();d=p('\x3cform method\x3d"post"\x3e\x3c/form\x3e');d.attr("action",a);c&&c.target&&d.attr("target",
c.target);if("string"===typeof b)for(a=b.split("\x26"),b=0;b<a.length;b++)c=a[b].split("\x3d"),2===c.length&&"ajaxResponse"!==c[0]&&(c=p('\x3cinput type\x3d"hidden"/\x3e').attr("name",c[0]).val(c[1]),d.append(c));else for(var e in b)"ajaxResponse"!==e&&d.append(p('\x3cinput type\x3d"hidden"/\x3e').attr("name",e).val(b[e]));y.pageContainer.append(d);d.submit()}function h(a,c,d,h,f){f&&f.suppressSpinner||k.show();f={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:e(c,a,h),dataType:"text",
timeout:u,type:"POST",url:a,complete:function(a,b){d&&d.completeHandler&&d.completeHandler(a,b);k.hide()},error:function(b,e){d&&d.errorHandler?d.errorHandler(b,e):g(b,e,a,c)},success:function(a,c,e){var h=e.getResponseHeader("x-amz-checkout-pay-page-name");if(!h&&d&&d.pageUpdater)d.pageUpdater(a);else{var f=e.getResponseHeader("x-amz-checkout-pay-page-title");f&&y.pageTitle.text(decodeURIComponent(f));d&&d.successHandler?d.successHandler(a,c,e):y.pageContainer.html(a);b(h)}}};p.extend(f,h);x=p.ajax(f)}
var p=a.$,x=null,v={main:{componentId:"page-main",pageId:"#select-payments-view"},"credit-card-rewards":{componentId:"page-rewards",pageId:"#select-payment-rewards-view"},"financial-offer":{componentId:"page-financial-offer",pageId:"#select-payment-financial-offer-view"},"new-payment-methods":{pageId:"#new-payments-view"},"gil-estimates":{pageId:"#gil-estimates-subpage"}},y={},w={cvvHelper:"div#cvv-help-popover",fromAnywhereField:"input[name\x3dfromAnywhere]",jppoints:"div#jppoints",pageContainer:"div#page-container",
pageTitle:"head title"},n=!0,u;return m.mergeFrom({decodeJSonResponse:function(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))},elements:y,getCurrentPage:function(){return y.pageContainer.children("div.page").filter(":visible")},getCurrentPageName:l,getPageId:function(a){a=
a.getResponseHeader("x-amz-checkout-pay-page-name");return v[a]&&v[a].pageId},handleForm:function(a,b,c){a.$event.preventDefault();d(a.data.action,a.$target.serialize(),{successHandler:function(a,c,d){b(a,c,d)}},c)},submitFormRequest:c,init:function(){m.isMobileCX()&&(q.onbeforeunload=f,m.refreshElements(y,w),u=parseInt(p("input[type\x3d'hidden'][name\x3d'paypageTimeoutValue']").val(),10),u=isNaN(u)?1E4:u,n&&(n=!1,p("div.pay-mobile").bind("keypress",function(a){m.prop("activeGoElement",13===a.keyCode?
document.activeElement:null,!0)})))},makeAjaxCall:d,handleAjaxError:g,pages:v,handlePaymentsPortalForm:function(a,b,c,e){a=m.processSubmissionParameters(a.submissionParameters);d(b,a,c,e)},handlePaymentsPortalRedeemClaimCodeTransition:function(a,b,c,d){a=m.processSubmissionParameters(a.submissionParameters);a.embedOnlyData=1;h(b,a,c,d)}},m)});"use strict";r.when("page-detector","pay-desktop-util","pay-mobile-util").register("pay-common-util",function(a,m,k){return a.isMobile()?k:m});"use strict";
r.when("A","pay-common-util","pay-rewards-currency","checkout-federation-wrapper","safe-apx-helper","weblab-helper").register("pay-validator",function(a,m,k,e,f,g){function l(){function a(a,b,c,d){Y.push({identifier:a,priority:c||100,target:b,isPincodeError:d})}function l(a){if(!a)return null;var b=new RegExp(String.fromCharCode(32),"g"),c=new RegExp(String.fromCharCode(45),"g");return a.replace(b,"").replace(c,"")}function x(){return 0<Y.length}function v(a){if(!a||0===a.length)return!1;for(var b=
0,c=!1,d=a.length-1;0<=d;--d){var e=a.charAt(d);c&&(e*=2,9<e&&(e-=9));b+=parseInt(e,10);c=!c}return 0===b%10}function y(a,b){return a&&a.match(/^[0-9]+$/)&&a.length===b}function w(a,b,c){return a&&a.match(/^[0-9A-Za-z]+$/)&&a.length>=b&&a.length<=c}function n(a,b){if(!a||!b)return!1;a=parseInt(a,10);b=parseInt(b,10);return u(a,b)}function u(a,b){var c=new Date,d=c.getFullYear();return b>d||b===d&&a>=c.getMonth()+1}function B(a){a=a.val();return!a||0===a.length}function A(){var c=b("#pm_pay_by_check").is(":checked"),
d=b("#existing-balance [paymentmethodid\x3d'availablebalance'] input").is(":checked");c&&d&&a("continue_BadCombinationCheckExistingBalance")}function t(c){if(b("#jppoints").length){var d=!1;if(1===c.length&&"jppoints"===c.attr("id")){var e=c;d=!0}else e=c.filter("#jppoints");if(e&&e.find("#redeemPoints").is(":checked")){c=e.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val();c=parseInt(c,10);b('input[type\x3d"checkbox"][name\x3d"useAvailableBalance"]').is(":checked")&&(c-=parseInt(e.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]').val(),
10));var h=parseInt(e.find("#redeemableAmount").text(),10),f=e.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]');e.find("#jpPointsMax").is(":checked")?e=h:(e=parseInt(f.val(),10))||(e=0);e>h?a("continue_jpPointsExceedsRedeemableAmount",f):d&&e<c?a("continue_notEnoughJPPoints"):e>c&&a("continue_jpPointsExceedsTotalPurchase")}}}function q(b){b&&(b=b.find(".pci-blocking-cvv"),b.length&&b.is(":visible")&&a("PCI_Block_CVV"))}function K(b){var c=b.find(".currency-list");c.length&&c.is(":visible")&&
(b=c.find("[type\x3dradio]:checked").val(),c=c.find("#cardCurrencyDropDown option:selected").val(),b&&("Other"!==b||"-1"!==c&&"-2"!==c)||a("continue_SelectCardCurrency"))}function P(b){var c=b.find("#existingCvvNum");if(0!==c.length){var e=c.val();b=d?b.data("validcvvlength"):b.attr("validcvvlength");y(e,parseInt(b,10))||a("continue_BadSecurityCode",c)}}function O(b){var c=b.find('input[name\x3d"paymentMethod"]').val();/^creditCard/.test(c)&&b.find("#savedCardSuppressed").length&&a("continue_BankTemporarilyNotAvailable")}
function H(b){b=b.find("#existingPincodeNum");if(0!==b.length){var c=b.val();c?w(c,4,8)||a("existingCreditCard_PincodeInvalid",b,null,!m.isMobileCX()):a("continue_EmptyPincode",b)}}function N(c){if(c&&c.length)for(var d=0;d<c.length;d++){var e=b(c[d]);q(e.parent());P(e);H(e);"netBanking"===e.find('input[name\x3d"paymentMethod"]').val()&&(b("#netBanking_select").val(),b("#net-banking-list").find("option:selected").data("isdisabled")&&a("continue_BankTemporarilyNotAvailable"));O(e);var h=e;h.find('input[name\x3d"paymentMethod"]').val();
h.find("#vdcBanksSelect").val();b("#vdcBanksSelect").find("option:selected").data("isdisabled")&&a("continue_BankTemporarilyNotAvailable");U(e);e=e.siblings("#upi-acceptance-input").find("#vpaCollect");if(!e||e.length)(h=e.val())&&h.match(/.+@.+/)||a("continue_BadVpaForUpi",e)}}function Q(b){var c=b.find("#newMonth"),d=b.find("#newYear");b=b.find("#newExpDate");!(c=c.length&&!n(c.val(),d.val()))&&(c=b.length)&&((b=b.val())?(c=b.split("-"),b=parseInt(c[0],10),c=parseInt(c[1],10),b=u(c,b)):b=!1,c=!b);
c&&a("continue_BadExpiration")}function S(b){"domesticCards"===b.find('input[name\x3d"paymentMethod"]').val()&&((b=b.find("select").val())&&b.match(/^[0-9]*$/)||a("continue_BlankSlate"))}function R(c){var d=b("#existing-balance input[name\x3duseFlexiblePayments]").is(":checked");c=m.getAttributeData(c,"paymentmethodtype");d&&"creditCard"!==c&&a("continue_FlexiblePaymentsNeedsCreditCard")}function J(b){"thirdPartyAccounts"===b.find('input[name\x3d"paymentMethod"]').val()&&((b=b.find("select").val())&&
0!==b.length||a("continue_BlankSlate"))}function V(b){var c=b.find(".rewards-list");if(c.length&&c.find('input[type\x3d"radio"][value\x3d"rewardscustom"]').is(":checked")){b=c.find("input.custom-rewards-input");var d=b.val();if(c.hasClass("show-currency-input-widget-new")){c=b.data("country-code");var e=k.getCurrencyFormatByCountryCode(c);c=b.data("min");d=k.getAmount(d,e.decimalPlace);d<c&&a("continue_BadRewardsMin")}else/^\s*$/.test(d)||isNaN(d)?a("continue_BadRewardsValue"):(d=parseFloat(b.val()),
c=b.data("min"),0>=d||d<c?a("continue_BadRewardsMin"):d>b.data().max&&a("continue_BadRewardsMax"))}}function W(c){var d=c.find('input[name\x3d"paymentMethod"]').val();"verifiedCreditCard"===d?a("continue_BlankSlate"):"verifiedDebitCard"===d&&(d=c.find("#vdcBanksSelect").val(),(""===d||"OtherBanks"===d||"1"===b("#save_citi_card").val()&&"CIT"===d)&&a("continue_BlankSlate"),c.find("option:selected").prop("disabled")&&a("continue_BankTemporarilyNotAvailable"))}function X(b){"cashOnDeliveryCash"===b.find('input[name\x3d"paymentMethod"]').val()&&
b.find(".phonenumberNotVerified").length&&a("continue_OTPforCOD")}function ha(b){if("netBanking"===b.find('input[name\x3d"paymentMethod"]').val()){var c=b.find("#net-banking-select-list").val();b=b.find("option:selected").prop("disabled");""===c&&a("continue_BlankSlate");b&&a("continue_BankTemporarilyNotAvailable")}}function E(b){"morePaymentMethod"===b.find('input[name\x3d"paymentMethod"]').val()&&""===b.find("#more-payment-methods-select-list").val()&&a("continue_BlankSlate")}function U(c){var d=
c.find('input[name\x3d"paymentMethod"]').val();if("StandaloneInstallment"===d||"StandaloneCreditCardInstallment"===d||"StandaloneReusableCreditLineInstallment"===d)c.find('input[name\x3d"gilShowContinueBlocker"]').val()&&("StandaloneCreditCardInstallment"===d?a("continue_GilCCContinueError"):"StandaloneReusableCreditLineInstallment"===d?a("continue_GilRCLContinueError"):a("continue_GilContinueError")),c.find('input[name\x3d"showIneligibleItemSubpage"]').val()&&("StandaloneCreditCardInstallment"===
d?a("continue_GilCCContinueErrorIneligibleItems"):"StandaloneReusableCreditLineInstallment"===d?a("continue_GilRCLContinueErrorIneligibleItems"):a("continue_GilContinueErrorIneligibleItems")),c.find('input[name\x3d"gilShowContinueBlockerIfPromotions"]').val()&&0<b("#existing-balance input[name\x3duseAvailableBalance]:checked").length&&("StandaloneCreditCardInstallment"===d?a("continue_GilCCContinueErrorPromotions"):"StandaloneReusableCreditLineInstallment"===d?a("continue_GilRCLContinueErrorPromotions"):
a("continue_GilContinueErrorPromotions"))}var Y=[],Z=null,z=null,ca=function(a){c=a};c||(m.isMobileCX()?r.when("rewards-section-mobile").execute(ca):r.when("rewards-section-desktop").execute(ca));return{displayErrors:function(a,c){(Z=a)&&Z.hide().find(".error-message").hide().addClass("hidden");(z=c)&&z.find(".a-form-error").removeClass("a-form-error");if(x()){for(a=0;a<Y.length;a++){c=Y[a];if(c.target){var d=c.target.parent();d.hasClass("a-input-text-wrapper")&&!d.hasClass("a-form-error")?d.addClass("a-form-error"):
c.target.hasClass("a-form-error")||c.target.addClass("a-form-error")}c=c.identifier;(Z&&Z.length?Z.find("#"+c):b("#"+c)).show().removeClass("hidden")}Z&&Z.length&&Z.show()}},getHighestErrorId:function(){for(var a={priority:100},c=0;c<Y.length;c++){var d=Y[c],e;(e=d.identifier)?(e=Z&&Z.length?Z.find("#"+e):b("#"+e),e=parseInt(m.getAttributeData(e,"priority"),10),e=isNaN(e)?100:e):e=100;e<=a.priority&&(a={identifier:d.identifier,priority:e,isPincodeError:d.isPincodeError,target:d.target})}return a},
hasErrors:x,isValidCardCVV:y,isValidCardPincode:w,validateBankAccountNum:function(b,c){B(b)&&a("addBankAccount_NoAccountNumber",c)},validateBankAccountNumConfirm:function(b,c,d){b.val()!==c.val()&&a("addBankAccount_AccountNumberMismatch",d)},validateBankDriverLicense:function(b,c){B(b)&&a("addBankAccount_NoDLNumber",c)},validateBankDriverLicenseState:function(b,c){b.val()!==G&&""!==b.val()&&"0"!==b.val()||a("addBankAccount_NoDLState",c)},validateBankHolderName:function(b,c){B(b)&&a("addBankAccount_NoName",
c)},validateBankRoutingNum:function(b,c){9!==b.val().length&&a("addBankAccount_ShortRoutingNumber",c)},validateCreditCardCVV2:function(b,c,d){d="true"===b.attr("isaddresschallenge")?b.attr("issuer"):d&&d.charAt(0);"R"!==d&&(b=b.val(),y(b,"A"===d?4:3)||a("addCreditCard_BadSecurityCode",c))},validateCreditCardDate:function(b,c,d,e){n(b.val(),d.val())||(a("addCreditCard_BadExpiration",c),a("addCreditCard_BadExpiration",e))},validateCreditCardMobile:function(b,c){b=b.val();g.isUpdateMobileNumberEnabled()?
b&&b.replace(/[^0-9]/g,"").match(/^1[0-9]{10}$/)||a("addCreditCard_BadMobileNumber",c):b&&b.replace(/[^0-9]/g,"").match(/^1[34578]{1}[0-9]{9}$/)||a("addCreditCard_BadMobileNumber",c)},validateCreditCardPincode:function(b,c){(b=b.val())&&b.match(/^[a-zA-Z0-9]{4,8}$/)||a("addCreditCard_BadPincode",c)},validateCreditCardName:function(b,c){B(b)&&a("addCreditCard_NoName",c)},validateCreditCardNumber:function(c,d){var e=l(c.val());e&&10<e.length&&v(e)||a("addCreditCard_BadNumber",d);e=b("#creditCardIssuersBlocked").val();
c=c.data("issuer");e&&""!==e&&c&&""!==c&&-1<b.inArray(c,e.split(","))&&a("addCreditCard_IssuerUnsupported",d)},validateSBIMaestroCardNumberLength:function(b,c){19!==l(b.val()).length&&a("addCreditCard_SBIMaestro_BadNumberLength",c)},isAMEXCreditCard:function(a){a=l(a.val());return null!==a?0===a.indexOf("37")||0===a.indexOf("34"):!1},validateCreditCardTail:function(b,c){var e=l(b.val());e&&10<e.length&&v(e)?(b=(m.isMobileCX()&&d?b.parent().data():b.data()).tail+"",e.substr(e.length-b.length)!==b&&
a("addCreditCard_NotMatch",c)):a("addCreditCard_NotMatch",c)},validateCreditCardType:function(b,c){b.is(":visible")&&((b=b.val())&&b.match(/^[A-Z][0-9]*$/)||a("addCreditCard_NoType",c))},validateRegistrationResult:function(b){b.cardStatus?1===b.checkStatusCount&&a("addCreditCard_RegisterFailed"):0<b.errors.length&&a("addCreditCard_RegisterFailed")},validateDirectDebitAccountName:function(b,c){B(b)&&a("addDirectDebit_NoAccountOwnerName",c)},validateDirectDebitAccountNum:function(b,c){B(b)&&a("addDirectDebit_NoAccountNumber",
c)},validateDirectDebitRoutingNum:function(b,c){B(b)&&a("addDirectDebit_NoRoutingNumber",c)},validateInvoiceFirstName:function(b,c){B(b)&&a("addInvoiceAccount_NoFirstName",c)},validateInvoiceLastName:function(b,c){B(b)&&a("addInvoiceAccount_NoLastName",c)},validateLocName:function(b,c){B(b)&&a("addLoc_NoName",c)},validateLocNumber:function(b,c){B(b)&&a("addLoc_BadNumber",c)},validateNewGiftPromotion:function(b,c){B(b)&&a("addGiftCardOrPromo_NoCode",c)},validatePayment:function(d){if(m.isMobileCX())N(d),
c&&e.wrap(function(){c.validatePaymentRewardsInRewardsSection(a)},"shopwithpointsmobile");else if(A(),d&&d.length){for(var h=0;h<d.length;h++){var f=b(d[h]);"true"===m.getAttributeData(f,"isaddresschallenge")&&a("continue_AddressChallenge");"true"===m.getAttributeData(f,"isverifiedfail")&&a("continue_VerifiedFail");"true"===m.getAttributeData(f,"iscupcardexpired")&&a("continue_CUPExpired");q(f);K(f);P(f);H(f);Q(f);S(f);R(f);J(f);V(f);W(f);ha(f);E(f);U(f);X(f);O(f)}c&&e.wrap(function(){c.validatePaymentRewardsInRewardsSection(a)},
"shopwithpoints");t(d)}else a("continue_BlankSlate")},validateGetCreditCardTypeResult:function(b){if(b.errors&&0<b.errors.length)for(var c=0;c<b.errors.length;c++)a(b.errors[c])},validateEMIMenuForContinueButton:function(b){var c=b.find("#emiPaymentMethodsSelectList").find("option:selected").val();if("CreditCard"===c||"SelectOption"===c)a("continue_BlankSlate");else if(c=c.split("."),1<c.length){var d=c[0];if("emiCreditCard"===d||"netbankingEMI"===d)b=b.find("."+c[1]),b=b.find(".emiMenuTenuresDropDown"),
b.length&&!b.find("option:selected").val()&&a("continue_BlankSlate")}},apxValidatePayment:function(a,b){var c=f.get("payselect");c&&c.validatePayments(this,b,a)},addError:a,errors:Y,validatePCICVVBlock:q}}var b=a.$,d=q.P&&q.P.AUI_BUILD_DATE,c=G;return{create:function(){return new l}}});"use strict";r.when("A","ajax-utility","pay-common-util","pay-validator").register("pay-credit-card",function(a,m,k,e){function f(a,b,e,f){a&&a.length&&(b=e+"-"+b,(e=k.prop(b))&&(a=a.find(f).val(e))&&a.length&&(k.isMobileCX()?
a.closest(".card-cvv-field").hide().data("isHidden",1):a.closest(".a-column").hide(),k.prop(b,G)))}var g=a.$,l={cc:!1,vcc:!1,vdc:!1},b=q.P&&q.P.AUI_BUILD_DATE;return{confirmCreditCard:function(a,b,e){a.currentPaymentInstrumentID=a.paymentmethodid;a.recommendedPaymentMethodId=a.paymentmethodid;if(a.newMonth&&a.newYear)a.month=a.newMonth,a.year=a.newYear;else if(a.newExpDate){var c=a.newExpDate.split("-");a.year=parseInt(c[0],10);a.month=parseInt(c[1],10)}else a.expmonth&&a.expyear&&(a.month=a.expmonth,
a.year=a.expyear);(c="existingCvvNum"in a?a.addCreditCardVerificationNumber=a.existingCvvNum:a.addCreditCardVerificationNumber)&&k.prop("cvv-"+a.paymentmethodid,c);(c="existingPincodeNum"in a?a.addCreditCardPincode=a.existingPincodeNum:a.addCreditCardPincode)&&k.prop("pincode-"+a.paymentmethodid,c);k.makeAjaxCall(e,a,{successHandler:b,errorHandler:function(b,c){a.handler="confirm-credit-card";k.handleAjaxError(b,c,"/gp/buy/payselect/handlers/submit.html",a)}},{useSif:!0})},handleCreditCardType:function(a,
b){var c=a.$target,d=a.data.type,f=e.create();a.$currentTarget.data("issuer","");f.validateCreditCardNumber(c,c);f.hasErrors()||(l[d]=!0,k.makeAjaxCall(a.data.url,{addCreditCardNumber:c.val(),returnjson:1},{completeHandler:function(){l[d]=!1},successHandler:function(c){c=m.jsonify(c);b(c,d);a.$currentTarget.data("issuer",c.issuer)}},{useSif:!0},{suppressSpinner:!0}))},isWaitingForType:function(a){return l[a]},runConfirmCardValidator:function(a,b){var c=a.find("#existingCvvNum");c=c.length?c:a.find("#addCreditCardVerificationNumber");
var d=a.find("#addCreditCardNumber"),f=a.find("#newMonth"),g=a.find("#newYear"),l=e.create();l.validateCreditCardTail(d,d);f.length&&g.length&&l.validateCreditCardDate(f,f.closest(".card-date").find(".a-button"),g,g.closest(".card-date").find(".a-button"));c.length&&(d=(d=a.find("#issuer"))&&d.val(),l.validateCreditCardCVV2(c,c,d));l.displayErrors(b,a);return l.hasErrors()},setDateSelectorStatus:function(a,b){var c=b.find(".card-date").find("select");c&&c.length&&r.when("a-dropdown").execute(function(b){c.each(function(){var c=
g(this).attr("id");b.updateSelect(c,{status:"21"===a.brand&&"G"===a.issuer?"disabled":"enabled"})})})},setNewCardCVVInputStatus:function(a){(k.prop("cvv-newcard")||k.prop("pincode-newcard"))&&a.each(function(){var a=g(this);if("1"===(b?a.data("isnewcard")+"":a.attr("isnewcard")))return f(a,"newcard","cvv","#existingCvvNum"),f(a,"newcard","pincode","#existingPincodeNum"),!1})},setCardPasswordInputStatus:f}});"use strict";r.when("A","ajax-utility","pay-common-util","pay-validator","page-transition-controller",
"page-conductor","pay-credit-card").register("pay-credit-card-reregistration",function(a,m,k,e,f,g,l){function b(a,b){var d=e.create(),f=c("#cupMobileNumber-"+a),h=c("#cupSecurityCode-"+a),g=c("#reRegisterCCErrors-"+a);a=c("#reRegisterCCInputs-"+a);d.validateCreditCardCVV2(h,h,b);d.validateCreditCardMobile(f,f);d.displayErrors(g,a);return d.hasErrors()}function d(a,b,c){g.ajaxUpdatePage(a,b,c)}var c=a.$;return{actionReregisterCardInBox:function(a){a.$event.preventDefault();f.show();var e=a.data.type,
h=c("#cupMobileNumber-"+a.data.paymentMethodID).val(),g=c("#cupSecurityCode-"+a.data.paymentMethodID).val();b(a.data.paymentMethodID,e)?f.hide():(e={isReregistering:a.data.isReregistering,currentPaymentInstrumentID:a.data.paymentMethodID,name:a.data.holderName,year:a.data.expiredYear,month:a.data.expiredMonth,addCreditCardMobileNumber:h,addCreditCardVerificationNumber:g},h={useSif:k.isMobileCX()?!0:!1,success:function(a,b,e){a=m.jsonify(a);b=c("#reRegisterCCErrors-"+a.paymentInstrumentId);l.waitForCreditCardStatus(a,
d,b)}},a.$event.preventDefault(),k.makeAjaxCall(a.data.url,e,null,h))}}});"use strict";r.when("A","client-side-metrics","ajax-utility","pay-common-util","pay-validator","existing-payments","page-conductor","checkout-modal-popover","page-transition-controller","pay-credit-card","pay-gil","new-verified-debit-card","emi-helper").register("new-payments",function(a,m,k,e,f,g,l,b,d,c,h,p,x){function v(a){a.$event.preventDefault();var b=a.data.type;if(c.isWaitingForType(b))d.show(),setTimeout(function(){v(a)},
50);else{var f="vdc"===b?I.newVDC:"emi"===b?I.newEMI:I.newVCC;if(ia(f,b))d.hide();else{d.show();var h=e.getInputValues(f),g="vdc"===b?"_VDC":"_VCC";f=h["addCreditCardVerificationNumber"+g];var l=h["addCreditCardPincode"+g];b={addCreditCardNumber:h["addCreditCardNumber"+g],addCreditCardVerificationNumber:f,addCreditCardPincode:l,handler:h["handler"+g],month:h["month"+g],name:h["name"+g],newPaymentType:b,year:h["year"+g],cctype:h["cctype"+g],isSBIInternationalMaestroSelected:h["isSBIInternationalMaestroSelected"+
g],isCardSavedFromEMIMenu:h["isCardSavedFromEMIMenu"+g]};e.prop("cvv-newcard",f);l&&e.prop("pincode-newcard",l);e.makeAjaxCall(a.data.url,b,{successHandler:function(a,b,d){P(a,b,d);c.setNewCardCVVInputStatus(I.paymentRows)}},{useSif:!0})}}}function y(a){a.$event.preventDefault();var b=a.data.type;if(c.isWaitingForType(b))d.show(),setTimeout(function(){y(a)},50);else{var f=I.newCCFormContent;if(ia(f,b))d.hide();else{d.show();b=e.getInputValues(f);b.handler=b.handler_addCCInBox;f=a.data.url;var h={};
C("#cupSecurityCode").is(":visible")&&C("#cupMobileNumber").is(":visible")?(f="/gp/buy/payselect/handlers/add-credit-card.html",h={successHandler:function(a){a=k.jsonify(a);H(a)}}):h={successHandler:P};e.makeAjaxCall(f,b,h,{useSif:!0})}}}function w(a){a.$event.preventDefault();var b=C("#new-giftcard-promotion");b=e.getInputValues(b);C("input[name\x3disUnifiedActionsDesignEnabled]").length&&n(a)||(b.handler=b.handler_addGCInBox,a=a.data.url,d.show(),e.makeAjaxCall(a,b,{successHandler:function(a,b,
c){l.ajaxUpdatePage(a,b,c);ma||e.scrollTopTo(C("#existing-balance"))}},{useSif:!0}))}function n(a){a=a.$declarativeParent;var b=C("#gcpromoinput"),c=f.create();c.validateNewGiftPromotion(b,b);c.displayErrors(I.newGCErrors,a);return c.hasErrors()}function u(a){var b=C(a.currentTarget).parents("div.new-payment-line").find(".card-date select");if(b&&b.length){var c=C(a.currentTarget).val();r.when("a-dropdown").execute(function(a){b.each(function(){var b=C(this).attr("id");a.updateSelect(b,{status:"G21"===
c?"disabled":"enabled"})})})}}function B(a){var b=I.newVDC.find(".vdc-form-fields"),c=I.newVDC.find("#vdc-logo-prompt"),d=I.newVDC.find(".top-cell");a?b.show():b.hide();a?c.show():c.hide();a?d.addClass():d.removeClass()}function A(a){var b=C(a.currentTarget).val(),c=I.newVDC.find("#suppressedVerifiedDebitCard").hide(),d=I.newVDC.find(".vdc-selected-bank-prompt").hide();B(!1);var e="1"===I.newVDC.find("#isRupayAsSavedCardEnabled").val()&&"URP"===b;"OtherBanks"===b||"1"===C("#save_citi_card").val()&&
"CIT"===b||e?(B(!0),C.isEmptyObject(p)||p.showExpiryDateAndCvv()):"SMP"!==b||C.isEmptyObject(p)?""!==b&&(b=C(a.currentTarget).find("option:selected").prop("disabled"),a=C(a.currentTarget).find("option:selected").text(),b?c.show().find(".suppressed-card-text").html(a):d.show().find(".bank-name-text").html(a)):(B(!0),p.hideExpiryDateAndCvv())}function t(a,b){if(!C.isEmptyObject(x)&&a)return a(b)}function q(a){t(x.removeEMIMenuSelectionAttributes);I.newEMI.find(".emi-group").hide();a=C(a.currentTarget).find("option:selected").val();
I.newEMI.find("#emiMenuErrors_VCC").length&&I.newEMI.find("#emiMenuErrors_VCC").hide();if(a=t(x.showPaymentOptionBlock,a))t(x.addEMIMenuSelectionAttributes),a.show()}function K(a){c.handleCreditCardType(a,aa)}function P(a,b,c){l.ajaxUpdatePage(a,b,c);ma||e.scrollTopTo(g.getSelectedPayment())}function O(a){a.$event.preventDefault();var b=a.data.type;c.isWaitingForType(b)?(d.show(),setTimeout(function(){O(a)},50)):ia(a.$declarativeParent,b)?d.hide():(ka&&ka.hide(),sa&&sa.hide(),d.show(),C("#cupSecurityCode").is(":visible")&&
C("#cupMobileNumber").is(":visible")?(b=a.$declarativeParent.serializeArray(),b=e.processSubmissionParameters(b),e.makeAjaxCall("/gp/buy/payselect/handlers/add-credit-card.html",b,{successHandler:function(a){a=k.jsonify(a);H(a)}},{useSif:!0})):e.handleForm(a,{successHandler:P},{useSif:!0}))}function H(a){var b={};b.paymentInstrumentId=a.paymentInstrumentId;a.checkStatusCount&&(b.checkStatusCount=a.checkStatusCount);var c={successHandler:function(a){a=k.jsonify(a);var b=f.create();"VERIFIED"===a.cardStatus?
e.makeAjaxCall("/gp/buy/payselect/handlers/submit.html",{newPaymentMethodId:a.paymentInstrumentId},{successHandler:P}):"PENDING"===a.cardStatus?(a.checkStatusCount?(a.checkStatusCount=parseInt(a.checkStatusCount,10),isNaN(a.checkStatusCount)&&(a.checkStatusCount=1)):a.checkStatusCount=3,b.validateRegistrationResult(a),1===a.checkStatusCount?(d.hide(),b.displayErrors(I.newCCErrors)):(--a.checkStatusCount,H(a))):(b.validateRegistrationResult(a),d.hide(),b.displayErrors(I.newCCErrors))}};setTimeout(function(){e.makeAjaxCall("/gp/buy/payselect/handlers/check-credit-card-status.html",
b,c)},2500)}function N(a){a.$event.preventDefault();var b=a.$declarativeParent,c=b.find("#loc-name"),h=b.find("#loc-number"),g=f.create();g.validateLocName(c,c);g.validateLocNumber(h,h);g.displayErrors(b.find("#error-box-new-loc"),b);g.hasErrors()||(na&&na.hide(),d.show(),e.handleForm(a,{successHandler:P}))}function G(a){a.$event.preventDefault();var b=a.$declarativeParent,c=b.find("#gcpromoinput");b.find("#gcpromosuccessblock").hide();var h=f.create();h.validateNewGiftPromotion(c,c);h.displayErrors(I.newGCErrors,
b);h.hasErrors()||(d.show(),e.handleForm(a,{successHandler:function(a,b,c){l.ajaxUpdatePage(a,b,c);ma?I.newGCErrors.is(":visible")&&C("#gc-link-expander").trigger("click"):e.scrollTopTo(C("#existing-balance"))}}))}function S(a){a.$event.preventDefault();C("#ccAddCard").trigger("submit")}function R(a){a.$event.preventDefault();C("#bank-address-popover-submit").trigger("submit")}function J(a){a.$event.preventDefault();C("#direct-debit-popover-submit").trigger("submit")}function V(a){a.$event.preventDefault();
C("#new-loc-popover-submit").trigger("submit")}function W(a){a.$event.preventDefault();C("#new-invoice-popover-submit").trigger("submit")}function X(a){a.$event.preventDefault();C("#brdcAddCard").trigger("submit")}function ha(a){a.$event.preventDefault();var b=a.$declarativeParent,c=f.create(),h=b.find("#bank-name"),g=b.find("#bank-routing-number"),l=b.find("#bank-account-number"),n=b.find("#bank-account-number-confirm"),k=b.find("#bank-dl"),m=b.find("#bank-dl-state");c.validateBankHolderName(h,h);
c.validateBankRoutingNum(g,g);c.validateBankAccountNum(l,l);c.validateBankAccountNumConfirm(l,n,n);c.validateBankDriverLicense(k,k);c.validateBankDriverLicenseState(m,m.parents("div.a-button-dropdown"));c.displayErrors(b.find("#new-bank-error-box"),b);c.hasErrors()||(la&&la.hide(),d.show(),e.handleForm(a,{successHandler:P}))}function E(a){a.$event.preventDefault();var b=a.$declarativeParent,c=f.create(),h=b.find("#debit-bank-routing-number"),g=b.find("#debit-account-number"),l=b.find("#debit-account-name");
c.validateDirectDebitRoutingNum(h,h);c.validateDirectDebitAccountNum(g,g);c.validateDirectDebitAccountName(l,l);c.displayErrors(b.find("#new-direct-debit-error"),b);c.hasErrors()||(da&&da.hide(),d.show(),e.handleForm(a,{successHandler:P}))}function U(a){a.$event.preventDefault();var b=a.$declarativeParent,c=f.create(),h=b.find("#invoice-first-name"),g=b.find("#invoice-last-name");c.validateInvoiceFirstName(h,h);c.validateInvoiceLastName(g,g);c.displayErrors(b.find("#new-invoice-error-box"),b);c.hasErrors()||
(fa&&fa.hide(),d.show(),e.handleForm(a,{successHandler:P}))}function Y(a){a=C("#order-summary-total");var b=C("#order-summary-container");a.prev().addClass("a-first");b.addClass("a-box-group");a.show();e.isTouchCX()&&b.parent().find(".bottom-order-summary").show();I.newCCFormContent.is(":visible")||C("#wrapper-new-cc").find("a.a-link-expander").trigger("click");C("#ecard-help-link").show()}function Z(a){var b="Unknown";e.isDesktopCX()?b="Desktop":e.isMobileCX()?b="Mobile":e.isTouchCX()&&(b="Tablet");
m.increaseCount("PayPage-ClientSide-AddCupClick-"+b,1);b=C("#cupForm");if(0<b.length)b.submit();else{var c=C("\x3cform\x3e\x3c/form\x3e");c.attr({target:"_blank",method:"POST",action:a.data.url});C("#cup-dc").find("input").each(function(){var a=C(this);"hidden"===a.attr("type")&&a.clone().appendTo(c)});C("body").append(c);c.submit();c.remove()}}function z(c){var f=c.$target.closest(".a-popover"),h=f.data("a-popover-id");b.hideById(h);f.hide();C("#a-popover-modal").hide();d.show();e.makeAjaxCall(c.data.url,
void 0,{successHandler:function(b){C("#existing-payment-methods").replaceWith(C(b).find("#existing-payment-methods"));a.trigger("checkout:reload:payselect");d.hide()}})}function ca(a){a.$event.preventDefault();a=a.data;d.show();h.submitNewGilPayment(a.subtype)}function ba(){if(!e.isMobileCX()){0===C("#form-add-credit-card").length&&(C("#ccAddCard").parents("div.cc-submit").hide(),C("#ccAddCardWithButton").parents("div.cc-submit").show());C("html").hasClass("a-ie6")&&(C("#cup-mbdc").show(),C(".mbdc-link").attr("data-action",
"redirect-cup"));I=e.getElements(ra);I.bankNumberConfirm.show();I.newVDC.find(".payment-row").data("hasstatus")||I.newVDC.find(".vdc-form-fields").hide();I.newVDC.find("#suppressedVerifiedDebitCard").hide();I.newCCFormContent.find(".cup-card-field").hide();I.newPayments.find("#cupInfoMessage").hide();I.newPayments.find("#use-ecard-link").show();I.newPayments.find(".mbdc-link").show();I.newPayments.find(".mbdc-button").hide();ma=!1;I.newPayments.each(function(){var a=C(this),b=a.data();b&&0===b.hasstatus?
(a.find("a.a-link-expander i.js-hide").remove(),a.find("a.a-link-section-expander i.js-hide").remove()):b&&1===b.hasstatus&&!ma&&(e.scrollTopTo(a),ma=!0)});var b=I.newVCC.find("#requireCVVOrPincode");b&&b.length&&b.val("1");qa&&(a.declarative("new-cc",["submit"],O),a.declarative("new-brdc",["submit"],O),a.declarative("new-loc",["submit"],N),a.declarative("show-card-image",["change"],K),a.declarative("new-giftcard-promotion",["submit"],G),a.declarative("new-verified-card",["click"],v),a.declarative("new-cc-in-dashboard",
["click"],y),a.declarative("new-gc-in-dashboard",["click"],w),a.declarative("add-bank-account",["submit"],ha),a.declarative("add-direct-debit",["submit"],E),a.declarative("add-invoice",["submit"],U),a.declarative("show-order-summary",["click"],Y),a.declarative("redirect-cup",["click"],Z),a.declarative("cup-popover-close",["click"],z),a.declarative("add-new-debit-and-cc-popover-submit",["click"],S),a.declarative("add-bank-account-popover-submit",["click"],R),a.declarative("add-loc-account-popover-submit",
["click"],V),a.declarative("new-gil-payment",["click"],ca),a.declarative("add-direct-debit-popover-submit",["click"],J),a.declarative("add-invoice-account-popover-submit",["click"],W),a.declarative("add-new-br-debit-card-popover-submit",["click"],X),qa=!1);I.cardTypeDropdown.unbind("change",u).bind("change",u);I.vdcBankDropdown.unbind("change",A).bind("change",A);I.emiCardsDropdown.unbind("change",q).bind("change",q);C("div.pay-desktop a.a-link-expander").unbind("keypress");C("div.pay-desktop .a-declarative, div.pay-desktop .a-button").filter("[data-action\x3da-checkout-modal-popover]").unbind("keypress");
a.on("a:popover:show:add-new-debit-cc-modal",function(a){sa=a.popover});a.on("a:popover:show:add-new-bank-account-modal",function(a){la=a.popover});a.on("a:popover:show:add-new-direct-debit-modal",function(a){da=a.popover});a.on("a:popover:show:add-new-loc-account-modal",function(a){na=a.popover});a.on("a:popover:show:add-invoice-account-modal",function(a){fa=a.popover});a.on("a:popover:show:add-br-debit-card-modal",function(a){ka=a.popover})}}function ia(a,b){var c,d,e,h,g,l,n,k,m,p,u,t;"vcc"===
b?(c="#vccCVVNum",d="#newVCCErrors",e="#vccMonth",h="#vccName",g="#newVerifiedCreditCardNumber",l="#vccType",n="#vccYear",k="#vccPincode",m=void 0,p=void 0,u=void 0,t=void 0):"vdc"===b?(c="#vdcCVVNum",d="#newVDCErrors",e="#vdcMonth",h="#vdcName",g="#newVerifiedDebitCardNumber",l="#vdcType",n="#vdcYear",m="#isSBIMaestroAsSavedCardEnabled",p="#isSBIInternationalMaestroSelected",k=void 0,u=void 0,t=void 0):"emi"===b?(c="#vccCVVNum",d="#newEMIErrors",e="#vccMonth",h="#vccName",g="#newVerifiedCreditCardNumber",
l="#vccType",n="#vccYear",k="#vccPincode",m=void 0,p=void 0,u=void 0,t=void 0):"brdc"===b?(d="#newBRDCErrors",e="#brdcMonth",h="#brdcName",g="#addCreditCardNumber_BRDC",n="#brdcYear",c=void 0,l=void 0,k=void 0,m=void 0,p=void 0,u=void 0,t=void 0):(u="#cupSecurityCode",t="#cupMobileNumber",c="#ccCVVNum",d="#newCCErrors",e="#ccMonth",h="#ccName",g="#addCreditCardNumber",l="#ccType",n="#ccYear",k=void 0,m=void 0,p=void 0);b=a.find(c);u&&0===b.length&&a.find(u).is(":visible")&&(b=a.find(u));m="1"===a.find(m).val()&&
"1"===a.find(p).val();h=a.find(h);g=a.find(g);t=t?a.find(t):null;e=a.find(e);l=a.find(l);n=a.find(n);var y;k&&a.find(k).is(":visible")&&(y=a.find(k));k=l.val();p=f.create();p.validateCreditCardName(h,h);p.validateCreditCardNumber(g,g);m&&p.validateSBIMaestroCardNumberLength(g,g);m=e.parent();m=m.hasClass("a-button")?m:m.find(".a-button");h=n.parent();h=h.hasClass("a-button")?h:h.find(".a-button");"G21"!==k&&p.validateCreditCardDate(e,m,n,h);p.validateCreditCardType(l,l.closest(".card-type-field").find(".a-button"));
n=k?k.substr(0,1):"";b.length&&"R"!==n&&b.is(":visible")&&p.validateCreditCardCVV2(b,b,k);t&&t.length&&t.is(":visible")&&p.validateCreditCardMobile(t,t);y&&y.length&&p.validateCreditCardPincode(y,y);p.displayErrors(C(d),a);return p.hasErrors()}function aa(a,b){if(a){"1"===a.isDebitCard?I.newCCWarnings.show().removeClass("hidden"):I.newCCWarnings.hide().addClass("hidden");if("1"===a.hasErrors){var d=f.create();d.validateGetCreditCardTypeResult(a);if(d.hasErrors()){d.displayErrors(I.newCCErrors);return}}b=
"vcc"===b?I.newVCC:"vdc"===b?I.newVDC:"emi"===b?I.newEMI:"brdc"===b?I.newBRDCFormContent:I.newCCFormContent;d=a.specificFields;var h=b.find(".cup-card-field");0!==h.length&&(d&&1===d.securityCode&&1===d.mobileNumber?(e.isTouchCX()&&b.find("#addCreditCardNumber").closest(".a-input-text-wrapper").removeClass("last-child"),h.show()):h.hide());d=a.specificFields;h=b.find(".amex-field");if(0!==h.length){var g=b.find(".cvv-field");0!==g.length&&(d&&1===d.pincode?(g.hide(),h.show()):d&&0===d.pincode&&0===
d.securityCode?(h.hide(),g.hide()):(h.hide(),g.show()))}d=b.find(".card-images");d.find("img").hide();g=a.installmentProgram;h=!1;g&&(g=d.find('img[data-installmentprogram\x3d"'+g+'"]'),0!==g.length&&(g.show(),h=!0));h||(a.issuerdisplayimage?d.find("img[data-issuer\x3dATM]").attr("src",a.issuerdisplayimage).show():(h=a.issuer+a.brand,d.find("img[data-issuer\x3d"+h+"]").show(),b.find(ra.cardTypeDropdown).val(h).trigger("change")));c.setDateSelectorStatus(a,b)}}var C=a.$,qa=!0,ma=!1,I={},ra={bankNumberConfirm:"#wrapper-bank-account-number-confirm",
btnAddCard:"#ccAddCard",btnAddLoc:"#button-new-loc",btnAddGC:"#button-add-gcpromo",btnAddBank:"#button-add-bank-account",btnAddDirectDebit:"#button-add-direct-debit",btnAddInvoice:"#button-add-invoice",cardImages:"#newCreditCardImages",cardTypeDropdown:".card-type-dropdown select",newCCFormContent:"#new-cc",newBRDCFormContent:"#new-brdc",newGCErrors:"#gcpromoerrorblock",newGCFormContent:"#gc_entry",newPayments:"div.new-payment-line",newVCC:"#new-verified-credit-cards-table",newVDC:"#new-verified-debit-cards-table",
newEMI:"#newEmiCard",paymentRows:"#existing-payment-methods .payment-row",vdcBankDropdown:"#vdcBanksSelect",emiCardsDropdown:"#emiPaymentMethodsSelectList",cardList:"#existing-credit-cards-box",newCCErrors:"#newCCErrors",newCCWarnings:"#newCCWarnings"},sa,la,na,da,fa,ka;a.on("checkout:reload:payselect",ba);a.on("checkout:reload:spp-payment",ba);return{actionShowOrderSummary:Y,handleFormHandlerScrollToSelected:P}});r.when("A","page-detector","client-side-metrics","ready").execute(function(a,m,k){function e(a,
e,b,d){a=f(e).is(":checked");q.P&&q.P.AUI_BUILD_DATE?a?f(b).val(f(b).parent().data("account-name")):f(b).val(""):(k.increaseCount("removeauijs8"),a?(f(d).removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active"),f(b).val(f(b).data("account-name"))):(f(d).removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive"),f(b).val("")));b="undefined"!==typeof q.ue&&"undefined"!==typeof q.ue.count;d=m.isMobilePayment()?"mobile":"tablet";a=f("#showNameOnCardCheckbox").is(":checked");
b&&q.ue.count(d+"NameOnCardCheckBox"+(a?"Checked":"Unchecked"),1)}var f=a.$;a.declarative("show-card-name",["click"],function(a){e(a,"#showNameOnCardCheckbox","#ccName","#showNameOnCardIcon")});a.declarative("show-br-debit-card-name",["click"],function(a){e(a,"#showNameOnCardCheckbox_BRDC","#brdcName","#showNameOnCardIcon_BRDC")})});"use strict";r.when("A").register("pay-rewards-currency",function(a){var m=function(a,e){e=Math.pow(10,e);a=a.replace(/[^0-9]/g,"");return parseFloat(a)/e},k={CA:{groupingSeparator:",",
decimalSeparator:".",decimalPlace:2},DE:{groupingSeparator:".",decimalSeparator:",",decimalPlace:2},GB:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2},JP:{groupingSeparator:",",decimalSeparator:".",decimalPlace:0},US:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2}},e=function(a,e,b,d,c){this.groupingSeparator=a;this.decimalSeparator=e;this.currencyDecimalPlace=b;this.pointsDecimalPlace=d;this.ratio=c;this.getCurrencyAmount=function(a){return m(a,this.currencyDecimalPlace)};
this.getPointsAmount=function(a){return this.getCurrencyAmount(a)/this.ratio};this.format=function(a,b){var c=parseInt(a,10);a=parseFloat(a-c).toFixed(b);a=this.decimalSeparator+a.slice(2);c=c.toString();b=3<c.length?c.length%3:0;c=(0<b?c.substr(0,b)+this.groupingSeparator:"")+c.substr(b).replace(/(\d{3})(?=\d)/g,"$1"+this.groupingSeparator);return a===G||a===this.decimalSeparator?c:c+a};this.formatCurrency=function(a){return this.format(a,b)};this.formatPoints=function(a){return this.format(a,d)}},
f=function(e,f,b,d){this.maxAmount=d;this.rewardsFormatter=b;this.currencyElement=e;this.pointElement=f;var c=this;this.isControlKey=function(a){switch(a.which){case 8:case 46:return!0;case 86:case 88:return a.ctrlKey;default:return!1}};this.isNavigationKey=function(a){switch(a.which){case 9:case 16:case 17:case 35:case 36:case 37:case 39:return!0;case 65:case 67:return a.ctrlKey;default:return!1}};this.isValidKey=function(a){var b=a.which;return 48<=b&&57>=b||96<=b&&105>=b||8===a.which||46===a.which};
this.getCaret=function(){var a=c.currencyElement,b=a.get(0),d=0,e=0;if("number"===typeof b.selectionStart&&"number"===typeof b.selectionEnd)d=b.selectionStart,e=b.selectionEnd;else{var f=document.selection.createRange();if(f!==G&&f.parentElement()===b){a=a.val();e=a.length;var g=b.createTextRange();g.moveToBookmark(f.getBookmark());b=b.createTextRange();b.collapse(!1);-1<g.compareEndPoints("StartToEnd",b)?d=e:(d=-g.moveStart("character",-e),d+=a.slice(0,d).length-1,-1<g.compareEndPoints("EndToEnd",
b)||(e=-g.moveEnd("character",-e),e+=a.slice(0,e).length-1))}}return{start:d,end:e}};this.setCaret=function(a){var b=c.currencyElement.get(0);b.setSelectionRange?b.setSelectionRange(a,a):b.createTextRange&&(b=b.createTextRange(),b.collapse(!0),b.moveStart("character",a),b.moveEnd("character",a),b.select())};this.bind=function(){c.currencyElement.unbind();c.currencyElement.bind("keydown",function(a){c.isNavigationKey(a)||c.isControlKey(a)||c.isValidKey(a)||a.preventDefault()});c.currencyElement.bind("keyup",
function(b){if(!c.isNavigationKey(b)){b=c.getCaret();var d=c.currencyElement.val().length;c.format();var e=c.currencyElement.val().length;b.start===b.end&&c.setCaret(Math.min(b.start+(e-d),e));a.trigger("inlineFormatter:formattingCompleted",c)}})};this.unbind=function(){c.currencyElement.unbind("keydown keyup")};this.format=function(a){a=c.currencyElement.val();a=c.rewardsFormatter.getCurrencyAmount(a);isNaN(a)&&(a=0);a>c.maxAmount&&(a=c.maxAmount);a=c.rewardsFormatter.formatCurrency(a);c.currencyElement.val(a)}};
a.on("inlineFormatter:formattingCompleted",function(a){var e=a.pointElement,b=a.currencyElement.val();b=a.rewardsFormatter.getPointsAmount(b);a=a.rewardsFormatter.formatPoints(Math.round(b));e.html(a)});return{getCurrencyFormatByCountryCode:function(a){(a=k[a])||(a=k["default"]);return a},getAmount:m,initializeInlineFormatting:function(g,l,b){var d=g.maxAmount;b=new e(b.groupingSeparator,b.decimalSeparator,b.decimalPlace,l.decimalPlace,l.ratio);g=new f(g.$element,l.$element,b,d);g.bind();g.format(0);
a.trigger("inlineFormatter:formattingCompleted",g)}}});"use strict";r.when("A","pay-common-util","pay-validator","page-conductor","mobile-carrier-billing-util","weblab-helper").register("jppoints",function(a,m,k,e,f,g){function l(){!m.isMobileCX()&&A("#jppoints").length&&(t=m.getElements(q),p())}function b(){var a=t.paymentRows.find('input[type\x3d"radio"][name\x3d"paymentMethod"]');a.closest("div.payment-selected").removeClass("payment-selected");a.attr("checked",!1);m.isTouchCX()&&d(a,"radio")}
function d(a,b){a.siblings("i").removeClass("a-icon-touch-"+b+"-active").addClass("a-icon-touch-"+b+"-inactive")}function c(a,b){a.is(":disabled")||a.siblings("i").removeClass("a-icon-touch-"+b+"-inactive").addClass("a-icon-touch-"+b+"-active")}function h(){return A('input[type\x3d"radio"][name\x3d"paymentMethod"][value\x3d"availablebalance"]').is(":checked")}function p(){if(t.jppoints&&t.jppoints.length){h()&&x();t.jppoints.show();var a=t.jppoints.find("#redeemPoints");m.isTouchCX()?a.parents("label").bind("click",
w):a.bind("click",w);t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').bind("click",function(){var a=t.jppoints.find("#jpPointsCustom");a.attr("checked",!0);var b=t.jppoints.find("#redeemPoints");b.attr("checked",!0);m.isTouchCX()&&(c(a,"radio"),d(t.jppoints.find("#jpPointsMax"),"radio"),c(b,"checkbox"))});t.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]').bind("click",v);t.jppoints.find("#jpPointsCustom").bind("click",function(){t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').focus()});
t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').bind("keyup",B)}}function x(){var a=t.jppoints.find("#redeemPoints"),b=t.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),c=t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),f=t.jppoints.find("#redeemableAmount"),h=t.jppoints.find("#redeemableValue");a.attr("checked",!1);a.attr("disabled",!0);b.attr("checked",!1);b.attr("disabled",!0);t.jppoints.find("#jpPointsError").hide();c.val("");
c.removeClass("a-form-error");c.attr("disabled",!0);h.text(t.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]').val());f.text(t.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]').val());e.isSPP()&&(t.jppoints.find("label").addClass("disabled-color"),t.jppoints.removeClass("payment-selected"));m.isTouchCX()&&(d(a,"checkbox"),d(b,"radio"),a.siblings("i").addClass("a-button-disabled"),b.siblings("i").addClass("a-button-disabled"))}function v(e){var f=e.currentTarget,
h=t.jppoints.find("#redeemPoints");h.attr("checked",!0);if(m.isTouchCX()){c(A("#"+f.id),"radio");var g="jpPointsMax"===f.id?t.jppoints.find("#jpPointsCustom"):t.jppoints.find("#jpPointsMax");d(g,"radio");c(h,"checkbox")}"true"===f.value&&(t.jppoints.find("#jpPointsError").hide(),f=t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),f.removeClass("a-form-error"),f.val(""),h=t.jppoints.find("#redeemableAmount"),g=parseInt(t.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),
10),f=parseInt(t.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),h=parseInt(h.text(),10)*g,A('input[name\x3d"useAvailableBalance"]').is(":checked")&&(g=t.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]'),f-=parseInt(g.val(),10)),h>=f&&b());r.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:toggleJPPointsInstallmentEligibility",A(e.currentTarget))})}function y(a){var c=t.jppoints.find("#redeemableAmount"),
e=t.jppoints.find("#redeemableValue"),f=parseInt(t.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10);if(a.is(":checked")){a=t.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]').val();var h=t.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]').val();f-=parseInt(t.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]').val(),10)}else a=t.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val(),
h=t.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]').val();var g=parseInt(t.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),10)*a;c.text(a);e.text(h);0>=parseInt(a,10)?(c=t.jppoints.find("#redeemPoints"),c.attr("checked",!1),e=t.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),e.attr("checked",!1),m.isTouchCX()&&(d(c,"checkbox"),d(e,"radio"))):t.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"][value\x3d"true"]').is(":checked")?
g>=f&&b():B()}function w(){var b=t.jppoints.find("#redeemPoints");if(!b.is(":disabled")){b=b.is(":checked");if(m.isTouchCX())b?(d(t.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]'),"radio"),u()):(c(t.jppoints.find("#jpPointsMax"),"radio"),d(t.jppoints.find("#jpPointsCustom"),"radio"),n());else if(b)n(),e.isSPP()&&t.jppoints.addClass("payment-selected");else if(u(),e.isSPP()){t.jppoints.removeClass("payment-selected");if(h())return;m.selectDefaultPaymentMethodIfNotSelected()}r.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:toggleJPPointsInstallmentEligibility",
t.jppoints)})}}function n(){var a=t.jppoints.find("#jpPointsMax");a.attr("checked",!0);var f=parseInt(t.jppoints.find("#redeemableAmount").text(),10),h=t.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val(),g=parseInt(t.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10);m.isTouchCX()&&(d(t.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]'),"radio"),c(a,"radio"));t.jppoints.find("#jpPointsMax").is(":checked")&&(f>=g?b():e.isSPP()&&t.paymentRows.find("#gcPromo, input[name\x3d'useAvailableBalance']").is(":checked")&&
(a=t.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]'),g-=parseInt(a.val(),10),h>=g&&b()))}function u(){var a=t.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]');a.attr("checked",!1);var b=t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]');b.val("");b.removeClass("a-form-error");t.jppoints.find("#jpPointsError").hide();m.isTouchCX()&&d(a,"radio")}function B(){var c=t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),d=parseInt(c.val(),
10);!d||0>d?(c.val(""),t.jppoints.find("#jpPointsError").hide(),t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').removeClass("a-form-error")):(c.val(d),parseInt(t.jppoints.find("#redeemableAmount").text(),10)<d?(t.jppoints.find("#jpPointsError").show(),t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').addClass("a-form-error")):(t.jppoints.find("#jpPointsError").hide(),t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').removeClass("a-form-error"),
c=parseInt(t.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),parseInt(t.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),10),d>=c&&b(),r.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:actionToggleJPPointsSection",d)})))}var A=a.$,t={},q={paymentRows:"#existing-payment-methods .payment-row",jppoints:"#jppoints",mcbPointsWarning:"#mcbPointsWarning"};a.on("checkout:reload:payselect",l);a.on("checkout:reload:spp-payment",
l);return{handleJPPointsOnPaymentRows:function(a){a=A(a.currentTarget);if("jppoints"!==a.attr("id"))if("useAvailableBalance"===a.attr("name"))y(a);else{g.isMCBMultiTenderWeblabEnabled()||f.hideMCBWarningMessageForPoints(t);var b=a.find('input[type\x3d"radio"][name\x3dpaymentMethod]');if(!g.isMCBMultiTenderWeblabEnabled()&&b.length&&0<b.filter("[value^\x3dMCB]").size())f.showMCBWarningMessageForPoints(t),x();else if("availablebalance"===a.attr("value")||a.find("#pm_300")&&"availablebalance"===a.find("#pm_300").attr("value"))x();
else{a=t.jppoints.find("#redeemPoints");b=t.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]');var c=t.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),d=t.jppoints.find("#redeemableAmount"),h=t.jppoints.find("#redeemableValue");e.isSPP()&&t.jppoints.find("label").removeClass("disabled-color");a.attr("disabled",!1);b.attr("disabled",!1);c.attr("disabled",!1);A('#existing-balance input[type\x3d"radio"][value\x3d"availablebalance"]').length&&(d.text(t.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val()),
h.text(t.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]').val()));m.isTouchCX()&&(a.siblings("i").removeClass("a-button-disabled"),b.siblings("i").removeClass("a-button-disabled"))}}},handleJPPointsWithGC:y}});"use strict";r.when("A","ajax-utility","client-side-metrics","pay-common-util","pay-validator","page-transition-controller","page-conductor","a-popover-position","inline-points-register-controller","jppoints","pay-credit-card","checkout-general-utils","a-popover-base",
"a-dropdown","pay-rewards-currency","cache-page-data-controller","pay-credit-card-reregistration","mobile-carrier-billing-util","emi-helper","instant-bank-discount-helper","safe-apx-helper","apb-limit-messaging-helper").register("existing-payments",function(a,m,k,e,f,g,l,b,d,c,h,p,x,v,y,w,n,u,B,A,t,M){function K(){return D.paymentRows.filter(function(){return L(this).hasClass("payment-selected")||L(this).find("#redeemPoints").is(":checked")})}function P(a){g.show();a.$event.preventDefault();var b=
K().find(".card-unreg-rewards").data();b.recommendedPaymentMethodId=b.paymentinstrumentid;e.makeAjaxCall(a.$target.attr("href"),b)}function O(b){b=L(b.currentTarget);var c=b.data();if(!(0>=c.ratio)){var d=b.val()/c.ratio;if(!isNaN(d)){var f=b.val();f<c.min&&(d=0);b=e.getNumberWithSeparators(d,c.decimalplaces);K().find(".custom-reward-points").html(b);r.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:actionToggleRewardsSection",f)})}}}function H(a){1===a.data.refresh&&
(g.show(),e.makeAjaxCall(a.data.url))}function N(a){Ha(a)?(a=D.continueBtns,a.find(".a-button-primary:not(.a-button-disabled)").addClass("aok-hidden"),a.find(".a-button-disabled").removeClass("aok-hidden")):L("#payPageContinueBtnStateFixEnabled").length&&W(a)}function G(a){e.isTouchCX()&&(Ha()?a.$event.preventDefault():(D.continueErrPopover.hide().find(".error-message").hide(),g.show()))}function S(a){e.isTouchCX()&&(Ha()||D.continueErrPopover.hide().find(".error-message").hide())}function R(a){a=
L(a.currentTarget);a.click();a=a.closest(".payment-container");a.find("#cc-errors").is(":visible")?a.find(".tv-update .a-button-primary").focus():a.click()}function J(a){a.$event.preventDefault();var b=K();if(!h.runConfirmCardValidator(b,b.find("#cc-errors"))){g.show();var c=(b=e.getInputValues(b))||{},d=e.getInputValues(D.hiddenFormFields),f;for(f in d)d.hasOwnProperty(f)&&(c[f]=d[f]);h.confirmCreditCard(b,da,a.data.url)}}function V(){D.continueErrPopover.filter(":visible").length&&D.continueErrPopover.hide()}
function W(){D.continueErrPopover.filter(":visible").length&&D.continueErrPopover.hide().find(".error-message").hide();var a=K();D.disableSubmitButtons.length?a.find(".no-address").length||(a.find(".continue-center").removeClass("aok-hidden"),a.find(".a-button-disabled").addClass("aok-hidden")):(D.continueBtns.find(".a-button-primary:not(.a-button-disabled)").removeClass("aok-hidden"),D.continueBtns.find(".a-button-disabled").addClass("aok-hidden"));if(a){var b=a.find(".a-form-error");b&&b.length&&
(b.removeClass("a-form-error"),(a=a.find(".pincode-err-block").filter(":visible"))&&a.length&&(D.continueErrPopover.hide().find(".error-message").hide(),D.continueBtns.find(".a-button-primary").removeClass("aok-hidden"),D.continueBtns.find(".a-button-disabled").addClass("aok-hidden"),a.hide()))}}function X(){D.continueErrPopover.filter(":visible").length||D.continueBtnTop.trigger("click")}function ha(a){if(13===a.which){var b=L(document.activeElement),c=b.closest("div.payment-row"),d=b.closest(".a-button");
b=b.get(0).tagName;if(c.length&&!d.length&&"A"!==b&&"a"!==b)return c=c.find('input[type\x3d"submit"]'),c.length?c.trigger("click"):(D.continueErrPopover.filter(":visible").length&&D.continueErrPopover.hide(),Ha(a)?(e.isTouchCX()||(D.continueBtns.find(".a-button-primary").addClass("aok-hidden"),D.continueBtns.find(".a-button-disabled").removeClass("aok-hidden")),a.preventDefault()):D.continueBtnTop.trigger("click")),!1}}function E(a){g.show();var b=K(),c=b.find("input[type\x3dradio][name\x3dpaymentMethod]").val(),
d=b.find(".card-unreg-rewards").data();b=e.isTouchCX()?b.find(".flag-register-rewards"):D.rewardsRegister;b=e.getInputValues(b);b.programid=d.programid;b.paymentinstrumentid=d.paymentinstrumentid;b.CARD_EXPIRATION_DATE=d.expiredate;b.CARD_HOLDER_NAME=d.holdername;b.returnRefreshedPage=a.data.returnRefreshedPage;b.rewardsdateofbirthmonth&&b.rewardsdateofbirthday&&(b.DATE_OF_BIRTH=b.rewardsdateofbirthmonth+b.rewardsdateofbirthday);-1===a.data.url.toLowerCase().indexOf("cachebuster")&&(a.data.url=p.addQueryStringParameter(a.data.url,
"cacheBuster",(new Date).getTime()));e.makeAjaxCall(a.data.url,b,{successHandler:function(a,b,d){g.hide();if(a){a=m.jsonify(a);D.rewardsRegister.find(".register-content").hide();var f=e.isTouchCX()?K().find(".register-error"):D.rewardsRegister.find(".register-error");f.hide();a.error?f.show().find(".error-message").hide().filter("#"+a.error).show():(l.ajaxUpdatePage(a.refreshedPage,b,d),b=D.paymentRows.find('input[type\x3dradio][name\x3dpaymentMethod][value\x3d"'+c+'"]').closest(".payment-row"),b.trigger("click"),
e.scrollTopTo(b))}}})}function U(a){a=L(a.currentTarget).parents("div.currency-list");var b=a.find("label.a-touch-radio");b.length?b.trigger("click"):a.find("input[type\x3dradio][value\x3dOther]").trigger("click")}function Y(a){a=a.$target.closest("div.payment-row");var b=a.find(".currency-list");if(l.isSPP()){var c=v.getSelect(b.find("select"));null!==c&&c.setValue("")}a.find(".change-currency").hide();b.show();e.isTouchCX()&&(a.find(".top-cell").removeClass("bottom-line").addClass("bottom-line"),
a.find(".bottom-cell").show());fa();pa()}function Z(a){a=a.$target.closest("div.payment-row");a.find(".expire-info, .expire-date").hide();a.find(".enter-date, .expire-date-fields").show();fa();ka()}function z(a){var b=a.$target.closest("div.payment-row"),c="true"===e.getAttributeData(b,"isaddresschallenge")?1:0;b.find(".expire-date-fields").length?(Z(a),b.find("#newExpDate").focus()):c&&b.find("#addCreditCardNumber").focus()}function ca(a){setTimeout(function(a){var b=L(a.target);a=document.createEvent("UIEvents");
a.initUIEvent("DOMActivate",!0,!0,q,1);b.get(0).dispatchEvent(a)},0,a)}function ba(a){var b=L(a.target).closest("div.payment-row");""!==L(a.target).val()&&("true"===e.getAttributeData(b,"isaddresschallenge")?b.find("#addCreditCardNumber").focus():X())}function ia(){var a=K();a.find("div.flag-register-rewards").is(":visible")?(a.find(".bottom-cell").hide(),a.find(".top-cell").removeClass("bottom-line"),a.find(".card-unreg-rewards").show()):(a.find(".card-unreg-rewards").hide(),a.find(".bottom-cell").show(),
a.find(".top-cell").removeClass("bottom-line").addClass("bottom-line"))}function aa(){ia()}function C(a){a.$event.preventDefault();if("1"===K().find("div.flag-register-rewards").attr("cached"))ia();else{var b=a.$target.attr("href");-1===b.toLowerCase().indexOf("cachebuster")&&(b=p.addQueryStringParameter(b,"cacheBuster",(new Date).getTime()));g.show();e.makeAjaxCall(b,a.data,{successHandler:function(a){g.hide();var b=m.jsonify(a);a=e.decodeJSONResponse(b.widgetHTML);var c=K();c.find("div.flag-register-rewards").html(a);
c.find("div.flag-register-rewards").attr("cached",1);c.find("div.flag-register-rewards .error-message").each(function(){var a=L(this),c=a.data("errorid");a.html(b.displaydata[c])});ia()}})}}function qa(b){var d=L(b.target);if(!d.is(":visible"))return b.preventDefault(),b.stopPropagation(),!1;l.isSPP()&&(l.isPrefetchFromAddressEnabled()?l.disablePageNoUpdateTransition():L("#payment").find(".panel-cancel-row").hide(),w.clearCache());var f=L(b.currentTarget);D.jppoints.length&&c.handleJPPointsOnPaymentRows(b);
var h=f.find("[name\x3duseAvailableBalance]");if("useAvailableBalance"!==b.target.name&&!h.length)if(I(f),u.toggleGCForMCB(f,D),ma(f),f.hasClass("payment-selected")||f.hasClass("payment-label"))D.disableSubmitButtons.length&&(sa(f,f,!1),!d.hasClass("continue-center")&&f.find(".continue-center").length||X());else if(b=f.find('input[type\x3d"radio"][name\x3d"paymentMethod"]'),b.length&&"disabled"!==b.attr("disabled")){db();b=K();l.isSPP()?b.filter(function(){var a=L(this).attr("id");return"gcPromo"===
a?(a=L(this).find('input[type\x3d"radio"][name\x3d"paymentMethod"][value\x3d"availablebalance"]'))&&a.length:"jppoints"!==a}).removeClass("payment-selected"):b.removeClass("payment-selected");b.find("[name\x3dpaymentMethod]").attr("checked",!1);b.find("i[data-a-input-name\x3dpaymentMethod]").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");b.find(".top-cell").removeClass("bottom-line");va(b);e.isTouchCX()&&(b.find(".bottom-cell").hide(),b.find(".card-unreg-rewards").show());
f.addClass("payment-selected");f.find("[name\x3dpaymentMethod]").attr("checked",!0);f.find("i[data-a-input-name\x3dpaymentMethod]").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active");d="true"===e.getAttributeData(f,"isaddresschallenge")?1:0;h=f.find('.rewards-list input[type\x3d"radio"]').length;var g="1"===e.getAttributeData(f,"hasDerivedCurrency")?1:0,n=f.find(".vcc-form-fields").length,k=f.find(".card-ref-num").length;e.isTouchCX()&&(d||h||n||k||g)&&(f.find(".top-cell").removeClass("align-top bottom-line").addClass("bottom-line"),
f.find(".bottom-cell").show());r.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:select-payment-row",f,pa)});Qa(f);Ta(f);Ua(f);Wa(f);eb(f);"1"===L("#suppressionMessageFixEnabledStatus").val()&&fb(f);gb(f);Va(f);Xa(f);Ya(f);bb(f);cb(f);Za(f);Na(B,B.toggleEMIMenu,f);$a(f);hb();la(f);La();fa();ka();S();za();na(f,b);Sa();D.hideInputBoxes.length&&(xa(f,b),Ra(f));D.disableSubmitButtons.length&&sa(f,b,!0);ja();pa();D.disableSubmitButtons.length&&!f.find(".continue-center").length&&
X()}}function ma(a){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=L("input[type\x3d'hidden'][name\x3d'paySelectLocale']");b.length&&"IN"===b.val()&&a.length&&r.when("client-side-metrics").execute(function(a){a.increaseCount("PayPage-COD-NonMobile",1)})}function I(a){var b=L("#isGlobalCODEligible").val();if(b&&"0"!==b){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');b=L("#button-add-gcpromo");var c=L("#button-add-gcpromo").parent().parent();a.length?(c.addClass("a-button-disabled"),
b.attr("disabled","disabled")):(c.removeClass("a-button-disabled"),b.removeAttr("disabled"))}}function ra(a){r.when("A","a-tv").execute(function(b,c){b=b.$;var d=b(a);d.length&&(b(".tv-lastSelected").removeClass("tv-lastSelected"),d.addClass("tv-lastSelected"),c.select(d))})}function sa(a,b,c){c&&b.find(".billing-address, .cc-continue-button").hide();if(a.find(".tv-update").length)xa(a,b),Ra(a);else{var d=a.find(".billing-address, .cc-continue-button");if(d.length&&!d.is(":visible")){var e=!1;a.find(".no-address").length&&
(e=!0,a.find(".a-button-primary").addClass("aok-hidden"),a.find(".a-button-disabled").removeClass("aok-hidden"));r.when("a-tv").execute(function(f){c&&(b.find(".payment-container").hasClass(".a-tv-navigate")||f.add(b.find(".payment-container")));f.remove(a.find(".payment-container"));f=e?a.find(".billing-address-link"):d.find(".continue-center");ra(f)});d.show()}}}function la(a){var b=L("#one-click-final-review-message");b.length&&(a.find("#canTryTFX").length?b.removeClass("aok-hidden"):b.addClass("aok-hidden"))}
function na(a,b){if(e.isTouchCX()&&(b&&b.find(".top-cell .data-row").children(".a-column").height("auto"),a)){a=a.find(".top-cell .data-row");var c=a.find(".addr-challenge-card-scan .a-box");if(c.length){b=a.height();c=c.height();var d=a.children(".a-column:first");a.children(".a-column").height(c);d.height(b);d.children(".vertical-center-grid:first").height(c)}else a.children(".a-column").height(a.height())}}function da(b){g.hide();var c=m.jsonify(b);c.imbWidgetHTML&&L("#imb-wrapper").html(e.decodeJSONResponse(c.imbWidgetHTML));
if(c.cardWidgetHTML&&(b=K(),b.replaceWith(e.decodeJSONResponse(c.cardWidgetHTML)),null!=c.rewardsAccountsWidgetHTML&&r.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:refresh-rewards-section",e.decodeJSONResponse(c.rewardsAccountsWidgetHTML))}),a.trigger("checkout:reload"),a.trigger("checkout:reload:payselect"),b=K(),"true"!==e.getAttributeData(b,"isaddresschallenge"))){h.setCardPasswordInputStatus(b,c.newpaymentmethodid,"cvv","#existingCvvNum");h.setCardPasswordInputStatus(b,
c.newpaymentmethodid,"pincode","#existingPincodeNum");if(D.cvvColumnLabel.length){var d=!1;D.paymentRows.each(function(){if("true"===e.getAttributeData(L(this),"isaddresschallenge"))return d=!0,!1});d||D.cvvColumnLabel.hide()}D.disableSubmitButtons.length&&X()}}function fa(){D.paymentRows.each(function(){var a=L(this),b=a.find('.currency-list input[type\x3d"radio"]').length,c=a.find('.rewards-list input[type\x3d"radio"]').length,d=a.find(".card-reg-info").is(":visible"),f=a.find(".expire-date-fields").is(":visible"),
h=a.find("a[data-action\x3dshow-expire-date-fields]").is(":visible"),g=a.find(".bottom-cell .inner-grid-left"),l=a.find(".bottom-cell .inner-grid-right");f?b||c||d?(g.removeClass("hidden a-span10 a-span12").addClass("a-span8"),l.removeClass("a-span12 a-span2 hidden").addClass("a-span4")):(g.removeClass("a-span8 a-span10 a-span12").addClass("hidden"),l.removeClass("a-span4 a-span2 hidden").addClass("a-span12")):h?(g.removeClass("a-span12 a-span8 hidden").addClass("a-span10"),l.removeClass("hidden a-span4 a-span12").addClass("a-span2")):
(g.removeClass("a-span10 a-span8 hidden").addClass("a-span12"),l.removeClass("a-span2 a-span4 a-span12").addClass("hidden"));!e.isTouchCX()&&h&&(b||c||d)&&a.find(".bottom-cell").removeClass("align-top").addClass("align-top")});var a=K(),b=a.find("a[data-action\x3dshow-expire-date-fields]").filter(":visible").length,c=a.find(".top-cell.bottom-line").length;b&&!c||a.find(".bottom-cell").removeClass("align-top")}function ka(){e.isTouchCX()&&D.paymentRows.each(function(){var a=L(this),b="true"===e.getAttributeData(a,
"isaddresschallenge")?1:0,c=a.find("a[data-action\x3dshow-expire-date-fields]").is(":visible"),d=a.find(".expire-date-fields").is(":visible"),f=a.find(".card-reg-info").is(":visible"),h=a.find(".rewards-info").is(":visible"),g=a.find(".change-currency").is(":visible");c?a.find(".top-cell .second-row").addClass("align-top"):a.find(".top-cell .second-row").removeClass("align-top");b=b||g||f||h;f=d||c;h=a.find(".top-cell .inner-grid-left");a=a.find(".top-cell .inner-grid-right");b||(h.removeClass("a-span6 a-span8 a-span12").addClass("hidden"),
a.removeClass("a-span4 a-span6 hidden").addClass("a-span12"));f||(h.removeClass("a-span6 a-span8 hidden").addClass("a-span12"),a.removeClass("a-span4 a-span6 a-span12").addClass("hidden"));b&&c&&(h.removeClass("a-span6 a-span12 hidden").addClass("a-span8"),a.removeClass("a-span6 a-span12 hidden").addClass("a-span4"));b&&d&&(h.removeClass("a-span6 a-span8 hidden").addClass("a-span6"),a.removeClass("a-span4 a-span12 hidden").addClass("a-span6"))})}function va(a){var b=a.find(".currency-list");if(b.length){var c=
b.find("[type\x3dradio]:checked").val();b=b.find("#cardCurrencyDropDown option:selected").val();"Other"!==c||"-1"!==b&&"-2"!==b||a.find(".currency-list input[type\x3dradio][value!\x3dOther]").attr("checked",!0)}}function oa(a){var b=L(a.currentTarget);a=b.find("option:selected");if(""===a.val())b.parents("div.selected-section").find(".selected-note-content").hide();else{var c=a.prop("disabled");b=b.parents("div.selected-section");var d=b.find("#active-bank-content"),e=b.find("#disable-bank-content");
c?(e.show(),d.hide()):(d.show(),e.hide());b.find("span.selected-note-bank").text(a.text()).show()}}function wa(a){var b=L(a.currentTarget);a=b.find("option:selected");""===a.val()?b.parents("div.selected-section-more-payment-method").find(".selected-more-payment-content").hide():(b=b.parents("div.selected-section-more-payment-method"),b.find("span.selected-payment-option").text(a.text()).show(),b.find("span.selected-more-payment-content").show())}function Da(a){(D.continueErrPopover.filter(":visible").length||
Ha())&&a.$event.preventDefault()}function F(b){b=L(b.currentTarget);var c=b.find("input[type\x3dcheckbox]");c.attr("checked")?(c.attr("checked",!1),b.find(".checked-checkbox").addClass("aok-hidden"),b.find(".empty-checkbox").removeClass("aok-hidden"),b.find(".gc-balance-insufficient-msg").addClass("aok-hidden")):(c.attr("checked",!0),b.find(".checked-checkbox").removeClass("aok-hidden"),b.find(".empty-checkbox").addClass("aok-hidden"),b.find(".gc-balance-insufficient-msg").removeClass("aok-hidden"));
r.when("a-tv").execute(function(b){setTimeout(function(){b.select(".tv-lastSelected")},500);a.trigger("a:tv:resize")})}function T(a){a=L(a.currentTarget);"1"===a.attr("isclicked")?a.attr("isclicked",0):a.attr("isclicked",1);za()}function za(a){var b=L("#pm_promo");a=L("#pm_gc_radio");var c=L("#pm_gc_checkbox"),d;L("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").length&&(d=L("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").val());if(a&&a.length||c&&c.length){var f=
L("input[name\x3dgcBalanceRaw]").val();L("input[name\x3damBalanceRaw]").length&&(f=L("input[name\x3damBalanceRaw]").val());var h=L("input[name\x3disAPBLimitMessagingLaunchWeblabEnabled]").val(),g=L("input[name\x3dhasAPBRedeemableLimitExhausted]").val(),l=L("input[name\x3damAvailableBalanceRaw]").val(),n=L("input[name\x3dremainingBalanceRaw]").val(),k=L("input[name\x3dpurchaseTotalRaw]").val(),m=L(".purchase-total").length;if(m){var p=L(".purchase-total").html();var u=L(".remaining-balance").html()}else p=
L("input[name\x3dpurchaseTotal]").val(),u=L("input[name\x3dremainingBalance]").val();var T=L(".balance-applied");m?T.html(p):T.text(p);(e.isTouchCX()&&"checkbox"===b.attr("type")?"1"===b.closest(".a-control-row").attr("isclicked"):b.is(":checked"))?(b=n,0<b&&(m?T.html(u):T.text(u))):b=k;h&&M.renderAPBMessagingRemainingBalance({purchaseTotal:p,remainingBalance:u,balanceApplied:T,isPurchaseTotalInSpan:m},f,k,l);u=a.closest(".radio-col");p=c.closest(".radio-col");n=L(".amazon-money-limit-breached");
m=L(".long");T=L(".short");"1"===h&&"1"===g?M.displayAPBRedeemableLimitExhaustedMessaging({gcRadioContainer:u,gcCheckboxContainer:p,gcCheckbox:c,gcRadio:a,shortMsg:T,longMsg:m,amazonMoneyLimitBreachedMsg:n}):0<=f-k?("disabled"===a.attr("disabled")&&a.removeAttr("disabled"),u.removeClass("hidden"),a.is(":checked")&&u.trigger("click"),p.addClass("hidden"),c.attr("disabled","disabled"),0==f-k?(m.hide(),T.show()):(m.show(),T.hide())):0<f-b?0>=b?(p.removeClass("hidden"),c.attr("disabled","disabled"),e.isTouchCX()&&
p.find("i").addClass("a-button-disabled checkbox-disabled"),u.addClass("hidden"),a.attr("disabled","disabled"),T.show(),m.hide()):("disabled"===a.attr("disabled")&&a.removeAttr("disabled"),u.removeClass("hidden"),a.is(":checked")?u.trigger("click"):e.isTouchCX()&&u.find("i").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"),p.addClass("hidden"),c.attr("disabled","disabled"),m.show(),T.hide()):("disabled"===c.attr("disabled")&&(c.removeAttr("disabled"),e.isTouchCX()&&
p.find("i").removeClass("a-button-disabled checkbox-disabled")),p.removeClass("hidden"),(g=p.closest(".payment-row"))&&g.hasClass("payment-selected")&&g.removeClass("payment-selected"),u.addClass("hidden"),a.attr("disabled","disabled"),"1"===h?M.renderAPBInsufficientMessaging({shortMsg:T,longMsg:m},f,l):(T.show(),m.hide()));"1"===d&&(a.attr("disabled","disabled"),c.attr("disabled","disabled"),(g=p.closest(".payment-row"))&&g.hasClass("payment-selected")&&g.removeClass("payment-selected"))}}function ua(b){var c=
K().find(".enter-custom-rewards");if("rewardscustom"===L(b.currentTarget).children('input[type\x3d"radio"]').val()){c.show();var d=c.find("input.custom-rewards-input");d.focus();D.paymentRows.find(".rewards-list").hasClass("show-currency-input-widget-new")&&(c=d.val().length,d=d.get(0),d.setSelectionRange?d.setSelectionRange(c,c):d.createTextRange&&(d=d.createTextRange(),d.collapse(!0),d.moveStart("character",c),d.moveEnd("character",c),d.select()))}else c.hide();r.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleRewardsInstallmentEligibility",
L(b.currentTarget))});pa()}function Ga(a){a=a.$target||L(a.currentTarget);ea(a)}function ea(b){if(b.length){var c=D.paymentRows.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]'),d=D.paymentRows.find(".installments-select.a-row"),e=d.siblings(".installments-message"),f=d.siblings(".card-offers"),h=D.paymentRows.find('input[type\x3d"radio"][value\x3d"morePaymentMethod"]'),g=D.installmentsOnlyCards,l=D.paymentRows.find('input[type\x3d"radio"][id\x3d"pmEmiPaymentOptions"]'),n=D.paymentRows.find('input[type\x3d"radio"][value\x3d"amazonBusinessCredit"]');
if(c.length){var m=c.closest(".payment-row"),k=h.closest(".payment-row"),p=l.closest(".payment-row"),u=n.closest(".payment-row");b.is(":checked")?(c.prop("disabled",!0),c.is(":checked")&&(c.prop("checked",!1),m.removeClass("payment-selected")),c.parent().siblings().addClass("a-color-secondary"),Na(B,B.disableEMIPaymentMethods,l),r.when("abc-helper").execute(function(b){a.trigger("abc-helper:disable-payment",n)}),A.showInstantBankDiscountAmazonPaySelected(),Ea(h,k),(b=d.find("select"))&&b.each(function(){var a=
this.id.replace(/\./g,"\\.");v.setValue(a,"")}),d.find(".installments-enabled-text").hide(),e.find(".installments-enabled-text").hide(),f.find(".installments-enabled-text").hide(),d.find(".installments-disabled-text").show(),e.find(".installments-disabled-text").show(),f.find(".installments-disabled-text").show(),L("#isGurupaPspToggleGcBugfixEnabled").length&&"1"===L("#isGurupaPspToggleGcBugfixEnabled").val()?g.find("input[name\x3dpaymentMethod]").attr("disabled","disabled").filter(":checked").removeAttr("checked"):
g.find("input[name\x3dpaymentMethod]").attr("disabled","disabled").removeAttr("checked"),g.removeClass("payment-selected")):(m.find(".payment-invalid").length||(c.prop("disabled",!1),c.parent().siblings().removeClass("a-color-secondary")),k.find(".payment-invalid").length||Ba(h,k),p.find(".payment-invalid").length||Na(B,B.enableEMIPaymentMethods,l),u.find(".payment-invalid").length||r.when("abc-helper").execute(function(b){a.trigger("abc-helper:enable-payment",n)}),A.showInstantBankDiscountAmazonPayDeselected(),
d.find(".installments-disabled-text").hide(),e.find(".installments-disabled-text").hide(),f.find(".installments-disabled-text").hide(),d.find(".installments-enabled-text").show(),e.find(".installments-enabled-text").show(),f.find(".installments-enabled-text").show(),g.find("input[name\x3dpaymentMethod]").removeAttr("disabled"))}}}function Ba(a,b){a.prop("disabled",!1);a.parent().siblings().removeClass("a-color-secondary");b.find(".selected-section-more-payment-method").show();b.find(".more-payment-gc-disabled-text").hide()}
function Ea(a,b){a.prop("disabled",!0);a.is(":checked")&&(a.prop("checked",!1),b.removeClass("payment-selected"));a.parent().siblings().addClass("a-color-secondary");b.find(".selected-section-more-payment-method").hide();b.find(".more-payment-gc-disabled-text").show()}function Fa(a){var b=a.$target||L(a.currentTarget);a=b.closest(".currency-list");b=b.val();!0===(e.isTouchCX()?"Other"===b:"Other"!==b)?(a.find("select").attr("disabled",!0),a.find(".a-button.a-button-dropdown").addClass("a-button-disabled"),
a.find(".a-button.a-touch-select").addClass("a-button-disabled")):(a.find("select").attr("disabled",!1),a.find(".a-button.a-button-dropdown").removeClass("a-button-disabled"),a.find(".a-button.a-touch-select").removeClass("a-button-disabled"));pa()}function Ca(a){n.actionReregisterCardInBox(a);e.scrollTopTo(K())}function Aa(a){pa()}function Oa(){D.paymentRows.each(function(){var a=L(this),b=".card-ref-num, .addr-challenge, .addr-challenge-msg, .cup-expired-msg, .enter-date, .expire-date-fields, .rewards-static-help-link, .verified-fail-msg, .tv-update, .billing-address, .cc-continue-button",
c=".card-info, .card-name, .card-reg-info, .expire-info, .rewards-err-msg, .rewards-list label, .rewards-list div.a-radio, .rewards-dynamic-help-link, .financial-offer-err-detail";a.hasClass("payment-selected")&&("1"===e.getAttributeData(a,"hasDerivedCurrency")||"1"===e.getAttributeData(a,"hasPreferredCurrency")&&"1"===e.getAttributeData(a,"isNewCard"))||(b+=", .currency-list");"1"===e.getAttributeData(a,"hasPreferredCurrency")&&"1"!==e.getAttributeData(a,"isNewCard")&&(c+=", .change-currency");a.find(b).hide();
a.find(c).show()})}function La(){D.paymentRows.each(function(){var a=L(this),b="#cc-errors, .enter-date, .expire-date-fields",c=".expire-info";if(a.hasClass("payment-selected")&&"1"===e.getAttributeData(a,"hasDerivedCurrency"))b+=", .change-currency",c+=", .currency-list";else{var d=a.find(".currency-list"),f=d.find("[type\x3dradio]:checked").val();if(f){if("Other"!==f)var h=d.find(".currencyNameLabel").html();else{f=d.find("#cardCurrencyDropDown option:selected");var g=f.val();"-1"!==g&&"-2"!==g&&
(h=f.text())}h&&(c+=", .change-currency",d.closest("div.payment-row").find(".change-currency .currencyNameLabel").html(h))}b+=", .currency-list"}a.find(b).hide();a.find(c).show()})}function Ia(){var a=L("#aan-ads-box");if(a.length){var b=a.data("adsendpoint"),c=a.data("adsclient"),d="https://"+b+"/2009-09-09/ad/";b="/jsc?pt\x3dstatic\x26slot\x3dlib\x26pt2\x3daanjs";a.data("useaannojq")&&(b+="-nojq");L.getScript(d+c+b,function(){q.d16g&&q.d16g.requestAanAd({elemId:"aan-ads-box",baseUrl:d,afterOnload:!0,
client:c,pt:"checkout",slot:"display-ad-right",pt2:"payselect"})})}}function Ka(){ab&&(a.declarative("auto-rewards-reg",["click"],P),a.declarative("complete-rewards-register",["click"],H),a.declarative("confirm-card",["click"],J),a.declarative("register-card-rewards",["click"],E),a.declarative("cancel-register-card-rewards",["click"],aa),a.declarative("show-currencies",["click"],Y),a.declarative("show-expire-date-fields",["click"],Z),a.declarative("focus-cc-update-fields",["click"],z),a.declarative("show-rewards-reg",
["click"],C),a.declarative("submit-payment-form",["submit"],Da),a.declarative("toggle-tfx-option",["click"],Fa),a.declarative("reregister-cc-in-dashboard",["click"],Ca),a.declarative("modify-expire-date-fields",["change"],Aa),e.isTouchCX()&&a.declarative("continue-button",["click"],G),ab=!1);D.paymentRows.unbind("click").has("input[name\x3dpaymentMethod]:enabled").bind("click",qa);r.when("apx-payselect-helper").execute(function(){var a=t.get("payselect");a&&a.initEvents(D.paymentRows,pa)});D.paymentRows.find("input[name\x3dusePromoBalance]").unbind("change",
za).bind("change",za);D.disableSubmitButtons.length&&D.paymentRows.has("input[type\x3dcheckbox]:enabled").unbind("click",F).bind("click",F);D.existingPincodeNum.unbind("click",Ma).bind("click",Ma);D.paymentRows.find("select#cardCurrencyDropDown").unbind("change",U).bind("change",U);D.paymentRows.find(".rewards-list").hasClass("show-currency-input-widget-new")?D.paymentRows.find(".rewards-list").undelegate("label","click").delegate("label","click",ua).each(function(b,c){c=a.$(c);b=c.find("input.custom-rewards-input");
c=c.find(".custom-reward-points");var d=a.$(b);b={$element:d,maxAmount:d.data("max")};c={$element:a.$(c),decimalPlaces:d.data("decimalplaces"),ratio:d.data("ratio")};d=d.data("country-code");d=y.getCurrencyFormatByCountryCode(d);y.initializeInlineFormatting(b,c,d)}):D.paymentRows.find(".rewards-list").undelegate("label","click").delegate("label","click",ua).undelegate("input.custom-rewards-input","keyup").delegate("input.custom-rewards-input","keyup",O);if(e.isTouchCX())D.pageContainer.find("#existing-payment-methods").find("select, input[type\x3dtext], input[type\x3dpassword]").unbind("change",
S).bind("change",S),D.pageContainer.find("#existing-payment-methods").find("div.currency-list label.a-touch-radio").unbind("click").bind("click",Fa),D.pageContainer.find("#existing-payment-methods").find("label.promoLabel").unbind("click").bind("click",T);else if(!l.isSPP()){var b=D.continueBtns.find(".a-button-text");L("#payPageContinueBtnStateFixEnabled").length?b.filter('input[type\x3d"button"]').unbind("mouseenter",ya).bind("mouseenter",ya).unbind("focus",ya).bind("focus",ya).unbind("mouseleave",
V).bind("mouseleave",V).unbind("blur",V).bind("blur",V):(b.filter('input[type\x3d"submit"]').unbind("mouseenter").bind("mouseenter",N).unbind("focus").bind("focus",N),b.filter('input[type\x3d"button"]').unbind("mouseleave").bind("mouseleave",W).unbind("blur").bind("blur",W))}D.netBankingSelect.unbind("change",oa).bind("change",oa);D.morePaymentMethodsSelect.unbind("change",wa).bind("change",wa);D.continueBtnBottom.unbind("click").bind("click",X);0<L("input[name\x3d'needDisableCODandEMIforGC']").length&&
(b=L("input#pm_300[type\x3d'checkbox'], #pm_gc_checkbox"),b.length&&(b.bind("change",Ga),b.is(":checked")&&ea(b)));D.jppoints.length&&D.paymentRows.find('input[name\x3d"useAvailableBalance"]').bind("click",c.handleJPPointsOnPaymentRows);r.when("installments-payselect").execute(function(){a.trigger("installments-payselect:initEvents")});D.hideInputBoxes.length&&(D.paymentRows.find("#confirm-card").unbind("focus").bind("focus",R),D.paymentRows.find("#newExpDate").unbind("focus").bind("focus",ca),D.paymentRows.find("#newExpDate").unbind("change").bind("change",
ba))}function ja(){var a=f.create();a.validatePayment(K());a.hasErrors()||l.makePrefetch(D.existingPaymentForm)}function Ma(a){a=D.showAmexWarning;null!==a&&(a.removeClass("hidden"),a.removeClass("amex_display"))}function Ja(){if(!e.isMobileCX()){D=e.getElements(ib);D.paymentRows.filter(".payment-selected-marker").removeClass("payment-selected-marker").addClass("payment-selected");var b=K();r.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:page-load",pa)});r.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:page-load")});
Wa(b);Xa(b);la(b);Oa();Qa(b);Ta(b);Ua(b);Ya(b);Za(b);$a(b);Va(b);za();Sa();L(document).undelegate("div.pay-desktop .checkout-page-form","keypress").delegate("div.pay-desktop .checkout-page-form","keypress",ha);L(document).undelegate("div.pay-desktop .checkout-page-form .enter-custom-rewards","keyup").delegate("div.pay-desktop .checkout-page-form .enter-custom-rewards","keyup",pa);D.addressChallengeCardList.length&&D.addressChallengeCardList.show();D.paymentRows.find('input[type\x3d"radio"][value\x3d"rewardsmax"]').each(function(){L(this).siblings('[type\x3d"checkbox"]').remove()}).removeClass("hidden");
ka();fa();Ka();D.existingPaymentForm.data("checkoutFormReady",!0);ja();Ia();D.orderSummaryBottom.show();na(b);S();pa();I(b);u.determineIsMCBEnabled(D);u.toggleGCForMCB(b,D);L(".a-popover-preload").each(function(){var b=L(this).find(".rewards-registration").data("parentPaymentMethodId");b&&(a.off("a:popover:show:rewards-registration-"+b,d.displayRewardsRegister),a.off("a:popover:hide:rewards-registration-"+b,d.hideRewardsRegister),a.on("a:popover:show:rewards-registration-"+b,d.displayRewardsRegister),
a.on("a:popover:hide:rewards-registration-"+b,d.hideRewardsRegister))});r.when("a-tv").execute(function(c){a.trigger("a:tv:resize");b.find(".a-tv-navigate").length&&sa(b,b,!1)})}}function pa(b){l.isSPP()?(Ha()?D.disableSubmitButtons.length?(b=K(),b.find(".continue-center").addClass("aok-hidden"),b.find(".a-button-disabled").removeClass("aok-hidden")):(D.continueBtns.find(".a-button-primary:not(.a-button-disabled)").addClass("aok-hidden"),D.continueBtns.find(".a-button-disabled").removeClass("aok-hidden")):
W(),a.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")):L("#payPageContinueBtnStateFixEnabled").length&&N(b)}function ta(a,c){a=L(a.target).closest(".order-summary-box").find(".continue-button-errors");a.length&&c.length&&(c=b.triggerLeft(a,c),a.show(),a.offset(c))}function ya(a){if((!D.continueErrPopover.filter(":visible").length||e.isTouchCX())&&D.continueErrPopover.find(".error-message:not(.hidden)").length&&a&&("mouseenter"===a.type||"focus"===a.type)){var b=L(a.target).closest(".continue-buttons").find(".a-button-disabled");
ta(a,b)}}function Ha(a){if(D.continueErrPopover.filter(":visible").length&&!e.isTouchCX())return!0;var c=K(),d=f.create();Na(B,B.isEMIPaymentInstrument,c)&&(d.validateEMIMenuForContinueButton(c),c=Na(B,B.getEMIMenuSelectedCardSection));d.validatePayment(c);d.apxValidatePayment(c,D.paymentRows);d=d.getHighestErrorId();if(!d||!d.identifier)return!1;D.continueErrPopover.find(".error-message").hide();c=c.find(".pincode-err-block");c.hide();c&&c.length&&d.target&&d.target.length&&d.target.addClass("a-form-error");
d.isPincodeError?(c.show(),c.addClass("a-form-error")):(D.continueErrPopover.find("#"+d.identifier).show(),D.continueErrPopover.find("#"+d.identifier).removeClass("hidden"),!a||"mouseenter"!==a.type&&"focus"!==a.type?l.isSPP||D.continueBtns.find(".a-button input").filter(":visible").each(function(){var a=L(this).closest(".order-summary-box").find(".continue-button-errors"),c=b.triggerLeft(a,L(this));a.show();a.offset(c)}):(c=L(a.target).closest(".continue-buttons").find(".a-button-primary"),ta(a,
c)));return!0}function Qa(b){D.paymentRows.find(".addr-challenge, .addr-challenge-msg").hide();D.hideInputBoxes.length?D.paymentRows.find(".card-name").show():D.paymentRows.find(".card-info").show();if("true"===e.getAttributeData(b,"isaddresschallenge")){var c=b.find(".addr-challenge, .addr-challenge-msg");0===c.length&&k.increaseCount("Checkout:Payment:AddressChallengeMissingInputAndMsg");c.show();D.hideInputBoxes.length?b.find(".card-name").hide():b.find(".card-info").hide();b=b.attr("paymentmethodid")?
b.attr("paymentmethodid"):b.attr("data-paymentmethodid");a.trigger("checkout:payment:challenge:log",b)}}function Ra(a){D.paymentRows.find(".expire-date-fields").hide();a=a.find(".expire-date-fields");a.length&&a.show()}function Sa(){D.paymentRows.find(".pci-blocking-cvv").length&&D.paymentRows.each(function(){var a=L(this),b=a.find(".pci-blocking-cvv");a.find("[type\x3dradio]:checked").val()&&b.length?b.show():b.length&&b.hide()})}function xa(a,b){r.when("a-tv").execute(function(c){c.add(b.find(".payment-container"));
b.find(".tv-update").hide();var d=a.find(".tv-update");d.length&&(c.remove(a.find(".payment-container")),d.show(),ra(d.find(".a-button-primary")))})}function Ta(a){D.paymentRows.find(".verified-fail-msg").hide();"true"===e.getAttributeData(a,"isverifiedfail")&&a.find(".verified-fail-msg").show()}function Ua(a){D.paymentRows.find(".cup-expired-msg").hide();"true"!==e.getAttributeData(a,"iscupcardexpired")&&"true"!==e.getAttributeData(a,"iscupcardexpiringsoon")||a.find(".cup-expired-msg").show()}function Wa(b){D.paymentRows.find(".rewards-list").hide();
D.paymentRows.find(".top-cell .inner-grid-left").show().find(".rewards-info").show();var c=b.find('.rewards-list input[type\x3d"radio"]'),d=c.filter(":checked");D.paymentRows.find('.rewards-list input[type\x3d"radio"]').prop("checked",!1);0<d.length?d.prop("checked",!0):b.find(".rewards-list").hasClass("apply-by-default")?c.filter('[value\x3d"rewardsmax"]').prop("checked",!0):c.filter('[value\x3d"rewardsnone"]').prop("checked",!0);c=b.find(".rewards-list").show();c.find('input[type\x3d"radio"][value\x3d"rewardscustom"]').is(":checked")&&
c.children(".enter-custom-rewards").show();e.isTouchCX()&&c.length&&(b.find(".rewards-info").hide(),b.find(".top-cell").addClass("bottom-line"),b.find(".bottom-cell").show());r.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleRewardsInstallmentEligibility",b)})}function Xa(a){D.paymentRows.find(".financial-offer-list").hide();D.paymentRows.find(".financial-offer-err-detail").hide();var b=a.find('.financial-offer-list input[type\x3d"radio"]'),c=b.filter(":checked");
b.prop("checked",!1);0<c.length?c.prop("checked",!0):b.first().prop("checked",!0);b=a.find(".financial-offer-list").show();a.find(".financial-offer-err-detail").show();e.isTouchCX()&&b.length&&(a.find(".top-cell").addClass("bottom-line"),a.find(".bottom-cell").show())}function db(){L(document.body).find(".a-dropdown").each(function(){x.hide(L(this))})}function eb(a){D.paymentRows.find(".installments-select").hide();D.paymentRows.find(".installments-message").show();a.find(".installments-select").show();
a.find(".installments-message").hide()}function fb(a){D.paymentRows.find("#savedCardSuppressed").hide();a.find("#savedCardSuppressed").show()}function gb(a){D.paymentRows.find(".installments-list").hide();a.find(".installments-list").show()}function Va(a){D.paymentRows.find(".card-ref-num, .selected-note, .selected-more-payment-option").hide();D.paymentRows.find(".card-benefit").show();a.find(".card-ref-num, .selected-note, .selected-more-payment-option").show();a.find(".card-benefit").hide()}function bb(a){D.paymentRows.find(".otpBlock").hide();
a.find(".otpBlock").show()}function cb(a){D.paymentRows.find(D.ovdWidgetSection).hide();a.find(D.ovdWidgetSection).show()}function Ya(a){D.paymentRows.find(".vcc-info-prompt,.vcc-form-fields").hide();a.find(".vcc-info-prompt,.vcc-form-fields").show()}function Za(a){var b=D.newVDC.find("#vdcBanksSelect"),c=D.newVDC.find(".vdc-selected-bank-prompt").hide(),d=D.newVDC.find("#suppressedVerifiedDebitCard").hide(),e=b.val(),f="1"===L("#save_citi_card").val()?"CIT"!==e:!0,h="1"===L("#save_citi_card").val()&&
"CIT"===e;a.find("#vdcBanksSelect").length?""!==e&&"OtherBanks"!==e&&f&&(D.newVDC.find("option:selected").prop("disabled")?(d.show(),c.hide()):(d.hide(),c.show())):(("OtherBanks"===e||h)&&b.val(b.children("option").first().val()).trigger("change"),c.hide())}function Na(a,b,c){if(!L.isEmptyObject(a)&&b)return b(c)}function $a(a){var b=L("#cash-back-ineligible-for-cod-message");b&&b.length&&((a=a.find("#cashOnDeliveryCash"))&&a.length?b.removeClass("hidden"):b.addClass("hidden"))}function hb(){var a=
L("#imb-wrapper");if(a.length&&a.is(":visible")){var b=a.find(".defaultPaymentMethodExpired"),c=a.find(".codUnavailable"),d=a.find("p").length;0===b.length&&0===c.length||1!==d||a.hide()}}var L=a.$,ab=!0,D={},ib={cardImages:"#newCreditCardImages",continueBtns:".continue-buttons:not(.place-order-button)",continueBtnTop:"#continue-top",continueBtnBottom:"#continue-bottom",continueErrPopover:".continue-button-errors",cvvColumnLabel:"#cvvColumnLabel",existingPaymentForm:"form.checkout-page-form",netBankingSelect:"#net-banking-select-list",
morePaymentMethodsSelect:"#more-payment-methods-select-list",newVDC:"#new-vdc",newEMI:"#newEmiCard",orderSummaryBottom:"#order-summary-bottom",pageContainer:"div.a-container",paymentRows:"#existing-payment-methods .payment-row",rewardsRegister:"#rewards-register",addressChallengeCardList:".address-challenge-card",hiddenFormFields:"#hiddenFormFields",jppoints:"#jppoints",gcpromo:"#gcPromo",disableSubmitButtons:"#disableSubmitButtons",hideInputBoxes:"#hideInputBoxes",showAmexWarning:"#showAmexWarning",
existingPincodeNum:"#existingPincodeNum",mcbBalanceWarning:"#mcbBalanceWarning",installmentsOnlyCards:".installments-only-card",ovdWidgetSection:"#ovdWidgetSection"};a.on("checkout:reload:payselect",Ja);a.on("checkout:reload:spp-payment",Ja);return{getSelectedPayment:K}});"use strict";r.when("A","page-detector").register("wechat-detector",function(a,m){var k=a.$,e=function(a){a&&!1!==a.isWeChatInstalled&&(a=k("#wechat_payment"),a.length&&a.show())},f=function(a){},g="MShopWeChatPayment";a.on("checkout:reload:payselect",
function(){k("#wechat_payment").length&&(k("#mShopWeChatApiName").length&&(g=k("#mShopWeChatApiName").val()),r.when("safe-mash").execute(function(a){q.cordova.require("cordova/exec")(e,f,g,"isWeChatInstalled",[])}))})});"use strict";r.when("A","page-main","client-side-metrics","ready").register("otp-for-cod",function(a,m,k){function e(){y=v("#cashOnDeliveryCash");if(y.length&&(w=y.find(J.verifyOTP),n=y.find(J.sendOTP),r=w.length&&n.length,O=v(J.payMobile).length?1:0,r&&(u=y.find(J.submitSendOTP),
B=y.find(J.submitVerifyOTP),A=y.find(J.submitResendOTP),t=y.find(J.changeOTPNumber),q=y.find(J.OTPPhoneNumber),K=y.find(J.otpCode),u.length&&B.length&&A.length&&t.length))){H=y.find(J.addURLHash).length;k.increaseCount(W.metricPrefix+W.block,1,1);u.click(function(){x();k.increaseCount(W.metricPrefix+W.send,1,1)});B.click(function(){N=q.val();R=K.val();p();var a=g(N);var b=/^\d{6}$/;b=R&&b.test(R);a&&b&&""!==Q?h("VerifyOTP",Q):b?a||y.find(J.otpServiceFailed).removeClass(J.aokHidden):y.find(J.invalidOTPError).removeClass(J.aokHidden);
k.increaseCount(W.metricPrefix+W.verify,1,1)});if(H&&location.hash&&location.hash.length){var a=location.hash;a=a.replace("#","");a=a.split(";");for(var c=0;c<a.length;c++)0<=a[c].indexOf(V.codehandle)&&(Q=a[c].replace(V.codehandle,"")),0<=a[c].indexOf(V.contactid)&&(S=a[c].replace(V.contactid,"")),0<=a[c].indexOf(V.phonenumber)&&(N=a[c].replace(V.phonenumber,""),q.val(N));""!==Q&&""!==S&&""!==N&&b()}A.click(function(){k.increaseCount(W.metricPrefix+W.resend,1,1);x()});t.click(function(){w.addClass(J.aokHidden);
n.removeClass(J.aokHidden);f(A,!1);f(B,!1);p();k.increaseCount(W.metricPrefix+W.changeNumber,1,1)})}}function f(a,b){b?a.addClass(J.aButtonDisabled):a.removeClass(J.aButtonDisabled);O?a.find("button").prop("disabled",b):a.find("input").prop("disabled",b)}function g(a){var b=/^\d{10}$/;return a&&b.test(a)}function l(){y.find(J.otpServiceFailed).removeClass(J.aokHidden)}function b(){var a=y.find(J.verifyOTPPhoneNumber);y.find(J.invalidPhoneNumber).addClass(J.aokHidden);n.hasClass(J.aokHidden)?y.find(J.otpResentSuccess).removeClass(J.aokHidden):
O&&y.find(J.otpSentSuccess).removeClass(J.aokHidden);n.addClass(J.aokHidden);w.removeClass(J.aokHidden);var b=N.substr(0,2)+"*****"+N.substr(7,9);a.text(b);f(A,!1)}function d(a){if(a!==G&&"object"!==typeof a)try{a=v.parseJSON(a)}catch(Y){a={}}a=a||{};var b=H&&location.hash?location.hash:"#";H&&location.hash&&";"!==b.slice(-1)&&(b+=";");var d=a.status;a.codeHandle&&null!==a.codeHandle&&(Q=a.codeHandle,H&&"SEND-SUCCESS"===d&&(b=c(b,V.codehandle,Q)));a.contactId&&null!==a.contactId&&(S=a.contactId,H&&
"SEND-SUCCESS"===d&&(b=c(b,V.contactid,S),b=c(b,V.phonenumber,N)));H&&(location.hash=b);y.find(J.otpAlertClass).addClass(J.aokHidden);if(X[d])X[d]();else X.DEFAULT()}function c(a,b,c){var d=a.indexOf(b);if(0<=d){var e=a.indexOf(";",d);e=0<=e?e:a.length;a=a.substring(0,d)+a.substring(e+1,a.length+1)}return a+b+c+";"}function h(b,c){a.ajax("/gp/buy/payselect/handlers/otpAjaxHandler.html",{method:"get",params:{phoneNumber:N,method:b,codeHandle:c,contactId:S,otp:R},success:d,error:function(){d({status:"SERVICE-FAILED"})}})}
function p(){K.val("");y.find(J.otpAlertClass).addClass(J.aokHidden)}function x(){p();N=q.val();g(N)?h("SendOTP",Q):y.find(J.invalidPhoneNumber).removeClass(J.aokHidden)}var v=a.$,y,w,n,u,B,A,t,q,K,r,O,H,N="",Q="",S="",R="",J={aokHidden:"aok-hidden",aRadio:".a-radio",aButtonHidden:"a-button-hidden",aButtonDisabled:"a-button-disabled",payMobile:".pay-mobile",invalidOTPError:".invalidOTPError",verifyOTP:"#verifyOTP",sendOTP:"#sendOTP",submitSendOTP:"#submitSendOTP",submitVerifyOTP:"#submitVerifyOTP",
submitResendOTP:"#submitResendOTP",changeOTPNumber:"#changeOTPNumber",OTPPhoneNumber:"#OTPPhoneNumber",otpCode:"#otpCode",cashOnDeliveryCash:"#cashOnDeliveryCash",invalidPhoneNumber:".invalidPhoneNumber",otpServiceFailed:".otpServiceFailed",enterOTPLabel:"#enterOTPLabel",reEnterOTPLabel:"#reEnterOTPLabel",maxOTPError:".maxOTPError",numberAlreadyUsed:".numberAlreadyUsed",verifiedOTPSuccess:".verifiedOTPSuccess",verifyOTPPhoneNumber:"#verifyOTPPhoneNumber",otpResentSuccess:".otpResentSuccess",otpSentSuccess:".otpSentSuccess",
otpAlertClass:".otpAlertClass",phonenumberNotVerified:"phonenumberNotVerified",addURLHash:".addURLHash"},V={codehandle:"codehandle:",contactid:"contactid:",phonenumber:"phonenumber:"},W={metricPrefix:"PayPage-COD-OTP-",block:"Block",send:"Send",verify:"Verify",resend:"ReSend",changeNumber:"ChangeNumber"},X={"SERVICE-FAILED":l,"SEND-SUCCESS":b,"VERIFY-SUCCESS":function(){n.addClass(J.aokHidden);w.addClass(J.aokHidden);y.find(J.verifiedOTPSuccess).removeClass(J.aokHidden);y.find("."+J.phonenumberNotVerified).removeClass(J.phonenumberNotVerified);
O&&m.setContinueButtonStatus(!0)},"INVALID-NUMBER":function(){y.find(J.invalidPhoneNumber).removeClass(J.aokHidden)},"NUMBER-ALREADY-USED":function(){f(A,!0);f(B,!0);y.find(J.numberAlreadyUsed).removeClass(J.aokHidden)},"MAX-OTP-REACHED":function(){y.find(J.maxOTPError).removeClass(J.aokHidden);f(A,!0)},"INVALID-OTP":function(){y.find(J.invalidOTPError).removeClass(J.aokHidden);K.val("");O?K.attr("placeholder","Re-enter OTP"):(y.find(J.enterOTPLabel).addClass(J.aokHidden),y.find(J.reEnterOTPLabel).removeClass(J.aokHidden))},
DEFAULT:l};a.on("checkout:reload:payselect",e);a.on("checkout:reload:spp-payment",e)});"use strict";r.when("A","pay-common-util","ready").execute(function(a,m){var k={productGls:"#productGls",gcTypes:"#gcDeliveryTypes",device:"#device"},e=m.getElements(k);a.on("checkout:payment:challenge:log",function(f){var g={},l;for(l in k)k.hasOwnProperty(l)&&e[l]&&e[l].val()&&(g[l]=e[l].val());f&&(g.paymentInstrumentId=f);Object.keys&&Object.keys(g).length&&a.ajax("/gp/buy/payselect/handlers/log-payment-challenge.html?ref_\x3dcheckout-payment-challenge",
{method:"POST",params:g,timeout:1E3,cache:!1})})});"use strict";r.when("A","page-spinner-controller","page-main","page-transition-controller","page-conductor","client-side-metrics","button-blocker","ready").register("pay-auth",function(a,m,k,e,f,g,l){function b(){var a=p("#otp_id").val(),b=/^\d{6}$/;a&&b.test(a)?l.hide("pay-auth-otp-checks"):(a=p("#otp_invalid_msg").val(),l.show("pay-auth-otp-checks",a))}function d(b,c){m.show();a.ajax("validate-otp.html",{method:"post",params:{otp_name:b,paystationRequestId:c},
success:function(a){!a||"APPROVED"!==a.status&&"PENDING"!==a.status?(p("#otp_id").addClass("a-form-error"),p("#otpBadCode").removeClass("hidden"),m.hide()):(p("#isFormValidated").val("1"),v.submit())},error:function(a){m.hide()}})}function c(){p("#otp_id").removeClass("a-form-error");p("#otpBadCode").addClass("hidden")}function h(){g.increaseCount(y.metricPrefix+y.resend,1,1);var b="1"===p("#isPaystationFlow").val();if(b){var c="resend-otp.html?returnHtml\x3d0\x26isPaystationFlow\x3d1";m.show()}else c=
"resend-otp.html?returnHtml\x3d0";a.ajax(c,{method:"get",success:function(a){b&&(a&&1===a.successful&&(p("#authSourceId").val(a.authSourceId),p("#paystationRequestId").val(a.paystationRequestId)),m.hide())},error:function(a){b&&m.hide()}})}var p=a.$,x,v,y={metricPrefix:"Payauth-",resend:"Resend"};a.on("checkout:reload:payauth",function(){x=p("#resend_form");v=p("#otp_form");v.submit(function(a){var b=p(a.currentTarget);if("1"===b.find('input[id\x3d"isPaystationFlow"]').val()&&(c(),"1"!==b.find('input[id\x3d"isFormValidated"]').val()))return a=
b.find('input[id\x3d"otp_id"]').val(),b=b.find('input[id\x3d"paystationRequestId"]').val(),d(a,b),!1});x.submit(function(a){"1"===p("#isPaystationFlow").val()&&c();h();return!1});b();p("#otp_id").unbind("keyup").bind("keyup",b)})});"use strict";r.when("A","ajax-utility","client-side-metrics","loading-spinner-controller","pay-common-lib","pay-common-util","page-conductor","page-transition-controller","quantity-service","weblab-helper").register("pay-gil",function(a,m,k,e,f,g,l,b,d,c){function h(a){q=
a.popover;var b=u(q);A("#gil-estimates-popover-"+b+" .gil-popover-content").html("");A("#gil-estimates-popover-"+b+" .gil-popover-error").html("");a.popover.updatePosition(!0)}function p(a){q=a.popover;var b=u(q),c=A("#gil-estimates-popover-"+b);c.find("input[name\x3dgil-subtype]").val(b);e.showSpinner(c,!1,q);a="/gp/buy/payselect/handlers/get-gil-popover-content.html?cachebuster\x3d"+(new Date).getTime();var d="hasWorkingJavascript\x3d1\x26subtype\x3d"+encodeURIComponent(b);A.ajax({type:"POST",url:a,
data:d,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return m.jsonify(a)},success:function(a,d,f){u(q)===b&&(k.increaseCount("Checkout:GIL:"+b+":IneligiblePopoverSuccess",1),d=q,e.hideSpinner(c),a&&a.errors&&0<a.errors.length?c.find(".gil-popover-error").show():a&&a.widgetHTML?c.find(".gil-popover-content").html(decodeURIComponent(a.widgetHTML)):c.find(".gil-popover-error").show(),d.updatePosition(!0))},error:function(a){u(q)===b&&(k.increaseCount("Checkout:GIL:"+b+":IneligiblePopoverError",
1),a=q,e.hideSpinner(c),c.find(".gil-popover-error").show(),a.updatePosition(!0))}})}function x(a){a.$event.preventDefault();a.$target.closest(".a-popover").find(".a-button-close").trigger("click")}function v(a){a.$event.preventDefault();var f=u(q),h=A("#gil-estimates-popover-"+f);e.showSpinner(h,!1,q);var g=y(a.$currentTarget.parents("#gil-estimates-popover-"+f));e.showSpinner(h,!1,q);d.callBatch(g,{success:function(d,e,h){u(q)===f&&(k.increaseCount("Checkout:GIL:"+f+":SubmitIneligiblePopoverSuccess",
1),x(a),b.show(),1==parseInt(A("input[name\x3d'gil-rendered-using-apx']").val(),10)&&c.isGILCreditCardEnabled()?(d=A(".pmts-select-payment-instrument-form"),e=q,"APX_PSP_TO_RCX_SPC"==(e.attrs?e.attrs("data").onSubmit:e.data.onSubmit)&&d&&0<d.length?l.continueClicked(null,d):k.increaseCount("Checkout:GIL:"+f+"Popover:ErrorRedirectingToSPC",1)):n(f))},error:function(a){u(q)===f&&(k.increaseCount("Checkout:GIL:"+f+":SubmitIneligiblePopoverError",1),a=q,e.hideSpinner(h),h.find(".gil-popover-error").show(),
a.updatePosition(!0))},isTrial:0})}function y(a){var b={};a.find(".gil-ineligible-items").children(".gil-ineligible-item").each(function(a,c){a=A(c).find('input[name^\x3d"ineligible-item"]').val();b[a]=0});return b}function w(a){a.$event.preventDefault();var b=A("#gil-ineligible-"+a.data.subtype).find(".gil-ineligible-items"),c=b.data("index"),d=b.data("size");c=(c+("next"===a.data.direction?1:-1)+d)%d;d=(c+1)%d;b.find(".gil-ineligible-item").addClass("aok-hidden").removeClass("a-span-last");a=b.find("#gil-ineligible-item-"+
c);d=b.find("#gil-ineligible-item-"+d);a.removeClass("aok-hidden");d.addClass("a-span-last").removeClass("aok-hidden");b.data("index",c)}function n(b){g.makeAjaxCall("/gp/buy/payselect/handlers/submit.html",{handler:"new-gil-payment",subtype:b},{successHandler:function(c,d,e){k.increaseCount("Checkout:GIL:"+b+":NewToExistingSuccess",1);l.ajaxUpdatePage(c,d,e);g.scrollTopTo(A("#existing-payment-methods [value\x3d"+b+"]"));if(l.isSPP())a.on("checkout:afterReload",function Q(){A("#existing-gil input[value\x3d"+
b+"]").trigger("click");a.off("checkout:afterReload",Q)});else A("#existing-gil input[value\x3d"+b+"]").trigger("click")},errorHandler:function(a,c,d){k.increaseCount("Checkout:GIL:"+b+":NewToExistingError",1);l.ajaxUpdatePage(a,c,d)}})}function u(a){return a.attrs?a.attrs("data").subtype:a.data.subtype}function B(){t&&(a.declarative("gil-close-popover",["click"],x),a.declarative("gil-submit-popover",["click"],v),a.declarative("gil-ineligible-pagination",["click"],w));A("#gil-cc-payment-type").length&&
(a.off("a:popover:beforeShow:gil-estimates",h),a.off("a:popover:show:gil-estimates",p),a.on("a:popover:beforeShow:gil-estimates",h),a.on("a:popover:show:gil-estimates",p));A("#gil-payment-type").length&&(a.off("a:popover:beforeShow:gil-si-estimates",h),a.off("a:popover:show:gil-si-estimates",p),a.on("a:popover:beforeShow:gil-si-estimates",h),a.on("a:popover:show:gil-si-estimates",p));t=!1}var A=a.$,t=!0,q;a.on("checkout:reload:payselect",B);a.on("checkout:reload:spp-payment",B);return{submitNewGilPayment:n,
displayGILEstimatesMobile:function(a,b,c){var d="/gp/buy/payselect/handlers/get-gil-popover-content.html?cachebuster\x3d"+(new Date).getTime(),e="hasWorkingJavascript\x3d1\x26subtype\x3d"+encodeURIComponent(a);g.makeAjaxCall(d,e,{successHandler:function(c,d,e){var f=m.jsonify(c);f&&!f.errors&&f.widgetHTML?k.increaseCount("Checkout:GIL:"+a+":Mobile:IneligibleSubPageSuccess",1):k.increaseCount("Checkout:GIL:"+a+":Mobile:IneligibleSubPageError",1);b(c,d,e)},errorHandler:function(b){k.increaseCount("Checkout:GIL:"+
a+":Mobile:IneligibleSubPageError",1);c(b)}})},actionCloseGilMobileSubpage:function(a){a.$event.preventDefault();A("#gil-estimates-subpage").remove();A(g.pages.main.pageId).show()},actionSubmitGilMobileSubpage:function(a,b,c){a.$event.preventDefault();A("#gil-ineligible-view");var e=y(a.$currentTarget.parents("#gil-ineligible-view"));d.callBatch(e,{success:function(c,d,e){k.increaseCount("Checkout:GIL:"+a.data.subtype+":Mobile:SubmitIneligibleSubPageSuccess",1);b(c,d,e)},error:function(b){k.increaseCount("Checkout:GIL:"+
a.data.subtype+":Mobile:SubmitIneligibleSubPageError",1);c(b)},isTrial:0})}}});"use strict";r.when("A","ready").register("new-verified-debit-card",function(a){});"use strict";r.when("A").register("apb-limit-messaging-helper",function(a){return{}});"use strict";r.when("A","page-conductor","page-transition-controller","quantity-service").register("rentals-ineligible-util",function(a,m,k,e){function f(a){var b={};a.find(".rentals-ineligible-item").each(function(a,d){a=l(d).find('input[name^\x3d"ineligible-item"]').val();
b[a]=0});return b}function g(){var a=l(".pmts-select-payment-instrument-form");a.attr("data-pmts-ajax-continuation","false");a.submit();k.show()}var l=a.$;return{actionSubmitRentalsIneligibleItemsInSfl:function(a,d,c,h,l){c=f(c);e.callBatch(c,{success:function(){h(a,d);g()},error:function(){l(d)},isTrial:0,ref:"chk_pay_rental_sfl"})},continueWithPaymentMethod:g,toggleButton:function(a,d){d?a.removeClass("a-button-disabled").removeAttr("disabled"):a.addClass("a-button-disabled").attr("disabled","disabled")}}});
"use strict";r.when("A","ajax-utility","client-side-metrics","loading-spinner-controller","pay-common-lib","pay-common-util","rentals-ineligible-util","a-modal").register("rentals-ineligible",function(a,m,k,e,f,g,l,b){function d(a){"undefined"!==typeof b?(t=b.get(a.popover.name),t.update({content:"\x3cdiv id\x3d'rentals-ineligible-popover-loading'\x3e\x3c/div\x3e",height:400,width:600,padding:"none",footer:null})):(t=a.popover,r=a.popover.$popover,t.update("\x3cdiv id\x3d'rentals-ineligible-popover-loading'\x3e\x3c/div\x3e"),
r.find(".a-popover-inner").css("padding","0"),r.find(".a-popover-footer").html(""),r.find(".a-popover-footer").css("width",600),t.updatePosition(!0));c()}function c(){var a=u("#rentals-ineligible-popover-loading");e.showSpinner(a,!1,t);u.ajax({type:"POST",url:"/gp/buy/payselect/handlers/get-rentals-ineligible-content.html?ref_\x3dchk_pay_rentals_ineligible",data:"hasWorkingJavascript\x3d1",dataType:"text",async:!0,cache:!1,dataFilter:m.jsonify,success:function(c,d,f){e.hideSpinner(a);c&&c.widgetHTML?
(k.increaseCount("Checkout:Rentals:RenderIneligiblePopoverDesktopSuccess",1),c=u(g.decodeJSONResponse(c.widgetHTML)),c.find("#no-ineligible-items").length?(t.$popover.find(".a-button-close").trigger("click"),l.continueWithPaymentMethod()):(f=c.find("#rentals-ineligible-popover-footer"),d=f.removeClass("aok-hidden"),f.remove(),A&&(l.toggleButton(d.find("#rentals-ineligible-submit"),!1),l.toggleButton(d.find("#rentals-ineligible-cancel"),!1)),"undefined"!==typeof b?(f=c.find(".rentals-ineligible-item").length,
t.update({content:c.html(),height:2<f?400:0,footer:d.html()}),w()):(t.update(c.html()),r.find(".a-popover-inner").css("padding","0"),r.find(".a-popover-footer").html(d.html()),r.find(".a-popover-footer").css("width",600),t.updatePosition(!0)))):h(a)},error:function(b){h(a)}})}function h(a){k.increaseCount("Checkout:Rentals:RenderIneligiblePopoverDesktopError",1);e.hideSpinner(a);a=u("#rentals-ineligible-content-unavailable-error");"undefined"!==typeof b?t.update({content:a.val(),padding:null,footer:null}):
(t.update(a.val()),r.find(".a-popover-inner").css("padding","100px"),r.find(".a-popover-footer").html(""),r.find(".a-popover-footer").css("width",600),t.updatePosition(!0))}function p(a){a.$event.preventDefault();A=!0;l.toggleButton(u("#rentals-ineligible-submit"),!1);l.toggleButton(u("#rentals-ineligible-cancel"),!1);var b=u("#rentals-ineligible-popover-container");e.showSpinner(b,!1,t);var c=u(".rentals-ineligible");l.actionSubmitRentalsIneligibleItemsInSfl(a,b,c,q,v)}function q(a,b){k.increaseCount("Checkout:Rentals:SubmitIneligibleItemsInSflDesktopSuccess",
1);A=!1;e.hideSpinner(b);y(a)}function v(a){k.increaseCount("Checkout:Rentals:SubmitIneligibleItemsInSflDesktopError",1);A=!1;l.toggleButton(u("#rentals-ineligible-submit"),!0);l.toggleButton(u("#rentals-ineligible-cancel"),!0);u("#rentals-ineligible-sfl-error").removeClass("aok-hidden");e.hideSpinner(a);"undefined"!==typeof b&&w()}function y(a){a.$event.preventDefault();"undefined"!==typeof b?t.hide():t.$popover.find(".a-button-close").trigger("click")}function w(){var a=t.$popover.find(".a-popover-inner").outerHeight(!0),
b=u("#rentals-ineligible-popover-fixed-content").outerHeight(!0);u("#rentals-ineligible-popover-items-container").css("height",a-b)}function n(){B&&(a.declarative("rentals-ineligible-cancel",["click"],y),a.declarative("rentals-ineligible-submit",["click"],p),a.on("a:popover:show:rentals-ineligible-popover",d));B=!1}var u=a.$,B=!0,A=!1,t,r;a.on("checkout:reload:payselect",n);a.on("checkout:reload:spp-payment",n);return{displayRentalsIneligible:function(){u("#rentals-ineligible-popover-trigger").trigger("click")}}});
"use strict";r.when("A").register("payment-marketplace-helper",function(a){return{}});"use strict";r.when("A","cvf","page-detector","weblab-helper","ready").register("cvf-old-amazon-aui-fixes",function(a,m,k,e){function f(){a.$(".cvf-widget-form .a-button-dropdown .a-button-text").css("text-overflow","unset")}function g(){var a=p(this).parent(),b=a.find(".a-native-dropdown option")[0];if(b&&b.hasAttribute("data-a-html-content")){var c=[];a.find(".cvf-widget-input.a-native-dropdown option").each(function(){c.push({phone_country_code:p(this).data("a-html-content"),
country_iso:p(this).val()})});var d=setInterval(function(){if(p(".a-popover-inner ul").length){var a="rtl"===p("html").attr("dir");p(".a-popover-inner ul").addClass("a-cvf-list-link");p.each(c,function(b,c){if(b=c.phone_country_code){if(a){b=b.split("+");var d=b[1];b=b[0].trim()+" "+d+"+"}p(".a-popover-inner [data-value\x3d'"+c.country_iso+"']").html(b)}});clearInterval(d)}},0)}p(".cvf-widget-form .a-button-dropdown").die("click")}function l(){var a=p(this).data("value");p(".cvf-widget-form .a-native-dropdown.cvf-widget-input").val(a).change()}
function b(){var a=p(this).parent().find(".a-dropdown-prompt"),b=p(this).find("option:selected").html().trim(),c=setTimeout(function(){a.html(b);clearTimeout(c)},0)}function d(){a.$(".cvf-widget-form .a-alert-inline.cvf-hidden").remove()}function c(){0===p(".cvf-widget-form").length&&(p("#apx-content .a-alert-info").first().remove(),p("[data-testid\x3d'pmts-cod-cash-description']").closest(".pmts-portal-component").find(".a-radio input").trigger("click"))}function h(){if(!x)if(v)a.on("a:pageUpdate a:ajax:complete",
d);else a.on("a:pageUpdate a:ajax:complete",f),p(".cvf-widget-form .a-button-dropdown").live("click",g),p(".a-cvf-list-link a").live("click",l),p(".cvf-widget-input.a-native-dropdown").live("change",b);a.on("cvf:verification:complete",c)}var p=a.$,x=k.isMobile(),v=q.P&&q.P.AUI_BUILD_DATE;e.isCvfOldAmazonUiFixesEnabled()&&(a.on("checkout:reload:payselect",h),a.on("checkout:reload:spp-payment",h))});r.when("A","checkout-general-utils","page-detector","ready").execute("updp-controller",function(a,m,
k){a.on("checkout:reload:pip",function(){var e=a.$,f=m.isChewbaccaUrl(document.location.pathname),g=!k.isMobile();f&&g&&(e(".prime-checkout-continue-link").removeClass("checkout-continue-link"),e(".prime-checkout-continue-form").removeClass("checkout-page-form"))})});"use strict";r.when("A","page-detector").register("alipay-detector",function(a,m){var k=a.$,e=function(){var a=k("input[name\x3d'isAlipayAppPayment']");0<a.length&&m.isMobileSpc&&a.val("1")},f=function(a){},g=function(){var a=k("input[name\x3d'isAlipayRedirect']");
0<a.length&&m.isMobileSpc&&a.val("1")},l=function(a){};a.on("checkout:reload:spc",function(){k("input[name\x3d'isAlipayAppPayment']").length&&r.when("safe-mash").execute(function(a){a=q.cordova.require("cordova/exec");a(e,f,"AlipayPlugin","isAlipayInstalled",[]);k("input[name\x3d'isAlipayRedirect']").length&&a(g,l,"AlipayPlugin","isAlipayFailReturnSupported",[])})})});"use strict";r.when("A","page-transition-controller","page-detector").execute(function(a,m,k){function e(){var a=f("#backButtonProtection");
a.length&&"1"===a.val()&&(m.showPageTransition(),document.location.reload())}var f=a.$;r.register("back-button-protection",function(){return{markAsDirty:function(){f("#backButtonProtection").val(1)}}});a.on("checkout:reload:spc",e);a.on("checkout:reload:spp-revieworder",e)});"use strict";r.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics","delivery-preferences-csm-helper").register("delivery-preferences-controller",
function(a,m,k,e,f,g,l,b,d){function c(){var a=n.find("input[name\x3dpreference]:checked").val(),b=n.find("select[name\x3dSafePlaceLocation]");"NeighborDelivery"===a?(n.find("input[name\x3dneighbor-name]").removeAttr("disabled").removeClass("a-form-disabled"),n.find("input[name\x3dneighbor-house]").removeAttr("disabled").removeClass("a-form-disabled"),f.isSPP()?r.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"disabled"})}):b.attr("disabled","disabled").closest(".a-button").addClass("a-button-disabled"),
n.find(".safe-place-error").hide()):"SafePlaceDelivery"===a?(f.isSPP()?r.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"enabled"})}):b.removeAttr("disabled").closest(".a-button").removeClass("a-button-disabled"),n.find("input[name\x3dneighbor-name]").attr("disabled","disabled").addClass("a-form-disabled"),n.find("input[name\x3dneighbor-house]").attr("disabled","disabled").addClass("a-form-disabled"),n.find(".neighbor-name-error").hide(),n.find(".neighbor-house-error").hide()):
(n.find("input[name\x3dneighbor-name]").attr("disabled","disabled").addClass("a-form-disabled"),n.find("input[name\x3dneighbor-house]").attr("disabled","disabled").addClass("a-form-disabled"),f.isSPP()?r.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"disabled"})}):b.attr("disabled","disabled").closest(".a-button").addClass("a-button-disabled"),n.find(".neighbor-name-error").hide(),n.find(".neighbor-house-error").hide(),n.find(".safe-place-error").hide());h(!0)}function h(a){var b=
n.find("input[name\x3dpreference]:checked").val();n.find(".safe-place-error").hide();n.find(".neighbor-name-error").hide();n.find(".neighbor-house-error").hide();n.find("input").removeClass("a-form-error");n.find("div.a-input-text-wrapper").removeClass("a-form-error");n.find("select").closest(".a-button").removeClass("a-button-error");0<w("div.spc-tablet").length?n.find(".set-delivery-preferences-button").removeClass("a-button-disabled"):n.find(".set-delivery-preferences-button").show();n.find(".save-disabled").hide();
n.find(".current-blocker-content").text("");var c=!1;if("NeighborDelivery"===b){var d=n.find("input[name\x3dneighbor-name]");d.data("defaultValueRemoved")&&d.val()||(n.find(".neighbor-name-error").show(),d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),n.find(".current-blocker-content").html(n.find(".neighbor-name-error-text").text()),c=!0);d=n.find("input[name\x3dneighbor-house]");d.data("defaultValueRemoved")&&d.val()||(n.find(".neighbor-house-error").show(),
d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),n.find(".current-blocker-content").html(n.find(".neighbor-house-error-text").text()),c=!0)}else"SafePlaceDelivery"===b&&(d=n.find("select[name\x3dSafePlaceLocation]"),d.val()||(n.find(".safe-place-error").show(),d.closest(".a-button").addClass("a-button-error"),n.find(".current-blocker-content").html(n.find(".safe-place-error-text").text()),c=!0));d=w("#disableSaveBtnWhenNoDeliveryPrefSelected").val();if(a&&c||
"true"===d&&b===G)0<w("div.spc-tablet").length?n.find(".set-delivery-preferences-button").addClass("a-button-disabled"):n.find(".set-delivery-preferences-button").hide(),n.find(".save-disabled").show();return!c}function p(a){a&&a.$event&&a.$event.preventDefault();a="hasWorkingJavascript\x3d1\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26";var c="",g=n.find(".popover-deliv-prefs-content");g.data("obfuscatedEntityId")?c=g.data("obfuscatedEntityId"):n.data("obfuscatedEntityId")&&
(c=n.data("obfuscatedEntityId"));a+="obfuscatedEntityId\x3d"+c+"\x26";c=n.find("input[name\x3dpreference]:checked").val();""!==c&&(a+="prefDelLocation\x3d"+c+"\x26","NeighborDelivery"===c?(a+="neighborName\x3d"+encodeURIComponent(n.find("input[name\x3dneighbor-name]").val())+"\x26",a+="houseNo\x3d"+encodeURIComponent(n.find("input[name\x3dneighbor-house]").val())+"\x26"):"SafePlaceDelivery"===c&&(a+="safePlaceLocation\x3d"+n.find("select[name\x3dSafePlaceLocation]").val()+"\x26"),c=n.find("input[name\x3ddefaultPreference]:checked").val(),
c!==G&&""!==c&&(a+="isDefaultPreference\x3d1"));0<w("div.spc-tablet").length?m.show():k.showSpinner(n.find(".popover-deliv-prefs-content"),!1,u);d.recordCSMWithCurrentFieldValues("popover-submitted","preference","defaultPreference");w.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-delivery-preference.html",data:a,dataType:"text",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},success:function(a,
c,d){B=!0;0<w("div.spc-tablet").length?m.hide():k.hideSpinner(n.find(".popover-deliv-prefs-content"));d.getResponseHeader("x-amz-checkout-page")?(n.find(".a-button-close").trigger("click"),f.ajaxUpdatePage(a,c,d)):(a=e.jsonify(a),f.redirect(a));b.increaseCount("checkoutSpcDeliveryPref-save",1)},error:function(a,b,c){0<w("div.spc-tablet").length?m.hide():k.hideSpinner(n.find(".popover-deliv-prefs-content"));h(!0)}})}function q(){n.find("input[name\x3d'neighbor-name'], input[name\x3d'neighbor-house']").unbind("focus").bind("focus",
function(){if(!w(this).data("defaultValueRemoved")){if(l.isMobileSpc()||l.isDesktopSpc())w(this).val(""),w(this).css("color","black");w(this).data("defaultValueRemoved",!0)}}).each(function(){(l.isMobileSpc()||l.isDesktopSpc())&&w(this).data("defaultValueRemoved")&&w(this).css("color","black")});n.find("input:radio[name\x3dpreference]").unbind("click").bind("click",c);n.find("input[name^\x3dneighbor]").unbind("keyup").bind("keyup",function(){h(!1)});0<w("div.spc-tablet").length?n.find("select[name\x3dSafePlaceLocation]").unbind("change").bind("change",
v):n.find("select[name\x3dSafePlaceLocation]").unbind("change").bind("change",function(){h(!1)})}function v(a){h(!0)&&p(a)}function y(a){var b=w("#spc-orders .delivery-preferences-options"),c="";if(a){var d=a.$currentTarget.find("input");c=b.find("input[name\x3dpreference]:checked").val()}else d=b.find("input[name\x3dpreference]:checked");b=d.val();if(c!==b){n.find(".expand-content").hide();c=d;var e=c.closest(".delivery-preferences-options");e.find("i.a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");
e.find("input").attr("checked",!1);c.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");c.attr("checked",!0);"NeighborDelivery"===b||"SafePlaceDelivery"===b?d.closest(".deliverypreference-option").siblings(".expand-content").show():a&&p(a)}}var w=a.$;if(!w("html").hasClass("a-ie6")){var n,u,B;a.on("a:popover:beforeShow",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-delivprefs")&&(a.popover.$popover.find(".a-popover-inner").html(n.find(".current-blocker-content").text()),
a.popover.updatePosition())});a.on("a:popover:show",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(b.increaseCount("checkoutSpcDeliveryPref-open",1),u=a.popover,n=u.$popover,B=!1,q(),d.recordCSMWithCurrentFieldValues("popover-displayed","preference","defaultPreference"),c(),n.find("select").trigger("change"))});a.on("a:popover:dismiss",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(B||b.increaseCount("checkoutSpcDeliveryPref-dismissed",
1))});a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(B||d.recordCSM("popover-dismissed"))});a.declarative("delivery-preferences-switch-tablet",["click"],function(a){y(a)});a.declarative("delivery-preferences-expander-toggle",["click"],function(a){g.toggleExpanderContent(a)});a.declarative("set-delivery-preferences",["click","touchend"],function(a){a.$event.preventDefault();g.protectAgainstDoubleAction("set-delivery-preferences")||h(!0)&&p()});
a.declarative("delivery-preferences-set-default-checkbox-triggered","change",function(a){(a=n.find("#delivery-preferences-set-default-checkbox"))&&1===a.length&&(a.prop("checked")?b.increaseCount("checkoutSpcDeliveryPref-setAsDefault",1):b.increaseCount("checkoutSpcDeliveryPref-setAsTemporary",1))});a.on("checkout:reload:spc",function(){l.isTabletSpc()&&(n=w("#spc-orders .delivery-preferences-options"),y(),n.find("select").trigger("change"),q())})}});"use strict";r.when("A","page-detector","time-left-formatter",
"weblab-helper").register("fast-track-controller",function(a,m,k,e){function f(){for(var b in q)q[b]&&clearInterval(q[b]);a.defer(g)}function g(){h.DAY=c("#fasttrack-day").html();h.DAYS=c("#fasttrack-days").html();h.HOUR=c("#fasttrack-hour").html();h.HOURS=c("#fasttrack-hours").html();h.AND=c("#fasttrack-and").html();h.MINUTE=c("#fasttrack-minute").html();h.MINUTES=c("#fasttrack-minutes").html();h.SECOND=c("#fasttrack-second").html();h.SECONDS=c("#fasttrack-seconds").html();(c("#isfresh").length&&
c(".checkout.spc-mobile").length||c("#lazy-fresh-promise-delivery-message").length?c("#spc-form"):c("#spc-orders")).find(".fasttrack-span").each(function(){var b=c(this),d=b.find("input[name\x3d'countdownId']").val();p[d]=parseInt(b.find("input[name\x3d'fasttrackExpiration']").val());v[d]=a.now()/1E3+p[d];l(b.find("input[name\x3d'countdownThreshold']").val(),b,b.find("input[name\x3d'showSimplifiedCountdown']").val(),d);b.show()})}function l(a,c,e,f){0>=p[f]?d(c,null):a&&0<a&&p[f]>a?c.find("span.fasttrackavailable").hide():
(b(c,e),q[f]=setInterval(function(){b(c,e,f)},1E3))}function b(b,e,f){0<p[f]?(p[f]=Math.round(v[f]-a.now()/1E3),e=k.getTimeLeftFormatted(p[f],1===e||"1"===e?!0:!1,h),c("html").hasClass("a-tablet")?b.find("span[data-field\x3d'fasttrackcountdown']").html("\x26nbsp;"+e):b.find("span[data-field\x3d'fasttrackcountdown']").html(e),b.find("span.fasttrackexpired").hide(),b.find("span.fasttrackcountdown").show(),b.find("span.fasttrackavailable").show()):d(b,f)}function d(a,b){b?(q[b]&&clearInterval(q[b]),
a.find("span.fasttrackavailable").hide(),a.find("span.fasttrackexpired").show()):clearInterval(q[b])}var c=a.$;if(!c("html").hasClass("a-ie6")){var h={},p={},q={},v={};a.on("checkout:reload:spc",f);a.on("checkout:reload:spp-revieworder",f);return{spcLiteLazyLoadFastTrack:function(){f()}}}});"use strict";r.when("A","page-transition-controller","ajax-utility","page-conductor","client-side-metrics").register("gc-redeem-controller",function(a,m,k,e,f){function g(a){if(!x){a.preventDefault();p(a.currentTarget);
var b;0<p("#spc-gcpromoinput").length&&(b=encodeURIComponent(p("#spc-gcpromoinput").val()));0<p("#gc-promo-input").length&&(b=encodeURIComponent(p("#gc-promo-input").val()));var c=encodeURIComponent(p("#spc-usePromoOnly").val());if(b&&0!==b.length){var f=encodeURIComponent(p("input[name\x3dpurchaseTotal]").val());p("#gc-error").hide();p("#gc-promo-success").hide();p("#gc-success").hide();p("#gc-ineligible").hide();p("#promo-success").hide();e.isSPP()?(m.blockAllActions(),m.showTransitionInContainer(p("#payment"))):
m.show();var h=(new Date).getTime();a="/gp/buy/spc/handlers/add-giftcard-promotion.html/ref\x3dox_pay_page_gc_add";p(".checkout.spc.aui-templatized").length&&(a="/gp/buy/spc/handlers/add-giftcard-promotion.html/ref\x3dox_spc_gc_add");b="purchaseTotal\x3d"+f+"\x26claimcode\x3d"+b+"\x26disablegc\x3d"+c+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+p("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+h;c=e.setAjaxTransitionHeader({"Cache-Control":"no-cache",
pragma:"no-cache","x-amz-checkout-page":"spc"});p.ajax({type:"POST",url:a,data:b,headers:c,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",complete:function(){x=!1},success:l,error:e.ajaxRedirect});x=!0}else d("addGiftCardOrPromo_NoCode")}}function l(a,f,h){var g=h.getResponseHeader("x-amz-checkout-page");if(g){if(e.ajaxUpdatePage(a,f,h),"spc"===g||"spclite"===g||"spp-revieworder"===g)(a=parseInt(p("#checkoutDisplayPage").data("delaySetTitle"),10)||parseInt(p("#gc-promo-delay").data("egcDelayUpdateRedemptionMessage"),
10)||0)?setTimeout(function(){b(h)},a):b(h)}else{a=k.jsonify(a);if(!a)return e.redirect();if(a.error)return d(a.error);if(a.errors)return d(a.errors);if(a.autohandlererror)return c(a.autohandlererror);e.redirect(a)}}function b(a){var b=a.getResponseHeader("x-updated-promo-type");a=a.getResponseHeader("x-updated-gc-applied-but-ineligible");b&&(a||p("#gc-promo-success").show(),0<p("div.spc-desktop").length?(p("#spc-gcpromoinput").removeClass("a-form-error"),p("#gc-promo-input").removeClass("a-form-error")):
(p("#spc-gcpromoinput").closest(".a-input-text-wrapper").removeClass("a-form-error"),p("#gc-promo-input").closest(".a-input-text-wrapper").removeClass("a-form-error")),"giftcard"===b?(h("applied"),a?(p("#gc-ineligible").show(),h("gcIneligible")):p("#gc-success").show()):p("#promo-success").show())}function d(a){m.hide();p("#gc-error p").hide();p("#gc-error").show();h("error");0<p("div.spc-desktop").length?(p("#spc-gcpromoinput").addClass("a-form-error"),p("#gc-promo-input").addClass("a-form-error")):
(p("#spc-gcpromoinput").closest(".a-input-text-wrapper").addClass("a-form-error"),p("#gc-promo-input").closest(".a-input-text-wrapper").addClass("a-form-error"));p(0<p("#gc-promo-input").length?"."+v[a]:"#"+a).show()}function c(a){if(a){var b=a.action,c="/gp/buy/payselect/handlers/error.html?errorType\x3d"+encodeURIComponent(a.type?a.type:b&&b.code?b.code:"string"===typeof a?a:"Unknown:pipelineJSError");"fatal"===b?c+="\x26errorAction\x3dfatal":"redirect"===b&&(a.url?c=a.url:"cart"===a.page&&(c="/gp/cart/view.html"));
q.location.href=c}else q.location.href="/gp/buy/payselect/handlers/error.html?errorType\x3dUnknown:pipelineJSError"}function h(b){var c=a.state("cxt-gc-redemption-method").method;f.increaseCount("rcxGCRedeem:"+c+":"+b,1)}var p=a.$,x=!1;if(!p("html").hasClass("a-ie6")){a.state("cxt-gc-redemption-method",{method:"type"});var v={addGiftCardOrPromo_Unknown:"UNKNOWN",addGiftCardOrPromo_NoCode:"NO_CODE",addPromo_InvalidForPurchase:"PROMO_INVALID_FOR_PURCHASE",addPromo_BadCode:"PROMO_BAD_CODE",addPromo_ExpiredCode:"PROMO_EXPIRED_CODE",
addPromo_InvalidForOrgUnit:"PROMO_INVALID_FOR_ORG_UNIT",addPromo_OfferNotYetBegun:"USED_BEFORE_START_DATE",addPromo_AlreadyRedeemed:"PROMO_ALREADY_REDEEMED",addGiftCard_AlreadyRedeemedByAnotherAccount:"GC_ALREADY_REDEEMED_BY_ANOTHER_ACCOUNT",addGiftCard_AlreadyRedeemedByThisAccount:"GC_ALREADY_REDEEMED_BY_THIS_ACCOUNT",addGiftCard_BadCode:"GC_BAD_CODE",addGiftCard_ExpiredCode:"GC_EXPIRED_CODE",addGiftCard_Cancelled:"CANCELLED_CODE",addGiftCard_WrongOrgUnit:"GC_WRONG_ORG_UNIT",addGiftCard_ServiceDown:"GC_SERVICE_DOWN",
addGiftCard_InvalidForAGS:"GC_INVALID_FOR_AGS",addGiftCard_PassedClaimByDate:"PASSED_CLAIM_BY_DATE",addGiftCard_OfferNotYetBegun:"GC_NOT_YET_BEGUN",addGiftCard_ExceededMaxLimit:"GC_EXCEED_MAX_LIMIT",addGiftCard_Disabled:"GC_DISABLED",addGiftCard_OTP_Required:"GC_OTP_REQUIRED",addGiftCard_SEVIS_Decline:"GC_SEVIS_DECLINE",addGiftCard_OCRAH_Decline:"GC_OCRAH_DECLINE",addGiftCard_DEFAULT_Message:"GC_DEFAULT_MESSAGE"};a.declarative("gc-element",["click"],function(a){var b=a.data.click;b&&null!==b&&g(a.$event)});
a.on("a:expander:redeem-gc-expander:toggle:expand",function(a){f.increaseCount("checkout:spp-payment:expand_addgc_coll",1)});p(document).delegate("#spc-gcpromoinput, #gc-promo-input","keypress",function(a){13===a.which&&g(a)});return{actionAddGiftPromotion:g,giftSystemErrorHandling:c}}});"use strict";r.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics","gift-utility","weblab-helper").register("gift-popover-controller",
function(a,m,k,e,f,g,l,b,d,c){function h(){var a=I;a.find("#select-recipient").empty();for(var b=0;b<fa.length;b++){var c=C("\x3coption/\x3e").attr({value:fa[b].value}).text(fa[b].text);a.find("#select-recipient").append(c)}oa&&(b=a.find('#select-recipient option[value\x3d"'+oa+'"]').attr("selected","selected"),a.find("#select-recipient").closest("#popover-gift-connection-recipient").find(".a-placeholder").text(b.text()),Z())}function p(){a.defer(function(){C("#spc-orders").find(".gift-popover-link").each(function(){C(this).data("action")&&
C(this).removeAttr("href").attr("tabindex",0)})});C(".larger-image-link").find("a").removeAttr("href")}function x(a){var b=I;b.find(".gift-error-box").hide();b.find(".fake-label").each(function(){C(this).unbind("click").bind("click",function(){C(this).closest(".popover-checkbox").find("input").trigger("click")})});a&&a.item&&a.item.title&&b.find(".popover-gift-top .gift-item-title span").html(a.item.title);a&&a.item&&a.item.isAutoripEligible?b.find("#gift-autorip-unavailable-msg").show():b.find("#gift-autorip-unavailable-msg").hide();
if(a&&a.obfuscatedEntityId){var c=b.find(".set-gift-options-button input");c.unbind("click").bind("click",{obfuscatedentityid:a.obfuscatedEntityId,giftData:a},v);g.bindActionEnterKeyOnButton(c)}la?(da=a&&a.item&&a.item.isAmazonFulfilled,na=!(a&&a.address&&0===a.address.shipToSelf),da&&(a&&a.options&&a.options.canHaveMessage||a&&a.options&&a.options.canBeWrapped)?(n(!0),b.find(".mfn-hide-prices").hide(),b.find(".include-gift-receipt").show()):da||(n(!0),b.find(".include-gift-receipt").hide(),b.find(".mfn-hide-prices").show(),
b.find(".include-gift-message").show()),wa=b.find(".include-gift-message").is(":visible"),M()):a&&a.options&&a.options.canHidePrices?b.find(".hide-prices-checkbox").closest("div").show():b.find(".hide-prices-checkbox").closest("div").hide();a&&a.selected&&(c=F(b.find(".hide-prices-checkbox")),a.selected.hidePrices?c.attr("checked",!0):c.removeAttr("checked"));if(a&&a.item&&a.item.purchaseIsKindle){if(c=b.find(".kindle-registration-box"),c.show(),c.find(".register-kindle-customer-name").html(b.find(".gift-customer-name").html()),
!la){c=F(b.find(".kindle-reg-radio-another-account"));var e=F(b.find(".kindle-reg-radio-your-account"));a.selected.hidePrices||a.selected.isWrapped?(e.removeAttr("checked"),c.attr("checked",!0)):(c.removeAttr("checked"),e.attr("checked","checked"));F(b.find(".hide-prices-checkbox")).trigger("change")}}else b.find(".kindle-registration-box").hide();if(a&&a.options&&a.options.canHaveMessage){a&&a.selected&&(c=a.selected.message,e=F(b.find(".include-gift-message-checkbox")),c&&c.length?(b.find("textarea[name\x3d'gift-message-text']").val(c),
B(!0)):null===c&&(a.selected.isWrapped||a.selected.hasReceipt)?(e.removeAttr("checked"),b.find(".textarea[name\x3d'gift-message-text']").val("")):(b.find("textarea[name\x3d'gift-message-text']").val(""),c="",la?(c+=b.find(".sample-gift-msg-greeting").html(),a&&a.address&&a.address.firstName&&!na&&(c+=" "+a.address.firstName),c=c+",\n"+b.find(".sample-gift-msg").html(),c+="\n"):(c+=b.find(".sample-gift-msg").html(),c+="\n\n"),c+=b.find(".sample-gift-msg-from").text(),c=la?c+d.getNameWithNoTitle(b.find(".gift-customer-name").html()):
c+d.getFirstName(b.find(".gift-customer-name").html()),b.find("textarea[name\x3d'gift-message-text']").val(c),!la||na&&wa||B(!0)));var f=C(".gift-message-warning").length;c=function(){la&&B(!0);H(a.options.maxMessageChars,a.options.maxMessageLines,a.options.hasFixedGiftMsgLimit);if(f){var b=I.find("textarea[name\x3d'gift-message-text']");d.toggleGiftMessageWarning(b,I)}};if(a&&a.options){var l=b.find("textarea[name\x3d'gift-message-text']");l.bind("keyup",c);l.bind("mouseup",c);H(a.options.maxMessageChars,
a.options.maxMessageLines,a.options.hasFixedGiftMsgLimit);f&&d.toggleGiftMessageWarning(l,b);F(b.find(".include-gift-message-checkbox")).bind("change",function(){var c=C(this).is(":checked"),e=a.options.maxMessageChars,h=a.options.maxMessageLines,g=a.options.hasFixedGiftMsgLimit,k=I,m=k.find("textarea[name\x3d'gift-message-text']");c?la&&t():(0<k.find(".validateInputCharactersOnBlur.a-form-error").size()&&(k.find(".validateInputCharactersOnBlur.a-form-error").removeClass("a-form-error"),0<k.find("#onblur-character-validation-error-gift-message-text").size()&&
k.find("#onblur-character-validation-error-gift-message-text").remove()),la?M():(m.val(""),H(e,h,g)));f&&d.toggleGiftMessageWarning(l,b)})}}else b.find(".popover-gift-message-text").css("visibility","hidden"),b.find(".include-gift-message").css("visibility","hidden"),la&&(b.find(".include-gift-message").hide(),b.find(".popover-gift-message").css("visibility","hidden")),b.find(".popover-gift-message-not-available").show();a&&a.options&&!a.options.canBeWrapped?(b.find(".wrap-option").hide(),b.find(".popover-gift-no-wrap-available").show(),
b.find(".hide-prices-amazon-msg").hide(),b.find(".hide-prices-note").hide(),b.find(".hide-prices-merchant-msg").show(),F(b.find(".hide-prices-checkbox")).attr("disabled",!1)):a&&a.item&&a.item.isAmazonFulfilled?(b.find(".wrap-option").hide(),b.find(".popover-gift-fba-wrap").show(),b.find(".hide-prices-amazon-msg").show(),b.find(".hide-prices-merchant-msg").hide(),(c=a.options.wraps[0].imageurl)&&0<c.length&&(b.find(".large-preview").find("img").attr("src",c),b.find(".large-preview").show(),b.find(".fba-wrap-checkbox").show(),
e=b.find(".larger-image-link"),e.unbind("click").bind("click",{imageURL:c},N),g.bindActionEnterKeyOnButton(e)),a.options.wraps[0].description&&b.find(".gift-wrap-title").show().html(a.options.wraps[0].description),"1"===C("#multipleAFNGiftWrapOption").val()?a.options&&a.options.wraps&&1<=a.options.wraps.length&&(c=b.find(".popover-gift-amazon-wrap"),r(b,c),ha(a,"afn",c)):a.options&&a.options.wraps&&1===a.options.wraps.length?(b.find(".popover-gift-amazon-wrap").hide(),b.find(".popover-gift-merchant-wrap").hide(),
b.find(".fba-wrap-checkbox .gift-wrap-price").html(a.options.wraps[0].price),e=F(b.find(".amazon-gift-wrap")),e.val(a.options.wraps[0].id),c=F(b.find(".hide-prices-checkbox")),a.selected.isWrapped?(e.attr("checked",!0),a.item.purchaseIsKindle||(c.attr("checked",!0),c.attr("disabled",!0),b.find(".hide-prices-note").show())):(e.removeAttr("checked"),c.attr("disabled",!1),b.find(".hide-prices-note").hide())):a.options&&a.options.wraps&&1<a.options.wraps.length&&(c=b.find(".popover-gift-amazon-wrap"),
r(b,c),U(a,"afn",c))):(b.find(".wrap-option").hide(),F(b.find(".hide-prices-checkbox")).removeAttr("disabled"),b.find(".hide-prices-amazon-msg").hide(),b.find(".hide-prices-note").hide(),b.find(".hide-prices-merchant-msg").show(),b.find(".large-preview").hide(),c=b.find(".popover-gift-merchant-wrap").show(),c.find(".mfn-wrap-copy").remove(),U(a,"mfn",c));la&&(P(),O(),K());if(0<C(".enable-gift-connections").length){b.find("#popover-gift-connection select.a-touch-select-input").each(function(){C(this).unbind("change").bind("change",
function(){var a=C(this),b=a.siblings("a.a-placeholder");a=a.find(":selected").text();b.text(a);return!1})});b.find("#select-recipient").bind("change",function(a){ca(a);return!1});b.find("#select-occasion").bind("change",function(a){ba(a);return!1});b.find("#input-recipient-first-name").keyup(function(){Z()});b.find("#input-recipient-last-name").keyup(function(){Z()});b.find("#popover-gift-connection-recipient").unbind("click").bind("click",function(a){a=I;ka||a.find("#select-recipient-spinner").show()});
oa=G;if(a.giftConnection){typeof a.giftConnection.giftlistTypeId!==G&&"0"===a.giftConnection.giftlistTypeId&&typeof a.giftConnection.occasionId!==G&&"0"===a.giftConnection.occasionId&&b.find("#include-gift-connection-checkbox").attr("checked",!1);a.giftConnection.firstName&&b.find("#input-recipient-first-name").val(a.giftConnection.firstName);a.giftConnection.lastName&&b.find("#input-recipient-last-name").val(a.giftConnection.lastName);if("1"===a.giftConnection.giftlistTypeId||"2"===a.giftConnection.giftlistTypeId)c=
b.find('#select-recipient option[value\x3d"'+a.giftConnection.giftlistTypeId+'"]').attr("selected","selected"),b.find("#select-recipient").closest(".a-button-inner").find(".a-placeholder").text(c.text()),b.find(".gift-connection-recipient-extra").show();if(a.giftConnection.giftlistId&&"0"!==a.giftConnection.giftlistId)oa=a.giftConnection.giftlistId;else if("0"===a.giftConnection.giftlistTypeId||"1"===a.giftConnection.giftlistTypeId||"2"===a.giftConnection.giftlistTypeId)oa=a.giftConnection.giftlistTypeId;
a.giftConnection.occasionId&&(c=b.find('#select-occasion option[value\x3d"'+a.giftConnection.occasionId+'"]').attr("selected","selected"),b.find("#select-occasion").closest(".a-button-inner").find(".a-placeholder").text(c.text()));a.giftConnection.occasionMonth&&(c=b.find('#select-occasion-month option[value\x3d"'+a.giftConnection.occasionMonth+'"]').attr("selected","selected"),b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(c.text()));a.giftConnection.occasionDay&&
(c=b.find('#select-occasion-day option[value\x3d"'+a.giftConnection.occasionDay+'"]').attr("selected","selected"),b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(c.text()));a.giftConnection.age&&(c=b.find('#select-occasion-age option[value\x3d"'+a.giftConnection.age+'"]').attr("selected","selected"),b.find("#select-occasion-age").closest(".a-button-inner").find(".a-placeholder").text(c.text()));if("1"===a.giftConnection.occasionId||"2"===a.giftConnection.occasionId)b.find(".gift-connection-occasion-extra").show(),
"2"===a.giftConnection.giftlistTypeId&&b.find("#select-occasion-age-row").show();a.giftConnection.hasReminder&&"0"===a.giftConnection.hasReminder&&b.find("#occasion-has-reminder-checkbox").attr("checked",!1)}(!a.giftConnection||typeof a.giftConnection.occasionId===G||"1"!==a.giftConnection.occasionId&&"2"!==a.giftConnection.occasionId&&"3"!==a.giftConnection.occasionId)&&Z();fa&&(typeof oa!==G||a.registryId in va)?(typeof oa===G&&(oa=va[a.registryId]),h(),b.find("#select-recipient").show(),b.find("#select-recipient-spinner").hide(),
ka=!0):(ka=!1,typeof oa!==G?ia():ia(a.registryId))}I.find(".content-container").css("visibility","visible");ra.updatePosition(!0);k.hideSpinner(b.find(".popover-content-main"))}function v(a){var b=I,c="";if(!(0<b.find(".validateInputCharactersOnBlur.a-form-error").size())){a&&a.data&&a.data.obfuscatedentityid&&(c+="obfuscatedEntityId\x3d"+a.data.obfuscatedentityid+"\x26");da&&(c+="isAFN\x3d1\x26");F(b.find(".include-gift-receipt-checkbox")).is(":checked")&&(c+="includeReceipt\x3d1\x26");F(b.find(".include-gift-message-checkbox")).is(":checked")?
(c+="includeMessage\x3d1\x26message\x3d"+encodeURIComponent(b.find("textarea[name\x3d'gift-message-text']").val())+"\x26",c+="maxChars\x3d"+a.data.giftData.options.maxMessageChars+"\x26",c+="maxLines\x3d"+a.data.giftData.options.maxMessageLines+"\x26"):c+="includeMessage\x3d0\x26";c=F(b.find(".hide-prices-checkbox")).is(":checked")?c+"hidePrices\x3d1\x26":c+"hidePrices\x3d0\x26";b.find(".kindle-registration-box").is(":visible")&&(c+="isKindlePurchase\x3d1\x26");var d;if(b.find(".popover-gift-fba-wrap").is(":visible"))if(b.find(".popover-gift-amazon-wrap").is(":visible")){if((d=
b.find("input[name\x3d'afn-gift-wrap']:checked").eq(0).val())&&d.length)for(c+="giftWrap\x3d"+d+"\x26",d=0;d<a.data.giftData.options.wraps.length;d++)if(b.find(".popover-gift-amazon-wrap").find(".afn-wrap-"+d).is(":checked")){c+="currencyAmount\x3d"+a.data.giftData.options.wraps[d].priceAmount+"\x26";c+="currencyUnit\x3d"+a.data.giftData.options.wraps[d].unit+"\x26";break}}else d=F(b.find(".amazon-gift-wrap")),d.is(":checked")&&(c+="giftWrap\x3d"+d.val()+"\x26",a.data.giftData.options&&(c+="currencyAmount\x3d"+
a.data.giftData.options.wraps[0].priceAmount+"\x26",c+="currencyUnit\x3d"+a.data.giftData.options.wraps[0].unit+"\x26"));else if(b.find(".popover-gift-merchant-wrap").is(":visible")&&(d=b.find("input[name\x3d'mfn-gift-wrap']:checked").eq(0).val())&&d.length)for(c+="giftWrap\x3d"+d+"\x26",d=0;d<a.data.giftData.options.wraps.length;d++)if(b.find(".popover-gift-merchant-wrap").find(".mfn-wrap-"+d).is(":checked")){c+="currencyAmount\x3d"+a.data.giftData.options.wraps[d].priceAmount+"\x26";c+="currencyUnit\x3d"+
a.data.giftData.options.wraps[d].unit+"\x26";break}if(0<C(".enable-gift-connections").length)if(b.find("#include-gift-connection-checkbox").is(":checked")){c+="includeGiftConnection\x3d1\x26";a=b.find("#select-recipient").val();c+="gcGiftlistTypeId\x3d"+a+"\x26";if("1"===a||"2"===a)c+="gcFirstName\x3d"+b.find("#input-recipient-first-name").val()+"\x26",c+="gcLastName\x3d"+b.find("#input-recipient-last-name").val()+"\x26";d=b.find("#select-occasion").val();c+="gcOccasionId\x3d"+d+"\x26";if("1"===d||
"2"===d)c+="gcMonth\x3d"+b.find("#select-occasion-month").val()+"\x26",c+="gcDay\x3d"+b.find("#select-occasion-day").val()+"\x26","1"===d&&"2"===a&&(c+="gcAge\x3d"+b.find("#select-occasion-age").val()+"\x26"),c+="gcHasReminder\x3d"+(b.find("#occasion-has-reminder-checkbox").is(":checked")?"1":"0")+"\x26"}else c+="includeGiftConnection\x3d0\x26";(a=C("input#executionId").val())&&(c+="executionId\x3d"+a+"\x26");a=(new Date).getTime();c+="isClientTimeBased\x3d"+C("input[name\x3d'useCtb']").val()+"\x26returnjson\x3d1\x26isDecoupleSPC\x3d1\x26hasWorkingJavascript\x3d1\x26returnFullHTML\x3d1\x26cachebuster\x3d"+
a;f.isSPP()&&(ra.hide(),a=C("#setOrderingPrefsCheckbox"),a.length&&a.is(":checked")&&(c+="\x26saveAsDefaultsSelected\x3d1"));m.show();a=f.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});C.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-gift.html",data:c,dataType:"text",async:!0,cache:!1,headers:a,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,c,d){d.getResponseHeader("x-amz-checkout-page")?(f.isSPP()||b.find(".a-button-close").trigger("click"),
f.ajaxUpdatePage(a,c,d)):(a=e.jsonify(a),f.redirect(a))},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}}function r(a,b){a.find(".fba-wrap-checkbox").hide();a.find(".large-preview").hide();b.show();b.find(".afn-wrap-copy").remove()}function w(){var a=I,b=a.find(".popover-gift-amazon-wrap").is(":visible"),c=F(a.find(".amazon-gift-wrap")),d=F(a.find(".afn-wrap-none")),e=F(a.find(".hide-prices-checkbox"));if(c.is(":checked")||!d.is(":checked")&&b)e.attr("checked",!0),e.attr("disabled",!0),a.find(".hide-prices-note").show();
else if(c.not(":checked")||d.is(":checked")&&b)e.attr("checked",!0),e.attr("disabled",!1),a.find(".hide-prices-note").hide()}function n(a){var b=I,c=F(b.find(".include-gift-receipt-checkbox"));b=F(b.find(".mfn-hide-prices-checkbox"));a?(da&&!c.is(":checked")&&c.attr("checked",!0).trigger("change"),da||b.is(":checked")||b.attr("checked",!0).trigger("change")):(da&&c.is(":checked")&&c.removeAttr("checked").trigger("change"),!da&&b.is(":checked")&&b.removeAttr("checked").trigger("change"))}function u(a){var b=
I,c=F(b.find(".include-gift-receipt-checkbox"));b=F(b.find(".mfn-hide-prices-checkbox"));a?(n(!0),da?c.attr("disabled","disabled"):b.attr("disabled","disabled")):da?c.removeAttr("disabled"):b.removeAttr("disabled")}function B(a){var b=F(I.find(".include-gift-message-checkbox"));a?(b.is(":checked")||b.attr("checked",!0).trigger("change"),A(!1),t()):(b.is(":checked")&&b.removeAttr("checked").trigger("change"),M())}function A(a){var b=I,d=b.find(".no-message-warning"),e=b.find(".no-receipt-warning"),
f=b.find("textarea[name\x3d'gift-message-text']");b=b.find(".message-remaining-text");a&&!e.is(":visible")?(c.showGiftTextAreaOnWarning()||f.addClass("gift-message-warning"),b.hide(),d.show()):(c.showGiftTextAreaOnWarning()||f.removeClass("gift-message-warning"),d.hide(),b.show())}function t(){var a=I,b=a.find("textarea[name\x3d'gift-message-text']");a=a.find(".gift-message-label");b.removeClass("gift-message-inactive");a.removeClass("a-color-secondary")}function M(){var a=I,b=a.find("textarea[name\x3d'gift-message-text']");
a=a.find(".gift-message-label");b.addClass("gift-message-inactive");a.addClass("a-color-secondary")}function K(){var b=I,c=F(b.find(".include-gift-message-checkbox")),d=b.find(".gift-msg-on-card"),e=b.find(".gift-msg-on-receipt"),f=a.trim(b.find(".gift-message-default-placeholder").text()),h=a.trim(b.find(".gift-message-with-wrap-placeholder").text()),g=b.find("textarea"),l=!1;b.find(".amazon-gift-wrap").each(function(){F(C(this)).is(":checked")&&(l=!0)});b.find(".afn-gift-wrap").each(function(){F(C(this)).is(":checked")&&
(l=!0)});b.find(".mfn-gift-wrap").each(function(){F(C(this)).is(":checked")&&(l=!0)});l?(e.hide(),d.show(),g.attr("placeholder",h),da&&(B(!0),wa&&c.attr("disabled","disabled"))):(d.hide(),da&&e.show(),g.attr("placeholder",f),c.removeAttr("disabled"))}function P(a){a=I;var b=F(a.find(".include-gift-receipt-checkbox"));b=da&&b.is(":checked");var c=F(a.find(".mfn-hide-prices-checkbox"));c=!da&&c.is(":checked");b||c?(R(),a.find(".kindle-reg-msg-your-account").hide(),a.find(".kindle-reg-msg-another-account").show()):
(J(),u(!1),a.find(".kindle-reg-msg-another-account").hide(),a.find(".kindle-reg-msg-your-account").show())}function O(a){a=I;var b=!1;F(a.find(".include-gift-message-checkbox")).is(":checked")&&(b=!0);var c=!1;a.find(".amazon-gift-wrap").each(function(){F(C(this)).is(":checked")&&(c=!0)});a.find(".afn-gift-wrap").each(function(){F(C(this)).is(":checked")&&(c=!0)});a.find(".mfn-gift-wrap").each(function(){F(C(this)).is(":checked")&&(c=!0)});(b||c)&&n(!0);b&&wa||c?u(!0):u(!1)}function H(a,b,c){var d=
I;qa=a;ma=b;if(a=d.find("textarea[name\x3d'gift-message-text']")){b=c?a.val().length:q.unescape(encodeURIComponent(a.val())).length;la&&!na&&da&&(0<b?A(!1):A(!0));var e=a.val().split("\n").length;c=qa-b;e=ma-e;!la&&0<b&&d.find(".include-gift-message-checkbox").not(":checked")&&d.find(".include-gift-message-checkbox").attr("checked",!0);a=a.val().split("\n");for(var h in a)24<a[h].length&&(e=0===a[h].length%24?e-(Math.floor(a[h].length/24)-1):e-Math.floor(a[h].length/24));d.find(".popover-gift-center .remainder-count").hide();
(-1>c?d.find(".popover-gift-center .remaining-char-over-multiple").show():0>c?d.find(".popover-gift-center .remaining-char-over-single").show():1===c?d.find(".popover-gift-center .remaining-char-single").show():d.find(".popover-gift-center .remaining-char-multiple").show()).find(".chars-remaining").html(Math.abs(c));(-1>e?d.find(".popover-gift-center .remaining-line-over-multiple").show():0>e?d.find(".popover-gift-center .remaining-line-over-single").show():1===e?d.find(".popover-gift-center .remaining-line-single").show():
d.find(".popover-gift-center .remaining-line-multiple").show()).find(".lines-remaining").html(Math.abs(e));if(0>c||0>e)f.isSPP()?(d.find(".set-gift-options-button").addClass("aok-hidden"),d.find(".set-gift-options-button-disabled").removeClass("aok-hidden")):(d.find(".set-gift-options-button").hide(),d.find(".set-gift-options-button-disabled").show()),0>c?(d.find(".gift-char-limit-error").find(".char-limit-error").html(qa),d.find(".current-blocker-content").html(d.find(".gift-char-limit-error").html())):
0>e&&(d.find(".gift-line-limit-error").find(".line-limit-error").html(ma),d.find(".current-blocker-content").html(d.find(".gift-line-limit-error").html()));-1<c&&-1<e&&(f.isSPP()?(d.find(".set-gift-options-button").removeClass("aok-hidden"),d.find(".set-gift-options-button-disabled").addClass("aok-hidden")):(d.find(".set-gift-options-button").show(),d.find(".set-gift-options-button-disabled").hide()))}}function N(a){a.stopPropagation();var b=I;b.find(".popover-content-main").fadeOut(100,function(){b.find(".popover-content-gift-wrap-preview .gift-wrap-preview-image").attr("src",
a.data.imageURL);b.find(".popover-content-gift-wrap-preview").fadeIn(100)});var c=b.find(".popover-content-gift-wrap-preview .back-to-gift-options-button");c.unbind("click").bind("click",Q);g.bindActionEnterKeyOnButton(c);sa=!0}function Q(a){sa=!1;var b=I;a?b.find(".popover-content-gift-wrap-preview").fadeOut(100,function(){b.find(".popover-content-main").fadeIn(100)}):setTimeout(function(){b.find(".popover-content-gift-wrap-preview").hide();b.find(".popover-content-main").show()},500)}function S(a){var b=
I,c=!1;C(".amazon-gift-wrap").each(function(){F(C(this)).is(":checked")&&(c=!0)});C(".afn-gift-wrap").each(function(){F(C(this)).is(":checked")&&(c=!0)});C(".mfn-gift-wrap").each(function(){F(C(this)).is(":checked")&&(c=!0)});if(c)R(),V();else if(F(b.find(".hide-prices-checkbox")).is(":disabled"))W();else if(a.is("input[type\x3dcheckbox]")&&(a.closest(".a-checkbox").hasClass("hide-prices-checkbox")||a.hasClass("hide-prices-checkbox")))a.is(":checked")?R():J();else if(f.isSPP())(b=a.closest(".a-radio"))&&
a.is(":checked")&&(b.hasClass("kindle-reg-radio-your-account")?J():b.hasClass("kindle-reg-radio-another-account")&&R());else if(a.hasClass("kindle-reg-radio-another-account")||a.hasClass("kindle-reg-radio-your-account"))b.find(".kindle-reg-radio-your-account").is(":checked")?J():R()}function R(){var a=I,b=F(a.find(".hide-prices-checkbox"));b.is(":checked")&&!f.isSPP()||b.attr("checked","checked");F(a.find(".kindle-reg-radio-your-account")).is(":checked")&&F(a.find(".kindle-reg-radio-another-account")).attr("checked",
!0)}function J(){var a=I,b=F(a.find(".hide-prices-checkbox"));b.is(":checked")&&b.removeAttr("checked");F(a.find(".kindle-reg-radio-another-account")).is(":checked")&&F(a.find(".kindle-reg-radio-your-account")).attr("checked",!0)}function V(){var a=I;F(a.find(".hide-prices-checkbox")).attr("disabled","true");F(a.find(".kindle-reg-radio-another-account")).attr("disabled",!0);F(a.find(".kindle-reg-radio-your-account")).attr("disabled",!0);a.find(".hide-prices-merchant-cant").is(":visible")||a.find(".hide-prices-note").show()}
function W(){var a=I;F(a.find(".hide-prices-checkbox")).removeAttr("disabled");F(a.find(".kindle-reg-radio-another-account")).removeAttr("disabled");F(a.find(".kindle-reg-radio-your-account")).removeAttr("disabled");a.find(".hide-prices-note").hide()}function X(a){var b=g.getPosition(a,"#",2),c=g.getPosition(a,"#",3);return"60"===a.substring(b+1,c)}function ha(b,c,d){var e=E();if(e){var f=d.find('li[class\x3d"a-carousel-card gift-wrap noshi-wrap none-wrap"]');var h=d.find(".carousel-gift-wrap").find("ol")}else f=
d.find("."+c+"-wrap-template"),h=d.find("ul.allGiftWrapList");e&&a.trigger("checkout:gift:removeEmptyCarouselCards",h);var g=(d.data("lineitemid")||b.obfuscatedEntityId||"").replace(":","-");"afn"!==c||e||(h.find('li[class!\x3d"none-wrap gift-wrap noshi-wrap"]').remove(),C("#giftwrap-carousel-wrap-holder-"+g).css("width",90*(b.options.wraps.length+1)),C("#giftwrap-carousel-wrap-pane-"+g).css("width",360));for(var l=I,k=l.find(".larger-image-link-carousel-template"),m=0;m<b.options.wraps.length;m++){var n=
f.clone(!0).removeClass(c+"-wrap-template").addClass(c+"-wrap-copy"),p=k.clone(!0).removeClass("larger-image-link-carousel-template").addClass("larger-image-link-carousel-"+m),u=c,t=b,q=m,v=n,B=p,x=t.options.wraps[q].id;v.find("input").addClass(u+"-wrap-"+q).val(x);v.find("label").attr("for",u+"-wrap-"+q);x=t.options.wraps[q].description;v.find("."+u+"-wrap-description").html(x);x=t.options.wraps[q].price;v.find("."+u+"-wrap-price").html(x);(t=t.options.wraps[q].imageurl)&&t.length?(v.find("."+u+
"-image").attr("src",t).show(),u=v.find(".larger-image-link"),u.show(),u.unbind("click").bind("click",{imageURL:t},N),B.unbind("click").bind("click",{imageURL:t},N),B.find("a").unbind("click").bind("click",{imageURL:t},N)):"mfn"!==u||E()||(v.find(".a-span3").hide(),v.find(".a-span9").addClass("a-span12").removeClass("a-span9"),v.find(".a-color-price").removeClass("wrap-price"));if("afn"===c){q=b;B=m;v=g;u=h;t=l;x=q.options.wraps[B].id;n.data("giftwrap-id",x);n.data("wrap-no",B);if(q.selected.wrap===
x){u.find("li.none-wrap").find("img").removeClass("selected-giftwrap-image");n.find("img").addClass("selected-giftwrap-image");q=n.find("img").attr("src");var r=C("#giftwrap-option-preview-imagearea-image-"+v);r.find("img").attr("src",q);r.removeClass("aok-hidden");C("#giftwrap-option-preview-imagearea-default-"+v).addClass("aok-hidden");S(n.find("input"));w();p.removeClass("aok-hidden");p.addClass("selectedWrapLargeLink")}E()?(v=X(x)?"gift-wrap":"noshi-wrap",n.removeClass(v).removeClass("none-wrap"),
u.append(n.show())):(v=X(x)?"\x3cli class\x3dnoshi-wrap\x3e":"\x3cli class\x3dgift-wrap\x3e",u.append(C(v).append(n.show())));n=t.find("#carousel-larger-image-div");n.find(".larger-image-link-carousel-"+B).length||n.append(p.show())}}d.find("."+c+"-wrap-checkbox").removeAttr("checked");b.selected&&b.selected.isWrapped?d.find("input[value\x3d'"+b.selected.wrap+"']").attr("checked",!0):F(d.find("."+c+"-wrap-none")).attr("checked",!0);e&&a.trigger("checkout:gift:adjustCarouselInitial",b,d)}function E(){return f.isSPP()&&
C("input[name\x3dsppGiftPopoverWithCarousel]").length}function U(a,b,c){for(var d=c.find("."+b+"-wrap-template"),e=0;e<a.options.wraps.length;e++){var h=d.clone(!0).removeClass(b+"-wrap-template").addClass(b+"-wrap-copy"),g=a.options.wraps[e].id;h.find("input").addClass(b+"-wrap-"+e).val(g);h.find("label").attr("for",b+"-wrap-"+e);g=a.options.wraps[e].description;h.find("."+b+"-wrap-description").html(g);g=a.options.wraps[e].price;h.find("."+b+"-wrap-price").html(g);if((g=a.options.wraps[e].imageurl)&&
g.length){var l=h.find("."+b+"-image");f.isSPP()&&l.removeClass("hidden");l.attr("src",g).show();l=h.find(".larger-image-link");f.isSPP()&&l.removeClass("hidden");l.show();l.unbind("click").bind("click",{imageURL:g},N)}else h.find(".a-span3").hide(),h.find(".a-span9").addClass("a-span12").removeClass("a-span9"),h.find(".a-color-price").removeClass("wrap-price");f.isSPP()&&h.removeClass("hidden");h.insertAfter(d).show()}c.find("."+b+"-wrap-checkbox").removeAttr("checked");a.selected&&a.selected.isWrapped?
c.find("input[value\x3d'"+a.selected.wrap+"']").attr("checked",!0):F(c.find("."+b+"-wrap-none")).attr("checked",!0)}function Y(a){for(var b=I,c=0;c<fa.length;c++)if(a&&a===fa[c].value&&fa[c].bMonth&&fa[c].bDay){var d=b.find('#select-occasion-month option[value\x3d"'+fa[c].bMonth+'"]').attr("selected","selected");b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(d.text());d=b.find('#select-occasion-day option[value\x3d"'+fa[c].bDay+'"]').attr("selected","selected");
b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(d.text())}}function Z(){var a=I,b=a.find("#popover-gift-connection #select-recipient").find(":selected").val();if(""!==b&&"0"!==b&&("1"!==b&&"2"!==b||a.find("#input-recipient-first-name").val()||a.find("#input-recipient-last-name").val()))a.find("#select-occasion").prop("disabled",!1),a.find("#popover-gift-connection-occasion .a-touch-select").css({opacity:1});else{b=I;b.find(".gift-connection-occasion-extra").hide();
var c=b.find('#select-occasion option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion").closest(".a-button-inner").find(".a-placeholder").text(c.text());c=b.find('#select-occasion-month option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(c.text());c=b.find('#select-occasion-day option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(c.text());
c=b.find('#select-occasion-age option[value\x3d"-1"]').attr("selected","selected");b.find("#select-occasion-age").closest(".a-button-inner").find(".a-placeholder").text(c.text());b.find("#occasion-has-reminder-checkbox").attr("checked",!0);a.find("#select-occasion").prop("disabled",!0);a.find("#popover-gift-connection-occasion .a-touch-select").css({opacity:.5})}}function z(a,b){var c=I;"1"===a&&"2"===b?c.find("#select-occasion-age-row").show():c.find("#select-occasion-age-row").hide()}function ca(a){a=
I;var b=a.find("#popover-gift-connection #select-recipient").find(":selected").val(),c=a.find("#popover-gift-connection #select-occasion").find(":selected").val();!b||"1"!==b&&"2"!==b?(a.find(".gift-connection-recipient-extra").hide(),"1"===c&&b&&Y(b)):a.find(".gift-connection-recipient-extra").show();z(c,b);Z()}function ba(a){a=I;var b=a.find("#popover-gift-connection #select-occasion").find(":selected").val(),c=a.find("#popover-gift-connection #select-recipient").find(":selected").val();!b||"1"!==
b&&"2"!==b?a.find(".gift-connection-occasion-extra").hide():("1"===b&&c&&"1"!==c&&"2"!==c&&Y(c),a.find(".gift-connection-occasion-extra").show());z(b,c)}function ia(a){var b=I,c="/gp/buy/pipeline/handlers/list-of-giftlists.html?escape\x3d0";fa&&(c+="\x26mappingOnly\x3d1");a&&(c+="\x26fromRegistryIds\x3d"+a);C.ajax({type:"POST",url:c,dataType:"json",async:!0,cache:!1,timeout:5E3,success:function(c){b.find("#select-recipient").hide();!fa&&c.options&&0<c.options.length&&(fa=c.options);a&&c.registryIdMapping?
(va[a]=c.registryIdMapping[a],oa=c.registryIdMapping[a]):a&&(va[a]=G);fa&&h();b.find("#select-recipient").show();b.find("#select-recipient-spinner").hide();ka=!0},error:function(){b.find("#select-recipient").show();b.find("#select-recipient-spinner").hide();ka=!0}})}function aa(b,c){var d=E(),e=c.lineItemId;c=E()?c.currentTab:b.data("current-tab");var f=C("#popover-gift-options-wrapper-"+e).data("active-tab");c!==f&&(b.parent().find(".selected-giftwrap-tab").removeClass("selected-giftwrap-tab"),b.addClass("selected-giftwrap-tab"),
b=C("#giftwrap-carousel-wrap-holder-"+e),d||b.css("left",0),f=C("#giftwrap-carousel-wrap-holder-"+e+" li"),d?(a.trigger("checkout:gift:changeCarouselWrapOptions",b,c,e),a.trigger("checkout:gift:adaptCarouselSPCPanel",e,c)):"all"===c?f.show():(f.hide(),f.filter("."+{"gift-wrap":"gift-wrap",noshi:"noshi-wrap"}[c]).show()),C("#popover-gift-options-wrapper-"+e).data("active-tab",c),f.find(".selected-giftwrap-image").removeClass("selected-giftwrap-image"),f.filter(".none-wrap").find("img").addClass("selected-giftwrap-image"),
C("#giftwrap-option-preview-imagearea-default-"+e).removeClass("aok-hidden"),C("#giftwrap-option-preview-imagearea-image-"+e).addClass("aok-hidden"),d=C("#allGiftWrapList-"+e).find(".none-wrap").find("input"),e=C(".selectedWrapLargeLink"),d.prop("checked",!0),d.val("").change(),e.length&&(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink")))}var C=a.$;if(!C("html").hasClass("a-ie6")){var qa,ma,I,ra,sa=!1,la=!1,na=!0,da=!0,fa,ka=!1,va={},oa,wa=!1;a.on("a:popover:hide",function(a){a.popover&&
a.popover.name&&0===a.popover.name.indexOf("gift-")&&(f.isSPP()&&b.increaseCount("checkout:spp-revieworder:gift_pop_cancel_sec",1),sa&&Q(),la&&(a=I,a.find(".gift-msg-on-card").hide(),a.find(".popover-gift-warning").hide(),a.find(".message-remaining-text").show(),F(a.find(".amazon-gift-wrap")).removeAttr("checked"),B(!1),a.find('input[type\x3d"checkbox"]').removeAttr("disabled")))});a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("gift-")){I=a.popover.$popover;
ra=a.popover;0<I.find(".include-gift-receipt-checkbox").length&&(la=!0);k.showSpinner(I.find(".popover-content-main"),!1,ra);I.find(".content-container").css("visibility","hidden");a="returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isDecoupleSPC\x3d1\x26cachebuster\x3d"+(new Date).getTime();try{var b=ra.data;if(b)a+="\x26obfuscatedEntityId\x3d"+b;else throw{name:"MissingData",message:"lineItemId is undefined"};}catch(ua){q.ueLogError&&q.ueLogError(ua,{logLevel:"FATAL",attribution:"gift-popover",message:"[No lineItemId to open the gift-popover with]. "})}C.ajax({type:"POST",
url:"/gp/buy/pipeline/handlers/gift-select-content.html",data:a,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},dataFilter:function(a){return e.jsonify(a)},success:function(a,b,c){a&&a.conductoraction&&a.conductoraction.url&&f.redirect(a);null!==a?x(a,b,c):f.ajaxRedirect()},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}});a.on("a:popover:beforeShow",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-gift"))b=I,a.popover.$popover.find(".a-popover-inner").html(b.find(".current-blocker-content").text()),
a.popover.updatePosition(!0);else if(a.popover&&a.popover.$popover){var b=a.popover.$popover;a=b.find(".validateInputCharactersOnBlur.a-form-error");0<a.size()&&a.removeClass("a-form-error");b=b.find("#onblur-character-validation-error-gift-message-text");0<b.size()&&b.remove()}});var Da={enforceSelectorParity:S,enforceGiftReceiptParity:O,enforceHidePriceParity:P,disableHidePrice:w,toggleMessageBoxDisplay:K,toggleEmptyMsgWarning:function(){var a=I,b=F(a.find(".include-gift-message-checkbox"));a=a.find("textarea[name\x3d'gift-message-text']");
!na&&da&&(b.is(":checked")&&0<a.val().length?A(!1):A(!0))},toggleNoReceiptWarning:function(){var a=I,b=F(a.find(".include-gift-receipt-checkbox")),c=a.find(".no-receipt-warning");a=a.find(".no-message-warning");b.is(":checked")?(c.hide(),wa||B(!0)):(a.hide(),c.show(),B(!1))},includeGiftConnection:function(){I.find("#include-gift-connection-checkbox").attr("checked",!0)},clearGiftConnection:function(){if(I.find(".include-gift-connection-checkbox").not(":checked")){var a=I;a.find(".gift-connection-recipient-extra").hide();
var b=a.find('#select-recipient option[value\x3d"0"]').attr("selected","selected");a.find("#select-recipient").closest(".a-button-inner").find(".a-placeholder").text(b.text());a.find("#input-recipient-first-name").val("");a.find("#input-recipient-last-name").val("");Z()}},toggleGiftConnectionRecipientArea:ca,toggleGiftConnectionOccasionArea:ba,updateGiftOptionsTabSelection:aa,updateCarouselOnLeftClick:function(a,b,c){c.$event.preventDefault();a=b.lineItemId;b=parseInt(C("#giftwrap-carousel-wrap-holder-"+
a).css("left"),10);0>b&&(b=b+90+"px",C("#giftwrap-carousel-wrap-holder-"+a).css("left",b))},updateCarouselOnRightClick:function(a,b,c){c.$event.preventDefault();a=b.lineItemId;var d=C("#allGiftWrapList-"+a);b=d.find("li").size();c=d.find("li.gift-wrap").size();d=d.find("li.noshi-wrap").size();var e=C("#popover-gift-options-wrapper-"+a).data("active-tab"),f;"all"===e?f=b:"gift-wrap"===e?f=c:"noshi"===e&&(f=d);b=parseInt(C("#giftwrap-carousel-wrap-holder-"+a).css("left"),10);b>-90*(f-4)&&(b=b-90+"px",
C("#giftwrap-carousel-wrap-holder-"+a).css("left",b))},updateSelectedGiftWrap:function(a,b){var c=b.lineItemId;C("#allGiftWrapList-"+c).find(".selected-giftwrap-image").removeClass("selected-giftwrap-image");a.find(".afn-image").addClass("selected-giftwrap-image");b=a.parent();var d=a.data("giftwrap-id"),e=a.find("input"),f=a.data("wrap-no");e.prop("checked",!0);e.val(d).change();d=C("#giftwrap-option-preview-imagearea-default-"+c);c=C("#giftwrap-option-preview-imagearea-image-"+c);e=C(".selectedWrapLargeLink");
f=C(".larger-image-link-carousel-"+f);b.hasClass("none-wrap")?(d.removeClass("aok-hidden"),c.addClass("aok-hidden"),e.length&&(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink"))):(a=a.find("img").attr("src"),c.find("img").attr("src",a),d.addClass("aok-hidden"),c.removeClass("aok-hidden"),e.length&&(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink")),f.length&&(f.addClass("selectedWrapLargeLink"),f.removeClass("aok-hidden")))},updatePreviewImageOnMouseEnter:function(a,b){var c=
b.lineItemId;b=C("#giftwrap-option-preview-imagearea-default-"+c);c=C("#giftwrap-option-preview-imagearea-image-"+c);a.hasClass("none-wrap")?(b.removeClass("aok-hidden"),c.addClass("aok-hidden")):(a=a.find("img").attr("src"),c.find("img").attr("src",a),b.addClass("aok-hidden"),c.removeClass("aok-hidden"))},updatePreviewImageOnMouseLeave:function(a,b){var c=b.lineItemId;a=C("#giftwrap-option-preview-imagearea-default-"+c);b=C("#giftwrap-option-preview-imagearea-image-"+c);C("#allGiftWrapList-"+c).find(".selected-giftwrap-image").parentsUntil("ul",
"li").hasClass("none-wrap")?(a.removeClass("aok-hidden"),b.addClass("aok-hidden")):(c=C("#allGiftWrapList-"+c).find(".selected-giftwrap-image").attr("src"),b.find("img").attr("src",c),a.addClass("aok-hidden"),b.removeClass("aok-hidden"))}},F=d.getInput;a.declarative("gift-popover-element",["change"],function(a){var b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(Da[b[c]])Da[b[c]](a.$target,a.data)});a.declarative("gift-popover-element","click mouseenter mouseleave",
function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(Da[b[c]])Da[b[c]](a.$currentTarget,a.data,a)});a.declarative("spc-update-gift-options-tab-selection","click",function(a){var b=a.$target.parents("li");b.attr("data",a.data);aa(b,a.data)});a.on("checkout:reload:spc",p);a.on("checkout:reload:spp-revieworder",p)}});"use strict";r.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor",
"checkout-general-utils","page-detector","client-side-metrics").register("concealment-popover-controller",function(a,m,k,e,f,g,l,b){function d(){x("#spc-orders").find(".concealment-widgets-desktop").removeClass("no-js-hide");a.defer(function(){x("#spc-orders").find(".concealment-popover-link").each(function(){x(this).data("action")&&x(this).removeAttr("href").attr("tabindex",0)})})}function c(a){return a.is("input")?a:a.find("input")}function h(a){var b=v;b.find(".fake-label").each(function(){x(this).unbind("click").bind("click",
function(){x(this).closest(".popover-checkbox").find("input").trigger("click")})});a&&a.item&&a.item.title&&b.find(".concealment-item-title").html(a.item.title);if(a&&a.obfuscatedEntityId){var d=b.find(".set-concealment-options-button input");d.unbind("click").bind("click",{obfuscatedentityid:a.obfuscatedEntityId,concealmentData:a,quantity:a.quantity},p);g.bindActionEnterKeyOnButton(d)}w=a&&a.item&&a.item.isAmazonFulfilled;a&&a.selected&&(d=c(b.find(".conceal-item-checkbox")),a.selected.concealItem?
d.attr("checked",!0):d.removeAttr("checked"));v.find(".content-container").css("visibility","visible");r.updatePosition(!0);k.hideSpinner(b.find(".popover-content-main"))}function p(a){var d=v,h="";a&&a.data&&a.data.obfuscatedentityid&&(h+="obfuscatedEntityId.0\x3d"+a.data.obfuscatedentityid+"\x26");a&&a.data&&a.data.quantity&&(h+="quantity.0\x3d"+a.data.quantity+"\x26");var g="";a&&a.data&&a.data.concealmentData&&a.data.concealmentData.saveConcealmentRefTag&&(g=a.data.concealmentData.saveConcealmentRefTag);
var l="";a&&a.data&&a.data.concealmentData&&a.data.concealmentData.cancelConcealmentRefTag&&(l=a.data.concealmentData.cancelConcealmentRefTag);(a=c(d.find(".conceal-item-checkbox")).is(":checked"))?(w&&(h+="isAFN.0\x3d1\x26"),h=h+"includeReceipt.0\x3d1\x26includeMessage.0\x3d1\x26"+("message.0\x3d"+encodeURIComponent(x("input[name\x3d'concealment-item-message']").val())+"\x26"),h=h+"hidePrices.0\x3d0\x26saveOnly\x3d1"+("ref\x3d"+g+"\x26")):h+="ref\x3d"+l+"\x26";var k=x("input#executionId").val();
k&&(h+="executionId\x3d"+k+"\x26");k="/gp/buy/gift/handlers/save-all.html/ref\x3d";a?(k+=g,b.increaseCount("CPEX.Checkout.Select.Concealment",1)):(k+=l,b.increaseCount("CPEX.Checkout.Cancel.Concealment",1));f.isSPP()&&(d.find(".a-button-close").trigger("click"),g=x("#setOrderingPrefsCheckbox"),g.length&&g.is(":checked")&&(h+="\x26saveAsDefaultsSelected\x3d1"));m.show();x.ajax({type:"POST",url:k,data:h,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},
contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,b,c){c.getResponseHeader("x-amz-checkout-page")?(f.isSPP()||d.find(".a-button-close").trigger("click"),f.ajaxUpdatePage(a,b,c)):(a=e.jsonify(a),f.redirect(a))},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}var x=a.$;if(!x("html").hasClass("a-ie6")){var v,r,w=!0;x(document).delegate(".concealment-popover-link, .concealment-options-button","click",function(){b.increaseCount("CPEX.Checkout.Concealment.Button.click",
1)});a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealment-")&&(f.isSPP()&&b.increaseCount("checkout:spp-revieworder:concealment_pop_cancel_sec",1),c(v.find(".conceal-item-checkbox")).removeAttr("checked"))});a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealment-")){v=a.popover.$popover;r=a.popover;k.showSpinner(v.find(".popover-content-main"),!1,r);v.find(".content-container").css("visibility","hidden");
a="returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isDecoupleSPC\x3d1\x26cachebuster\x3d"+(new Date).getTime();try{var b=r.data.lineItemEntityId,c=r.data.itemId;if(b)a+="\x26obfuscatedEntityId\x3d"+b;else if(c)a+="\x26lineItemEntityId\x3d"+c;else throw{name:"MissingData",message:"lineItemId is undefined"};var d=r.data.quantity;if(d)a+="\x26quantity\x3d"+d;else throw{name:"MissingData",message:"quantity is undefined"};}catch(M){q.ueLogError&&q.ueLogError(M,{logLevel:"FATAL",attribution:"concealment-popover",
message:"[Data missing to open the concealment-popover]. "})}b=r.data.ref;x.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/concealment-select-content.html/ref\x3d"+b,data:a+("\x26ref\x3d"+b),dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},dataFilter:function(a){return e.jsonify(a)},success:function(a,b,c){a&&a.conductoraction&&a.conductoraction.url&&f.redirect(a);null!==a?h(a,b,c):f.ajaxRedirect()},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}});a.on("a:popover:beforeShow",
function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-concealment")){var b=v;a.popover.$popover.find(".a-popover-inner").html(b.find(".current-blocker-content").text());a.popover.updatePosition(!0)}});var n={};a.declarative("concealment-popover-element",["change"],function(a){var b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(n[b[c]])n[b[c]](a.$target,a.data)});a.declarative("concealment-popover-element","click mouseenter mouseleave",
function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(n[b[c]])n[b[c]](a.$currentTarget,a.data,a)});a.on("checkout:reload:spc",d);a.on("checkout:reload:spp-revieworder",d)}});"use strict";r.when("A","page-conductor","scroll-controller","page-detector","client-side-metrics","button-blocker","weblab-helper").register("gold-box-controller",function(a,m,k,e,f,g,l){function b(){a.defer(h);a.defer(p)}var d=a.$,c={};if(!d("html").hasClass("a-ie6")){var h=
function(){var a=d("#goldbox-countdown"),b=d("#spc-orders");b&&0!==b.length||(b=d("#spclite-items-block"));b=b.find("input[name\x3dgoldboxexpirelefttime]");if(0!==b.length){if(1<b.size()){var e=parseInt(b.attr("data-timeleftms"),10),h=b;d.each(b,function(){var a=d(this),b=parseInt(a.attr("data-timeleftms"),10);b<e&&(h=a,e=b)});b=h}var g=parseFloat(b.attr("data-pagestarttime")),l=parseFloat(b.attr("data-timeleftms")/1E3);if(!(isNaN(g)||isNaN(l)||0>=l)){var p=(new Date).getTime();isNaN(c[g])?(c={},
c[g]=p):p=c[g];var r=a.find("span[data-timefield\x3dminute]"),t=a.find("span[data-timefield\x3dsecond]"),M=q.setInterval(function(){var b=(new Date).getTime();l-=(b-p)/1E3;p=b;if(0>l&&M)t.html("00"),q.clearInterval(M),M=null,m.isSPP()&&f.increaseCount("checkout:spp-revieworder:deal_expired",1),d("#gold-box-modal-launcher").trigger("click"),k.scrollToTop(),k.toggleScrollOff();else{b=Math.floor(l/60%60);var c=Math.floor(l%60);c=10>c?"0"+c:c;r.html(b);t.html(c);a.is(":visible")||a.show()}},1E3);m.isSPP()&&
f.increaseCount("checkout:spp-revieworder:deal_countdown",1)}}},p=function(){var a=d("#gold-box-button-blocker");1===a.length&&g.show("place-order-gold-box-blocker",a.attr("data-blocker-message"))};a.on("checkout:reload:spc",b);a.on("checkout:reload:spclite",b);a.on("checkout:reload:spp-revieworder",b)}});"use strict";r.when("A","page-transition-controller","ajax-utility","page-conductor","currency-formatter","page-detector","client-side-metrics","pay-rewards-currency","weblab-helper").register("inline-points-controller",
function(a,m,k,e,f,g,l,b,d){function c(){u("#spc-points-input")&&u("#spc-points-input").data("points-used")&&(u("#points-applied").show(),u("#inline-points-button").hide());u("#inline-points-register")&&u("#inline-points-register").removeAttr("href");u("#spc-loyalty-points-input")&&u("#spc-loyalty-points-input").val()&&(u("#loyalty-points-applied").show(),u("#loyalty-points-button").hide());u("#spc-points-input")&&u("#spc-points-input").hasClass("show-currency-input-widget-new")&&u("#spc-points-input").each(function(c,
d){var e=a.$(d);c={$element:e,maxAmount:e.data("max-dollar-amount")};d={$element:a.$("#inline-raw-points"),decimalPlaces:e.data("decimal-places"),ratio:e.data("conversion-ratio")};var f=e.data("country-code");f=b.getCurrencyFormatByCountryCode(f);b.initializeInlineFormatting(c,d,f);u(document).delegate("#spc-points-input","keydown",function(a){if(e.data("points-used")!==e.val){a=u("#inline-points-button");var b=!1;a.is("span")&&(b=!0);var c=a.find("span.apply"),d=a.find("span.change");u("#points-applied").hide();
e.data("points-used")?(c.hide(),d.show()):(c.show(),d.hide());b?a.addClass("display-inline-block"):a.show()}})})}function h(a,b){a.preventDefault();if(p(b)){e.isSPP()?(m.blockAllActions(),m.showTransitionInContainer(u("#payment"))):m.show();a={"x-amz-checkout-page":"spc"};if(b){var c=u("#loyalty-points-hidden-fields");b="/gp/buy/spc/handlers/update-loyalty-points.html/ref\x3dox_spc_points_edit";var f="\x26jpPointsPaymentInstrumentId\x3d"+encodeURIComponent(c.find("input[name\x3d'jpPointsPaymentInstrumentId']").val())+
"\x26jpPointsCustomerRequestedAmount\x3d"+u("#spc-loyalty-points-input").val()+"\x26jpPointsConversionRate\x3d"+c.find("input[name\x3d'jpPointsConversionRate']").val()+"\x26jpPointsBaseCurrencyCode\x3d"+c.find("input[name\x3d'jpPointsBaseCurrencyCode']").val()+"\x26jpPointsTargetCurrencyCode\x3d"+c.find("input[name\x3d'jpPointsTargetCurrencyCode']").val()+"\x26jpPointsAvailablePoints\x3d"+c.find("input[name\x3d'jpPointsAvailablePoints']").val()+"\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+
u("input[name\x3duseCtb]").val()}else{a=e.setAjaxTransitionHeader(a);c=u("#inline-points-hidden-fields");var h=c.find("input[name\x3d'useGCBalance']").val();b="/gp/buy/pipeline/handlers/update-reward-points.html/ref\x3d"+(e.isSPP()?"chk_pay_addswp_coll":"ox_pay_page_points_apply");f="paymentMethodId\x3d"+c.find("input[name\x3d'paymentMethodId']").val()+"\x26paymentMethodType\x3d"+c.find("input[name\x3d'paymentMethodType']").val()+"\x26rewardAccountId\x3d"+c.find("input[name\x3d'rewardAccountId']").val()+
"\x26rewardAccountAmount\x3d"+u("#spc-points-input").val()+"\x26rewardAccountRate\x3d"+c.find("input[name\x3d'rewardAccountRate']").val()+"\x26useGCBalance\x3d"+h+"\x26usePromoBalance\x3d"+h+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+u("input[name\x3duseCtb]").val();d.isBRMarketplaceCurrencyFormatEnabled()&&(f="paymentMethodId\x3d"+c.find("input[name\x3d'paymentMethodId']").val()+"\x26paymentMethodType\x3d"+c.find("input[name\x3d'paymentMethodType']").val()+
"\x26rewardAccountId\x3d"+c.find("input[name\x3d'rewardAccountId']").val()+"\x26rewardAccountAmount\x3d"+u("#spc-points-input").val().replaceAll(",",".")+"\x26rewardAccountRate\x3d"+c.find("input[name\x3d'rewardAccountRate']").val()+"\x26useGCBalance\x3d"+h+"\x26usePromoBalance\x3d"+h+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+u("input[name\x3duseCtb]").val())}u.ajax({type:"POST",url:b,data:f,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
headers:a,success:function(a,b,c){c.getResponseHeader("x-amz-checkout-page")?e.ajaxUpdatePage(a,b,c):(a=k.jsonify(a),e.redirect(a))},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}}function p(a){var b=!1,c=u("input[name\x3drewardAccountAmount]"),d=u("#inline-points-error-block");a||u("#spc-points-input")&&!u("#spc-points-input").hasClass("show-currency-input-widget-new")?(a&&(c=u("input[name\x3dloyaltyPointsValue]"),d=u("#loyalty-points-error")),d.hide(),d.find("p").hide(),v(c))?r(c,a)?w(c,a)||(d.find("p").filter(function(){return"badMax"===
u(this).data("error")}).show().css("display","inline"),b=!0):(d.find("p").filter(function(){return"badMin"===u(this).data("error")}).show().css("display","inline"),b=!0):(d.find("p").filter(function(){return"badValue"===u(this).data("error")}).show().css("display","inline"),b=!0):a||r(c,a)||(d.find("p").filter(function(){return"badMin"===u(this).data("error")}).show().css("display","inline"),b=!0);if(b)return d.show(),c.addClass("a-form-error"),!1;c.removeClass("a-form-error");return!0}function q(a,
b){var c=u(a.currentTarget),e=c.val();d.isBRMarketplaceCurrencyFormatEnabled()&&(e=e.includes(".")?e.replaceAll(".",","):e.replaceAll(",","."));a=u("#inline-raw-points");b&&(a=u("#loyalty-points-applied-value"));var h=a.html();if(b)!/^\s*$/.test(e)&&!isNaN(e)&&0<e?a.html(e):a.html(0);else if(!u("#spc-points-input").hasClass("show-currency-input-widget-new")){var g=c.data("min-dollar-amount");!/^\s*$/.test(e)&&!isNaN(e)&&0<e&&!isNaN(g)&&e>=g?(g=c.data("conversion-ratio"),c=c.data("decimal-places"),
c=d.isBRMarketplaceCurrencyFormatEnabled()?f.getNumberWithSeparators(e/g,c).replaceAll(".","z").replaceAll(",",".").replaceAll("z",","):f.getNumberWithSeparators(e/g,c),a.html(c)):a.html(0)}(b||u("#points-applied").is(":visible"))&&h!==a.html()&&(a=u("#spc-loyalty-points-display"),h=u("#loyalty-points-applied"),c=u("#loyalty-points-button"),e=!1,b||(a=u("#inline-points-button"),a.is("span")&&(e=!0),h=a.find("span.apply"),c=a.find("span.change"),u("#points-applied").hide()),h.hide(),c.show(),e?a.css("display",
"inline-block"):a.show())}function v(a){a=a.val();d.isBRMarketplaceCurrencyFormatEnabled()&&(a=a.includes(".")?a.replaceAll(".",","):a.replaceAll(",","."));return/^\s*$/.test(a)||!isNaN(a)}function r(a,b){if(b)return!0;b=a.val();d.isBRMarketplaceCurrencyFormatEnabled()&&(b=b.includes(".")?b.replaceAll(".",","):b.replaceAll(",","."));if(/^\s*$/.test(b))return!0;b=parseFloat(b);return isNaN(b)||!a.data("min-dollar-amount")?!0:0===b||b>=a.data("min-dollar-amount")}function w(a,b){var c=a.val();d.isBRMarketplaceCurrencyFormatEnabled()&&
(c=c.includes(".")?c.replaceAll(".",","):c.replaceAll(",","."));if(/^\s*$/.test(c))return!0;c=parseFloat(c);var e=a.data("max-dollar-amount");b&&(e=a.data("available-points"));return isNaN(c)||!e?!0:c<=e}function n(a){switch(a.keyCode?a.keyCode:a.which){case 13:case 10:var b=u("#loyalty-points-button"),c=u("#spc-points-input");0<b.length&&b.is(":visible")?h(a,1):0<c.length&&h(a,0)}}var u=a.$;u("html").hasClass("a-ie6")||(u(document).delegate("#spc-loyalty-points-input","keypress",function(a){n(a)}),
u("#spc-points-input")&&!u("#spc-points-input").hasClass("show-currency-input-widget-new")&&(u(document).delegate("#spc-points-input","keypress",function(a){n(a)}),u(document).delegate("#spc-points-input","keyup",function(a){q(a,0)})),u(document).delegate("#spc-loyalty-points-input","keyup",function(a){q(a,1)}),u(document).delegate("#inline-points-button","click",function(a){h(a,0)}),u(document).delegate("#loyalty-points-button","click",function(a){h(a,1)}),a.on("a:expander:apply-point-expander:toggle:expand",
function(a){l.increaseCount("checkout:spp-payment:expand_addswp_coll",1)}),a.on("checkout:reload:spc",c),a.on("checkout:reload:spp-revieworder",c))});"use strict";r.when("A","client-side-metrics","ready").execute(function(a,m){var k=a.$;a.on("checkout:reload:spc",function(){var a=k("input[name\x3d'rewardsProgramId']").val(),f=k("input[name\x3d'swpWidgetCase']").val();a&&f&&m.increaseCount("Checkout::SPC::SWPWidgetCSM::"+a+"::"+f,1)})});"use strict";r.when("A","page-transition-controller","ajax-utility",
"page-conductor").register("inline-fps-balance-controller",function(a,m,k,e){function f(a){a.preventDefault();g("#inline-fps-balance-checkbox").prop("disabled","disabled");e.isSPP()?(m.blockAllActions(),m.showTransitionInContainer(g("#payment"))):m.show();var b=g("#inline-fps-balance-hidden-fields"),d=0;g("#inline-fps-balance-checkbox").prop("checked")&&(d=1);a=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});var c="/gp/buy/pipeline/handlers/update-fps-balance.html/ref\x3d"+(e.isSPP()?"chk_pay_"+
(d?"apply":"remmove")+"_fps_balance_coll":"ox_spc_page_fps_balance_apply");b="fpsPaymentMethodId\x3d"+b.find("input[name\x3d'fpsPaymentMethodId']").val()+"\x26useFlexiblePayments\x3d"+d+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+g("input[name\x3duseCtb]").val();g.ajax({type:"POST",url:c,data:b,dataType:"text",async:!0,cache:!1,headers:a,success:function(a,b,c){c.getResponseHeader("x-amz-checkout-page")?e.ajaxUpdatePage(a,b,c):(a=k.jsonify(a),
e.redirect(a))},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}var g=a.$;g("html").hasClass("a-ie6")||g(document).delegate("#inline-fps-balance-checkbox","click",function(a){f(a)})});"use strict";r.when("A","page-transition-controller","ajax-utility","page-conductor","checkout-general-utils","error-feature-detection","page-detector","client-side-metrics","weblab-helper","a-modal").register("shipping-speed-selection-controller",function(a,m,k,e,f,g,l,b,d,c){function h(){Z?E("fieldset div.a-radio").addClass("a-touch-radio"):
a.defer(function(){var a=E("#spc-orders").find("div.ship-option");a.filter(".no-scheduled-delivery");a.each(function(){E(this).find("input.radio-image").remove()});a.each(function(){var a=E(this).find("input.radio-standard");a.attr("checked")&&a.attr("checked",!0)})});ba=E("#spc-orders").find("div.ship-option").find('input[type\x3d"radio"]:checked');ia=ba.attr("value");p();g.markFeatureAvailable("shipping-speed-selection-controller");x()}function p(){var a=0<E("#trigger-case-call-to-resolve-cv").length||
0<E(".force-resolve-invalid-ship-option").length;if(e.isSPP()&&a){a=function(){var a=q.setInterval(function(){e.isAnimating()||(m.show(),q.clearInterval(a))},50)};var b=E("div.ship-option").filter(".call-set-to-resolve-cv").first().find("input[type\x3d'radio']");if(b&&b.length){var c=b.parents(".shipping-speeds").find("input.lineitemidinput[type\x3dhidden]").val();O(b,null,null,{transitionAction:a,refTag:"chk_revieworder_set_ship_option_no_default",extraData:{callingCASEResolveCV:1,lineItemIds:c}})}}}
function x(){E("#buy-button-disabled-state").length&&v(function(a){y(a)})}function v(a){E("div.sd-widgets").each(function(b,c){a(c)})}function y(a){var b=setInterval(E.proxy(function(){if(E(this).hasClass("sd_widget_initialized")){var a=E(this),c=E(a).attr("id");c&&(a=w(a),a["ScheduledDeliveryEntity.startDeliveryDate"]&&O(null,c,a));q.clearInterval(b)}},a),1E3)}function w(a){var b={};n(a,function(a){var c=E(a).attr("key");a=E(a).val();b[c]=a||""});return b}function n(a,b){E(a).find("input[type\x3d'hidden']").each(function(a,
c){b(c)})}function u(a){return d.isExcludeMdwFromGoldenCXWidgetRenamingWeblabEnabled()?!(a&&a[0]&&a[0].classList&&a[0].classList.contains("sd-mdw-widget-root")):!0}function B(){U||(U=E("input[type\x3d'hidden'][name\x3d'scopeId']").val());return U}function A(a,b,c){if(c.getResponseHeader("x-amz-checkout-page")){var f=k.jsonify(a);return f&&f.success&&f.trialkey&&Y[f.trialkey]?(a=Y[f.trialkey],e.isSPP()&&"object"===typeof a&&(a=JSON.stringify(Y[f.trialkey])),d.isSPCMobileDisplayMoreShipOptionsEnabled()&&
0<E(".mobile-view").length?e.ajaxUpdatePage(a,b,c,{pushNewFrame:"false"}):e.ajaxUpdatePage(a,b,c),z&&(clearTimeout(z),z=null),Y={},!0):d.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<E(".mobile-view").length?e.ajaxUpdatePage(a,b,c,{pushNewFrame:"false"}):e.ajaxUpdatePage(a,b,c)}return e.redirect(a)}function t(a,b){if(a){var c=a.data(b);if(c!==G)return c;(a=a.closest(".radio-standard"))&&(c=a.data(b));return c}}function M(a){a.closest("fieldset").find("i.a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");
a.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive")}function K(a){var b=a;E(".shipping-group").each(function(a,c){var d=!1;E(c).parents().each(function(a,b){return E(b).hasClass("shipment")?(d=!0,!1):!0});d||(b=b.add(c))});return b}function P(a,b,c){var e="",f=0;1<a.length&&(e+="\x26forcesetbylineitem\x3d1");a.each(function(h,g){h=E(g);var l="",k=h.data("orderid"),m=h.has(".prime-calendar-container"),n=h.find("input[name\x3d'currentshippingspeed']").attr("value"),
p=h.find("input[name\x3d'currentshipsplitpreference']").attr("value");1===a.length&&(e+="\x26oldoption\x3d"+n+"."+p);var q=h.find("input[name\x3d'defaultshipsplitpreference."+k+"']").attr("value"),v=h.find("input[name\x3d'usingprimeshipping."+k+"']").attr("value");q&&v&&(l+="\x26defaultshipsplitpreference."+f+"\x3d"+q,l+="\x26usingprimeshipping."+f+"\x3d"+v);q=h.find(".shipping-speed");q=b?q.find('input[type\x3d"radio"]:checked'):q.find("input[src*\x3dradio-on]");m&&!q.length&&(q=h.find("input[name\x3d'hiddenSelection"+
k+"']"));v=h.find(".ship-split-preferences").find("input[type\x3d'radio']:checked");1!==v.length&&(v=h.find(".ship-split-preferences").find("input[type\x3d'hidden'][name^\x3d'shippriority']"));c===h.data("orderid")&&(t(b,"shippingofferingid")?q=b:v=b,1===a.length&&(l=m?l+("\x26option\x3d"+q.data("key")+"."+(v?v.attr("value"):"")):l+("\x26option\x3d"+q.attr("value")+"."+(v?v.attr("value"):""))));var r=h.find("input[name\x3d'lineitemids"+k+"']");0<r.length&&(l+="\x26lineitemids"+f+"\x3d"+r.attr("value"));
d.isSecureUnifiedDeliveryEnabled()&&(r=h.find("input[name\x3d'issecureunifieddelivery"+k+"']"),0<r.length&&(l+="\x26issecureunifieddelivery"+f+"\x3d"+r.attr("value")));r=h.find("input[name\x3d'onOrAfterAppointment"+k+"']").val();var x=h.find("input[name\x3d'onOrAfterLineItemId"+k+"']").val(),w="";r&&x&&(w+="\x26onOrAfterAppointment"+f+"\x3d"+r,w+="\x26onOrAfterLineItemId"+f+"\x3d"+x);l+=w;if(q.length)l+=R(q,v,f,m),1===t(q,"isscheduleddelivery")?(m=q.closest(".shipping-speed").find('[id^\x3d"sd_widgets_"]'),
u(m)&&(m=E("#sd-widgets-"+k)),g=m.children(":input").serialize(),m.length&&(k=m.get(0).id.substring(11),m=k.replace(/^(\d+)(-)?/,function(a,b,c){return f+(c?c:"")}),g=g.replaceAll(k+"\x3d",m+"\x3d"),g=g.replace(/(SD-OrderID-\d+=)\d+/,"$1"+f),g=g.replace(/(SDV1-orderId-\d+=)\d+/,"$1"+f)),l+="\x26"+g):1===t(q,"isscheduleddeliveryslot")&&t(q,"sddatastring")&&(l+="\x26ScheduledDeliveryEntity.data."+f+"\x3d"+encodeURIComponent(q.data("sddatastring"))),"rush-ispu"===q.attr("value")&&(l+=Q(h,f,v));else if(H(h))l+=
N(h,f,n,p);else{if(h.find("[data-action\x3d'checkout-select-ship-option-radio'").length)return;d.isRemoveDigitalFlagForScheduledDeliveryShipmentEnabled()&&"1"===E(g).find("input[type\x3d'hidden'][name\x3d'previousSDSelected"+f+"']").attr("value")||(l+="\x26isdigital"+f+"\x3d1")}f++;e+=l});0<f&&(e+="\x26groupcount\x3d"+f);return e}function O(a,c,h,g){Z&&M(a);g&&g.transitionAction?g.transitionAction():m.show();for(var l in ca)ca.hasOwnProperty(l)&&(ca[l].abort(),delete ca[l]);h=E("#spc-orders").find("input[type\x3d'hidden'][name\x3d'shiptrialprefix']").val();
a||(a=E("#"+c).closest(".shipping-speed").find("input[type\x3d'radio']"));a.attr("value")!==ia&&(b.increaseCount("checkout:spc:shipoption:change",1),ia=a.attr("value"));l=a.closest(".shipment").data("orderid");a&&a.length&&a.hasClass("valid-btn")&&a.closest(".prime-calendar").hasClass("long-calendar")&&(l=a.closest(".prime-calendar").data("orderid"));c="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1";if(g&&g.extraData)for(var k in g.extraData)g.extraData.hasOwnProperty(k)&&
(c+="\x26"+k+"\x3d"+g.extraData[k]);k=E(".shipment");var n=k.length;k=K(k);c=c+("\x26groupsadded\x3d"+(k.length-n))+P(k,a,l);k="ox_spc_set_ship_option";e.isSPP()&&(k="chk_revieworder_set_ship_option",l=E("#setOrderingPrefsCheckbox"),l.length&&l.is(":checked")&&(c+="\x26saveAsDefaultsSelected\x3d1"));l=E("input[name\x3duseCtb]").val();c+="\x26isClientTimeBased\x3d"+l;1===t(a,"istrial")?(h=B()+":"+a.attr("name")+":"+a.attr("value"),c+="\x26trialkey\x3d"+h,Y[h]&&(z&&clearTimeout(z),k="ox_spc_set_cached_ship_option",
e.isSPP()&&(k="chk_revieworder_set_cached_ship_option"),c=c.replace("returnFullHTML\x3d1","returnFullHTML\x3d0"),c+="\x26trialSuccess\x3d1")):"undefined"!==typeof h&&(h=h+":"+a.attr("name")+":"+a.attr("value"),c+="\x26trialkey\x3d"+h);g&&g.refTag&&(k=g.refTag);g&&g.removeGiftOption&&(c+="\x26giftOrderid\x3d"+a.closest(".shipment").data("orderid"));0===c.indexOf("\x26")&&(c=c.substr(1));a="/gp/buy/spc/handlers/set-delivery-options.html/ref\x3d"+k;g=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});
d.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<E(".mobile-view").length&&(g=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"}));E.ajax({type:"POST",url:a,data:c,dataType:"text",async:!0,cache:!1,headers:g,success:function(a,b,c){A(a,b,c);f.nukeDropdowns("#b2brd-cadence-dropdown")},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}function H(a){return d.isVasTrueSPCEnabled()?"1"===E.trim(a.data("iahiddenshipment"))||0<a.find(".vas-scheduling-prefBlock").length:
0<a.find(".vas-scheduling-prefBlock").length}function N(a,b,c,d){var e="\x26shippingofferingid"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'shippingofferingid']").val();e+="\x26guaranteetype"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'guaranteetype']").val();e+="\x26issss"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'issss']").val();e+="\x26forceshipsplitpreference"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'forceshipsplitpreference']").val();return e+("\x26shippingspeed"+
b+"\x3d"+c)+("\x26shippriority"+b+"\x3d"+d)}function Q(a,b,c){var d="\x26preferredSSP"+b+"\x3d"+a.find("input[type\x3d'hidden'][name^\x3d'shipsplitpriority']").val();d+="\x26currentSSP"+b+"\x3d"+c.attr("value");"shipWhenever"==a.find("input[name\x3d'ispuShipSplitPriority']").attr("value")&&(d=d+("\x26isShipWheneverValid"+b+"\x3d1")+("\x26isShipWhenCompleteValid"+b+"\x3d0"));return d}function S(a,b){Z&&M(a);a=b.find("input[name\x3d'ispuLoadingText']").attr("value");if(e.isSPP()&&a){var c=E("#shipaddress");
c&&c.length&&(c.hasClass("expanded")?m.show():(m.shrinkPanel(E(".spp-panel.expanded"),!1),m.shrinkPanel(c,!0,a)))}else m.show();a="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1";c=b.find("input[name\x3d'storeAddressID']").attr("value");var d=b.find("input[name\x3d'storeId']").attr("value"),f=b.find("input[name\x3d'storeOwnerId']").attr("value"),h=b.find("input[name\x3d'lineItemsQuantity']").attr("value"),g=b.find("input[name\x3d'destinationType']").attr("value"),
l=b.find("input[name\x3d'ispuShippingOfferingId']").attr("value"),k=b.find("input[name\x3d'ispuShipSplitPriority']").attr("value"),n=b.find("input[name\x3d'ispuGuaranteeType']").attr("value"),p=b.find("input[name\x3d'ispuPageType']").attr("value");a=a+("\x26storeId\x3d"+d)+("\x26storeAddressId\x3d"+c)+("\x26storeOwnerId\x3d"+f);a+="\x26lineItemsQuantity\x3d"+h;a+="\x26destinationType\x3d"+g;a+="\x26shippingOfferingId\x3d"+l;a+="\x26shipPriority\x3d"+k;a+="\x26guaranteeType\x3d"+n;a+="\x26pageType\x3d"+
p;b=b.find("input[name\x3d'retailProgram']");b.length&&(a+="\x26retailProgram\x3d"+b.attr("value"));b="chk_spc_ispu_ship_option";e.isSPP()&&(b="chk_revieworder_ispu_ship_option");b="/gp/buy/ispu/handlers/ispu-select-store.html/ref\x3d"+b;c=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});0<E(".mobile-view").length&&(c=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"}));E.ajax({type:"POST",url:b,data:a,dataType:"text",async:!0,cache:!1,headers:c,success:function(a,
b,c){A(a,b,c)},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}function R(a,b,c,d,e){var f="";"undefined"!==typeof e&&(c+="-"+e);if(t(a,"rcxsspdecoupling"))return f={},f["shippingspeed"+c]=d?a.attr("key"):a.attr("value"),f["shippingofferingid"+c]=t(a,"shippingofferingid"),f["guaranteetype"+c]=t(a,"guaranteetype"),f["issss"+c]=t(a,"issss"),f["forceshipsplitpreference"+c]=t(a,"forceshipsplitpreference"),d="shipWhenComplete",b&&(d=b.attr("value")),1===t(a,"isscheduleddelivery")&&(f["isscheduleddelivery"+
c]="1",d="shipWhenComplete"),f["shippriority"+c]=d,f["preferredSSP"+c]=t(a,"shipsplitpriority"),f["currentSSP"+c]=b.attr("value"),f["isShipWheneverValid"+c]=t(a,"isshipwhenevervalid"),f["isShipWhenCompleteValid"+c]=t(a,"isshipwhencompletevalid"),f=E.param(f),"\x26"+f;f=d?f+("\x26shippingspeed"+c+"\x3d"+a.data("key")):f+("\x26shippingspeed"+c+"\x3d"+a.attr("value"));f+="\x26shippingofferingid"+c+"\x3d"+t(a,"shippingofferingid");f+="\x26guaranteetype"+c+"\x3d"+t(a,"guaranteetype");f+="\x26issss"+c+
"\x3d"+t(a,"issss");f+="\x26forceshipsplitpreference"+c+"\x3d"+t(a,"forceshipsplitpreference");d="shipWhenComplete";b&&(d=b.attr("value"));1===t(a,"isscheduleddelivery")&&(f+="\x26isscheduleddelivery"+c+"\x3d1",d="shipWhenComplete");return f+("\x26shippriority"+c+"\x3d"+d)}function J(a){var b=[a.closest(".shipment").data("orderid")];W(a,b)}function V(a){var c=[];E("#spc-orders").find(".shipment").each(function(a,b){c.push(a)});b.increaseCount("checkout:spc:mobile:same-day-upsell-banner:clicked",1);
W(a,c)}function W(a,b){m.show();var c="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1",d="/gp/buy/spc/handlers/set-delivery-options.html/ref\x3d"+a.data("reftag");E("#spc-orders").find(".shipment").each(function(d,e){var f=c+="\x26lineitemids"+d+"\x3d"+E(e).find("input[type\x3d'hidden'][name\x3d'lineitemids"+d+"']").attr("value"),h=E(e),g=h.find("input[name\x3d'onOrAfterAppointment"+d+"']").val();h=h.find("input[name\x3d'onOrAfterLineItemId"+
d+"']").val();var l="";g&&h&&(l=l+("\x26onOrAfterAppointment"+d+"\x3d"+g)+("\x26onOrAfterLineItemId"+d+"\x3d"+h));c=f+l;f=E(e).find("input[type\x3d'hidden'][name^\x3d'shippriority']");if(e=-1===b.indexOf(d)?E(e).find("#selected-ship-option-"+d):a)c+="\x26shippingofferingid"+d+"\x3d"+e.data("shippingofferingid"),c+="\x26guaranteetype"+d+"\x3d"+e.data("guaranteetype"),c+="\x26issss"+d+"\x3d"+e.data("issss"),c+="\x26forceshipsplitpreference"+d+"\x3d"+e.data("forceshipsplitpreference"),c+="\x26shippriority"+
d+"\x3d"+e.data("targetshipoptionkey"),e.data("rcxsspdecoupling")&&(c+="\x26preferredSSP"+d+"\x3d"+e.data("shipsplitpriority"),c+="\x26currentSSP"+d+"\x3d"+f.attr("value"),c+="\x26isShipWheneverValid"+d+"\x3d"+e.data("isshipwhenevervalid"),c+="\x26isShipWhenCompleteValid"+d+"\x3d"+e.data("isshipwhencompletevalid"))});var f=E("#spc-orders").find("input[type\x3d'hidden'][name\x3d'groupcount']").val();c+="\x26groupcount\x3d"+f;c+="\x26isClientTimeBased\x3d"+E("input[type\x3d'hidden'][name\x3d'useCtb']").attr("value");
c+="\x26trialkey\x3d"+B()+":"+a.data("orderindex")+":"+a.data("targetshipoptionkey");f=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});E.ajax({type:"POST",url:d,data:c,dataType:"text",async:!0,cache:!1,headers:f,success:function(a,b,c){A(a,b,c)},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}function X(b,c,e,h){f.protectAgainstDoubleAction(c)||d.isAmazonDayIncentiveDetailsLinkRedirectionEnabledOnStripeMsg()&&b.$target.is('a[target\x3d"PromoDetails"]')||C||(a.trigger(e,b),b=b.$currentTarget.find("a"),
h&&h(b))}function ha(){aa.closest("div.shipping-speed").find('input[type\x3d"radio"]').attr("checked",!0);"undefined"!==typeof c?(0<E(".mobile-view").length?c.get(E("#faster-than-same-day-sosp-popover")):c.get(E("#faster-than-same-day-spc-popover"))).hide():a.$("div.a-popover button.a-button-close").trigger("click");O(aa,null,null,{removeGiftOption:!0})}var E=a.$;if(!E("html").hasClass("a-ie6"))if(q.spcpage){var U,Y={},Z=E("html").hasClass("a-touch"),z,ca={},ba,ia,aa;q.spcpage.scheduledDeliverySetSOCallback=
function(b,c){e.isSPP()&&a.objectIsEmpty(b)||(q.spcpage&&E("#spcpagecontent").is(":visible")?q.spcpage.actionSetShipOptions(null,c,b):O(null,c,b))};q.spcpage.scheduledDeliverySetSOCallbackWithTarget=function(b,c,d){e.isSPP()&&a.objectIsEmpty(c)||(q.spcpage&&E("#spcpagecontent").is(":visible")?q.spcpage.actionSetShipOptions(null,d,c):O(b,d,c))};q.spcpage.scheduledDeliveryEnableSOCallback=function(){};q.spcpage.scheduledDeliveryMdwSetSOCallback=function(b,c,f){d.isSsdMdwEnabled()&&(e.isSPP()&&a.objectIsEmpty(c)||
(q.spcpage&&E("#spcpagecontent").is(":visible")?q.spcpage.actionSetShipOptions(null,f,c):O(b,f,c)))};q.spcpage.secureDeliverySetSOCallback=function(a,b){d.isSecureUnifiedDeliveryEnabled()&&O(a,null,null,b)};E(document).delegate(".ship-option","click",function(e){var h=E(e.target);d.isSPCMobileDisplayMoreShipOptionsEnabled()&&E(e.target).closest(".ship-option").hasClass("mobile-view")&&"a-link-normal"!==e.target.parentNode.parentNode.className&&e.preventDefault();var g=E(e.currentTarget);b.resetMetrics();
if(!h.is('a[target\x3d"AmazonHelp"]')&&!h.is('a[target\x3d"PromoDetails"]')&&!h.hasClass("no-ship-option-selection-change"))if(d.isAmazonDayDatePickerClickSkipShipOptionChangeEnabled()&&h.closest(".no-ship-option-selection-change").length)e.preventDefault();else if(!(g.is("input")||h.hasClass("a-button")||h.closest("a-button").length||h.is("img")&&(h.closest("div").is(".prime-ship-speed")||h.closest(".prime-fake-radio").parent().is(".prime-ship-speed"))))if(h=g.find("div.prime-ship-speed"),0<h.length)h.find("a:first img").trigger("click");
else if((h=g.find("input[type\x3d'image']").attr("src"))&&h.match(/radio-off/)&&E(".ap_popover_sprited").hide(),g=g.find("input[type\x3d'radio']"),(h=g.closest("div.shipping-speeds").data("sospargs"))&&1===g.data("isscheduleddelivery")&&!g.is(":checked"))m.show(),g.attr("checked",!0),M(g),f.redirectWithJavascript("/gp/buy/shipoptionselect/handlers/display.html?"+h);else if(d.removesGiftOptionOnRush()&&0<g.closest(".shipment").find("input[name^\x3dItemIsGift]").length&&1===g.closest(".radio-standard").data("nosupportforgiftoption")){aa=
g;aa.is(":checked")&&(aa.attr("checked",!1),ba.attr("checked",!0));var k=0<E(".mobile-view").length?E("#faster-than-same-day-sosp-popover"):E("#faster-than-same-day-spc-popover");"undefined"!==typeof c?c.get(k).show():a.delay(function(){k.trigger("click")},10)}else if(g.hasClass("js-no-serverside-callback")&&(g.attr("checked",!0),M(g),g.closest(".a-section-expander-container").find(".a-link-section-expander").click()),!d.isSsdMdwEnabled()||1!==g.closest(".radio-standard").data("callcaseforsdoverride"))if(1!==
t(g,"isscheduleddelivery")||!l.isDesktopSpc()){h=E("#disableSubmitButtons").length;var n=!1;d.isSPCMobileDisplayMoreShipOptionsEnabled()&&(e=E(e.currentTarget).closest(".ship-option"),e.hasClass("mobile-view")&&!e.hasClass("mobile-selected-option")&&(n=!0));!h&&g.is(":checked")&&!n||1===g.data("isscheduleddelivery")||(g.attr("checked",!0),O(g))}});E(document).delegate(".ship-option input[type\x3d'radio']","change",function(a){if(!d.isSPCMobileDisplayMoreShipOptionsEnabled()||!E(a.target).closest(".ship-option").hasClass("mobile-view")){a=
E(a.currentTarget);var b=a.closest("div.prime-ship-speed");d.removesGiftOptionOnRush()&&0<a.closest(".shipment").find("input[name^\x3dItemIsGift]").length&&1===a.closest(".radio-standard").data("nosupportforgiftoption")||d.isSsdMdwEnabled()&&1===a.closest(".radio-standard").data("callcaseforsdoverride")||1===t(a,"isscheduleddelivery")&&l.isDesktopSpc()||(0<b.length?b.find('input[type\x3d"radio"]').attr("checked",!1):1!==a.data("isscheduleddelivery")&&O(a))}});E(document).delegate(".ispu-ship-option",
"click",function(a){if(d.isISPUMasterEnabled()){E(a.target).closest(".ispu-ship-option").hasClass("mobile-view")&&a.preventDefault();E(a.target);var c=E(a.currentTarget);b.resetMetrics();var e=c.find("input[type\x3d'radio']"),f=!1;a=E(a.currentTarget).closest(".ispu-ship-option");a.hasClass("mobile-view")&&!a.hasClass("mobile-selected-option")&&(f=!0);if(!e.is(":checked")||f)e.attr("checked",!0),S(e,c)}else b.increaseCount("checkout:ispu:selection:weblab:disabled",1)});E(document).delegate(".ispu-ship-option input[type\x3d'radio']",
"change",function(a){if(!d.isISPUMasterEnabled())b.increaseCount("checkout:ispu:selection:weblab:disabled",1);else if(!E(a.target).closest(".ispu-ship-option").hasClass("mobile-view")){a=E(a.currentTarget);var c=a.closest(".ispu-ship-option");S(a,c)}});E(document).delegate(".rush-ispu-ship-option","click",function(a){if(d.isRushISPUMasterEnabled()){E(a.target).closest(".rush-ispu-ship-option").hasClass("mobile-view")&&a.preventDefault();E(a.target);var c=E(a.currentTarget);b.resetMetrics();var e=
c.find("input[type\x3d'radio']"),f=!1;a=E(a.currentTarget).closest(".rush-ispu-ship-option");a.hasClass("mobile-view")&&!a.hasClass("mobile-selected-option")&&(f=!0);if(!e.is(":checked")||f)e.attr("checked",!0),S(e,c)}else b.increaseCount("checkout:rushIspu:selection:weblab:disabled",1)});E(document).delegate(".rush-ispu-ship-option input[type\x3d'radio']","change",function(a){if(!d.isRushISPUMasterEnabled())b.increaseCount("checkout:rushIspu:selection:weblab:disabled",1);else if(!E(a.target).closest(".rush-ispu-ship-option").hasClass("mobile-view")){a=
E(a.currentTarget);var c=a.closest(".rush-ispu-ship-option");S(a,c)}});E(document).delegate(".rush-ispu-view-details-link","click",function(a){a.preventDefault();a.stopPropagation()});E(document).delegate(".mfn-ispu-view-details-link","click",function(a){a.preventDefault();a.stopPropagation()});a.declarative("shipping-speed-expander-toggle",["click"],function(a){var b=a.$target.closest(".a-box");if(b.hasClass("a-single")){var c=b.find(".expanded-header-content");var d=b.find(".collapsed-header-content");
d.hide();c.hasClass("prime-title")&&c.find("div").attr("style","");c.show()}else d=b.find(".collapsed-header-content"),c=b.find(".expanded-header-content"),b=b.siblings(".a-expander-content").find(".a-icon-touch-radio-active").siblings(".a-radio-label").html(),d.html(b),c.hide(),d.show();f.toggleExpanderContent(a)});a.declarative("select-prime-slot",["click"],function(a){a=a.$currentTarget;E(".a-button-close").trigger("click");a.closest(".valid-slot").hasClass("selected-slot")||O(a)});var C=!1;E(document).delegate(".mobile-upsell",
"touchmove",function(a){C=!0});E(document).delegate(".mobile-upsell","touchstart",function(a){C=!1});a.declarative("select-upsell-shipping-speed",["click","touchend"],function(a){X(a,"select-upsell-shipping-speed","a:checkout:mobile-upsell-shipping-speed:select",J)});a.declarative("select-all-upsell-shipping-speed",["click","touchend"],function(a){X(a,"select-all-upsell-shipping-speed","a:checkout:mobile-upsell-shipping-speed:select-all",V)});a.declarative("faster-than-same-day-save",["click"],ha);
a.declarative("faster-than-same-day-sosp-save",["click"],ha);a.on("checkout:reload:spc",h);a.on("checkout:reload:spp-revieworder",h)}else r.log("window.spcpage undefined, shipping-speed-selection-controller not initialized","WARN","ship-speed")});"use strict";r.when("A","page-detector","spc-page-state","client-side-metrics","page-conductor","page-transition-controller","weblab-helper").register("order-summary-controller",function(a,m,k,e,f,g,l){function b(a){var b=n("#currencyConverterFooter");if(0!==
b.length&&!b.is(":hidden")){n("input[name\x3dcurrentViewId]").val(a.attr("id"));b=a.find("input[name\x3dgurupaFxCurrencyChoice]").val();n("input[name\x3d'fxCurrencyChoice']").val(b);b=n("input[name\x3d'fxApplicabilityChoice']");if(0!==b.length){var c=a.find("input[name\x3dgurupaFxApplicabilityChoice]").val();b.val(c)}b=a.find("input[name\x3dselectedCurrencyOption]").val();n("input[name\x3d'currentCurrencyOption']").val(b);b=n("input[name\x3d'currentTnCOption']");0!==b.length&&(c=a.find("input[name\x3dselectedTnCOption]").val(),
b.val(c));b=a.find("input[name\x3dplaceYourOrderButtonText]").val();n(".place-your-order-button").val(b);u&&(c=f.isTangoSpc()?n("input#placeOrder + span"):n(".place-order-button-text"),(f.isSPP()?c:n(".place-your-order-button + span")).text(b));b=a.find("input[name\x3d'selectedCurrencyOption']").val();c=n("#subtotals-marketplace-table");var e=n("#vatRetailSubtotals-marketplace-table"),h=n("#vatGlobalSubtotals-marketplace-table"),g=n("#vatMerchantSubtotals-marketplace-table"),l=n("#subtotals-transactional-table"),
k=n("#vatRetailSubtotals-transactional-table"),m=n("#vatGlobalSubtotals-transactional-table"),p=n("#vatMerchantSubtotals-transactional-table"),q=f.isTangoSpc()?n("#subtotals-marketplace-tango-bottom"):n("#subtotals-marketplace-spp-bottom"),t=f.isTangoSpc()?n("#subtotals-transactional-tango-bottom"):n("#subtotals-transactional-spp-bottom");"LOCAL"===b?(d("transactional"),l.show(),t.show(),k.show(),m.show(),p.show(),c.hide(),q.hide(),e.hide(),h.hide(),g.hide()):"MARKETPLACE"===b&&(d("marketplace"),
l.hide(),t.hide(),k.hide(),m.hide(),p.hide(),c.show(),q.show(),e.show(),h.show(),g.show());b=n("#ACCB_GIFT_CARD_ORDER_SUMMARY_POLICY_MESSAGE");0!==b.length&&("LOCAL"===a.find("input[name\x3d'currencyOptions']:checked").val()?b.show():b.hide());n("#tfx-header").hide()}}function d(a){l.isTFXGuaranteedExchangeFeeEnabled()||(a="marketplace");n(".tfx-currency").each(function(){n(this).text(n(this).data(a))})}function c(b){d(b);k.prop("currencyType",b);var c=n("#subtotals-marketplace-table"),h=n("#subtotals-transactional-table"),
g=n("#subtotals-marketplace-spp-bottom"),l=n("#subtotals-transactional-spp-bottom"),p=n("#vatRetailSubtotals-transactional-table"),q=n("#vatGlobalSubtotals-transactional-table"),r=n("#vatMerchantSubtotals-transactional-table"),x=n("#vatRetailSubtotals-marketplace-table"),w=n("#vatGlobalSubtotals-marketplace-table"),y=n("#vatMerchantSubtotals-marketplace-table"),A=n(".place-your-order-button"),K=n("#fx-enable"),E=f.isSPP()?n(".place-order-button-text"):n(".place-your-order-button + span");f.isSPP()||
setTimeout(function(){var a=Math.max(c.outerHeight(),h.outerHeight());0<a&&(c.height(a),h.height(a))},500);if(!u){e.increaseCount("removeauijs17");var U=G.siblings("i"),Y=t.siblings("i");if(U.hasClass("a-icon-touch-radio-inactive")||U.hasClass("a-icon-touch-radio-active"))"marketplace"===b?(U.removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"),Y.removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive")):(Y.removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"),
U.removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"))}"marketplace"===b?(n("#fxGoodNews-transactional").hide(),n("#fxGoodNews-marketplace").show(),h.hide(),c.show(),l.hide(),g.show(),p.hide(),q.hide(),r.hide(),x.show(),w.show(),y.show(),B&&B.hide(),K&&K.hide(),A.val(n("#placeYourOrderTextMarketplace").val()),v()&&n("#ACCB_GIFT_CARD_ORDER_SUMMARY_POLICY_MESSAGE").hide(),u&&E.text(n("#placeYourOrderTextMarketplace").val()),n("#currencyChanged").attr("value","true"),n("#fxCurrencyChoice").attr("value",
"marketplace"),n("#tfx-total-header").addClass("aok-hidden"),n("#mkt-total-header").removeClass("aok-hidden")):(n("#fxGoodNews-transactional").show(),n("#fxGoodNews-marketplace").hide(),c.hide(),h.show(),g.hide(),l.show(),x.hide(),w.hide(),y.hide(),p.show(),q.show(),r.show(),B&&B.show(),K&&K.show(),A.val(n("#placeYourOrderTextTransactional").val()),v()&&n("#ACCB_GIFT_CARD_ORDER_SUMMARY_POLICY_MESSAGE").show(),u&&E.text(n("#placeYourOrderTextTransactional").val()),n("#currencyChanged").attr("value",
"false"),n("#fxCurrencyChoice").attr("value","transactional"),n("#mkt-total-header").addClass("aok-hidden"),n("#tfx-total-header").removeClass("aok-hidden"));a.trigger("checkout:spc:ordersummary:sizeChanged");m.isMobileSpc()&&(g=n("#vatBreakdownNote"),0<g.size()&&(l=g.attr("href"),l=0<l.lastIndexOf(".html?")?l+("\x26currencyType\x3d"+b):l+("?currencyType\x3d"+b),g.attr("href",l)))}function h(a){var b=n("#tfx-footer"),d=n("#tfx-header");if(!u){e.increaseCount("removeauijs18");var f=n("#fxApplicabilityDecision").siblings("i"),
h=n("#fxApplicabilityAdoption").siblings("i");if(h.hasClass("a-icon-touch-checkbox-inactive")||h.hasClass("a-icon-touch-checkbox-active"))h.removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive"),f.removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active")}"accept"===a?(p()?(n("#fx-terms-and-conditions").show(),n("#fxCardCurrencySubcondition").hide()):(n("#fx-enable").show(),n("#fx-disable").hide()),n("#fxApplicabilityDecision").prop("checked",
!0),d.show(),c("transactional"),b.show(),n("#marketplaceRadio").prop("checked",!1),n("#transactionalRadio").prop("checked",!0),n("#fxApplicabilityChoice").attr("value","accept")):(p()?(n("#fx-terms-and-conditions").hide(),n("#fxCardCurrencySubcondition").show()):(n("#fx-enable").hide(),n("#fx-disable").show()),n("#fxApplicabilityAdoption").prop("checked",!1),d.hide(),c("marketplace"),b.hide(),n("#transactionalRadio").prop("checked",!1),n("#marketplaceRadio").prop("checked",!0),n("#fxApplicabilityChoice").attr("value",
"decline"))}function p(){return f.isSPP()&&n("input[name\x3disNewTFXExperienceEnabled]").length}function r(a){a.preventDefault();a=y();var c=a.find("input[name\x3d'currencyOptions']:checked").val(),d=n("input[name\x3d'currentCurrencyOption']").val();c!==d&&(e.increaseCount("checkout:CSM:TFX:CurrencySelection:"+d,1),c=a.find("input[name\x3d'currencyToggleTransition']").val(),a.hide(),a=n("#"+c),a.show(),b(a))}function v(){return 0!==n("#ACCB_GIFT_CARD_ORDER_SUMMARY_POLICY_MESSAGE").length}function y(){var a=
n("input[name\x3d'currentViewId']").val();return n("#"+a)}function w(a){a.preventDefault();a=y();var c=a.find("input[name\x3d'currencyConverterTCAgreement']").val(),d=n("input[name\x3d'currentTnCOption']").val();c===d&&(e.increaseCount("Checkout:CSM:TFX:TCSelection:"+!d,1),c=a.find("input[name\x3d'tncTransition']").val(),a.hide(),a=n("#"+c),a.show(),b(a))}var n=a.$;if(!n("html").hasClass("a-ie6")){var u=q.P&&q.P.AUI_BUILD_DATE,B,A,t,G;l.isTFXCurrencyToggleOnTabletFixed()?(n(document).delegate("#checkoutCurrencyTransactional",
"click",function(){c("transactional")}),n(document).delegate("#checkoutCurrencyMarketplace","click",function(){c("marketplace")})):(n(document).delegate("#transactionalRadio","click",function(){c("transactional")}),n(document).delegate("#marketplaceRadio","click",function(){c("marketplace")}));n(document).delegate("#fxApplicabilityDecisionCheckbox","click",function(){h("decline")});n(document).delegate("#fxApplicabilityAdoptionCheckbox","click",function(){var a=p()&&!n("#fxApplicabilityAdoption").is(":checked");
h(a?"decline":"accept")});a.on("a:expander:tfx-options-expander:toggle:expand",function(a){e.increaseCount("checkout:spp-ordersummary:expand_tfx_options",1)});a.on("a:expander:tfx-see-rate-expander:toggle:expand",function(a){e.increaseCount("checkout:spp-ordersummary:expand_tfx_see_rate",1)});n(document).delegate("input[name\x3d'currencyOptions']","click",r);n(document).delegate("input[name\x3d'currencyConverterTCAgreement']","click",w);return{changeCurrency:c,initOrderSummary:function(){t=n("#transactionalRadio");
G=n("#marketplaceRadio");B=n("#tfx-see-exchange-rates");A=n("#tfx-switch-currency-options");u||(e.increaseCount("removeauijs15"),n("#transactionalRadioImage").remove(),n("#marketplaceRadioImage").remove(),n("#acceptAccImage").remove());var a=n("#exchange-rate-link"),d=n("#switch-currency-link");if(0!==G.length){var f=A.find('input[name\x3d"switchCurrency"]'),h=f.not(":checked");f=k.prop("currencyType")||f.filter(":checked").val();h.val()===f?h.trigger("click"):c(f);u||(e.increaseCount("removeauijs16"),
a.find("i.a-icon-collapse").remove(),d.find("i.a-icon-collapse").remove())}b(y());n("#currencyConverterFooter").find("*[disabled\x3d'']").prop("disabled",!1)},updateCurrencyView:r,updateTnCView:w}}});"use strict";r.when("A","ready").register("spc-page-state",function(a){var m={};return{prop:function(a,e){if(a&&"string"===typeof a)return 1<arguments.length&&(m[a]=e),m[a]}}});"use strict";r.when("A","ready").execute(function(a){function m(){0<k("#spcCachedPromiseData").length&&(e=(new Date).getTime(),
k(".place-your-order-button").click(function(){var a=(new Date).getTime()-e;k("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'spcWaitingTime' value\x3d'"+a+"' /\x3e")}))}var k=a.$,e=0;a.on("checkout:reload:spc",m);a.on("checkout:reload:spclite",m);a.on("checkout:reload:spp-revieworder",m)});"use strict";r.when("A","client-side-metrics","ready").register("spc-apx-standin",function(a,m){function k(e){var f=a.state("apx-standin-state");f.timestamp=(new Date).toISOString();f.metricName=e;return f}
if(a.state("apx-standin-state")){var e=k("APX_STANDIN_ENABLED");m.emitNexusMetrics(e,e.producerId,e.schemaId);a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&"apx-popover"==a.popover.name||a.popover&&a.popover.originalFocus&&a.popover.originalFocus.id&&"payChangeButtonId"==a.popover.originalFocus.id)a=k("APX_STANDIN_POPOVER_SHOW"),m.emitNexusMetrics(a,a.producerId,a.schemaId)});a.on("a:sheet:afterShow:apx_standin_bottom_sheet_instance",function(a){a=k("APX_STANDIN_POPOVER_SHOW");m.emitNexusMetrics(a,
a.producerId,a.schemaId)})}});"use strict";r.when("A","page-transition-controller","scroll-controller","loading-spinner-controller","page-conductor","checkout-general-utils","ready").register("changeCustomerDetailsPopover",function(a,m,k,e,f,g){function l(){return 0<c("#onblur-character-validation-error-changeNameInput").size()}function b(){h&&h.find("button[data-action\x3da-popover-close]").trigger("click")}function d(){var a=c("#saveButton");if(a.length){var b=c("#changeNameInput"),d=c("#changePostNumberInput"),
e=c("#changePhoneInput"),f=1,h=1,g=1;b.length&&!b.val()&&(f=0);d.length&&!d.val()&&(h=0);e.length&&!e.val()&&(g=0);f&&h&&g&&!l()?(a.removeClass("a-button-disabled"),a.removeAttr("disabled")):(a.addClass("a-button-disabled"),a.attr("disabled","true"))}}var c=a.$,h;a.declarative("clickedsave","click submit",function(a){if(!l()){var d=c("#changeNameInput").val(),e=c("#changePhoneInput").val(),h=c("#changePostNumberInput").val(),g=c("#changeAccountNameCheckBox").is(":checked")?1:0,k=c("#changePostNumberCheckBox").is(":checked")?
1:0;d="custName\x3d"+encodeURIComponent(d)+"\x26changeAccountName\x3d"+encodeURIComponent(g);e&&(d=d+"\x26custPhoneNumber\x3d"+encodeURIComponent(e));h&&(d=d+"\x26dhlPostNumber\x3d"+encodeURIComponent(h),k&&(d=d+"\x26changeDhlPostNumberInEmbu\x3d"+encodeURIComponent(k)));e=a.data.changeDetailUrl;f.isSPP()&&(e=a.$target.data("changedetailurl"),c("#cancelReminderPopover").click());f.isSPP()||(d+="\x26usePipelineDispatch\x3d1");m.show();e&&c.ajax({type:"POST",data:d,url:e,dataType:"html",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
async:!0,cache:!1,headers:f.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"}),success:function(a,c,d){b();m.hide();f.ajaxUpdatePage(a,c,d)},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}});a.declarative("clickedsave","mouseenter mousemove touchstart",function(a){d()});a.declarative("changeNameKeyIn changePostNumberKeyIn changePhoneNumberKeyIn","keydown keyup change keypress mouseenter mouseleave mousemove",function(a){d()});a.declarative("clickedcancel","click submit",function(a){b()});a.on("a:popover:beforeShow:changeDetailPopover",
function(a){l()&&c("#onblur-character-validation-error-changeNameInput").remove()});a.on("a:popover:show:changeDetailPopover",function(a){if(!f.isSPP()){var b=c(q).width(),e=c(q).height();b=parseInt(.6*b,10);e=parseInt(.7*e,10);h=a.popover.$popover;var g=a.popover;h.css("position","absolute");h.css("top","50px");h.css("height",e+"px");h.css("width",b+"px");g.updatePosition()}b=f.isSPP()?a.popover.originalnamevalue:a.popover.$trigger.data("original-name-value");e=f.isSPP()?a.popover.originalcellphonevalue:
a.popover.$trigger.data("original-cellphone-value");a=f.isSPP()?a.popover.originalpostnumbervalue:a.popover.$trigger.data("original-postnumber-value");g=c("#changeNameInput");var l=c("#changePhoneInput"),k=c("#changePostNumberInput");g.val(b);l.val(e);k.val(a);d()})});"use strict";r.when("A","page-transition-controller","ajax-utility","page-conductor","page-detector","checkout-general-utils").register("prime-decline-controller",function(a,m,k,e,f,g){function l(){d("input[name\x3d'changeCardNoEndDatePrime']").attr("data-action",
"prime-decline-element")}function b(a,b,d){if(d.getResponseHeader("x-amz-checkout-page"))e.ajaxUpdatePage(a,b,d);else{a=k.jsonify(a);if(!a)return e.redirect();a.error?m.hide():a.errors?m.hide():a.autohandlererror?(b=(a=a.autohandlererror)?a.action:null,d=a&&a.type?a.type:b&&b.code?b.code:"string"===typeof a?a:"Unknown:pipelineJSError",q.location.href="fatal"===b?"/gp/buy/payselect/handlers/error.html?errorAction\x3dfatal\x26errorType\x3d"+encodeURIComponent(d):"redirect"===b?a.url:"/gp/buy/payselect/handlers/error.html?errorType\x3d"+
encodeURIComponent(d)):e.redirect(a)}}var d=a.$;d("html").hasClass("a-ie6")||(a.declarative("prime-decline-element",["click","touchend"],function(a){g.protectAgainstDoubleAction("prime-decline-element")||(a.$event.preventDefault(),m.show(),a=(new Date).getTime(),a="changeCardNoEndDatePrime\x3d1\x26hasWorkingJavascript\x3d1\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26fromAnywhere\x3d"+d("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+a,d.ajax({type:"POST",url:"/gp/buy/spc/handlers/stuff-handler.html/ref\x3dox_spc_prime_renew_nodate",
data:a,headers:{"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",success:b,error:e.ajaxRedirect}))}),a.on("checkout:reload:spc",l),a.on("checkout:reload:spp-revieworder",l))});"use strict";r.when("A","loading-spinner-controller","page-conductor").register("prime-popover-controller",function(a,m,k){function e(){g={};a.defer(function(){0!==f("#spc-orders").find(".prime-popover-link").length&&
(f("#spc-orders").find(".prime-popover-link").each(function(){var a=f(this);if(a.data("action")){a.removeAttr("href").attr("tabindex",0);var b=a.data("aCheckoutModalPopover");var d=b.name,c="";b.width&&b.height&&(c="width:"+b.width+"px;height:"+b.height+"px;");0<f("#spc-orders").find("#"+d+"-popover").length||(b=f(['\x3cdiv id\x3d"a-popover-'+d+'" class\x3d"a-popover-preload" style\x3d"display:none;"\x3e','\x3cdiv id\x3d"'+d+'-popover" class\x3d"checkout" style\x3d"'+c+'"\x3e\x3c/div\x3e',"\x3c/div\x3e"].join("")),
f("#spc-orders").append(b));a=a.data("aCheckoutModalPopover").name;g[a]||(b=f(".prime-popover-content").html())&&0<b.length&&(g[a]=b,f("#"+a+"-popover").html(b))}}),f("#spc-orders").find(".a-box").each(function(){var a=f(this),b=a.find(".prime-ad-banner-content .prime-popover-link");1<b.length&&(b=b.first());a.find("a.primeAdLauncher").each(function(){var a=f(this);a.wrap('\x3cspan class\x3d"a-declarative" data-action\x3d"prime-event" data-prime-event\x3d\'{"metric":"lm3"}\'\x3e\x3c/span\x3e');a.replaceWith(b.clone().text(a.text()).addClass("a-size-mini"))})}))})}
var f=a.$;if(!f("html").hasClass("a-ie6")){var g={};a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("prime")&&(a=a.popover.name,!g[a])){var b=f("input#primePopopverFallbackContent").val()||"";g[a]=b;f("#"+a+"-popover").html(b)}});a.on("checkout:reload:spc",e);a.on("checkout:reload:spp-revieworder",e)}});"use strict";r.when("A","page-transition-controller","back-button-protection","page-conductor","weblab-helper","checkout-general-utils").register("place-order-controller",
function(a,m,k,e,f,g){function l(){if(!e.isAnimating()){var b=d("#spc-form");if("0"===d("#showPageTransition").attr("content"))if(b.hasClass("paylast-spc"))m.show();else{if(0<d("#enableAlternatePYOBlocker").length){var h=f.isTangoAlternatePlaceYourOrderButtonBlockerEnabled()&&g.isChewbaccaUrl()?d("form[name\x3d'spc']").find(".a-button.continue-button"):b.find(".a-button.continue-button");if("disabled"===h.find("input").attr("disabled"))return;h.find("input").attr("disabled","disabled");h.addClass("a-button-disabled");
setTimeout(function(){h.removeClass("a-button-disabled");h.find("input").removeAttr("disabled")},4E4)}}else m.showPageTransition();var l=d("#currencyChanged");0<l.length&&"true"===l.val()&&(l='\x3cinput type\x3d"hidden" name\x3d"checkoutCurrencySelection.'+d("#tfx-switch-currency-options").find("input:radio:checked").val()+'" /\x3e',d("#spc-form-inputs").append(l));if(f.isMfaPSD2DeviceDescriptionCollectionEnabled()){l=[{name:"javaEnabled",value:q&&q.navigator&&q.navigator.javaEnabled()},{name:"language",
value:q&&q.navigator&&q.navigator.language},{name:"screenColorDepth",value:q&&q.screen&&q.screen.colorDepth},{name:"screenHeight",value:q&&q.screen&&q.screen.height},{name:"screenWidth",value:q&&q.screen&&q.screen.width},{name:"timeZone",value:(new Date).getTimezoneOffset()}];for(var r=0;r<l.length;r++)if(l[r].name!==G&&l[r].value!==G){var v='\x3cinput type\x3d"hidden" name\x3d"'+l[r].name+'" value\x3d"'+l[r].value+'" /\x3e';d("#spc-form-inputs").append(v)}}0==b.find("input[type\x3d'hidden'][name\x3d'placeYourOrder1']").length&&
b.append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");(l=a.state("firetv-aws-attributes"))&&l.queryParams&&(r=b.attr("action"),r+=0<=r.indexOf("?")?"\x26":"?",r+=d.param(l.queryParams),b.attr("action",r));e.isSPP()&&b.append(d("#subtotalsSection").find("input").hide());k.markAsDirty();b.submit()}}function b(a){a.preventDefault();l(a.target)}var d=a.$;if(!d("html").hasClass("a-ie6"))return a.declarative("a-checkout-place-order",["click"],function(a){l(a.target)}),d(document).delegate("span.place-order-button-link",
"click",b),{placeOrderClick:l,placeOrderClickDelegate:b,PLACE_ORDER_BUTTON_LINK_SELECTOR:"span.place-order-button-link"}});"use strict";r.when("A","page-conductor","button-blocker","client-side-metrics","weblab-helper").register("verification-checkbox-controller",function(a,m,k,e,f){function g(a){w?l(a):b(a);n&&a&&a.blocking&&(e.setmarker("fn"),n=!1)}function l(a){var b=x(".continue-button"),c=x(".continue-button-blocker"),d=x(".place-order-blocker-message.custom-blocker-message");if(a.blocking||
!h())a.blocking?(d.text(a.message),b.addClass("aok-hidden"),c.removeClass("aok-hidden")):(d.empty(),b.removeClass("aok-hidden"),c.addClass("aok-hidden"),r.when("a-tooltip").execute(function(a){(a=a.get(c))&&a.isActive()&&a.hide()}))}function b(a){a.blocking?k.show("place-order-imb-checks",a.message):(k.hide("place-order-imb-checks"),x("#hasTVNavigation").length&&r.when("a-tv").execute(function(a){a.select(".continue-button")}))}function d(){var b={blocking:!1,message:""};if(w){var c=x("#spc-imb").find(".verification-checkbox input:not(:checked)");
0<c.length&&(b={blocking:!0,message:c.first().closest(".verification-checkbox").attr("data-blocker-message")})}else{e.increaseCount("removeauijs23");if(!x("#spc-imb").find(".verification-checkbox").length)return;c=m.isSPP()?x("#spc-imb").find(".verification-checkbox input:not(:checked)"):x("#spc-imb").find(".verification-checkbox:not(:checked)");0<c.length&&(b={blocking:!0,message:m.isSPP()?c.first().closest(".spp-panel").hasClass("aok-hidden")?c.first().closest(".verification-checkbox").data("non-review-panel-blocker-msg"):
c.first().closest(".verification-checkbox").data("blocker-message"):c.first().attr("data-blocker-message")})}f.isPyoClientSideInitiationEnabled()?g(b):a.trigger("checkbox:primaryActionBlocker:blockingStateChanged",b)}function c(){var a=x("#wineNoticeCheckbox");a&&a.length&&(v?(a.attr("checked",""),y&&(a=a.siblings(".a-icon-touch-checkbox-inactive"))&&a.length&&(a.removeClass("a-icon-touch-checkbox-inactive"),a.addClass("a-icon-touch-checkbox-active"))):(a.removeAttr("checked",""),y&&(a=a.siblings(".a-icon-touch-checkbox-active"))&&
a.length&&(a.removeClass("a-icon-touch-checkbox-active"),a.addClass("a-icon-touch-checkbox-inactive"))))}function h(){var a=x("input[name\x3disINExpressCheckoutCC]");return a&&a.length?1===parseInt(a.val(),10):!1}function p(){f.isPyoClientSideInitiationEnabled()||c();x('[data-client-component\x3d"PrimaryActionBlockerCheckbox"]').length||(d(),f.isPyoClientSideInitiationEnabled()&&c());var a=q.P&&q.P.AUI_BUILD_DATE?'.verification-checkbox input[type\x3d"checkbox"]':"input.verification-checkbox";x("#spc-imb").find(a).unbind("change.verification-checkbox").bind("change.verification-checkbox",
d)}var x=a.$,v,y=x("html").hasClass("a-touch"),w=!m.isSPP()&&q.P&&q.P.AUI_BUILD_DATE,n=!0;if(!x("html").hasClass("a-ie6")){if(!f.isPyoClientSideInitiationEnabled())a.on("checkbox:primaryActionBlocker:blockingStateChanged",g);a.declarative("change-wine-notice-checkbox",["change"],function(a){v=a.$target.is(":checked")?1:0});a.on("checkout:reload:spc",p);a.on("checkout:reload:spclite",p);a.on("checkout:reload:spp-revieworder",p);a.on("checkout:reload:spp-collapsed",p);a.on("checkout:unload",function(){n=
!0});a.on("checkout:afterReload",function(){n=!1});return{verifyCheckboxes:d,updatePyo:g}}});"use strict";r.when("A","page-transition-controller","scroll-controller","ajax-utility","page-conductor","quantity-service","checkout-modal-popover","page-detector","checkout-general-utils","a-popover","client-side-metrics","weblab-helper").register("quantity-update-controller",function(a,m,k,e,f,g,l,b,d,c,h,p){function x(){W=V=!1;a.defer(function(){var a=H("#spc-orders");a.find("a.quantity-change-button-static").remove();
"1"!==H("#spc-form-inputs").find("input[name\x3d'isQuantityInvariant']").val()&&a.find("div.quantity-value-static").remove()});H(".lineitem").each(function(a,b){a=H(b);a.find(".no-js-quantity").remove();b=a.find(".quantity-dropdown");b.is(":visible")?(a.find(".js-select").prop("disabled",!1),b.removeClass("a-button-disabled")):(a=a.find(".quantity-input"),a.prop("disabled",!1),a.removeClass("a-form-disabled"))});var b=H("#pantry-mov-popover-content"),c=H("#pantry-mov-popover-placeholder");!b.length&&
c.length&&(b=c.attr("data-device"),H.ajax({type:"GET",url:"/gp/pantry/checkout/mov/get-pantry-mov-popover-contents.html",data:"device\x3d"+b,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,b,d){~a.indexOf("pantry-mov-popover-content")?c.append(a):h.increaseCount("checkout:pantry:pantry_mov_popover_contents:bad-content",1)},error:function(a,b,c){h.increaseCount("checkout:pantry:pantry_mov_popover_contents:"+c,1)}}))}function v(a,
b){a=H('.update-quantity-error[data-itemid\x3d"'+a+'"]');a.find(".error-message").hide();a.find('.error-message[data-error-type\x3d"'+b+'"]').show();a.find("i").show();a.find(".a-span12").show();a.show();b=a.closest(".item-details-right-column");b.find(".spc-quantity-dropdown-button").addClass("a-button-error");b.find(".spc-quantity-input").addClass("a-form-error");b=a.parents("div.update-quantity-error");a=b.siblings(".item-details");0<a.length&&(a.find(".a-input-text-wrapper").addClass("a-form-error"),
a.removeClass("a-spacing-large"),a.find(".a-touch-select").addClass("a-input-text a-form-error"));b.show()}function y(a,b,g){var l=g.getResponseHeader("x-amz-checkout-new-cart-quantity");d.updateCartByMash(l);if(g.getResponseHeader("x-amz-checkout-page"))f.ajaxUpdatePage(a,b,g,{pushNewFrame:"false"}),a=g.getResponseHeader("x-amz-checkout-updated-itemid"),g=g.getResponseHeader("x-amz-checkout-quantity-error"),a&&g&&v(a,g);else if(a=e.jsonify(a))if(a&&a.errors&&a.errors.pantry&&a.errors.pantry.mov)n(a.errors.pantry.showAddonInfo);
else{if(a&&a.errors&&a.errors.addon&&(f.isSPP()&&h.increaseCount("checkout:spp-revieworder:addon_warn_pri",1),g=a.errors.addon.type,b=a.errors.addon.asins,w(),H(".item-list").hide(),b.forEach(function(a){H('[data-asin\x3d"'+a+'"]').show()}),g=H("#addon-warning-"+g+"-launcher"),g.length)){H("input[name\x3duseLiveAUI]").length?c.get(g).attrs({$trigger:X}).show():ha&&H("div.checkout.spc-mobile.aui-templatized").length?g.click():(h.increaseCount("removeauijs19"),a=H.Event("keyup",{triggerPositioningElement:X,
manualTrigger:!0}),g.trigger(a),0<H("div.spc-mobile").length&&(k.scrollToTop(),k.toggleScrollOff()));m.hide();return}return f.redirect(a)}else f.redirect()}function w(){H("#a-popover-addon-warning-normal .select-address-title").hide();0<N?(H("#a-popover-addon-warning-normal .reduce-title").show(),H("#a-popover-addon-warning-normal .delete-title").hide()):(H("#a-popover-addon-warning-normal .delete-title").show(),H("#a-popover-addon-warning-normal .reduce-title").hide())}function n(a){var b=H("#pantry-mov-popover-launcher"),
c=H(".pantry-mov-reduce-prompt"),d=H(".pantry-mov-delete-prompt"),e=H("#pantry-mov-addon-info-container");b.length?(O()||h.increaseCount("checkout:pantry:pantry_mov_popover:non_spc",1),e.length&&e.empty(),a&&H("#addon-warning-normal-popover-content").length&&(w(),e.length||(e=H("\x3cdiv/\x3e",{id:"pantry-mov-addon-info-container"})),e.append('\x3chr class\x3d"a-divider-normal"\x3e').append(H("#addon-warning-normal-popover-content").html()).appendTo("#pantry-mov-popover-content")),0<N?(c.show(),d.hide()):
(d.show(),c.hide()),b.length&&(b.click(),m.hide())):(h.increaseCount("checkout:pantry:pantry_mov_popover_contents:no-launcher",1),f.redirect())}function u(a,b){m.show();var c={isClientTimeBased:H('input[name\x3d"useCtb"]').val(),fromAnywhere:H("input[name\x3dfromAnywhere]").val(),success:y};if(b)for(var d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);f.isSPP()?(c.ref="chk_ship_chg_qty_pri",b=H("#setOrderingPrefsCheckbox"),b.length&&b.is(":checked")&&(c.saveAsDefaultsSelected=1)):H(".spc-mobile.aui-templatized").length&&
(c.ref="ox_spc_change_quantity");b=H("#addon-indicator")&&"true"===H("#addon-indicator").attr("data-has-addon-items");d=H("#pantry-mov-indicator")&&"true"===H("#pantry-mov-indicator").attr("data-has-pantry-items");a||!b&&!d||(c.istrial=1);g.call(S,N,c);R?R.data("currentQuantity",N):J&&J.data("currentQuantity",N)}function B(){m.hide();q.location="/gp/aw/c/ref\x3dox_spc_deal_expired?app-action\x3dcart"}function A(a){var b=Q;N=Q;R&&r.when("a-dropdown").execute(function(a){R&&(a.getSelect(R).setValue(b.toString()),
R.data("currentQuantity",N))});a===E.addOn&&k.toggleScrollOn();J&&(J.val(b),J.data("currentQuantity",N),a=J.closest(".quantity-block"),a.find(".change-quantity-button").closest(".a-declarative").removeClass("hidden"),a.find(".quantity-display").removeClass("hidden"),a.find(".quantity-display-block-tablet").removeClass("hidden"),a.find(".dynamic-quantity-update").hasClass("stay-visible")||a.find(".dynamic-quantity-update").addClass("hidden").children().addClass("hidden"))}function t(a,b){var c=a.$currentTarget.is("a")?
a.$currentTarget:a.$currentTarget.find("a");S=c.data("entityId");N=0;R=null;Q=c.data("currentQuantity");X=H("a.quantity-delete-button[data-entity-id\x3d'"+S+"']");X.length||(X=a.$currentTarget);J=c.closest(".dynamic-quantity-update").find(".quantity-input");J.length||(J=null);c.data("isBundleDelete")?H("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click"):p.isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled()&&c.data("showItemAssocDeletePopover")?(h.increaseCount("checkout:item-association:delete:selected",
1),setTimeout(function(){H("#ia-delete-trigger-"+c.data("itemAssocGroupId")).trigger("click")},100)):(u(!1,b),l.hideById(c.closest(".a-popover").data("aPopoverId")))}function G(a){if(!d.protectAgainstDoubleAction("order-summary-update-quantity",200)){h.resetMetrics();var b=a.$currentTarget,c=b.closest(".lineitem"),e=b.find("select"),f=e.length?e:b;S=c.data("entityId");e=H('.update-quantity-error[data-itemid\x3d"'+S+'"]');J=R=null;f.is("select")?(R=b.find("select"),N=f.val()):(J=c.find(".quantity-input"),
N=J.val());Q!==N&&(X=f.is("select")?R.parent():J,""===N?K(c):"Delete"===N||0===parseInt(N,10)?(a.$event.preventDefault(),d.protectAgainstDoubleAction("delete-item")||(c=a.$currentTarget.closest(".lineitem"),S=c.data("entityId"),N=0,c.data("isBundleDelete")?H("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click"):(u(!1,void 0),l.hideById(c.closest(".a-popover").data("aPopoverId"))))):(a=parseInt(H("#quantity-input-max-value").val(),10),d.validateNumber(N,0,a)?(e.hide(),c.blur(),c.data("isBundleDelete")?
H("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click"):u(!1)):v(S,"changeQuantity_quantityNotInRange")))}}function K(a){a.find(".quantity-input").val(Q)}function P(b,c,d){var e=c.data("itemAssocGroupId"),f="a:sheet:beforeShow:ia-delete-mbs-"+e,g="a:sheet:afterHide:ia-delete-mbs-"+e;a.on(f,function C(b){b=b.sheet.getContentContainer();var c=H("#ia-delete-"+e).html();c&&(b.empty(),b.html(c));a.off(f,C)});r.when("a-dropdown").execute(function(c){a.on(g,function qa(){h.increaseCount("checkout:item-association:delete:canceled",
1);H("#ia-delete-trigger-"+e).data("isItemAssocAlreadyDeleted")||(N=d,R.data("currentQuantity",d),c.getSelect(b).setValue(d));a.off(g,qa)})});H("#ia-delete-trigger-"+e).trigger("click")}function O(){return f.isSPP()?H("#revieworder").hasClass("expanded")?!0:!1:0<H("div.spc").length?!0:!1}var H=a.$;if(!H("html").hasClass("a-ie6")){var N,Q,S,R,J,V=!1,W=!1,X,ha=q.P&&q.P.AUI_BUILD_DATE,E={addOn:"addOn",pantryMOV:"pantryMOV"};a.declarative("change-quantity",["click","touchend"],function(a){if(!d.protectAgainstDoubleAction("lock-update-quantity",
200)){a=a.$currentTarget;var b=!0;a.addClass("hidden");a=a.closest(".quantity-block");a.find(".change-quantity").addClass("hidden");a.find(".quantity-display").addClass("hidden");a.find(".quantity-display-block-tablet").addClass("hidden");a.find(".dynamic-quantity-update").removeClass("hidden").find(".hidden").each(function(){var a=H(this);a.removeClass("hidden");a.is("input")&&(a.focus(),a.select(),a.unbind("keydown.update-quantity-spc").bind("keydown.update-quantity-spc",function(a){13===a.which&&
a.preventDefault()}),a.unbind("keyup.update-quantity-spc").bind("keyup.update-quantity-spc",function(a){13!==a.which||b||H(a.target).closest(".dynamic-quantity-update").find(".update-quantity-button").trigger("click")}))});setTimeout(function(){b=!1},500)}});a.declarative("order-summary-get-quantity",["click","touchend"],function(a){d.protectAgainstDoubleAction("order-summary-get-quantity",200)||a.$currentTarget.find("select").length&&(Q=a.$currentTarget.find("select").val())});a.declarative("order-summary-update-quantity",
["change"],G);a.declarative("order-summary-update-quantity-text-field",["click","touchend"],G);a.declarative("order-summary-handle-text-input",["keydown"],function(a){13===a.$event.which?(a.$event.preventDefault(),G(a)):d.limitInputToNumbers(a)});a.declarative("order-summary-show-update-button",["change","keyup"],function(a){var b=a.$currentTarget.closest(".quantity-text-field").find(".update-quantity-link"),c=a.$currentTarget.is("input")?a.$currentTarget.val():a.$currentTarget.find("input").val(),
d=a.$currentTarget.find("input").data("currentQuantity");Q=d;-1===parseInt(c,10)||""===c?("change"===a.type&&K(a.$currentTarget.closest(".lineitem")),b.hide()):parseInt(c,10)!==d?b.show():b.hide()});a.declarative("trigger-update-quantity-button",["keydown"],function(a){13===a.$event.which&&(a.$event.preventDefault(),a.$currentTarget.closest(".quantity-block").find(".update-quantity-button").trigger("click"))});a.declarative("toggle-update-quantity-button",["change","keyup"],function(a){var b=a.$currentTarget.closest(".quantity-block").find(".update-quantity-button"),
c=a.$currentTarget.find("input"),d=c.val(),e=c.data("currentQuantity");""===d?("change"===a.type&&c.val(e),b.hide()):parseInt(d,10)!==e?b.show():b.hide()});a.declarative("update-quantity",["click","touchend"],function(a){h.resetMetrics();a=a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a");var b=a.closest(".quantity-block"),c=a.closest(".dynamic-quantity-update"),e=c.find(".quantity-input");c.length||(e=b.find(".quantity-input"));if(d.protectAgainstDoubleAction("lock-update-quantity",
200))e.focus();else{var f=e.val();S=a.data("entityId");var g=H('.update-quantity-error[data-itemid\x3d"'+S+'"]'),l=parseInt(H("#quantity-input-max-value").val(),10);d.validateNumber(f,0,l)?(g.hide(),c.find(".a-form-error").removeClass("a-form-error"),e.removeClass("a-form-error"),f=parseInt(f,10),J=e,Q=J.data("currentQuantity"),Q=parseInt(Q,10),f===Q?(b.find(".change-quantity-button").closest(".a-declarative").removeClass("hidden"),b.find(".quantity-display").removeClass("hidden"),b.find(".quantity-display-block-tablet").removeClass("hidden"),
c.addClass("hidden").children().addClass("hidden")):(N=f,X=a,a.blur(),a.data("isBundleDelete")?H("#pb-delete-trigger-"+a.data("bundleGroupId")).trigger("click"):u(!1))):v(S,"changeQuantity_quantityNotInRange")}});H(document).delegate(".spc-quantity-dropdown","change",function(a){R=H(a.currentTarget);h.resetMetrics();ha?(a=R.next(),S=a.data("entityId"),Q=a.data("currentQuantity")):(h.increaseCount("removeauijs21"),S=R.data("entityId"),Q=R.data("currentQuantity"));a=R.find(":selected");N=parseInt(a.val(),
10);if(Q!==N){var b=H("#toggleDropdownQuantityTrigger");b.length&&N===parseInt(b.val(),10)?(a=R.closest(".quantity-block"),a.find(".spc-quantity-dropdown-button").hide(),a.find(".quantity-input").show()):(X=R.parent(),R.blur(),a&&a.data("isBundleDelete")?H("#pb-delete-trigger-"+a.data("bundleGroupId")).trigger("click"):p.isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled()&&a&&a.data("showItemAssocDeletePopover")||u(!1))}});a.on("a:dropdown:select",function(a){if(p.isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled()&&
(a=H(a.nativeItemNode))&&a.data("showItemAssocDeletePopover")){h.increaseCount("checkout:item-association:delete:selected",1);var b=a.closest("select"),c=ha?b.next().data("currentQuantity"):b.data("currentQuantity");P(b,a,c)}});a.declarative("item-assoc-delete-confirm",["click","touchend"],function(a){if(!d.protectAgainstDoubleAction("item-assoc-delete-confirm")){h.increaseCount("checkout:item-association:delete:confirmed",1);u(!1);var b=H(a.$target).data("itemAssocGroupId");H("#ia-delete-trigger-"+
b).data("isItemAssocAlreadyDeleted",1);r.when("a-sheet").execute(function(a){var c=a.get("ia-delete-mbs-"+b);c&&a.hideSheet(c)})}});a.declarative("item-assoc-delete-cancel",["click","touchend"],function(){d.protectAgainstDoubleAction("item-assoc-delete-cancel")||(h.increaseCount("checkout:item-association:delete:canceled",1),N=Q)});a.declarative("dont-delete-item",["click","touchend"],function(a){a.$event.preventDefault();d.protectAgainstDoubleAction("dont-delete-item")||l.hideById(a.$currentTarget.closest(".a-popover").data("aPopoverId"))});
a.declarative("delete-item",["click","touchend"],function(a){a.$event.preventDefault();d.protectAgainstDoubleAction("delete-item")||t(a)});a.declarative("delete-prime-membership-item-confirm",["click","touchend"],function(a){a.$event.preventDefault();if(!d.protectAgainstDoubleAction("delete-prime-membership-item-confirm")){var b={additionalData:{deletePrimeMembership:1,primeMembershipASIN:(a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a")).data("asin")}};t(a,b)}});a.declarative("bundle-delete",
["click","touchend"],function(){d.protectAgainstDoubleAction("bundle-delete")||u(!1)});a.declarative("bundle-delete-action",["click","touchend"],function(a){d.protectAgainstDoubleAction("bundle-delete-action")||(r.when("a-popover-base").execute(function(b){b.get(a.data.popoverName).hide()}),u(!1))});a.declarative("egc-delete",function(a){S=a.entityId;N=0;u(!0)});a.declarative("bundle-dont-delete",["click","touchend"],function(){d.protectAgainstDoubleAction("bundle-dont-delete")||(N=Q,r.when("a-dropdown").execute(function(a){R&&
(a.getSelect(R).setValue(Q.toString()),R.data("currentQuantity",N))}))});a.declarative("pantry-return-to-cart-btn",["click","touchend"],function(){d.protectAgainstDoubleAction("pantry-return-to-cart-btn")||O()&&B()});a.declarative("pantry-delete-items-btn",["click","touchend"],function(){!d.protectAgainstDoubleAction("pantry-delete-items-btn")&&O()&&(W=!0,H(".a-button-close").trigger("click"),u(!0))});a.declarative("pantry-cancel-delete-btn",["click","touchend"],function(){d.protectAgainstDoubleAction("pantry-cancel-delete-btn")||
O()&&A(E.pantryMOV)});a.on("a:popover:hide:pantry-mov-popover",function(){O()&&(W||A(E.pantryMOV))});a.declarative("addon-return-to-cart",["click","touchend"],function(){d.protectAgainstDoubleAction("addon-return-to-cart")||O()&&B()});a.declarative("addon-delete-items",["click","touchend"],function(){d.protectAgainstDoubleAction("addon-delete-items")||(O()&&(V=!0,H(".a-button-close").trigger("click"),u(!0)),f.isSPP()&&h.increaseCount("checkout:spp-revieworder:addon_delete_pri",1))});a.declarative("addon-dont-delete",
["click","touchend"],function(){d.protectAgainstDoubleAction("addon-dont-delete")||(O()&&A(E.addOn),f.isSPP()&&h.increaseCount("checkout:spp-revieworder:addon_keep_pri",1))});a.on("a:popover:hide:addon-warning-normal",function(){0<H("div.spc-mobile").length?B():O()&&(V||A(E.addOn))});a.on("a:popover:hide:addon-warning-special",function(){O()&&(V||A(E.addOn))});a.on("checkout:reload:spc",x);a.on("checkout:reload:spp-revieworder",x)}});r.when("A","ready").execute(function(a){a.on("a:popover:beforeShow",
function(a){if(a.popover.$trigger.hasClass("quantity-dropdown-button")){var k=a.popover.$popover,e=k.closest("div.a-dropdown");e.length&&(a.popover.$iframe.css("max-height","260px"),k.css("max-height","260px"),k=e.find("div.a-popover-inner"),k.css({"max-height":"260px"}),a.popover.updatePosition(),k.css({"overflow-y":"scroll"}))}})});"use strict";r.when("A","page-transition-controller","page-conductor","ajax-utility").register("tax-exemption-controller",function(a,m,k,e){function f(a,d,c){return c.getResponseHeader("x-amz-checkout-page")?
k.ajaxUpdatePage(a,d,c,{pushNewFrame:"false"}):(a=e.jsonify(a))?k.redirect(a):k.redirect()}function g(a,d){var b=d.$target.data("entityId");if(b){m.show();var e={isClientTimeBased:l('input[name\x3d"useCtb"]').val(),fromAnywhere:l("input[name\x3dfromAnywhere]").val()};e=e||{};d={returnFullHTML:1,cachebuster:(new Date).getTime(),isClientTimeBased:0,hasWorkingJavascript:1};l.extend(d,e);d.entityId=b;d.optOut=a;a=k.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});l.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/tax-exemption-optout.html",
data:l.param(d),dataType:"text",async:!0,cache:!1,headers:a,success:f,error:k.ajaxRedirect})}else q.ueLogError&&q.ueLogError({name:"MissingData",message:"lineItemId is undefined, when trying to opt out from tax exemption",logLevel:"FATAL"})}var l=a.$;l("html").hasClass("a-ie6")||(a.declarative("tax-exemption-opt-out",["click","touchend"],function(a){g(!0,a)}),a.declarative("tax-exemption-opt-in",["click","touchend"],function(a){g(!1,a)}))});"use strict";r.when("A").execute(function(a){return{}});
"use strict";r.when("A","page-transition-controller","page-conductor").register("sns-subscription-controller",function(a,m,k){function e(a){var b=a.closest(".sns-upsell,.sns-upsell-mobile,.sns-upsell-tablet");if(a.length&&b.length){var d=b.data("index"),c=b.find("span.sns-change-delivery-txt");c&&c.text(a.find("option:selected").data("date"));c=a.find("option:selected").data("epoch");a=a.find("option:selected").val();b.find("input[type\x3d'hidden'][name\x3d'sns_nextDelivery"+d+"']").val(c);b.find("input[type\x3d'hidden'][name\x3d'sns_frequency"+
d+"']").val(a)}}function f(a,b){m.show();var d=a.data("index"),c=(new Date).getTime(),e=a.find("input[type\x3d'hidden'][name\x3d'sns_lineItemIdentifier"+d+"']").attr("value"),f=a.find("input[type\x3d'hidden'][name\x3d'sns_merchantId"+d+"']").attr("value"),l=a.find("input[type\x3d'hidden'][name\x3d'sns_asin"+d+"']").attr("value");a=a.find("input[type\x3d'hidden'][name\x3d'sns_frequency"+d+"']").attr("value");b=b.prop("checked")||b.find("[type\x3dcheckbox]").is(":checked");c={returnpipedata:0,returnFullHTML:1,
cachebuster:c,hasWorkingJavascript:1};c.lineItemIdentifier=e;c.isONMLSelected=b?1:0;c.merchantId=f;c.asin=l;c.frequency=a;e=k.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});g.ajax({type:"POST",url:"/gp/buy/spc/handlers/set-sns-options.html",data:g.param(c),dataType:"text",async:!0,cache:!1,headers:e,success:function(a,b,c){return k.ajaxUpdatePage(a,b,c)},error:function(a,b,c){k.ajaxRedirect(a,b,c)}})}var g=a.$;g("html").hasClass("a-ie6")||function(){var l=g(document);l.delegate(".sns-option",
"click",function(a){a=g(this);f(a.closest(".sns-upsell"),a)});l.delegate(".sns-option-mobile","click",function(a){var b=g(this);a.target.name&&"snsSetCreateSubscription"===a.target.name&&f(b.closest(".sns-upsell-mobile"),b)});l.delegate(".sns-option-tablet","click",function(a){a=g(this);f(a.closest(".sns-upsell-tablet"),a)});l.delegate(".sns-upsell-nextdelivery","change",function(){e(g(this))});a.declarative("sns-upsell-nextdelivery-dropdown","change",function(a){e(g(a.$target))});l.delegate(".sns-upsell-learn-more",
"click",function(a){var b=g(this);a=b.width();var c=b.height(),e=b.position();b=b.find(".sns-upsell-popover-learn-more");b.removeClass("aok-hidden");var f=b.width();b.height();b.css({top:e.top+c,left:e.left-(f-a)/2,position:"absolute"})});l.delegate(".sns-upsell-learn-more-close","click",function(a){(a=g(this))&&a.closest(".sns-upsell-popover-learn-more")&&a.closest(".sns-upsell-popover-learn-more").addClass("aok-hidden");return!1})}()});"use strict";r.when("A","client-side-metrics").register("trialSignPrefetchCommon",
function(a,m){function k(){e()&&(h().val(0),m.increaseCount("TrialSign:js:activated"),f(),r!==G&&c(),r=a.interval(d,5E4),y=0)}function e(){return 0!==h().length&&0!==p("input[name\x3d'purchaseID']").length}function f(){q!==G&&q.abort();q=a.ajax("/gp/buy/spc/handlers/trigger-trial-sign.html",{method:"post",params:{purchaseId:p("input[name\x3d'purchaseID']").val()},success:g,error:l,abort:b})}function g(a,b,c){h().val(a.signPurchaseTrialId);q=G;m.increaseCount("TrialSign:js:success")}function l(a,b,
d){c();q=G;m.increaseCount("TrialSign:js:failed")}function b(){c();q=G;m.increaseCount("TrialSign:js:aborted")}function d(){y++;10<y?c():(m.increaseCount("TrialSign:js:retry"),m.increaseCount("TrialSign:js:retry:"+y),f())}function c(){r!==G&&(clearInterval(r),r=G)}function h(){return p("input[name\x3d'trialSignId']")}var p=a.$,q,r,y=0;a.on("checkout:reload:spc",k);a.on("checkout:reload:spclite",k);a.on("checkout:billing-address-update",k);return{makeTrialSignCall:f,trialSignCallSucceeded:g,isTrialSignActivated:e}});
"use strict";r.when("A","page-transition-controller","client-side-metrics","page-conductor").register("recurring-delivery-line-item",function(a,m,k,e){function f(a,b,e){if("undefined"===typeof a)throw k.increaseCount("Checkout:B2B:RD:RecurrencePeriod:Update:JSFailure:VariableUndefined:"+b,1),e.show(),Error("Provided variable is undefined");e.hide()}function g(a,c,h){f(a,"updateRecurrencePeriod",c);f(a.lineItemId,"updateRecurrencePeriod-lineItemId",c);var d=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc",
"x-amz-checkout-transition":"ajax"});l.ajax({type:"POST",url:"/gp/buy/spc/handlers/update-recurrence-period.html",data:{recurrencePeriod:b,encodedLineItemEntityId:a.lineItemId,relatedRequestId:a.relatedRequestId},dataType:"json",cache:!1,headers:d,success:function(a,b){k.increaseCount("Checkout:B2B:RD:RecurrencePeriod:Update:"+b,1);l("#b2brd-frdd").text(a.firstRecurringDeliveryDate);h.hide();c.hide();m.hide()},error:function(b){k.increaseCount("Checkout:B2B:RD:RecurrencePeriod:Update:"+b,1);l("#b2brd-cadence-selector").find(".a-dropdown-prompt").text(a.selectedRecurrencePeriodDisplayString);
h.hide();c.show();m.hide()}});m.show()}var l=a.$,b;a.declarative("b2brd-cadence-dropdown-change","change",function(a){var c=l("#update-recurrence-period-error"),d=l("#update-recurrence-period-link");f(a,"b2brd-cadence-dropdown-change",c);a=a.$event.target.value;f(a,"handleDropdownChange",c);d.show();b=a});a.declarative("update-recurrence-period","click",function(a){var b=l("#update-recurrence-period-error"),d=l("#update-recurrence-period-link");f(a,"update-recurrence-period",b);g(a.data,b,d)});a.declarative("update-recurrence-period-mobile",
"change",function(a){var c=l("#update-recurrence-period-error"),d=l("#update-recurrence-period-link");f(a,"update-recurrence-period-mobile",c);var e=a.$event.target.value;f(e,"handleDropdownChange",c);d.show();b=e;g(a.data,c,d)})});"use strict";r.when("A","client-side-metrics","ajax-utility","button-blocker","button-blocker-popover","spclite-items-viewer","fast-track-controller").register("get-final-results-update",function(a,m,k,e,f,g,l){function b(){for(var b=function(){a.trigger("checkout:spc:ordersummary:sizeChanged")},
c=0;20>c;++c)setTimeout(b,100*c)}function d(a,c){setTimeout(function(){var d=g.prepare(a);d&&v("#spclite-items-operation").show();v("#spclite-items-header-dynamic").fadeIn(c?0:300,function(){d&&v("#spclite-items-operation").find(".spclite-items-view-switch").each(function(){var a=v(this).attr("view-name");a&&v(this).find("a").click(function(){m.increaseCount("SPCLite:ClientSide:SwitchViewClick:"+a,1);g.switchToView(a);v("#spclite-items-operation").fadeOut(c?0:300);b()})})})},c?0:800)}function c(b,
c,d){if(b&&v.isArray(b))for(var e=!1,f=0;f<b.length;f++){var g=b[f];if(g.identifier&&g.content){var h=v("#"+c+"-"+g.identifier);h&&0!==h.length?a.slideDown(h.html(g.content),d?0:500,"ease-out",function(){}):(m.increaseCount("SPCLite:LazyContentPlaceHolderMissing:Item:"+c,1),e||(m.increaseCount("SPCLite:LazyContentPlaceHolderMissing:Page:"+c,1),e=!0))}}}function h(e,f){if(e.presentCVs&&0<e.presentCVs.countOfCVs)p();else{e.orderSummaryHTML&&(a.fadeOut(v("#order-summary-footer"),f?0:250,"ease-out"),
a.fadeOut(v("#spc-order-summary"),f?0:250,"ease-out",function(){v("#spc-order-summary").replaceWith(e.orderSummaryHTML).hide();e.additionalOrderSummaryHTML&&v("#order-summary-footer").html(e.additionalOrderSummaryHTML);a.fadeIn(v("#spc-order-summary"),f?0:400,"ease-out");a.fadeIn(v("#order-summary-footer"),f?0:400,"ease-out")}));e.freshDeliveryMessageHTML&&(v("#lazy-fresh-promise-delivery-message").html(e.freshDeliveryMessageHTML),a.slideDown(v("#lazy-fresh-promise-delivery-message"),f?0:500,"ease-out"),
l.spcLiteLazyLoadFastTrack());c(e.itemToPrimeMembershipDelivery,"lazy-membership-delivery",f);c(e.itemToGiftContentMapping,"lazy-gift-options",f);c(e.itemToShipOfferingMapping,"lazy-ship-method",f);c(e.itemToPromise,"lazy-promise",f);e.freshDeliverySlotInformationHTML&&(v("#lazy-fresh-delivery-slot-information").html(e.freshDeliverySlotInformationHTML),a.slideDown(v("#lazy-fresh-delivery-slot-information"),f?0:250,"ease-out"));e.freshDeliveryInstructionsHTML&&(v("#lazy-fresh-delivery-instructions").html(e.freshDeliveryInstructionsHTML),
a.slideDown(v("#lazy-fresh-delivery-instructions"),f?0:250,"ease-out"));if(e.itemToPromoMapping&&v.isArray(e.itemToPromoMapping))for(var g=v("#items-block"),h=0;h<e.itemToPromoMapping.length;h++){var k=e.itemToPromoMapping[h];"lightningdeal"===k.type?g.find(".lazy-lightning-promo-details-"+k.identifier).removeClass("aok-hidden"):"promotion"===k.type&&g.find(".lazy-promo-details-"+k.identifier).removeClass("aok-hidden")}e.freeShippingId&&v("#"+e.freeShippingId).removeClass("aok-hidden");v("input#isOrderSummaryReady").val(1);
d(e.itemGroupData,f);b()}}function p(){var b=v("#spclite-block-order-place-message").html()||"";e.show("disabled-order-place",b);e.lock();f.create({name:"disabled-order-place",content:b});f.lock();var c=e.getButtonBlocker().data("a-popover-id");a.on("checkout:beforeReload",function(){f.unlock();e.unlock();f.destroy();v("#a-popover-"+c).remove()})}function r(a){if(a&&a.data){try{var b=q.atob(a.data)}catch(B){return m.increaseCount("SPCLite:FinalResult:Base64Decode:Failure",1),null}if((b=k.jsonify(b))&&
!v.isEmptyObject(b))return b}return null}var v=a.$,y,w=function(a,b){function c(){if(f&&0!==f.length){for(var a="",b=0;b<d%3+1;b++)a+=".";f.html(a);d++}}var d=0,e,f;this.start=function(){b&&b.useTextAnimate&&(d=0,f=a.find(".spclite-loading-text .spclite-processing-indicator"),e=setInterval(c,800))};this.stop=function(){e&&(clearInterval(e),f&&0<f.length&&f.html(""),d=0);a.find(".spclite-loading-spinner").hide();b&&b.showTextAlways||a.find(".spclite-loading-text").hide()}};a.on("checkout:reload:spclite",
function(){if("1"===v('script[type\x3d"spclite-encoding"]').attr("data-base64-encode-final-results")){var a=r(q.__spcliteFinalResultsData);if(a){h(a,!0);return}}else if(q.__spcliteFinalResultsData){h(q.__spcliteFinalResultsData,!0);return}a="";var b=v("input#executionId").val();b&&(a+="executionId\x3d"+b);return v.ajax({type:"GET",url:"/gp/buy/spclite/handlers/get-final-results.html/ref\x3dox_spclite_get_final_results",data:a,dataType:"text",async:!0,beforeSend:function(a){y=new w(v("#spclite-order-summary-loading-indicator"),
{showTextAlways:!0});y.start();q.uet&&q.uet("bb","SPCLite:ClientSide:Perf:FinalAjax",{wb:1})},success:function(a,b,c){a=k.jsonify(a);"1"===v('script[type\x3d"spclite-encoding"]').attr("data-base64-encode-final-results")?(a=r(a))?h(a,!1):p():a&&!v.isEmptyObject(a)?h(a,!1):p()},error:function(a,b,c){p()},complete:function(a){y.stop();q.uex&&q.uex("ld","SPCLite:ClientSide:Perf:FinalAjax",{wb:1})},cache:!1})});a.on("checkout:beforeLoadPage",function(){q.__spcliteFinalResultsData=G})});"use strict";r.when("A",
"client-side-metrics").register("spclite-items-viewer",function(a,m){function k(){var a=f("#spclite-items-block").find(".spclite-item-detail");a&&0<a.length&&(l={},a.each(function(a){a=f(this).attr("entity-id");l[a]=f("\x3cp\x3e\x3c/p\x3e").append(f(this).clone().removeClass("a-span-last")).html()}))}function e(a,d){if(!d||0===d.length)return null;a=f('\x3cdiv class\x3d"a-row spclite-item-view" view-type\x3d"order-by-delivery"\x3e\x3c/div\x3e');var b=d;d=[];for(var e=[],g=0;g<b.length;g++){var k=
b[g];if("normal"!==k.type)e.push(k);else{for(var m=0;m<d.length;)if(k.data.destinationAddressId!==d[m].data.destinationAddressId)m++;else break;for(;m<d.length;)if(k.data.destinationAddressId===d[m].data.destinationAddressId&&k.data.promise.starttime.dayepoch>d[m].data.promise.starttime.dayepoch)m++;else break;d.splice(m,0,k)}}for(b=0;b<e.length;b++)switch(k=e[b],k.type){case "primemembership":d.unshift(k);break;case "vas":case "digital":case "no-promise":case "exception":d.push(k);break;default:d.push(k)}for(e=
0;e<d.length;e++){k=d[e];if(b=k.content)g='\x3cdiv class\x3d"row spclite-item-group-title"\x3e',b.destination&&(g+='\x3cdiv class\x3d"row destination"\x3e'+b.destination+"\x3c/div\x3e"),b.promise&&(g+='\x3cdiv class\x3d"row promise"\x3e'+b.promise+"\x3c/div\x3e"),g+="\x3c/div\x3e",a.append(g);a:if(b=k.items,l&&b&&0!==b.length){g="";for(m=0;m<b.length;m++){0===m%2&&(g+='\x3cdiv class\x3d"a-row"\x3e');var q=b[m].identifier;if(!l[q]){b=null;break a}q=f(l[q]);1===m%2&&q.addClass("a-span-last");g+=f("\x3cp\x3e\x3c/p\x3e").append(q).html();
1===m%2&&(g+="\x3c/div\x3e")}1===b.length%2&&(g+='\x3cdiv class\x3d"a-column a-span6 a-span-last"\x3e\x3c/div\x3e\x3c/div\x3e');b=g}else b=null;if(b)b=f(b),("no-promise"===k.type||"normal"===k.type&&k.data&&k.data.promise&&"scheduled"!==k.data.promise.type)&&b.find(".spclite-promise").hide(),a.append(b);else return null;e<d.length-1&&a.append("\x3chr\x3e")}return a}var f=a.$,g,l;return{prepare:function(a){try{a:{k();if(l){var b=e("order-by-delivery",a);if(b){g={"order-by-delivery":b};var c=!0;break a}}c=
!1}return c}catch(h){m.increaseCount("SPCLite:ClientSide:Exception:SwitchViewPrepare",1)}return!1},switchToView:function(a,d){if(g&&g[a])var b=g[a];else m.increaseCount("SPCLite:ClientSide:SwitchViewNoPrepared:"+a,1),"order-by-delivery"===a&&(b=e(a,d));if(b){var h=f("#spclite-items-block");h.find(".spclite-item-view").fadeOut(300,function(){h.empty();h.append(b.clone().hide());h.find(".spclite-item-view").fadeIn(500)})}}}});"use strict";r.when("A","loading-spinner-controller").register("cpf-controller",
function(a,m){function k(a){if(/^\d{11}$/.test(a)||/^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(a)){a=a.replace(/[^\w\s]|_/g,"");if(/(\d)\1{10}/.test(a))return!1;var e=a.substring(0,9);var f=a.substring(9);var b=0;for(var d=10;1<d;d--)b+=e.charAt(10-d)*d;if((2>b%11?0:11-b%11)!==f.charAt(0))return!1;e=a.substring(0,10);b=0;for(a=11;1<a;a--)b+=e.charAt(11-a)*a;return(2>b%11?0:11-b%11)!==f.charAt(1)?!1:!0}return!1}var e=a.$;a.on("checkout:reload:spp-taxid",function(){e("#useThresholdTaxIdService").length||e("#taxidForm").submit(function(){var a=
e("#taxidregistration-imb");if(!k(e("#taxid-field").val()))return m.hideSpinner(e("#spinner-anchor"),!0),a.show(),!1;a.hide();return!0})})});"use strict";r.when("A","page-conductor","ready").register("taxid-threshold-controller",function(a,m){function k(){var a=e();m.isSPP()?a?(f("#taxid-continue-disabled").hide(),f("#taxid-continue-enabled").show()):(f("#taxid-continue-enabled").hide(),f("#taxid-continue-disabled").show()):a?f("span.#continue").removeClass("a-button-disabled").find('input[type\x3d"submit"]').removeAttr("disabled"):
f("span.#continue").addClass("a-button-disabled").find('input[type\x3d"submit"]').attr("disabled","disabled")}function e(){var a=!0,e=f("#taxIdForm");e.length&&e.find('input[type\x3d"text"]').each(function(){var b=f(this);if(!b.val()||7>b.val().length)b.parents(".taxid-form").find('input[type\x3d"checkbox"]').attr("checked")||(a=!1)});return a}var f=a.$;a.on("checkout:reload:spp-taxid",function(){if(f("#useThresholdTaxIdService").length){var a=f("#taxIdForm");a.length&&(a.find('input[type\x3d"text"]').keyup(k),
a.find('input[type\x3d"checkbox"]').change(k));k()}})});"use strict";r.when("A","page-conductor","loading-spinner-controller","taxaddress-page-config","ready").register("taxaddress-controller",function(a,m,k,e){function f(){m.isSPP()&&(l(),b())}function g(){if(m.isSPP()){var a=h(r.taxregistrationnumberInputIdSelector).val();h(r.taxregistrationnumberInputIdSelector).val(a.replace(q,""));a=h(r.businesslegalnameInputIdSelector).val();h(r.businesslegalnameInputIdSelector).val(a.trim());l();b()}}function l(){if(r.isChewbaccaURL){var a=
c(h(r.taxregistrationnumberInputIdSelector).val()),b=c(h(r.businesslegalnameInputIdSelector).val());a&&b?h(r.taxaddressFormIdSelector).attr("action",r.formActionNonSifEncryptionUrl):h(r.taxaddressFormIdSelector).attr("action",r.formActionSifEncryptionUrl)}}function b(){var a=h("#taxid-continue-enabled"),b=h("#taxid-continue-disabled");var d=h(r.taxregistrationnumberInputIdSelector).val();var e=h(r.businesslegalnameInputIdSelector).val();if(c(d)&&c(e))d=!0;else{e=!e||c(e.toString().trim());var f=c(h(r.taxaddressInputNameSelector).val());
d=c(d)||!p.test(d)||e||f?!1:!0}d?(a.show(),b.hide()):(a.hide(),b.show());d=c(h(r.taxregistrationnumberInputIdSelector).val())&&c(h(r.businesslegalnameInputIdSelector).val())?r.continueLabel:r.saveContinueLabel;a.find("span.a-button-text").text(d);b.find("span.a-button-text").text(d)}function d(){if(y)y=!1;else{var a=h(r.taxregistrationnumberInputIdSelector).val().trim(),b=h(r.businesslegalnameInputIdSelector).val().trim();if(!c(a)||!c(b)){var d={tax_registration_number:a,business_legal_name:b};h.ajax({type:"POST",
url:r.sifEncryptionUrl,dataType:"json",data:d,success:function(a,b,e){c(d.tax_registration_number)?h(r.taxregistrationnumberInputIdSelector).val(""):h(r.taxregistrationnumberInputIdSelector).val(a.sifEncryptedTaxId);c(d.business_legal_name)?h(r.businesslegalnameInputIdSelector).val(""):h(r.businesslegalnameInputIdSelector).val(a.sifEncryptedLegalName);y=!0;h(r.taxaddressFormIdSelector).submit()},error:function(a,b,c){console.log("[taxaddress-controller.js] Error while encrypting the input fields. Error Type: "+
b+" tax_registration_number: "+d.tax_registration_number+" business_legal_name: "+d.business_legal_name)}});return!1}}}function c(a){return!a||0===a.toString().length}var h=a.$,p=/^\d{11}$/,q=/\s+/g,r=e.getConfig(),y=!1;a.on("checkout:reload:spp-taxaddress",function(){h(r.taxregistrationnumberInputIdSelector).keyup(g).blur(g);h(r.businesslegalnameInputIdSelector).keyup(f).blur(g);h('input:radio[name\x3d"'+r.taxaddressInputName+'"]').each(function(){h(this).change(f)});r.isChewbaccaURL=-1!=r.formActionSifEncryptionUrl.indexOf("/checkout/p/p-");
r.isChewbaccaURL||h(r.taxaddressFormIdSelector).submit(d);f()});return{getNewTaxAddressPopoverURL:function(){return r.newTaxAddressPopoverURL},submitTaxAddressFormWithNewAddressId:function(a){h(r.newTaxaddressInputIdSelector).val(a);k.showSpinner(h(r.taxAddressPanelSelector),!1);h(r.taxaddressFormIdSelector).submit()}}});r.when("A","address-popovers","taxaddress-controller","ready").register("taxaddress-addresspopover-helper",function(a,m,k){m.actionRegisterTaxAddressController(k)});"use strict";
r.when("A","page-spinner-controller","ajax-utility","page-conductor","client-side-metrics").execute(function(a,m,k,e,f){function g(){function d(a){if(!g)if(a.preventDefault(),a=encodeURIComponent(l("#spc-deliverytipinput").val()),l("#tip-error").addClass("aok-hidden"),l("#tip-promo-success").addClass("aok-hidden"),l("#tip-success").addClass("aok-hidden"),l("#tip-ineligible").addClass("aok-hidden"),l("#tip-success").addClass("aok-hidden"),a&&0!==a.length)if(0>a)f("invalidDeliveryTip_NoAmount");else if(/^[0-9]*(\.[0-9]{1,2})?$/.test(a)){m.show();
k=l("#spc-deliverytipnoticecheckbox").attr("checked")?1:0;var b=(new Date).getTime();a="tipamount\x3d"+a+"\x26isDefaultTip\x3d"+k+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+l("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+b;b=e.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});l.ajax({type:"POST",url:"/gp/buy/spc/handlers/add-delivery-tip.html/ref\x3dox_tip_page_delivery_tip_add",data:a,
headers:b,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",complete:function(){g=!1;m.hide()},success:c,error:e.ajaxRedirect});g=!1}else f("invalidDeliveryTip_NoAmount");else f("addDeliveryTip_NoAmount")}function c(a,b,c){m.hide()}function f(a){m.hide();l("#tip-error").removeClass("aok-hidden");0<l("div.spc-desktop").length?l("#spc-deliverytipinput").addClass("a-form-error"):l("#spc-deliverytipinput").closest(".a-input-text-wrapper").addClass("a-form-error");l("#"+
a).removeClass("aok-hidden")}var g=!1,k=0;b&&(a.declarative("tip-element",["click"],function(a){var b=a.data.click;b&&null!==b&&d(a.$event)}),b=!1)}var l=a.$;if(!l("html").hasClass("a-ie6")){var b=!0;a.on("checkout:reload:spc",g);a.on("checkout:reload:spclite",g)}});"use strict";r.when("A","checkout-general-utils","page-conductor","loading-spinner-controller").register("checkout-feedback-controller",function(a,m,k,e){function f(){if(!l||"function"!==typeof l)return"";var a=l(),d="";if(a)for(var c in a)if("number"===
typeof a[c]||"string"===typeof a[c]||"boolean"===typeof a[c])d+="\x26__pagedata_"+c+"\x3d"+a[c];return d}var g=a.$,l;a.declarative("checkout-submit-feedback",["click","touchend"],function(a){if(!m.protectAgainstDoubleAction("checkout-submit-feedback",200)&&(a=g("#checkout-feedback-form"),a.length)){e.showSpinner(a,!1);var b=a.serialize();b+=f();g.ajax({type:"POST",url:a.attr("action"),data:b,dataType:"text",error:k.ajaxRedirect,success:function(a,b,d){b=d.getResponseHeader("checkout-feedback-submitted");
g(".a-button-close").trigger("click");null!==b&&b!==G&&g("#checkout-feedback-banner").append(a)}})}});return{registerPageDataCollecter:function(a){a&&"function"===typeof a&&(l=a)}}});"use strict";r.when("A","page-spinner-controller","scroll-controller","ajax-utility","page-conductor","checkout-modal-popover","page-detector-current-page","checkout-general-utils","a-popover","client-side-metrics").execute(function(a,m,k,e,f,g,l,b,d,c){function h(){function b(a){a=a.$currentTarget.closest(".delivery-instructions-block");
a.find(".edit-delivery-instructions-link").addClass("aok-hidden");a.find(".delivery-instructions-display").addClass("aok-hidden");var b=a.find(".dynamic-delivery-instructions-update").find(".delivery-instructions-input").attr("maxlength");a.find(".dynamic-delivery-instructions-update").removeClass("aok-hidden");p("#deliveryInstructions").focus();p("#deliveryInstructions").select();p("#deliveryInstructions").keydown(function(a){10===a.which&&a.preventDefault()});p("#deliveryInstructions").keyup(function(){p("#delivery-instructions-left-text").hasClass("aok-hidden")&&
p("#delivery-instructions-left-text").removeClass("aok-hidden");var a=b-p(this).val().length;0>a&&(a=0);p("#delivery-instructions-left").text(a)});setTimeout(function(){},500)}function c(a){m.show();a=a.$currentTarget;var b=p("#deliveryInstructions").val(),c=a.closest(".delivery-instructions-block"),e=a.closest(".dynamic-delivery-instructions-update");c.find(".edit-delivery-instructions-link").removeClass("aok-hidden");c.find(".delivery-instructions-display").removeClass("aok-hidden");e.addClass("aok-hidden");
c=(new Date).getTime();b="deliveryInstructions\x3d"+encodeURIComponent(b)+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+p("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+c;c=f.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":l.getCurrentPage()});p.ajax({type:"POST",url:"/gp/buy/spc/handlers/add-delivery-instructions.html/ref\x3dox_instructions_page_delivery_instructions_update",data:b,headers:c,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
dataType:"text",complete:function(){m.hide()},success:d,error:f.ajaxRedirect});a.blur()}function d(a,b,c){(a=e.jsonify(a))&&!p.isEmptyObject(a)&&p("#deliveryInstructionsDisplay").html(a.deliveryInstructions);m.hide()}q&&(a.declarative("edit-delivery-instructions",["click"],b),a.declarative("update-delivery-instructions",["click"],c),q=!1)}var p=a.$;if(!p("html").hasClass("a-ie6")){var q=!0;a.on("checkout:reload:spc",h);a.on("checkout:reload:spclite",h);a.on("checkout:reload:spp-shipaddress",h);a.on("checkout:reload:spp-f3-sosp",
h);a.on("checkout:reload:spp-payment",h)}});"use strict";r.when("A","page-conductor","page-transition-controller").register("installments-service",function(a,m,k){var e=a.$;return{call:function(a,g,l,b){k.show();e.ajax({type:"POST",url:"/checkout/p/"+b+"/ihi/setinhouseinstallments",data:{itemId:a,programId:g},dataType:"text",async:!0,cache:!1,headers:m.setAjaxTransitionHeader(),success:l.success||null,error:l.error||null})},sendReftag:function(a){e.post("/gp/buy/spc/handlers/pmts-continue-widget.html/ref\x3d"+
a)}}});"use strict";r.when("A","page-transition-controller","page-conductor","page-detector","button-blocker","installments-service","client-side-metrics","widgets/installmentsModal/state","allow-installments-page-transition","weblab-helper").register("installments-controller",function(a,m,k,e,f,g,l,b,d,c){function h(){a.defer(q)}function p(a,b,c){d.isEnabled?k.ajaxUpdatePage(a,b,c,{pushNewFrame:"true"}):(m.hide(),k.ajaxUpdatePage(a,b,c,{pushNewFrame:"false"}))}function q(){var a=r("#installments-button-blocker");
1===a.length&&(a=a.data("blocker-message"),f.show("place-order-installments-blocker",a))}var r=a.$;a.declarative("installments-sync-state",["change"],function(a){var c=r("#trigger-installments-modal");if(c.length){b.$target=a.$target;b.bundleAsin=a.data.bundleAsin;b.asin=a.data.asin;b.itemId=a.data.itemId;b.isChecked=b.$target.is(":checked");b.programId=b.isChecked?a.data.programId:"";b.purchaseId=a.data.purchaseId;var d={success:p,error:k.ajaxRedirect};b.handlerData=d;var e=b.isChecked?"Checkout:Installments:UpdateOptIn":
"Checkout:Installments:UpdateOptOut";if(b.isChecked)c=b.asin,d=b.bundleAsin,g.call(b.itemId,b.programId,b.handlerData,a.data.purchaseId),d?g.sendReftag("installments_toggle_on_asin_"+c+"_bundle_asin_"+d):g.sendReftag("installments_toggle_on_asin_"+c);else{d=b.itemId;var f=b.programId,h=b.handlerData,m=b.asin,q=b.bundleAsin;a=a.data.purchaseId;q&&c.length?(g.sendReftag("installments_toggle_off_asin_"+m+"_bundle_asin_"+q),c.click()):(g.sendReftag("installments_toggle_off_asin_"+m),g.call(d,f,h,a))}}else c=
a.data.itemId,f=(e=a.$target.is(":checked"))?a.data.programId:"",d={success:p,error:k.ajaxRedirect},e=e?"Checkout:Installments:UpdateOptIn":"Checkout:Installments:UpdateOptOut",g.call(c,f,d,a.data.purchaseId);l.increaseCount(e)});a.declarative("page-transit-invalidate-ric","click",function(a){if(!k.isAnimating()){a.$event.preventDefault();var b=a.$currentTarget.closest("div.spp-panel");m.shrinkPanel(b,!0);b={invalidate:!0,gurupaRicCSRFToken:r("#gurupaRicCSRFToken").val()};l.increaseCount("Checkout:RetailInstallmentContract:Invalidate");
var d="/checkout/p/p-"+a.data.purchaseId+"/ihi/deleteretailinstallmentcontract?pipelineType\x3dChewbacca\x26referrer\x3dspc";c.isInHouseInstallmentsTangoEnabled()?k.ajaxUpdate(a.data.url,b,{pushNewFrame:"true"}).done(function(){l.increaseCount("Checkout:RetailInstallmentContract:Invalidate:UpdateSuccess",1)}).fail(function(){l.increaseCount("Checkout:RetailInstallmentContract:Invalidate:UpdateFailure",1)}):r.ajax({type:"POST",url:d,data:b,async:!0,cache:!1,headers:k.setAjaxTransitionHeader(),success:k.redirect,
error:k.redirect})}});a.on("checkout:reload:spp-revieworder",h);a.on("checkout:reload:spc",h)});"use strict";r.when("A","page-conductor","checkout-modal-popover","page-transition-controller","ajax-utility","page-detector","payments-portal-common","ready").register("spc-payments-portal",function(a,m,k,e,f,g,l){function b(b,c){c={refTag:c,callbackBeforePageUpdate:function(){a.$("div.a-popover button.a-button-close").trigger("click")}};m.isSPP()&&(c.keepCachedPagesData=1);m.loadPage("spc",b,null,c)}
function d(a,b,d){m.isSPP()?(e.blockAllActions(),e.showTransitionInContainer(c("#payment"))):e.show();a="/gp/buy/spc/handlers/pmts-continue-widget.html/ref\x3d"+a;var f=m.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});c.ajax({type:"POST",url:a,data:b,headers:f,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",success:function(a,b,c){c.getResponseHeader("x-amz-checkout-page")?m.ajaxUpdatePage(a,b,c):d(a)},error:m.ajaxRedirect})}
var c=a.$;return{prepareDelegatedPopovers:function(b){function d(a,b){a=c(a);a.data("aCheckoutModalPopover",b);k.createModal({$declarativeParent:a},b)}a.on("pmts:retail:billing-address-popover",function(a){d(".pmts-change-address-link",{header:b.billingAddressPopoverHeader,footer:"",name:"billing-address",allowScrollOnPage:!0})});a.on("pmts:retail:rewards-registration",function(a){d(".pmts-shop-with-points-learn-more-link",{header:b.rewardsRegistrationPopoverHeader,footer:"",name:"rewards-registration",
allowScrollOnPage:!0})})},handleClaimCodeSubmittedEvent:function(a,b){var e={returnjson:"1",returnFullHTML:"1",hasWorkingJavascript:"1",fromAnywhere:c("input[name\x3dfromAnywhere]").val(),cachebuster:(new Date).getTime(),nextAction:"pipeline-dispatch",embedOnlyData:"1"};a=c.param(a)+"\x26"+c.param(e);d("ox_pay_page_gc_add",a,function(a){l.claimCodePageUpdater(b,a)})},handleChangeBillingAddressRequestedEvent:function(){g.isDesktopSpc()?m.isSPP()?c("#pmts-change-billing-address-popover").trigger("click"):
a.trigger("pmts:retail:billing-address-popover"):(e.show(),m.isPipeliningOn()&&b("billingaddressselect","ox_spc_change_ship_addr"))},handleChangePaymentInstrumentRequestedEvent:function(){e.show();m.isPipeliningOn()&&b("payselect","ox_spc_change_payment")},handleRewardsAccountLearnMoreRequestedEvent:function(){a.trigger("pmts:retail:rewards-registration")},handlePointsAccountSubmittedEvent:function(a){var b={hasWorkingJavascript:"1",isClientTimeBased:c("input[name\x3duseCtb]").val(),nextAction:"dispatch"};
a=c.param(a)+"\x26"+c.param(b);d("ox_spc_points_edit",a,function(a){a=f.jsonify(a);m.redirect(a)})}}});"use strict";r.when("ajax-utility","gc-redeem-controller","page-transition-controller","ready").register("payments-portal-common",function(a,m,k){return{claimCodePageUpdater:function(e,f){f=a.jsonify(f);null!==f?f.widgetJsonData?(e.update(f.widgetJsonData),k.hide()):f.autohandlererror&&m.giftSystemErrorHandling(f.autohandlererror):k.hide()}}});"use strict";r.when("A","page-detector-current-page",
"a-button","a-meter").register("checkout-throttle-error",function(a,m,k,e){var f=a.$;a.on("checkout:reload:throttle",function(){if(f("#checkout-throttle-meter").length){var a=1E3*f('input[name\x3d"waiting-time"]').val()/100;k("#checkout-throttle-return-to-cart").disable();var l=e("#checkout-throttle-meter"),b=0,d=setInterval(function(){l.percent(b);if(100>b)b+=1;else{clearInterval(d);var a=k("#checkout-throttle-return-to-cart");a.text(f("#checkout-throttle-primary-button-active-text").text());a.enable()}},
a)}})});"use strict";r.when("A","weblab-helper").register("nav-bar-helper",function(a,m){function k(){try{r.register("navCF")}catch(e){if(-1===e.message.toLowerCase().indexOf("already registered"))throw e;}}if(m.isNavCFWeblabOn())a.on("checkout:reload",k)});"use strict";r.register("pipeline-dispatch-endpoint",function(){return{get:function(a){return a}}});r.when("A").execute(function(a){a.declarative("remaining-customizations-action","click",function(a){a.$currentTarget.parent().find(".remaining_customization_info").removeClass("aok-hidden");
a.$currentTarget.hide();a.$event.preventDefault()})});"use strict";r.when("A","checkout-federation-utilities","client-side-metrics").register("checkout-federation-wrapper",function(a,m,k){function e(a){for(var e=[],b=f;b<a.length;b++)e.push(a[b]);return e}var f=2;return{wrap:function(a,f){try{return a.apply(null,e(arguments))}catch(h){var b=f,d=h;var c=m.getExternalDependecies()[b];c=c!==G&&null!==c?c.cti:"Undefined";k.logError(d,"["+b+"] Javascript error thrown while executing wrapper",c,"FATAL");
q.console&&q.console.error&&q.console.error(d,b,c)}}}});"use strict";r.when("A","jQuery","checkout-federation-utilities").register("checkout-federation-injector",function(a,m,k){function e(a){a=a.assetsModule;if(f[a]?0:0<m('script[type\x3d"checkout-asset-trigger"][data-checkout-asset-trigger\x3d"'+a+'"]').length)f[a]=!0,r.register("trigger"+a,function(){})}var f={};a.on("checkout:reload",function(){var a=k.getExternalDependecies(),f;for(f in a)a.hasOwnProperty(f)&&e(a[f])})});"use strict";r.when("A",
"client-side-metrics").register("checkout-federation-utilities",function(a,m){return{getExternalDependecies:function(){var k=a.state("triggerExternalDependencies");Object&&Object.keys&&m.increaseCount("Checkout:ExternalDependencies:count:"+(k?Object.keys(k).length:"undefined"));return k===G||null===k?{}:k}}});"use strict";r.register("allow-installments-page-transition",function(){return{isEnabled:!0}})});
/* ******** */
