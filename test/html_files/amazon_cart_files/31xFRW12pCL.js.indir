'use strict';mix_d("P13NSCCards__p13n-desktop-list:p13n-desktop-list__lEMXWAzO","exports tslib @p/A @c/metrics @c/scoped-dom @c/aui-carousel @c/dom @c/remote-operations @p/a-carousel-framework @c/logger @c/aui-untrusted-ajax @c/browser-operations".split(" "),function(F,t,M,B,N,O,P,Q,R,S,T,U){function x(a){return a&&"object"===typeof a&&"default"in a?a:{"default":a}}var n=x(M),v=x(N),V=x(O),W=x(Q),X=x(R),z=x(S),Y=x(T),Z=x(U),G={},C=function(a,d,b){void 0===d&&(d="");void 0===b&&(b=1);d=a+d;G.hasOwnProperty(d)||
(G[d]=!0,B.count(a,(B.count(a)||0)+b))},aa=function(a){C(n["default"].capabilities.mobile?"Card:EERU:SharedLib:mobile:render":"Card:EERU:SharedLib:desktop:render");var d=function(c,e){c={$event:{preventDefault:n["default"].$.noop,stopPropagation:n["default"].$.noop},$target:c.getContent().find('[data-a-tab-name="'+e+'"]'),data:{name:"energyEfficiencyTabSet"}};n["default"].trigger("a:declarative:a-tabs:click",c)},b=function(c,e){var h=c&&c.$event,f=c&&c.data||{},p=f.activeTabName,l=f.modalHeight,q=
f.name;h&&h.preventDefault&&h.preventDefault();h&&h.stopPropagation&&h.stopPropagation();h=e.get(q);h||(n["default"].on("a:popover:beforeShow:"+q,function(g){g.popover&&g.popover.getContent&&(g=g.popover.getContent(),g.find(".a-manually-loaded").parent().css("min-height",l),n["default"].loadDescendantImagesManually(g))}),h=e.create(c.$target,f));h.show();d(h,p)};a.when("a-secondary-view").execute("RegisterEnergyEfficiencyEventMobile",function(c){n["default"].declarative("card-energy-efficiency-secondary-view",
"click",function(e){C("Card:EERU:SharedLib:mobile:click",e&&e.data&&e.data.name||"");b(e,c)})});a.when("a-modal").execute("RegisterEnergyEfficiencyEventDesktop",function(c){n["default"].declarative("card-energy-efficiency-modal","click",function(e){C("Card:EERU:SharedLib:desktop:click",e&&e.data&&e.data.name||"");b(e,c)})})},ba=function(a){a.when("ready").execute("EEBadgeProductFicheResize",function(d){var b=n["default"].$;b(".energyEfficiencyContainer").each(function(c,e){c=b(e).find(".energyEfficiencyProductFicheLabel").first();
e=b(e).find("svg").first();c.parent().outerHeight()>e.outerHeight()&&(c.removeClass("a-size-small"),c.addClass("a-size-micro"),c.parent().outerHeight()>e.outerHeight()&&c.parent().css("line-height","10px"))})})},H=function(){var a=window.P;aa(a);ba(a)},ca={ctiList:["Website/Personalization/Report a Problem CX"],category:"Website",type:"Personalization",item:"Report a Problem CX",folder:"9c9c97c9-6f69-4dba-a55d-26045c6a3068",group:"P13N Report a Problem CX"},da=[{ctiList:["Website/Personalization/Similarities",
"Website/Detail Page/Similarities"],category:"Website",type:"Personalization",item:"Similarities",folder:"4d16d05d-9a17-4b36-b8fe-9ee159ff81de",group:"Similarities"}],ia=function(a){var d=v["default"].cardRoot.querySelector(".p13n-report-flag"),b=Z["default"].setup();b.define("showFlag","mouseover",function(){d.classList.remove("p13n-report-flag-hide")});b.define("hideFlag","mouseout",function(){d.classList.add("p13n-report-flag-hide")});b.attach("showFlag",a);b.attach("hideFlag",a);var c=v["default"].cardRoot.querySelector(".internal-flag-form"),
e=c.querySelector(".internal-flag-env-data").dataset,h=c.querySelector(".internal-flag-title-text"),f=c.querySelector(".internal-flag-description").firstElementChild,p=c.querySelector(".internal-flag-alias"),l=c.querySelector(".internal-flag-response-message"),q=function(g){g.preventDefault();g=function(r){return!r||!r.trim()};if(g(h.value)||g(f.value)||g(p.value))return D(l,!1,"Something went wrong. One of the required fields was missing."),!1;g=v["default"].cardRoot.querySelectorAll(".a-dynamic-image");
var k;if(k=v["default"].cardRoot.querySelector(".a-carousel-heading")){var u=ea(a,g.length);k="Internal user reported issue '"+h.value+"' with widget: "+k.innerText}else u=fa(a),k="Internal user reported issue '"+h.value+"'";g=ha(g,u,f.value,p.value,e);var m=ca;da.forEach(function(r){r.ctiList.includes(e.cti)&&(m=r)});Y["default"].post("https://p13ngoals.corp.amazon.com/sims",{accepts:"text/html, application/json",contentType:"application/json;charset=UTF-8"},{sim_params:{assigned_folder:m.folder,
description:g,descriptionContentType:"text/amz-markdown-sim",extensions:{tt:{assignedGroup:m.group,category:m.category,impact:5,item:m.item,type:m.type}},tags:[{id:"internal-problem-generated"}],title:k}}).then(function(r){D(l,!0,r)}).catch(function(r){D(l,!1,r)});return!1};c.onsubmit=function(g){return q(g)};b=v["default"].cardRoot.querySelector(".p13n-desktop-report-problem-flag-data");if(b.dataset.name)n["default"].on("a:popover:hide:"+b.dataset.name,function(){c.reset();l.innerText=""})},ea=function(a,
d){if(!a.dataset.aCarouselOptions)return z["default"].log("Empty ASIN List in carouselElement.dataset.aCarouselOptions","ERROR"),[];a=JSON.parse(a.dataset.aCarouselOptions).ajax.id_list;var b=v["default"].cardRoot.querySelector(".a-carousel-firstvisibleitem");b=(Number(b.value)||1)-1;return a.map(function(c){return JSON.parse(c).id}).slice(b,b+d)},fa=function(a){return(a=a.dataset.asinList)?a.split(","):[]},ha=function(a,d,b,c,e){for(var h="",f=0;f<a.length;f++){var p=a[f];h+=(p?"![]("+p.src+")":
"IMAGE MISSING")+"\nASIN: "+(d[f]?d[f]:"ASIN MISSING")+"\n\n"}return"**This SIM-T ticket is created by the 'Report a Problem' internal tool. To know more, here's its wiki: https://w.amazon.com/bin/view/Personalization/CoreRecommendations/Projects/Canaries/Report-a-Problem-UX-on-P13NWidget/UserGuide/**\n\n**Alias:** ["+(c+"](https://phonetool.amazon.com/users/"+c+")\n**Comment:** "+b+"\n\n**Widget Group ID:** "+e.widgetGroupId+"\n**Strategy ID:** "+e.strategyId+"\n**CTI:** "+e.cti+"\n**Facets:** ")+
(e.facets+"\n**Content Reftag:** "+e.reftag+"\n"+(""!==e.baseAsin?"**Page ASIN:** "+e.baseAsin+"\n":"")+"\n**SessionID:** ")+(e.sessionId+"\n**MarketplaceID:** "+e.marketplaceId+"\n**Device Type:** "+e.deviceType+"\n\n**List of ASINs:**\n\n")+h},D=function(a,d,b){d?(a.classList.remove("a-color-error"),b.responseBody&&"object"===typeof b.responseBody?b.responseBody.response&&b.responseBody.response.id?a.innerHTML="Success, here's the <a href=\"https://t.corp.amazon.com/"+b.responseBody.response.id+
'" target="_blank">SIM-T ticket</a> you created.':(z["default"].log("Fail to find the id of the SIM-T ticket created in the response body of response data.","ERROR"),a.innerText="Success, but we could not find the link to the SIM-T ticket."):(z["default"].log("The response body of response data is not an object.","ERROR"),a.innerText="Success, but we could not find the link to the SIM-T ticket.")):(a.classList.add("a-color-error"),a.innerText="string"===typeof b?b:"Oops! Something went wrong. Please try again.")},
ja={setupModal:function(a){return t.__awaiter(void 0,void 0,void 0,function(){var d;return t.__generator(this,function(b){d=v["default"].cardRoot.querySelector(".p13n-report-problem-modal-root");if(!d)return[2];ia(a);return[2]})})}},I=[],ka=function(a){var d=Array.prototype.slice.call(a.querySelectorAll("[data-metrics]"));d.push(a);d.forEach(function(b){if(b&&b.dataset&&b.dataset.metrics&&(!b.id||!I.includes(b.id))){var c=JSON.parse(b.dataset.metrics),e;for(e in c)c.hasOwnProperty(e)&&B.count(e,c[e]);
b.removeAttribute("data-metrics");b.id&&I.push(b.id)}})},J=/(?=[ \-\/])|(?=[\u3105-\u312F])|(?=[\u31A0-\u31BA])|(?=[\u4E00-\u9FD5])|(?=[\u3400-\u4DB5])|(?=[\uF900-\uFAFF])|(?=[\u3040-\u309F])|(?=[\u30A0-\u30FF])|(?=[\u3190-\u319F])/,K=/[^\/\-\[\]():\s]/,la=function(a){var d=n["default"].$("<div>")[0];d.classList.add("p13n-sc-offscreen-truncate");var b=parseInt(a.getAttribute("data-rows")||"2",10),c=function(){var f=a.innerHTML;a.innerHTML="&hellip;";var p=a.clientHeight;a.innerHTML=f;return p}();
if(b){if(c){var e=function(f){d.innerHTML=f;return Math.round(d.clientHeight/c)<=b},h=function(f,p){f=f.split(p);var l=Math.floor(a.clientWidth/12),q=function(k){d.classList.add("p13n-sc-offscreen-truncate");d.style.overflow="hidden";d.textContent=k;a.appendChild(d);k=a.clientWidth>=a.scrollWidth;a.removeChild(d);return k},g=function(k){var u=k.length-l;k.trim().length>l&&!q(k)&&Array.prototype.slice.call(k).map(function(m,r){return r>l&&r<=u&&K.test(m)?"&shy;"+m:m});return k};return f.map(function(k){return g(k)}).join("")};
return{truncate:function(){var f=a.innerHTML.trim(),p=a.textContent||"";f=h(f,J);a.appendChild(d);if(e(f))a.removeChild(d),a.innerHTML=f;else{var l=f.split(J);for(var q=1,g=l.length,k,u,m=0;q!==g;)if(k=Math.floor((g+q)/2),u=l.slice(0,k).join("")+"&hellip;",e(u)){if(1>=g-k){for(m=k;0<m&&!K.test(l[m-1]);)m--;break}q=k}else g=k;l=0===m?void 0:l.slice(0,m).join("")+"&hellip;";l?(a.innerHTML=l,a.setAttribute("title",p)):(z["default"].log("Unable to successfully truncate line "+f,"ERROR"),a.removeChild(d))}}}}z["default"].log("Truncation element does not have a line height or it is zero",
"ERROR")}else z["default"].log("Truncation element missing necessary line number data","ERROR")},ma=function(a){var d=Array.prototype.slice.call(a.getElementsByClassName("p13n-sc-truncate"));a=a.getElementsByClassName("p13n-sc-truncate-fallback");(window.CSS&&CSS.supports&&CSS.supports("-webkit-line-clamp","1")?d:d.concat(Array.prototype.slice.call(a))).filter(function(b){return!!b.offsetParent}).map(function(b){var c=la(b);c&&(c.truncate(),b.classList.add("p13n-sc-truncated"),b.classList.remove("p13n-sc-truncate"),
b.classList.remove("p13n-sc-truncate-fallback"),b.className=b.className.replace(/p13n-sc-line-clamp-\d/g,""))})},sa={initCarousel:function(a){return t.__awaiter(void 0,void 0,void 0,function(){var d,b,c;return t.__generator(this,function(e){d=(a||{}).afterPageLoaded;b=v["default"].cardRoot.classList.contains("p13n-sc-shoveler")?[v["default"].cardRoot]:Array.prototype.slice.call(v["default"].cardRoot.getElementsByClassName("p13n-sc-shoveler"));c=W["default"].setup(["getCarouselItems"]);if(null===b||
void 0===b||!b.length)return[2];b.forEach(function(h){return t.__awaiter(void 0,void 0,void 0,function(){var f,p,l,q,g;return t.__generator(this,function(k){switch(k.label){case 0:f=function(){n["default"].loadDynamicImage("[data-name]='"+g+"' .p13n-sc-dynamic-image");ma(h);ka(h);null===d||void 0===d?void 0:d(h);H()};f();if(h.classList.contains("p13n-carousel-initialized"))return[2];h.classList.add("p13n-carousel-initialized");p=X["default"].getCarousel(P.unscope(h));l=V["default"].getCarousel(h);
q=h.dataset||{};g=p.getAttr("name");return[4,Promise.all([l.initialized,ja.setupModal(h)])];case 1:return k.sent(),n["default"].on("a:carousel:"+g+":change:pageSize",f),n["default"].on("a:carousel:"+g+":change:loading",f),n["default"].on("a:carousel:"+g+":change:animating",f),n["default"].on("a:carousel:"+g+":change:fetchedItems",f),l.attachRemoteOperation(function(u){var m=u.indexes;u=u.ids;var r=c,na=r.getCarouselItems,oa=t.__assign,pa=t.__assign({},q),qa=String(m[0]||0);var ra=m[0]||0,y,E,L=0,
w=q.aCarouselOptions?q.aCarouselOptions:void 0;if(w&&(w=JSON.parse(w),w=null===(y=null===w||void 0===w?void 0:w.ajax)||void 0===y?void 0:y.id_list))for(y=0;y<ra&&y<w.length;y++){var A=JSON.parse(w[y]);"true"===((null===(E=null===A||void 0===A?void 0:A.metadataMap)||void 0===E?0:E.isSponsoredProduct)?A.metadataMap.isSponsoredProduct:"false")&&(L+=1)}return na.call(r,oa.call(t,pa,{ids:u,indexes:m,offset:qa,adOffset:L}))}),[2]}})})});return[2]})})}};F._operationNames=["getValue"];F.card=function(){return t.__awaiter(void 0,
void 0,void 0,function(){var a;return t.__generator(this,function(d){a=function(){return t.__awaiter(void 0,void 0,void 0,function(){var b;return t.__generator(this,function(c){switch(c.label){case 0:return b=v["default"].cardRoot.id,n["default"].loadDynamicImage("#"+b+" .p13n-sc-dynamic-image"),[4,sa.initCarousel()];case 1:return c.sent(),H(),[2]}})})};a();n["default"].on("p13n:swapRecommendations",a);return[2]})})}});
